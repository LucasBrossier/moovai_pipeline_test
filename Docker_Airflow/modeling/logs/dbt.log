[0m21:52:30.306638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f69bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf5880>]}


============================== 21:52:30.309467 | a470702b-5d4e-4fb0-9869-6c5cd267f440 ==============================
[0m21:52:30.309467 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:52:30.309786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project/profile', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:30.317277 [info ] [MainThread]: dbt version: 1.8.6
[0m21:52:30.317472 [info ] [MainThread]: python version: 3.12.1
[0m21:52:30.317617 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m21:52:30.317744 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m21:52:30.317877 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project/profile
[0m21:52:30.318001 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project/profile/profiles.yml
[0m21:52:30.318121 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m21:52:30.318245 [info ] [MainThread]: Configuration:
[0m21:52:30.318363 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m21:52:30.318477 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m21:52:30.318650 [info ] [MainThread]: Required dependencies:
[0m21:52:30.318795 [debug] [MainThread]: Executing "git --help"
[0m21:52:30.336990 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m21:52:30.337557 [debug] [MainThread]: STDERR: "b''"
[0m21:52:30.337731 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:52:30.337904 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:52:30.338136 [info ] [MainThread]: [31m2 checks failed:[0m
[0m21:52:30.338274 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project/profile/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m21:52:30.338410 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml> not found

[0m21:52:30.339778 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.064454414, "process_user_time": 0.577065, "process_kernel_time": 0.102389, "process_mem_max_rss": "92962816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:52:30.340142 [debug] [MainThread]: Command `dbt debug` failed at 21:52:30.340080 after 0.06 seconds
[0m21:52:30.340388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104656510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036976e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca5400>]}
[0m21:52:30.340614 [debug] [MainThread]: Flushing usage events
[0m21:56:37.761577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f3cb0>]}


============================== 21:56:37.764343 | 31820591-5efe-4e7e-93fd-b53a870b3ef2 ==============================
[0m21:56:37.764343 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:56:37.764672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project/profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:37.772613 [info ] [MainThread]: dbt version: 1.8.6
[0m21:56:37.772846 [info ] [MainThread]: python version: 3.12.1
[0m21:56:37.772982 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m21:56:37.773108 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m21:56:37.773507 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m21:56:37.775307 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/task/debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/task/debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/task/debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m21:56:37.776603 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.027119666, "process_user_time": 0.554981, "process_kernel_time": 0.097273, "process_mem_max_rss": "92635136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:37.776968 [debug] [MainThread]: Command `dbt debug` failed at 21:56:37.776915 after 0.03 seconds
[0m21:56:37.777165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10325dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10363f320>]}
[0m21:56:37.777372 [debug] [MainThread]: Flushing usage events
[0m21:57:48.736186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041226c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dfce0>]}


============================== 21:57:48.739024 | a78d0f8f-16ac-4328-a228-96aa7a6a2dfc ==============================
[0m21:57:48.739024 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:57:48.739336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project/profiles', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:48.747392 [info ] [MainThread]: dbt version: 1.8.6
[0m21:57:48.747676 [info ] [MainThread]: python version: 3.12.1
[0m21:57:48.747819 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m21:57:48.747952 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m21:57:48.748244 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m21:57:48.750023 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/task/debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/task/debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/brossierlucas/programmation/moovai_pipeline_test/venv/lib/python3.12/site-packages/dbt/task/debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m21:57:48.751697 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.026491333, "process_user_time": 0.565504, "process_kernel_time": 0.085614, "process_mem_max_rss": "92127232", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:48.751963 [debug] [MainThread]: Command `dbt debug` failed at 21:57:48.751918 after 0.03 seconds
[0m21:57:48.752137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046733e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465dd90>]}
[0m21:57:48.752308 [debug] [MainThread]: Flushing usage events
[0m22:05:10.275147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f07200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104969f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104969c70>]}


============================== 22:05:10.278012 | c491ab3d-c9b2-4c03-99f7-ec6443689c59 ==============================
[0m22:05:10.278012 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:05:10.278362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:05:10.286850 [info ] [MainThread]: dbt version: 1.8.6
[0m22:05:10.287070 [info ] [MainThread]: python version: 3.12.1
[0m22:05:10.287212 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m22:05:10.287340 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:05:10.287477 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:05:10.287595 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:05:10.287709 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:05:10.287834 [info ] [MainThread]: Configuration:
[0m22:05:10.287947 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m22:05:10.288057 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m22:05:10.288233 [info ] [MainThread]: Required dependencies:
[0m22:05:10.288370 [debug] [MainThread]: Executing "git --help"
[0m22:05:10.309137 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:05:10.309807 [debug] [MainThread]: STDERR: "b''"
[0m22:05:10.309987 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:05:10.310180 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:05:10.310433 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:05:10.310669 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/brossierlucas/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m22:05:10.310842 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml> not found

[0m22:05:10.312328 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.066794544, "process_user_time": 0.581365, "process_kernel_time": 0.090007, "process_mem_max_rss": "92471296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:10.312709 [debug] [MainThread]: Command `dbt debug` failed at 22:05:10.312640 after 0.07 seconds
[0m22:05:10.312970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491d5e0>]}
[0m22:05:10.313198 [debug] [MainThread]: Flushing usage events
[0m22:08:45.186810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e09ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e09c10>]}


============================== 22:08:45.189486 | 10e67219-6445-4f1d-a201-22bf1dd3f3ee ==============================
[0m22:08:45.189486 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:08:45.189784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:08:45.198020 [info ] [MainThread]: dbt version: 1.8.6
[0m22:08:45.198240 [info ] [MainThread]: python version: 3.12.1
[0m22:08:45.198381 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m22:08:45.198508 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:08:45.198637 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:08:45.198756 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:08:45.198874 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:08:45.199050 [info ] [MainThread]: Configuration:
[0m22:08:45.199168 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m22:08:45.199282 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m22:08:45.199461 [info ] [MainThread]: Required dependencies:
[0m22:08:45.199609 [debug] [MainThread]: Executing "git --help"
[0m22:08:45.211778 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:08:45.212306 [debug] [MainThread]: STDERR: "b''"
[0m22:08:45.212471 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:08:45.212632 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:08:45.212857 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:08:45.213008 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/brossierlucas/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m22:08:45.213152 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml> not found

[0m22:08:45.214885 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.0600365, "process_user_time": 0.580003, "process_kernel_time": 0.092949, "process_mem_max_rss": "93388800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:45.215257 [debug] [MainThread]: Command `dbt debug` failed at 22:08:45.215196 after 0.06 seconds
[0m22:08:45.215522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e838c0>]}
[0m22:08:45.215747 [debug] [MainThread]: Flushing usage events
[0m22:11:26.097642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106313200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d9a0>]}


============================== 22:11:26.100500 | 0b39ed39-2a1a-42b8-83bb-b342acf3657b ==============================
[0m22:11:26.100500 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:11:26.100818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:26.109331 [info ] [MainThread]: dbt version: 1.8.6
[0m22:11:26.109561 [info ] [MainThread]: python version: 3.12.1
[0m22:11:26.109703 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m22:11:26.109831 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:11:26.109963 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:11:26.110078 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:11:26.110192 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:11:26.110309 [info ] [MainThread]: Configuration:
[0m22:11:26.110418 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m22:11:26.110529 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m22:11:26.110699 [info ] [MainThread]: Required dependencies:
[0m22:11:26.110840 [debug] [MainThread]: Executing "git --help"
[0m22:11:26.131223 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:11:26.131930 [debug] [MainThread]: STDERR: "b''"
[0m22:11:26.132119 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:11:26.132295 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:11:26.132517 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:11:26.132653 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/brossierlucas/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m22:11:26.132805 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml> not found

[0m22:11:26.134567 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.069087, "process_user_time": 0.582193, "process_kernel_time": 0.094115, "process_mem_max_rss": "92651520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:26.134952 [debug] [MainThread]: Command `dbt debug` failed at 22:11:26.134887 after 0.07 seconds
[0m22:11:26.135229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d9a0>]}
[0m22:11:26.135468 [debug] [MainThread]: Flushing usage events
[0m22:14:17.620050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcdb20>]}


============================== 22:14:17.622950 | 13da6bc4-bbfb-4fec-8aaa-8a0bab6ecac9 ==============================
[0m22:14:17.622950 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:14:17.623273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:17.631636 [info ] [MainThread]: dbt version: 1.8.6
[0m22:14:17.631865 [info ] [MainThread]: python version: 3.12.1
[0m22:14:17.632009 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m22:14:17.632136 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:14:17.632270 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:14:17.632391 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:14:17.632521 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:14:17.632645 [info ] [MainThread]: Configuration:
[0m22:14:17.632764 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m22:14:17.632878 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m22:14:17.633056 [info ] [MainThread]: Required dependencies:
[0m22:14:17.633207 [debug] [MainThread]: Executing "git --help"
[0m22:14:17.652293 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:14:17.652958 [debug] [MainThread]: STDERR: "b''"
[0m22:14:17.653145 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:14:17.653315 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:14:17.653561 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:14:17.653792 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/brossierlucas/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m22:14:17.654000 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml> not found

[0m22:14:17.655849 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.069869585, "process_user_time": 0.581529, "process_kernel_time": 0.095185, "process_mem_max_rss": "93356032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:17.656203 [debug] [MainThread]: Command `dbt debug` failed at 22:14:17.656144 after 0.07 seconds
[0m22:14:17.656446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079178c0>]}
[0m22:14:17.656663 [debug] [MainThread]: Flushing usage events
[0m22:18:42.471593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10269a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104999d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104999a90>]}


============================== 22:18:42.474553 | 6f8230ca-726a-4edd-a8f4-40a8fbd66e19 ==============================
[0m22:18:42.474553 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:18:42.474864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:42.482813 [info ] [MainThread]: dbt version: 1.8.6
[0m22:18:42.482988 [info ] [MainThread]: python version: 3.12.1
[0m22:18:42.483127 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m22:18:42.483254 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:18:42.485085 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m22:18:42.485311 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:18:42.485445 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:18:42.485568 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:18:42.485690 [info ] [MainThread]: Configuration:
[0m22:18:42.485805 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:18:42.485914 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m22:18:42.486021 [info ] [MainThread]: Required dependencies:
[0m22:18:42.486158 [debug] [MainThread]: Executing "git --help"
[0m22:18:42.498534 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:18:42.499136 [debug] [MainThread]: STDERR: "b''"
[0m22:18:42.499303 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:18:42.499456 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:18:42.499697 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:18:42.499853 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "mooveai_pipeline_modeling", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!


[0m22:18:42.500000 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml> not found

[0m22:18:42.501729 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.06273554, "process_user_time": 0.577477, "process_kernel_time": 0.101012, "process_mem_max_rss": "94093312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:18:42.502055 [debug] [MainThread]: Command `dbt debug` failed at 22:18:42.502004 after 0.06 seconds
[0m22:18:42.502324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10269a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a13bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104999790>]}
[0m22:18:42.502563 [debug] [MainThread]: Flushing usage events
[0m22:20:33.016419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106219700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d760>]}


============================== 22:20:33.019435 | d7f5ab74-a929-420f-a891-fab61661aa35 ==============================
[0m22:20:33.019435 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:20:33.019759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:20:33.027504 [info ] [MainThread]: dbt version: 1.8.6
[0m22:20:33.027686 [info ] [MainThread]: python version: 3.12.1
[0m22:20:33.027828 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m22:20:33.027956 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:20:33.029598 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:20:33.029747 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:20:33.029871 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:20:33.088998 [info ] [MainThread]: Configuration:
[0m22:20:33.089284 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:20:33.089432 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:20:33.089556 [info ] [MainThread]: Required dependencies:
[0m22:20:33.089732 [debug] [MainThread]: Executing "git --help"
[0m22:20:33.102537 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:20:33.103121 [debug] [MainThread]: STDERR: "b''"
[0m22:20:33.103300 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:20:33.103463 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:20:33.103622 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:20:33.103753 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_project'


[0m22:20:33.105490 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.12848233, "process_user_time": 0.63922, "process_kernel_time": 0.094827, "process_mem_max_rss": "96059392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:20:33.105840 [debug] [MainThread]: Command `dbt debug` failed at 22:20:33.105785 after 0.13 seconds
[0m22:20:33.106082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106826450>]}
[0m22:20:33.106311 [debug] [MainThread]: Flushing usage events
[0m22:21:20.883071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106261460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106541b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106541850>]}


============================== 22:21:20.885948 | bad86e49-39f6-4d28-b6b6-022c133e8e94 ==============================
[0m22:21:20.885948 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:21:20.886283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:21:20.894238 [info ] [MainThread]: dbt version: 1.8.6
[0m22:21:20.894418 [info ] [MainThread]: python version: 3.12.1
[0m22:21:20.894555 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/venv/bin/python3.12
[0m22:21:20.894676 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:21:20.896743 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m22:21:20.896985 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:21:20.897122 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:21:20.897250 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:21:20.955177 [info ] [MainThread]: Configuration:
[0m22:21:20.955455 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:21:20.955598 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:21:20.955721 [info ] [MainThread]: Required dependencies:
[0m22:21:20.955892 [debug] [MainThread]: Executing "git --help"
[0m22:21:20.976538 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:21:20.977106 [debug] [MainThread]: STDERR: "b''"
[0m22:21:20.977301 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:21:20.977469 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:21:20.977617 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:21:20.977745 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!


[0m22:21:20.979704 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.12963717, "process_user_time": 0.640326, "process_kernel_time": 0.094758, "process_mem_max_rss": "94683136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:20.980089 [debug] [MainThread]: Command `dbt debug` failed at 22:21:20.980034 after 0.13 seconds
[0m22:21:20.980345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5f8c0>]}
[0m22:21:20.980573 [debug] [MainThread]: Flushing usage events
[0m22:28:58.281893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c19610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c19310>]}


============================== 22:28:58.284687 | fecd7e04-ea89-45eb-87f4-9e45d8092151 ==============================
[0m22:28:58.284687 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:28:58.285031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:58.293449 [info ] [MainThread]: dbt version: 1.8.6
[0m22:28:58.293626 [info ] [MainThread]: python version: 3.12.1
[0m22:28:58.293761 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/venv/bin/python3.12
[0m22:28:58.293908 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:28:59.143373 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:28:59.143620 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:28:59.143765 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:28:59.180462 [info ] [MainThread]: Configuration:
[0m22:28:59.180743 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:28:59.180890 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:28:59.181015 [info ] [MainThread]: Required dependencies:
[0m22:28:59.181184 [debug] [MainThread]: Executing "git --help"
[0m22:28:59.204026 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:28:59.204580 [debug] [MainThread]: STDERR: "b''"
[0m22:28:59.204759 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:28:59.204916 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:28:59.205055 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:28:59.205208 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'


[0m22:28:59.206692 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.9612879, "process_user_time": 0.819948, "process_kernel_time": 0.129807, "process_mem_max_rss": "113524736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:28:59.207059 [debug] [MainThread]: Command `dbt debug` failed at 22:28:59.206997 after 0.96 seconds
[0m22:28:59.207322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bccec0>]}
[0m22:28:59.207562 [debug] [MainThread]: Flushing usage events
[0m22:29:59.908011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f113a0>]}


============================== 22:29:59.910804 | 92ee6ae4-ce89-4da6-a3dd-9a946c4c95a9 ==============================
[0m22:29:59.910804 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:29:59.911116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:29:59.918592 [info ] [MainThread]: dbt version: 1.8.6
[0m22:29:59.918802 [info ] [MainThread]: python version: 3.12.1
[0m22:29:59.918947 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/venv/bin/python3.12
[0m22:29:59.919081 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:29:59.920710 [info ] [MainThread]: target not specified in profile 'dbt_project', using 'default'
[0m22:29:59.920919 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:29:59.921055 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:29:59.921177 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:29:59.979767 [info ] [MainThread]: Configuration:
[0m22:29:59.980041 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:29:59.980187 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:29:59.980305 [info ] [MainThread]: Required dependencies:
[0m22:29:59.980468 [debug] [MainThread]: Executing "git --help"
[0m22:29:59.999182 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:29:59.999878 [debug] [MainThread]: STDERR: "b''"
[0m22:30:00.000053 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:30:00.000218 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:30:00.000363 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:30:00.000490 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'dbt_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m22:30:00.001977 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.12513517, "process_user_time": 0.722732, "process_kernel_time": 0.14108, "process_mem_max_rss": "98779136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:30:00.002372 [debug] [MainThread]: Command `dbt debug` failed at 22:30:00.002309 after 0.13 seconds
[0m22:30:00.002652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105554830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fec050>]}
[0m22:30:00.002882 [debug] [MainThread]: Flushing usage events
[0m22:31:27.905544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a621520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a621250>]}


============================== 22:31:27.908845 | 39277a8b-88e4-4b82-ba1e-638e56ec84e5 ==============================
[0m22:31:27.908845 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:31:27.909176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:31:27.918024 [info ] [MainThread]: dbt version: 1.8.6
[0m22:31:27.918251 [info ] [MainThread]: python version: 3.12.1
[0m22:31:27.918394 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/venv/bin/python3.12
[0m22:31:27.918528 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:31:28.046679 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:31:28.046928 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:31:28.047075 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:31:28.083341 [info ] [MainThread]: Configuration:
[0m22:31:28.083627 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:31:28.083779 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:31:28.083907 [info ] [MainThread]: Required dependencies:
[0m22:31:28.084082 [debug] [MainThread]: Executing "git --help"
[0m22:31:28.107724 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:31:28.108256 [debug] [MainThread]: STDERR: "b''"
[0m22:31:28.108428 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:31:28.108581 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:31:28.108718 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:31:28.108850 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'


[0m22:31:28.110280 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.23688358, "process_user_time": 0.679801, "process_kernel_time": 0.109576, "process_mem_max_rss": "111460352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:31:28.110640 [debug] [MainThread]: Command `dbt debug` failed at 22:31:28.110580 after 0.24 seconds
[0m22:31:28.110897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a177b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9059d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f3770>]}
[0m22:31:28.111118 [debug] [MainThread]: Flushing usage events
[0m22:34:08.851395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103565370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a855b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a852b0>]}


============================== 22:34:08.854210 | ea211dc0-2e7d-4052-b9a1-6dd255ac01c9 ==============================
[0m22:34:08.854210 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:34:08.854552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:08.863368 [info ] [MainThread]: dbt version: 1.8.6
[0m22:34:08.863814 [info ] [MainThread]: python version: 3.12.1
[0m22:34:08.863956 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/venv/bin/python3.12
[0m22:34:08.864086 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:34:08.991066 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:34:08.991311 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:34:08.991459 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:34:09.028058 [info ] [MainThread]: Configuration:
[0m22:34:09.028342 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:34:09.028491 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:34:09.028617 [info ] [MainThread]: Required dependencies:
[0m22:34:09.028884 [debug] [MainThread]: Executing "git --help"
[0m22:34:09.053772 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:34:09.054320 [debug] [MainThread]: STDERR: "b''"
[0m22:34:09.054500 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:34:09.054693 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:34:09.054841 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:34:09.054974 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'


[0m22:34:09.056641 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.23694238, "process_user_time": 0.680973, "process_kernel_time": 0.112619, "process_mem_max_rss": "112574464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:09.057057 [debug] [MainThread]: Command `dbt debug` failed at 22:34:09.056996 after 0.24 seconds
[0m22:34:09.057322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10313f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b89e50>]}
[0m22:34:09.057548 [debug] [MainThread]: Flushing usage events
[0m22:34:25.218767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079aff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b396a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b393d0>]}


============================== 22:34:25.221566 | a02fd17b-12a1-4b3e-9977-ddbb07b9f008 ==============================
[0m22:34:25.221566 [info ] [MainThread]: Running with dbt=1.8.6
[0m22:34:25.221879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:25.229183 [info ] [MainThread]: dbt version: 1.8.6
[0m22:34:25.229422 [info ] [MainThread]: python version: 3.12.1
[0m22:34:25.229570 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/venv/bin/python3.12
[0m22:34:25.229704 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m22:34:25.367889 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m22:34:25.368159 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m22:34:25.368307 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m22:34:25.369687 [info ] [MainThread]: adapter type: duckdb
[0m22:34:25.369873 [info ] [MainThread]: adapter version: 1.8.3
[0m22:34:25.407105 [info ] [MainThread]: Configuration:
[0m22:34:25.407401 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:34:25.407546 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:34:25.407668 [info ] [MainThread]: Required dependencies:
[0m22:34:25.407849 [debug] [MainThread]: Executing "git --help"
[0m22:34:25.426894 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m22:34:25.427490 [debug] [MainThread]: STDERR: "b''"
[0m22:34:25.427667 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:34:25.427844 [info ] [MainThread]: Connection:
[0m22:34:25.428064 [info ] [MainThread]:   database: memory
[0m22:34:25.428319 [info ] [MainThread]:   schema: your_schema_name
[0m22:34:25.428532 [info ] [MainThread]:   path: :memory:
[0m22:34:25.428689 [info ] [MainThread]:   config_options: None
[0m22:34:25.428844 [info ] [MainThread]:   extensions: None
[0m22:34:25.428966 [info ] [MainThread]:   settings: {}
[0m22:34:25.429085 [info ] [MainThread]:   external_root: .
[0m22:34:25.429201 [info ] [MainThread]:   use_credential_provider: None
[0m22:34:25.429317 [info ] [MainThread]:   attach: None
[0m22:34:25.429431 [info ] [MainThread]:   filesystems: None
[0m22:34:25.429542 [info ] [MainThread]:   remote: None
[0m22:34:25.429654 [info ] [MainThread]:   plugins: None
[0m22:34:25.429773 [info ] [MainThread]:   disable_transactions: False
[0m22:34:25.430383 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m22:34:25.472429 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m22:34:25.500284 [debug] [MainThread]: Using duckdb connection "debug"
[0m22:34:25.500526 [debug] [MainThread]: On debug: select 1 as id
[0m22:34:25.500707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:25.511117 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m22:34:25.511640 [debug] [MainThread]: On debug: Close
[0m22:34:25.511804 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:34:25.511959 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:34:25.513504 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.32500958, "process_user_time": 0.702291, "process_kernel_time": 0.122149, "process_mem_max_rss": "119373824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:25.513809 [debug] [MainThread]: Command `dbt debug` succeeded at 22:34:25.513754 after 0.33 seconds
[0m22:34:25.513972 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:34:25.514146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aed910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbb1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b396a0>]}
[0m22:34:25.514347 [debug] [MainThread]: Flushing usage events
[0m08:02:30.743061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084364b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088893d0>]}


============================== 08:02:30.745904 | b5918e61-5980-4ec1-9e42-c87fbd344554 ==============================
[0m08:02:30.745904 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:02:30.746257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:02:30.754629 [info ] [MainThread]: dbt version: 1.8.6
[0m08:02:30.754813 [info ] [MainThread]: python version: 3.12.1
[0m08:02:30.754949 [info ] [MainThread]: python path: /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/venv/bin/python3.12
[0m08:02:30.755073 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m08:02:30.887341 [info ] [MainThread]: Using profiles dir at /Users/brossierlucas/.dbt
[0m08:02:30.887603 [info ] [MainThread]: Using profiles.yml file at /Users/brossierlucas/.dbt/profiles.yml
[0m08:02:30.887747 [info ] [MainThread]: Using dbt_project.yml file at /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project.yml
[0m08:02:30.889114 [info ] [MainThread]: adapter type: duckdb
[0m08:02:30.889300 [info ] [MainThread]: adapter version: 1.8.3
[0m08:02:30.925670 [info ] [MainThread]: Configuration:
[0m08:02:30.925950 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:02:30.926094 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:02:30.926216 [info ] [MainThread]: Required dependencies:
[0m08:02:30.926376 [debug] [MainThread]: Executing "git --help"
[0m08:02:30.949610 [debug] [MainThread]: STDOUT: "b"usage : git [-v | --version] [-h | --help] [-C <chemin>] [-c <nom>=<valeur>]\n           [--exec-path[=<chemin>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<chemin>]\n           [--work-tree=<chemin>] [--namespace=<nom>] [--config-env=<nom>=<var-d-env>] \n           <commande> [<args>]\n\nCi-dessous les commandes Git habituelles dans diverses situations\xc2\xa0:\n\nd\xc3\xa9marrer une zone de travail (voir aussi\xc2\xa0: git help tutorial)\n   clone     Cloner un d\xc3\xa9p\xc3\xb4t dans un nouveau r\xc3\xa9pertoire\n   init      Cr\xc3\xa9er un d\xc3\xa9p\xc3\xb4t Git vide ou r\xc3\xa9initialiser un existant\n\ntravailler sur la modification actuelle (voir aussi\xc2\xa0: git help revisions)\n   add       Ajouter le contenu de fichiers dans l'index\n   mv        D\xc3\xa9placer ou renommer un fichier, un r\xc3\xa9pertoire, ou un lien symbolique\n   restore   Restaurer les fichiers l'arbre de travail\n   rm        Supprimer des fichiers de la copie de travail et de l'index\n\nexaminer l'historique et l'\xc3\xa9tat (voir aussi\xc2\xa0: git help revisions)\n   bisect    Trouver par recherche binaire la modification qui a introduit un bogue\n   diff      Afficher les changements entre les validations, entre validation et copie de travail, etc\n   grep      Afficher les lignes correspondant \xc3\xa0 un motif\n   log       Afficher l'historique des validations\n   show      Afficher diff\xc3\xa9rents types d'objets\n   status    Afficher l'\xc3\xa9tat de la copie de travail\n\nagrandir, marquer et modifier votre historique\n   branch    Lister, cr\xc3\xa9er ou supprimer des branches\n   commit    Enregistrer les modifications dans le d\xc3\xa9p\xc3\xb4t\n   merge     Fusionner deux ou plusieurs historiques de d\xc3\xa9veloppement ensemble\n   rebase    R\xc3\xa9application des commits sur le sommet de l'autre base\n   reset     R\xc3\xa9initialiser la HEAD courante \xc3\xa0 l'\xc3\xa9tat sp\xc3\xa9cifi\xc3\xa9\n   switch    Basculer de branche\n   tag       Cr\xc3\xa9er, lister, supprimer ou v\xc3\xa9rifier un objet d'\xc3\xa9tiquette sign\xc3\xa9 avec GPG\n\ncollaborer (voir aussi\xc2\xa0: git help workflows)\n   fetch     T\xc3\xa9l\xc3\xa9charger les objets et r\xc3\xa9f\xc3\xa9rences depuis un autre d\xc3\xa9p\xc3\xb4t\n   pull      Rapatrier et int\xc3\xa9grer un autre d\xc3\xa9p\xc3\xb4t ou une branche locale\n   push      Mettre \xc3\xa0 jour les r\xc3\xa9f\xc3\xa9rences distantes ainsi que les objets associ\xc3\xa9s\n\n'git help -a' et 'git help -g' listent les sous-commandes disponibles et\nquelques concepts. Voir 'git help <commande>' ou 'git help <concept>'\npour en lire plus \xc3\xa0 propos d'une commande sp\xc3\xa9cifique ou d'un concept.\nVoir 'git help git' pour un survol du syst\xc3\xa8me.\n""
[0m08:02:30.950387 [debug] [MainThread]: STDERR: "b''"
[0m08:02:30.950576 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:02:30.950744 [info ] [MainThread]: Connection:
[0m08:02:30.950908 [info ] [MainThread]:   database: memory
[0m08:02:30.951038 [info ] [MainThread]:   schema: your_schema_name
[0m08:02:30.951160 [info ] [MainThread]:   path: :memory:
[0m08:02:30.951277 [info ] [MainThread]:   config_options: None
[0m08:02:30.951389 [info ] [MainThread]:   extensions: None
[0m08:02:30.951500 [info ] [MainThread]:   settings: {}
[0m08:02:30.951608 [info ] [MainThread]:   external_root: .
[0m08:02:30.951719 [info ] [MainThread]:   use_credential_provider: None
[0m08:02:30.951833 [info ] [MainThread]:   attach: None
[0m08:02:30.951943 [info ] [MainThread]:   filesystems: None
[0m08:02:30.952051 [info ] [MainThread]:   remote: None
[0m08:02:30.952160 [info ] [MainThread]:   plugins: None
[0m08:02:30.952269 [info ] [MainThread]:   disable_transactions: False
[0m08:02:30.952651 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:02:30.956715 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:02:30.982425 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:02:30.982658 [debug] [MainThread]: On debug: select 1 as id
[0m08:02:30.982791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:02:30.992879 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m08:02:30.993417 [debug] [MainThread]: On debug: Close
[0m08:02:30.993583 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:02:30.993742 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:02:30.995022 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.28864214, "process_user_time": 0.690309, "process_kernel_time": 0.136608, "process_mem_max_rss": "119259136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:02:30.995319 [debug] [MainThread]: Command `dbt debug` succeeded at 08:02:30.995272 after 0.29 seconds
[0m08:02:30.995475 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:02:30.995643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd5520>]}
[0m08:02:30.995842 [debug] [MainThread]: Flushing usage events
[0m08:02:36.159810 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m08:13:46.150601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103110170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccd610>]}


============================== 08:13:46.153463 | 86e668ad-1254-4c46-b0c1-7534c90ff7f7 ==============================
[0m08:13:46.153463 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:13:46.153779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:13:46.334698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86e668ad-1254-4c46-b0c1-7534c90ff7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caef90>]}
[0m08:13:46.358162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86e668ad-1254-4c46-b0c1-7534c90ff7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd3d70>]}
[0m08:13:46.359809 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:13:46.369475 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:13:46.370018 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:13:46.370226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86e668ad-1254-4c46-b0c1-7534c90ff7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e89df0>]}
[0m08:13:46.737808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.example
[0m08:13:46.741109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86e668ad-1254-4c46-b0c1-7534c90ff7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d73a10>]}
[0m08:13:46.781993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86e668ad-1254-4c46-b0c1-7534c90ff7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe5d00>]}
[0m08:13:46.782289 [info ] [MainThread]: Found 416 macros
[0m08:13:46.782458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86e668ad-1254-4c46-b0c1-7534c90ff7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d532c0>]}
[0m08:13:46.783131 [info ] [MainThread]: 
[0m08:13:46.783295 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:13:46.783513 [debug] [MainThread]: Command end result
[0m08:13:46.796776 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68037546, "process_user_time": 1.094903, "process_kernel_time": 0.142433, "process_mem_max_rss": "118603776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:13:46.797113 [debug] [MainThread]: Command `dbt test` succeeded at 08:13:46.797066 after 0.68 seconds
[0m08:13:46.797312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103110170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5c260>]}
[0m08:13:46.797481 [debug] [MainThread]: Flushing usage events
[0m08:14:06.764640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe9640>]}


============================== 08:14:06.767399 | 57287cb0-e378-4360-ab5c-0d0eee9a49ae ==============================
[0m08:14:06.767399 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:14:06.767718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:14:06.918538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57287cb0-e378-4360-ab5c-0d0eee9a49ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c6b0>]}
[0m08:14:06.941910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57287cb0-e378-4360-ab5c-0d0eee9a49ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc5e50>]}
[0m08:14:06.943990 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:14:06.953787 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:14:06.992214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:14:06.992445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:14:06.992655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.example
[0m08:14:06.995371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57287cb0-e378-4360-ab5c-0d0eee9a49ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606ce30>]}
[0m08:14:07.024617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57287cb0-e378-4360-ab5c-0d0eee9a49ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a86e0>]}
[0m08:14:07.024895 [info ] [MainThread]: Found 416 macros
[0m08:14:07.025064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57287cb0-e378-4360-ab5c-0d0eee9a49ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b9940>]}
[0m08:14:07.025945 [info ] [MainThread]: 
[0m08:14:07.026111 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:14:07.026976 [debug] [MainThread]: Command end result
[0m08:14:07.038808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.303624, "process_user_time": 0.768188, "process_kernel_time": 0.109751, "process_mem_max_rss": "115752960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:14:07.039099 [debug] [MainThread]: Command `dbt run` succeeded at 08:14:07.039056 after 0.30 seconds
[0m08:14:07.039300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbfb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106137980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0e660>]}
[0m08:14:07.039476 [debug] [MainThread]: Flushing usage events
[0m08:16:38.526400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048be450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc1760>]}


============================== 08:16:38.529463 | 30fb3daa-fc58-4d4c-9a67-aa52db87a2ea ==============================
[0m08:16:38.529463 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:16:38.529777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:16:38.715700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30fb3daa-fc58-4d4c-9a67-aa52db87a2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c26120>]}
[0m08:16:38.739220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30fb3daa-fc58-4d4c-9a67-aa52db87a2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdfc20>]}
[0m08:16:38.741204 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:16:38.751771 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:16:38.771217 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:16:38.771532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30fb3daa-fc58-4d4c-9a67-aa52db87a2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef4bf0>]}
[0m08:16:39.128593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30fb3daa-fc58-4d4c-9a67-aa52db87a2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c97260>]}
[0m08:16:39.157247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30fb3daa-fc58-4d4c-9a67-aa52db87a2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6e840>]}
[0m08:16:39.157505 [info ] [MainThread]: Found 416 macros
[0m08:16:39.157671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30fb3daa-fc58-4d4c-9a67-aa52db87a2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e06360>]}
[0m08:16:39.158340 [info ] [MainThread]: 
[0m08:16:39.158513 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:16:39.158740 [debug] [MainThread]: Command end result
[0m08:16:39.170829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6769989, "process_user_time": 1.095739, "process_kernel_time": 0.13066, "process_mem_max_rss": "117850112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:16:39.171148 [debug] [MainThread]: Command `dbt run` succeeded at 08:16:39.171105 after 0.68 seconds
[0m08:16:39.171342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc1a90>]}
[0m08:16:39.171503 [debug] [MainThread]: Flushing usage events
[0m08:16:47.962937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106165520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106165220>]}


============================== 08:16:47.965175 | 0d3c55fa-2356-48d1-b115-c84f6346f7c9 ==============================
[0m08:16:47.965175 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:16:47.965481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:16:48.029964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d3c55fa-2356-48d1-b115-c84f6346f7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105074800>]}
[0m08:16:48.036496 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.101191334, "process_user_time": 0.636187, "process_kernel_time": 0.07105, "process_mem_max_rss": "96370688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:16:48.036729 [debug] [MainThread]: Command `dbt clean` succeeded at 08:16:48.036687 after 0.10 seconds
[0m08:16:48.036888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efa6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106131be0>]}
[0m08:16:48.037042 [debug] [MainThread]: Flushing usage events
[0m08:16:52.192322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110223d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107198e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110719610>]}


============================== 08:16:52.194669 | 18d20eb9-c0b6-43cf-a005-46231c11866d ==============================
[0m08:16:52.194669 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:16:52.194983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:16:52.370993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18d20eb9-c0b6-43cf-a005-46231c11866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694f500>]}
[0m08:16:52.394113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18d20eb9-c0b6-43cf-a005-46231c11866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eeb3e0>]}
[0m08:16:52.396094 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:16:52.405729 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:16:52.406270 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:16:52.406478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18d20eb9-c0b6-43cf-a005-46231c11866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f12fc0>]}
[0m08:16:52.762006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18d20eb9-c0b6-43cf-a005-46231c11866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a72ea0>]}
[0m08:16:52.786083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18d20eb9-c0b6-43cf-a005-46231c11866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b10e00>]}
[0m08:16:52.786332 [info ] [MainThread]: Found 416 macros
[0m08:16:52.786503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18d20eb9-c0b6-43cf-a005-46231c11866d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b67f80>]}
[0m08:16:52.787186 [info ] [MainThread]: 
[0m08:16:52.787359 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:16:52.787590 [debug] [MainThread]: Command end result
[0m08:16:52.799431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.636337, "process_user_time": 1.069518, "process_kernel_time": 0.110152, "process_mem_max_rss": "117178368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:16:52.799720 [debug] [MainThread]: Command `dbt run` succeeded at 08:16:52.799677 after 0.64 seconds
[0m08:16:52.799912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eeb680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110719700>]}
[0m08:16:52.800065 [debug] [MainThread]: Flushing usage events
[0m08:17:54.464557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654d6a0>]}


============================== 08:17:54.467702 | d001ad32-db21-481b-9950-84b56df680f0 ==============================
[0m08:17:54.467702 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:17:54.468021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:17:54.653880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd001ad32-db21-481b-9950-84b56df680f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1b7d0>]}
[0m08:17:54.676933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd001ad32-db21-481b-9950-84b56df680f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541a030>]}
[0m08:17:54.678546 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:17:54.688596 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:17:54.708298 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:17:54.708609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd001ad32-db21-481b-9950-84b56df680f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7fb0>]}
[0m08:17:55.063512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd001ad32-db21-481b-9950-84b56df680f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106881dc0>]}
[0m08:17:55.092758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd001ad32-db21-481b-9950-84b56df680f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675da30>]}
[0m08:17:55.093033 [info ] [MainThread]: Found 416 macros
[0m08:17:55.093201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd001ad32-db21-481b-9950-84b56df680f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106882e10>]}
[0m08:17:55.093866 [info ] [MainThread]: 
[0m08:17:55.094031 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:17:55.094256 [debug] [MainThread]: Command end result
[0m08:17:55.106374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6729883, "process_user_time": 1.089831, "process_kernel_time": 0.129764, "process_mem_max_rss": "117440512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:17:55.106681 [debug] [MainThread]: Command `dbt run` succeeded at 08:17:55.106638 after 0.67 seconds
[0m08:17:55.106869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d72c0>]}
[0m08:17:55.107031 [debug] [MainThread]: Flushing usage events
[0m08:18:27.423894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075def00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d1700>]}


============================== 08:18:27.426691 | 9a0d6a25-4913-4aa7-a3a6-01870e4afcfe ==============================
[0m08:18:27.426691 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:18:27.427027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:18:27.607267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a0d6a25-4913-4aa7-a3a6-01870e4afcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088849e0>]}
[0m08:18:27.630461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a0d6a25-4913-4aa7-a3a6-01870e4afcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ad670>]}
[0m08:18:27.632076 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:18:27.641780 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:18:27.661539 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:18:27.661866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a0d6a25-4913-4aa7-a3a6-01870e4afcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e680e0>]}
[0m08:18:28.016335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a0d6a25-4913-4aa7-a3a6-01870e4afcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c82420>]}
[0m08:18:28.044178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a0d6a25-4913-4aa7-a3a6-01870e4afcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7e780>]}
[0m08:18:28.044457 [info ] [MainThread]: Found 416 macros
[0m08:18:28.044621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a0d6a25-4913-4aa7-a3a6-01870e4afcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0e630>]}
[0m08:18:28.045290 [info ] [MainThread]: 
[0m08:18:28.045472 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:18:28.045701 [debug] [MainThread]: Command end result
[0m08:18:28.058084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6653585, "process_user_time": 1.085908, "process_kernel_time": 0.128151, "process_mem_max_rss": "116473856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:18:28.058397 [debug] [MainThread]: Command `dbt run` succeeded at 08:18:28.058343 after 0.67 seconds
[0m08:18:28.058580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108327500>]}
[0m08:18:28.058738 [debug] [MainThread]: Flushing usage events
[0m08:18:57.380113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c81a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c81760>]}


============================== 08:18:57.383115 | 19a78156-209d-45b3-be1c-ef67e6c32673 ==============================
[0m08:18:57.383115 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:18:57.383433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:18:57.565070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a78156-209d-45b3-be1c-ef67e6c32673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a24980>]}
[0m08:18:57.588222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a78156-209d-45b3-be1c-ef67e6c32673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f41640>]}
[0m08:18:57.589998 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:18:57.600347 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:18:57.619849 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:18:57.620220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19a78156-209d-45b3-be1c-ef67e6c32673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbca70>]}
[0m08:18:57.974380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a78156-209d-45b3-be1c-ef67e6c32673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbf3e0>]}
[0m08:18:58.003442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a78156-209d-45b3-be1c-ef67e6c32673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105036360>]}
[0m08:18:58.003704 [info ] [MainThread]: Found 416 macros
[0m08:18:58.003869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a78156-209d-45b3-be1c-ef67e6c32673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049af5f0>]}
[0m08:18:58.004548 [info ] [MainThread]: 
[0m08:18:58.004724 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:18:58.004950 [debug] [MainThread]: Command end result
[0m08:18:58.017235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6697393, "process_user_time": 1.092833, "process_kernel_time": 0.120004, "process_mem_max_rss": "116293632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:18:58.017546 [debug] [MainThread]: Command `dbt run` succeeded at 08:18:58.017500 after 0.67 seconds
[0m08:18:58.017736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c81760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e97020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e97d40>]}
[0m08:18:58.017903 [debug] [MainThread]: Flushing usage events
[0m08:19:03.621250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fe540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d9370>]}


============================== 08:19:03.624205 | ac5895a7-6435-4902-8341-6a78ceb6ecf6 ==============================
[0m08:19:03.624205 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:19:03.624528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m08:19:03.690012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac5895a7-6435-4902-8341-6a78ceb6ecf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106692db0>]}
[0m08:19:03.700006 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10795267, "process_user_time": 0.641059, "process_kernel_time": 0.083278, "process_mem_max_rss": "95305728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:19:03.700266 [debug] [MainThread]: Command `dbt clean` succeeded at 08:19:03.700219 after 0.11 seconds
[0m08:19:03.700438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106402420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d9610>]}
[0m08:19:03.700615 [debug] [MainThread]: Flushing usage events
[0m08:19:05.709565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d45550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d45280>]}


============================== 08:19:05.712004 | 8328d09b-c229-49de-b2ac-a1e6fb5c0e1c ==============================
[0m08:19:05.712004 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:19:05.712311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:19:05.778017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8328d09b-c229-49de-b2ac-a1e6fb5c0e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7410>]}
[0m08:19:05.783046 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10425308, "process_user_time": 0.644686, "process_kernel_time": 0.084714, "process_mem_max_rss": "96747520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:19:05.783279 [debug] [MainThread]: Command `dbt clean` succeeded at 08:19:05.783237 after 0.10 seconds
[0m08:19:05.783443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d45250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eaa3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c1c560>]}
[0m08:19:05.783595 [debug] [MainThread]: Flushing usage events
[0m08:19:07.688812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107965e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1d220>]}


============================== 08:19:07.691241 | c6227a7e-da7e-47dd-ba0e-bf451a30dbdb ==============================
[0m08:19:07.691241 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:19:07.691548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:19:07.757130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6227a7e-da7e-47dd-ba0e-bf451a30dbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866f260>]}
[0m08:19:07.762068 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.108639374, "process_user_time": 0.649509, "process_kernel_time": 0.072925, "process_mem_max_rss": "96878592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:19:07.762305 [debug] [MainThread]: Command `dbt clean` succeeded at 08:19:07.762262 after 0.11 seconds
[0m08:19:07.762467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a47560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e32e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866f260>]}
[0m08:19:07.762621 [debug] [MainThread]: Flushing usage events
[0m08:19:10.814398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086819a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086816a0>]}


============================== 08:19:10.816605 | 2da2f837-84ff-4e3f-9e10-534de1408711 ==============================
[0m08:19:10.816605 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:19:10.816921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:19:10.989340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2da2f837-84ff-4e3f-9e10-534de1408711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108713230>]}
[0m08:19:11.012450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2da2f837-84ff-4e3f-9e10-534de1408711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759c830>]}
[0m08:19:11.014558 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:19:11.024167 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:19:11.024656 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:19:11.024863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2da2f837-84ff-4e3f-9e10-534de1408711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108761e80>]}
[0m08:19:11.379640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2da2f837-84ff-4e3f-9e10-534de1408711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086629c0>]}
[0m08:19:11.403776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2da2f837-84ff-4e3f-9e10-534de1408711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108999820>]}
[0m08:19:11.404027 [info ] [MainThread]: Found 416 macros
[0m08:19:11.404200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2da2f837-84ff-4e3f-9e10-534de1408711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108995d60>]}
[0m08:19:11.404890 [info ] [MainThread]: 
[0m08:19:11.405072 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:19:11.405309 [debug] [MainThread]: Command end result
[0m08:19:11.416783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6314207, "process_user_time": 1.063516, "process_kernel_time": 0.095419, "process_mem_max_rss": "116391936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:19:11.417072 [debug] [MainThread]: Command `dbt run` succeeded at 08:19:11.417030 after 0.63 seconds
[0m08:19:11.417255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108870dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d7c80>]}
[0m08:19:11.417411 [debug] [MainThread]: Flushing usage events
[0m08:19:50.906339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082beea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085955b0>]}


============================== 08:19:50.909326 | 1f8aa63e-09c4-4d74-a033-4569b868b67b ==============================
[0m08:19:50.909326 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:19:50.909689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:19:51.094120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086012b0>]}
[0m08:19:51.117081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108597b00>]}
[0m08:19:51.118666 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:19:51.128960 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:19:51.149188 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:19:51.149504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ccad0>]}
[0m08:19:51.708734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f4800>]}
[0m08:19:51.757427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c89880>]}
[0m08:19:51.757805 [info ] [MainThread]: Found 2 models, 4 data tests, 3 sources, 416 macros
[0m08:19:51.757984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089652b0>]}
[0m08:19:51.758834 [info ] [MainThread]: 
[0m08:19:51.759109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:19:51.761409 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:19:51.818100 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:19:51.818341 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:19:51.818489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:51.828514 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:19:51.829965 [debug] [ThreadPool]: On list_memory: Close
[0m08:19:51.830328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:19:51.830544 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:19:51.833788 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:19:51.833966 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:19:51.834097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:19:51.834854 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:19:51.835590 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:19:51.835718 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:19:51.835882 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:19:51.836002 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:19:51.836123 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:19:51.836500 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:19:51.836887 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:19:51.837012 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:19:51.837123 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:19:51.837269 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:19:51.837392 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:19:51.837894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:19:51.840379 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:19:51.840534 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:19:51.840661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:19:51.840858 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:19:51.840990 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:19:51.841126 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:19:51.854184 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:19:51.854844 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:19:51.855710 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:19:51.855852 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:19:51.856143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecad50>]}
[0m08:19:51.856352 [debug] [MainThread]: Using duckdb connection "master"
[0m08:19:51.856480 [debug] [MainThread]: On master: BEGIN
[0m08:19:51.856595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:19:51.856785 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:19:51.856916 [debug] [MainThread]: On master: COMMIT
[0m08:19:51.857032 [debug] [MainThread]: Using duckdb connection "master"
[0m08:19:51.857147 [debug] [MainThread]: On master: COMMIT
[0m08:19:51.857304 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:19:51.857426 [debug] [MainThread]: On master: Close
[0m08:19:51.857605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:19:51.857749 [info ] [MainThread]: 
[0m08:19:51.859202 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:19:51.859449 [info ] [Thread-1 (]: 1 of 2 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:19:51.859644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:19:51.859795 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:19:51.863166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:19:51.863669 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:19:51.878265 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:19:51.878850 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:19:51.879012 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:19:51.879162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:19:51.879453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:19:51.879603 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:19:51.879745 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:19:51.887283 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:19:51.887454 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:19:51.887646 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:19:51.892674 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:19:51.892846 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:19:51.894189 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:19:51.895206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f8aa63e-09c4-4d74-a033-4569b868b67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2d190>]}
[0m08:19:51.895539 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.03s]
[0m08:19:51.895830 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:19:51.896476 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m08:19:51.896716 [info ] [Thread-1 (]: 2 of 2 SKIP relation main.my_second_dbt_model .................................. [[33mSKIP[0m]
[0m08:19:51.896923 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m08:19:51.897411 [debug] [MainThread]: Using duckdb connection "master"
[0m08:19:51.897569 [debug] [MainThread]: On master: BEGIN
[0m08:19:51.897693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:19:51.897951 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:19:51.898085 [debug] [MainThread]: On master: COMMIT
[0m08:19:51.898203 [debug] [MainThread]: Using duckdb connection "master"
[0m08:19:51.898318 [debug] [MainThread]: On master: COMMIT
[0m08:19:51.898471 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:19:51.898593 [debug] [MainThread]: On master: Close
[0m08:19:51.898749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:19:51.898866 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:19:51.899019 [info ] [MainThread]: 
[0m08:19:51.899160 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m08:19:51.899462 [debug] [MainThread]: Command end result
[0m08:19:51.914330 [info ] [MainThread]: 
[0m08:19:51.914575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:19:51.914720 [info ] [MainThread]: 
[0m08:19:51.914904 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:19:51.915042 [info ] [MainThread]: 
[0m08:19:51.915181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:19:51.916696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0425534, "process_user_time": 1.419374, "process_kernel_time": 0.147606, "process_mem_max_rss": "133251072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:19:51.916920 [debug] [MainThread]: Command `dbt run` failed at 08:19:51.916882 after 1.04 seconds
[0m08:19:51.917089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108943cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108943590>]}
[0m08:19:51.917240 [debug] [MainThread]: Flushing usage events
[0m08:20:13.358474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ec440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111654e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c51580>]}


============================== 08:20:13.361241 | b371a9df-8c89-471c-9c6e-9feeffdfdf0c ==============================
[0m08:20:13.361241 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:20:13.361597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:20:13.539631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793c650>]}
[0m08:20:13.562956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d27620>]}
[0m08:20:13.564948 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:20:13.575061 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:20:13.618365 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:20:13.618685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de4140>]}
[0m08:20:14.156293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d893d0>]}
[0m08:20:14.201849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112631760>]}
[0m08:20:14.202133 [info ] [MainThread]: Found 2 models, 4 data tests, 3 sources, 416 macros
[0m08:20:14.202303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f1b20>]}
[0m08:20:14.203199 [info ] [MainThread]: 
[0m08:20:14.203481 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:20:14.205664 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:20:14.259860 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:20:14.260098 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:20:14.260241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:14.273143 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:20:14.274728 [debug] [ThreadPool]: On list_memory: Close
[0m08:20:14.275081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:20:14.275304 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:20:14.278600 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:14.278768 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:20:14.278898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:14.279750 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:20:14.280474 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:14.280610 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:20:14.280782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:20:14.280903 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:14.281025 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:20:14.281715 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:20:14.282110 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:20:14.282233 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:14.282344 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:20:14.282490 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:20:14.282613 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:20:14.283096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:20:14.285591 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:20:14.285741 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:20:14.285858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:14.286038 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:20:14.286169 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:20:14.286303 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:20:14.299751 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:20:14.300385 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:20:14.301235 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:20:14.301378 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:20:14.301677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126c1220>]}
[0m08:20:14.301898 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:14.302029 [debug] [MainThread]: On master: BEGIN
[0m08:20:14.302145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:20:14.302334 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:14.302464 [debug] [MainThread]: On master: COMMIT
[0m08:20:14.302584 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:14.302702 [debug] [MainThread]: On master: COMMIT
[0m08:20:14.302860 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:14.302987 [debug] [MainThread]: On master: Close
[0m08:20:14.303167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:14.303310 [info ] [MainThread]: 
[0m08:20:14.304522 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:20:14.304757 [info ] [Thread-1 (]: 1 of 2 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:20:14.304949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:20:14.305099 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:20:14.308447 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:20:14.308792 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:20:14.323375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:20:14.323842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:20:14.324001 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:20:14.324144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:14.324448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:20:14.324594 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:20:14.324743 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:20:14.332316 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:20:14.332519 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:20:14.332726 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:20:14.337597 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:20:14.337775 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:20:14.339082 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:20:14.339757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b371a9df-8c89-471c-9c6e-9feeffdfdf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ed6a0>]}
[0m08:20:14.340041 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.03s]
[0m08:20:14.340315 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:20:14.340944 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m08:20:14.341228 [info ] [Thread-1 (]: 2 of 2 SKIP relation main.my_second_dbt_model .................................. [[33mSKIP[0m]
[0m08:20:14.341427 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m08:20:14.341877 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:14.342019 [debug] [MainThread]: On master: BEGIN
[0m08:20:14.342132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:20:14.342345 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:14.342469 [debug] [MainThread]: On master: COMMIT
[0m08:20:14.342585 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:14.342697 [debug] [MainThread]: On master: COMMIT
[0m08:20:14.342840 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:14.342961 [debug] [MainThread]: On master: Close
[0m08:20:14.343114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:14.343231 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:20:14.343383 [info ] [MainThread]: 
[0m08:20:14.343523 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m08:20:14.343819 [debug] [MainThread]: Command end result
[0m08:20:14.357795 [info ] [MainThread]: 
[0m08:20:14.358047 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:20:14.358210 [info ] [MainThread]: 
[0m08:20:14.358390 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:20:14.358527 [info ] [MainThread]: 
[0m08:20:14.358663 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:20:14.360240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0380986, "process_user_time": 1.425809, "process_kernel_time": 0.14246, "process_mem_max_rss": "134823936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:20:14.360464 [debug] [MainThread]: Command `dbt run` failed at 08:20:14.360426 after 1.04 seconds
[0m08:20:14.360637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212cb60>]}
[0m08:20:14.360823 [debug] [MainThread]: Flushing usage events
[0m08:20:51.314202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c11c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c11940>]}


============================== 08:20:51.317245 | 3afc9f77-4ad9-47d6-bd8a-c618d583517d ==============================
[0m08:20:51.317245 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:20:51.317615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:20:51.485967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3afc9f77-4ad9-47d6-bd8a-c618d583517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c11a60>]}
[0m08:20:51.509278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3afc9f77-4ad9-47d6-bd8a-c618d583517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cedca0>]}
[0m08:20:51.510867 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:20:51.520650 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:20:51.585264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:20:51.585674 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/schema.yml
[0m08:20:51.690567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3afc9f77-4ad9-47d6-bd8a-c618d583517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105130080>]}
[0m08:20:51.731077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3afc9f77-4ad9-47d6-bd8a-c618d583517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e95700>]}
[0m08:20:51.731360 [info ] [MainThread]: Found 2 models, 3 sources, 416 macros
[0m08:20:51.731537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3afc9f77-4ad9-47d6-bd8a-c618d583517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105118530>]}
[0m08:20:51.732380 [info ] [MainThread]: 
[0m08:20:51.732707 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:20:51.735064 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:20:51.764098 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:20:51.764346 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:20:51.764496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:51.776252 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:20:51.777250 [debug] [ThreadPool]: On list_memory: Close
[0m08:20:51.777593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:20:51.777841 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:20:51.781073 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:51.781240 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:20:51.781373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:51.782359 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:20:51.782975 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:51.783113 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:20:51.783278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:20:51.783400 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:51.783522 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:20:51.784009 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:20:51.784393 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:20:51.784519 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:20:51.784629 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:20:51.784771 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:20:51.784896 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:20:51.785367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:20:51.787860 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:20:51.788007 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:20:51.788122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:51.788297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:20:51.788420 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:20:51.788550 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:20:51.801764 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:20:51.802388 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:20:51.803300 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:20:51.803436 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:20:51.803720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3afc9f77-4ad9-47d6-bd8a-c618d583517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036903e0>]}
[0m08:20:51.803943 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:51.804079 [debug] [MainThread]: On master: BEGIN
[0m08:20:51.804195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:20:51.804393 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:51.804523 [debug] [MainThread]: On master: COMMIT
[0m08:20:51.804642 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:51.804760 [debug] [MainThread]: On master: COMMIT
[0m08:20:51.804914 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:51.805037 [debug] [MainThread]: On master: Close
[0m08:20:51.805214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:51.805358 [info ] [MainThread]: 
[0m08:20:51.806573 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:20:51.806812 [info ] [Thread-1 (]: 1 of 2 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:20:51.807002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:20:51.807154 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:20:51.810754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:20:51.811148 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:20:51.826981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:20:51.827358 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:20:51.827526 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:20:51.827737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:51.828102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:20:51.828286 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:20:51.828455 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:20:51.836070 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:20:51.836275 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:20:51.836494 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:20:51.841670 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:20:51.841849 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:20:51.843175 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:20:51.843889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3afc9f77-4ad9-47d6-bd8a-c618d583517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a9100>]}
[0m08:20:51.844205 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m08:20:51.844504 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:20:51.845143 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m08:20:51.845424 [info ] [Thread-1 (]: 2 of 2 SKIP relation main.my_second_dbt_model .................................. [[33mSKIP[0m]
[0m08:20:51.845639 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m08:20:51.846089 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:51.846233 [debug] [MainThread]: On master: BEGIN
[0m08:20:51.846352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:20:51.846574 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:51.846701 [debug] [MainThread]: On master: COMMIT
[0m08:20:51.846818 [debug] [MainThread]: Using duckdb connection "master"
[0m08:20:51.846929 [debug] [MainThread]: On master: COMMIT
[0m08:20:51.847073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:20:51.847193 [debug] [MainThread]: On master: Close
[0m08:20:51.847356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:51.847480 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:20:51.847653 [info ] [MainThread]: 
[0m08:20:51.847803 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:20:51.848112 [debug] [MainThread]: Command end result
[0m08:20:51.861861 [info ] [MainThread]: 
[0m08:20:51.862166 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:20:51.862319 [info ] [MainThread]: 
[0m08:20:51.862514 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:20:51.862666 [info ] [MainThread]: 
[0m08:20:51.862811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:20:51.864515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5848272, "process_user_time": 0.984319, "process_kernel_time": 0.151969, "process_mem_max_rss": "133464064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:20:51.864786 [debug] [MainThread]: Command `dbt run` failed at 08:20:51.864745 after 0.59 seconds
[0m08:20:51.864969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10496c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316d0a0>]}
[0m08:20:51.865128 [debug] [MainThread]: Flushing usage events
[0m08:21:13.602092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106826e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11104dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11104d910>]}


============================== 08:21:13.604962 | 3e724c60-b228-4312-ab7b-a8730acb2d83 ==============================
[0m08:21:13.604962 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:21:13.605289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:21:13.785266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e724c60-b228-4312-ab7b-a8730acb2d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072df740>]}
[0m08:21:13.808851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e724c60-b228-4312-ab7b-a8730acb2d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102fdd60>]}
[0m08:21:13.810933 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:21:13.821888 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:21:13.878704 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m08:21:13.878980 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/my_second_dbt_model.sql
[0m08:21:13.911806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e724c60-b228-4312-ab7b-a8730acb2d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111421550>]}
[0m08:21:13.953099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e724c60-b228-4312-ab7b-a8730acb2d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111398bf0>]}
[0m08:21:13.953375 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:21:13.953551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e724c60-b228-4312-ab7b-a8730acb2d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d3a10>]}
[0m08:21:13.954372 [info ] [MainThread]: 
[0m08:21:13.954654 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:21:13.955089 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:21:13.983796 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:21:13.984024 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:21:13.984170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:21:13.997519 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:21:13.998988 [debug] [ThreadPool]: On list_memory: Close
[0m08:21:13.999343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:21:13.999585 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:21:14.003452 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:21:14.003627 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:21:14.003757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:21:14.004734 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:21:14.005451 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:21:14.005626 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:21:14.005801 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:21:14.005922 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:21:14.006045 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:21:14.006433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:21:14.006853 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:21:14.006980 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:21:14.007093 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:21:14.007252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:21:14.007385 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:21:14.007814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:21:14.010247 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:21:14.010393 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:21:14.010509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:21:14.010690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:21:14.010813 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:21:14.010945 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:21:14.024302 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:21:14.024930 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:21:14.025827 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:21:14.025968 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:21:14.026260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e724c60-b228-4312-ab7b-a8730acb2d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b9e060>]}
[0m08:21:14.026473 [debug] [MainThread]: Using duckdb connection "master"
[0m08:21:14.026594 [debug] [MainThread]: On master: BEGIN
[0m08:21:14.026707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:21:14.026890 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:21:14.027016 [debug] [MainThread]: On master: COMMIT
[0m08:21:14.027131 [debug] [MainThread]: Using duckdb connection "master"
[0m08:21:14.027246 [debug] [MainThread]: On master: COMMIT
[0m08:21:14.027392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:21:14.027517 [debug] [MainThread]: On master: Close
[0m08:21:14.027693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:21:14.027842 [info ] [MainThread]: 
[0m08:21:14.029119 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:21:14.029368 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:21:14.029558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:21:14.029710 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:21:14.033117 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:21:14.033462 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:21:14.050026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:21:14.050508 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:21:14.050672 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:21:14.050816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:21:14.051140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:21:14.051285 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:21:14.051432 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:21:14.059329 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_raw_data"."tracks"
  );

[0m08:21:14.059518 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:21:14.059724 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:21:14.064607 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:21:14.064784 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:21:14.066073 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:21:14.066718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e724c60-b228-4312-ab7b-a8730acb2d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11139b530>]}
[0m08:21:14.067001 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m08:21:14.067275 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:21:14.068091 [debug] [MainThread]: Using duckdb connection "master"
[0m08:21:14.068259 [debug] [MainThread]: On master: BEGIN
[0m08:21:14.068382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:21:14.068595 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:21:14.068723 [debug] [MainThread]: On master: COMMIT
[0m08:21:14.068841 [debug] [MainThread]: Using duckdb connection "master"
[0m08:21:14.068950 [debug] [MainThread]: On master: COMMIT
[0m08:21:14.069098 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:21:14.069218 [debug] [MainThread]: On master: Close
[0m08:21:14.069372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:21:14.069481 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:21:14.069603 [info ] [MainThread]: 
[0m08:21:14.069736 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:21:14.070014 [debug] [MainThread]: Command end result
[0m08:21:14.083127 [info ] [MainThread]: 
[0m08:21:14.083355 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:21:14.083496 [info ] [MainThread]: 
[0m08:21:14.083669 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_raw_data"."tracks"
               ^
[0m08:21:14.083804 [info ] [MainThread]: 
[0m08:21:14.083936 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:21:14.085712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.51541454, "process_user_time": 0.908437, "process_kernel_time": 0.147188, "process_mem_max_rss": "131022848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:21:14.086003 [debug] [MainThread]: Command `dbt run` failed at 08:21:14.085959 after 0.52 seconds
[0m08:21:14.086220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111005040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106826e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097d730>]}
[0m08:21:14.086397 [debug] [MainThread]: Flushing usage events
[0m08:25:49.364794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b51970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b51670>]}


============================== 08:25:49.367888 | 8f03e1a5-e296-4c9e-81ea-dd97404c431a ==============================
[0m08:25:49.367888 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:25:49.368201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:25:49.552846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f03e1a5-e296-4c9e-81ea-dd97404c431a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e766f0>]}
[0m08:25:49.576195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f03e1a5-e296-4c9e-81ea-dd97404c431a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a90a0>]}
[0m08:25:49.577785 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:25:49.587487 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:25:49.644992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:25:49.645376 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/schema.yml
[0m08:25:49.645668 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m08:25:49.758362 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.my_first_dbt_model' (dbt_project/models/my_first_dbt_model.sql) depends on a source named 'moovai_raw_data.tracks' which was not found
[0m08:25:49.760144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.42939, "process_user_time": 0.847281, "process_kernel_time": 0.133973, "process_mem_max_rss": "121831424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:25:49.760475 [debug] [MainThread]: Command `dbt run` failed at 08:25:49.760423 after 0.43 seconds
[0m08:25:49.760715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b51760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f29b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a79160>]}
[0m08:25:49.760947 [debug] [MainThread]: Flushing usage events
[0m08:25:59.519561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102414170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fdd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fdd2b0>]}


============================== 08:25:59.522280 | 2d23736c-1adc-4d63-9726-78fb6fa3fe5d ==============================
[0m08:25:59.522280 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:25:59.522592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:25:59.586465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d23736c-1adc-4d63-9726-78fb6fa3fe5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028af470>]}
[0m08:25:59.600227 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11030779, "process_user_time": 0.637462, "process_kernel_time": 0.073634, "process_mem_max_rss": "96747520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:25:59.600464 [debug] [MainThread]: Command `dbt clean` succeeded at 08:25:59.600424 after 0.11 seconds
[0m08:25:59.600626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fdd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030d2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e44e30>]}
[0m08:25:59.600866 [debug] [MainThread]: Flushing usage events
[0m08:26:02.809714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106319220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddd610>]}


============================== 08:26:02.812295 | de96ca7c-9a0f-4301-8b1d-15e41e14fb37 ==============================
[0m08:26:02.812295 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:26:02.812613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:26:02.984283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de96ca7c-9a0f-4301-8b1d-15e41e14fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5b230>]}
[0m08:26:03.007512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de96ca7c-9a0f-4301-8b1d-15e41e14fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0590>]}
[0m08:26:03.009494 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:26:03.019535 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:26:03.020042 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:26:03.020257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de96ca7c-9a0f-4301-8b1d-15e41e14fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8fdd0>]}
[0m08:26:03.469378 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.my_first_dbt_model' (dbt_project/models/my_first_dbt_model.sql) depends on a source named 'moovai_raw_data.tracks' which was not found
[0m08:26:03.470408 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6960129, "process_user_time": 1.144733, "process_kernel_time": 0.116156, "process_mem_max_rss": "119504896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:26:03.470700 [debug] [MainThread]: Command `dbt run` failed at 08:26:03.470643 after 0.70 seconds
[0m08:26:03.470904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107086660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7e4e0>]}
[0m08:26:03.471066 [debug] [MainThread]: Flushing usage events
[0m08:26:41.624106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dd5e0>]}


============================== 08:26:41.626818 | f1ffd611-a4c3-4115-9284-65b767fc8fd0 ==============================
[0m08:26:41.626818 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:26:41.627125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:26:41.804338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105827e90>]}
[0m08:26:41.827120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066149b0>]}
[0m08:26:41.828756 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:26:41.838698 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:26:41.839214 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:26:41.839411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b47560>]}
[0m08:26:42.325344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2b8f0>]}
[0m08:26:42.365223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2bbc0>]}
[0m08:26:42.365505 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:26:42.365675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6bbf0>]}
[0m08:26:42.366463 [info ] [MainThread]: 
[0m08:26:42.366737 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:26:42.367212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:26:42.396216 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:26:42.396454 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:26:42.396602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:42.409870 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:26:42.411376 [debug] [ThreadPool]: On list_memory: Close
[0m08:26:42.411734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:26:42.411991 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:26:42.415294 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:26:42.415474 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:26:42.415617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:42.416281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:26:42.417259 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:26:42.417391 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:26:42.417564 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:26:42.417688 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:26:42.417810 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:26:42.418455 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:26:42.418841 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:26:42.418968 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:26:42.419089 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:26:42.419260 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:26:42.419405 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:26:42.419909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:26:42.422554 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:26:42.422710 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:26:42.422833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:42.423032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:26:42.423159 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:26:42.423295 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:26:42.436419 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:26:42.437105 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:26:42.438048 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:26:42.438192 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:26:42.438549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6bbf0>]}
[0m08:26:42.438791 [debug] [MainThread]: Using duckdb connection "master"
[0m08:26:42.438930 [debug] [MainThread]: On master: BEGIN
[0m08:26:42.439053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:26:42.439270 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:26:42.439401 [debug] [MainThread]: On master: COMMIT
[0m08:26:42.439522 [debug] [MainThread]: Using duckdb connection "master"
[0m08:26:42.439641 [debug] [MainThread]: On master: COMMIT
[0m08:26:42.439800 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:26:42.439926 [debug] [MainThread]: On master: Close
[0m08:26:42.440113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:26:42.440263 [info ] [MainThread]: 
[0m08:26:42.441818 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:26:42.442079 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:26:42.442406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:26:42.442569 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:26:42.446082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:26:42.446583 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:26:42.464415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:26:42.465029 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:26:42.465204 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:26:42.465351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:26:42.465651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:26:42.465797 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:26:42.465942 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_data"."tracks"
  );

[0m08:26:42.473974 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_data"."tracks"
  );

[0m08:26:42.474206 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:26:42.474422 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:26:42.479859 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:26:42.480041 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:26:42.481376 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_data"."tracks"
               ^
[0m08:26:42.482063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ffd611-a4c3-4115-9284-65b767fc8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7d0a0>]}
[0m08:26:42.482361 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m08:26:42.482634 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:26:42.483433 [debug] [MainThread]: Using duckdb connection "master"
[0m08:26:42.483569 [debug] [MainThread]: On master: BEGIN
[0m08:26:42.483684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:26:42.483912 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:26:42.484037 [debug] [MainThread]: On master: COMMIT
[0m08:26:42.484151 [debug] [MainThread]: Using duckdb connection "master"
[0m08:26:42.484260 [debug] [MainThread]: On master: COMMIT
[0m08:26:42.484403 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:26:42.484522 [debug] [MainThread]: On master: Close
[0m08:26:42.484675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:42.484786 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:26:42.484909 [info ] [MainThread]: 
[0m08:26:42.485039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:26:42.485314 [debug] [MainThread]: Command end result
[0m08:26:42.498236 [info ] [MainThread]: 
[0m08:26:42.498491 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:26:42.498633 [info ] [MainThread]: 
[0m08:26:42.498810 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_data"."tracks"
               ^
[0m08:26:42.498947 [info ] [MainThread]: 
[0m08:26:42.499083 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:26:42.500610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.90786844, "process_user_time": 1.299251, "process_kernel_time": 0.138549, "process_mem_max_rss": "134643712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:26:42.500855 [debug] [MainThread]: Command `dbt run` failed at 08:26:42.500816 after 0.91 seconds
[0m08:26:42.501032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106996360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dade20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5e720>]}
[0m08:26:42.501191 [debug] [MainThread]: Flushing usage events
[0m08:27:53.499381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102839310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105219a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105219700>]}


============================== 08:27:53.502175 | ac678c8a-f8a5-4dd9-8db2-0a338ed52871 ==============================
[0m08:27:53.502175 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:27:53.502485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:27:53.672747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac678c8a-f8a5-4dd9-8db2-0a338ed52871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054174d0>]}
[0m08:27:53.696113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac678c8a-f8a5-4dd9-8db2-0a338ed52871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d36720>]}
[0m08:27:53.697851 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:27:53.707433 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:27:53.763289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:27:53.763526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:27:53.778413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac678c8a-f8a5-4dd9-8db2-0a338ed52871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055288c0>]}
[0m08:27:53.819208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac678c8a-f8a5-4dd9-8db2-0a338ed52871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056debd0>]}
[0m08:27:53.819485 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:27:53.819664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac678c8a-f8a5-4dd9-8db2-0a338ed52871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549ade0>]}
[0m08:27:53.820458 [info ] [MainThread]: 
[0m08:27:53.820628 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:27:53.831656 [info ] [MainThread]: Done.
[0m08:27:53.833263 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.3649256, "process_user_time": 0.808998, "process_kernel_time": 0.121269, "process_mem_max_rss": "116703232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:27:53.833551 [debug] [MainThread]: Command `dbt source freshness` succeeded at 08:27:53.833505 after 0.37 seconds
[0m08:27:53.833734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c8e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105219a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052193d0>]}
[0m08:27:53.833889 [debug] [MainThread]: Flushing usage events
[0m08:35:54.894927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062311c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111521730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111521460>]}


============================== 08:35:54.898783 | ee954f41-2eae-4413-afc8-6116a73f6341 ==============================
[0m08:35:54.898783 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:35:54.899101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:35:55.079506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee954f41-2eae-4413-afc8-6116a73f6341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11177a750>]}
[0m08:35:55.103203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee954f41-2eae-4413-afc8-6116a73f6341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba63f0>]}
[0m08:35:55.104807 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:35:55.114406 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:35:55.172431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:35:55.172663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:35:55.187431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee954f41-2eae-4413-afc8-6116a73f6341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d8710>]}
[0m08:35:55.265000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee954f41-2eae-4413-afc8-6116a73f6341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111856240>]}
[0m08:35:55.265321 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:35:55.265516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee954f41-2eae-4413-afc8-6116a73f6341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115914c0>]}
[0m08:35:55.266451 [info ] [MainThread]: 
[0m08:35:55.266777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:35:55.267274 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:35:55.298667 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:35:55.298900 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:35:55.299046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:55.311701 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:35:55.313160 [debug] [ThreadPool]: On list_memory: Close
[0m08:35:55.313498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:35:55.313775 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:35:55.316990 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:35:55.317158 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:35:55.317292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:35:55.317987 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:35:55.318720 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:35:55.318849 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:35:55.319015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:35:55.319135 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:35:55.319257 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:35:55.319921 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:35:55.320305 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:35:55.320431 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:35:55.320541 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:35:55.320688 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:35:55.320810 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:35:55.321244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:35:55.323742 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:35:55.323893 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:35:55.324012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:35:55.324188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:35:55.324313 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:35:55.324444 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:35:55.337064 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:35:55.337698 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:35:55.338627 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:35:55.338769 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:35:55.339074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee954f41-2eae-4413-afc8-6116a73f6341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111582300>]}
[0m08:35:55.339303 [debug] [MainThread]: Using duckdb connection "master"
[0m08:35:55.339435 [debug] [MainThread]: On master: BEGIN
[0m08:35:55.339549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:35:55.339748 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:35:55.339877 [debug] [MainThread]: On master: COMMIT
[0m08:35:55.339995 [debug] [MainThread]: Using duckdb connection "master"
[0m08:35:55.340114 [debug] [MainThread]: On master: COMMIT
[0m08:35:55.340265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:35:55.340388 [debug] [MainThread]: On master: Close
[0m08:35:55.340564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:35:55.340705 [info ] [MainThread]: 
[0m08:35:55.341977 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:35:55.342228 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:35:55.342424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:35:55.342579 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:35:55.346049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:35:55.346405 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:35:55.363849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:35:55.364341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:35:55.364506 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:35:55.364652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:55.364938 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:35:55.365079 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:35:55.365218 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_data"."tracks"
  );

[0m08:35:55.373206 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_data"."tracks"
  );

[0m08:35:55.373402 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:35:55.373610 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:35:55.378715 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:35:55.378888 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:35:55.380180 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_data"."tracks"
               ^
[0m08:35:55.380851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee954f41-2eae-4413-afc8-6116a73f6341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fecc50>]}
[0m08:35:55.381133 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m08:35:55.381405 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:35:55.382238 [debug] [MainThread]: Using duckdb connection "master"
[0m08:35:55.382415 [debug] [MainThread]: On master: BEGIN
[0m08:35:55.382542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:35:55.382767 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:35:55.382901 [debug] [MainThread]: On master: COMMIT
[0m08:35:55.383019 [debug] [MainThread]: Using duckdb connection "master"
[0m08:35:55.383134 [debug] [MainThread]: On master: COMMIT
[0m08:35:55.383282 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:35:55.383402 [debug] [MainThread]: On master: Close
[0m08:35:55.383557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:55.383671 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:35:55.383796 [info ] [MainThread]: 
[0m08:35:55.383932 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:35:55.384232 [debug] [MainThread]: Command end result
[0m08:35:55.396046 [info ] [MainThread]: 
[0m08:35:55.396265 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:35:55.396402 [info ] [MainThread]: 
[0m08:35:55.396572 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_data"."tracks"
               ^
[0m08:35:55.396706 [info ] [MainThread]: 
[0m08:35:55.396839 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:35:55.398368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.53760135, "process_user_time": 0.891817, "process_kernel_time": 0.149751, "process_mem_max_rss": "131514368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:35:55.398624 [debug] [MainThread]: Command `dbt run` failed at 08:35:55.398584 after 0.54 seconds
[0m08:35:55.398804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11174a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111521580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115216a0>]}
[0m08:35:55.398955 [debug] [MainThread]: Flushing usage events
[0m08:36:44.239744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d74b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112051940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112051670>]}


============================== 08:36:44.242698 | 797b33c3-5bd9-47c5-b773-e53130c00cb2 ==============================
[0m08:36:44.242698 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:36:44.243046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:36:44.423708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '797b33c3-5bd9-47c5-b773-e53130c00cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11234b230>]}
[0m08:36:44.447093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '797b33c3-5bd9-47c5-b773-e53130c00cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c7f80>]}
[0m08:36:44.457523 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:36:44.467650 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:36:44.525250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:36:44.525478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:36:44.540564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '797b33c3-5bd9-47c5-b773-e53130c00cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cd340>]}
[0m08:36:44.583155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '797b33c3-5bd9-47c5-b773-e53130c00cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db00e0>]}
[0m08:36:44.583425 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:36:44.583601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797b33c3-5bd9-47c5-b773-e53130c00cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112500920>]}
[0m08:36:44.584417 [info ] [MainThread]: 
[0m08:36:44.584697 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:36:44.585117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:36:44.615254 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:36:44.615479 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:36:44.615621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:44.630209 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:36:44.631239 [debug] [ThreadPool]: On list_memory: Close
[0m08:36:44.631585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:36:44.631825 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:36:44.635180 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:36:44.635357 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:36:44.635494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:44.636138 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:36:44.636749 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:36:44.636886 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:36:44.637050 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:36:44.637168 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:36:44.637289 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:36:44.638069 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:36:44.638456 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:36:44.638581 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:36:44.638693 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:36:44.638836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:36:44.638960 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:36:44.639390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:36:44.641958 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:36:44.642112 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:36:44.642234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:44.642441 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:36:44.642581 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:36:44.642719 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:36:44.655485 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:36:44.656222 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:36:44.657131 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:36:44.657272 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:36:44.657590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797b33c3-5bd9-47c5-b773-e53130c00cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126c6390>]}
[0m08:36:44.657806 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:44.657938 [debug] [MainThread]: On master: BEGIN
[0m08:36:44.658049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:44.658285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:36:44.658411 [debug] [MainThread]: On master: COMMIT
[0m08:36:44.658528 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:44.658642 [debug] [MainThread]: On master: COMMIT
[0m08:36:44.658802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:36:44.658926 [debug] [MainThread]: On master: Close
[0m08:36:44.659102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:36:44.659244 [info ] [MainThread]: 
[0m08:36:44.660570 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:36:44.660871 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:36:44.661109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:36:44.661276 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:36:44.665018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:36:44.665376 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:36:44.683287 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:36:44.683747 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:36:44.683918 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:36:44.684069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:44.684366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:36:44.684510 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:36:44.684651 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_data"."tracks"
  );

[0m08:36:44.691460 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "memory"."moovai_data"."tracks"
  );

[0m08:36:44.691650 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:36:44.691855 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:36:44.697148 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:36:44.697328 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:36:44.698650 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_data"."tracks"
               ^
[0m08:36:44.699360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797b33c3-5bd9-47c5-b773-e53130c00cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c055e0>]}
[0m08:36:44.699662 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m08:36:44.699946 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:36:44.700744 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:44.700888 [debug] [MainThread]: On master: BEGIN
[0m08:36:44.701005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:36:44.701234 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:36:44.701356 [debug] [MainThread]: On master: COMMIT
[0m08:36:44.701473 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:44.701588 [debug] [MainThread]: On master: COMMIT
[0m08:36:44.701739 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:36:44.701859 [debug] [MainThread]: On master: Close
[0m08:36:44.702012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:44.702126 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:36:44.702249 [info ] [MainThread]: 
[0m08:36:44.702384 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:36:44.702666 [debug] [MainThread]: Command end result
[0m08:36:44.715793 [info ] [MainThread]: 
[0m08:36:44.716028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:36:44.716166 [info ] [MainThread]: 
[0m08:36:44.716342 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 6: FROM "memory"."moovai_data"."tracks"
               ^
[0m08:36:44.716475 [info ] [MainThread]: 
[0m08:36:44.716611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:36:44.717865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.509761, "process_user_time": 0.889358, "process_kernel_time": 0.139666, "process_mem_max_rss": "129843200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:36:44.718114 [debug] [MainThread]: Command `dbt run` failed at 08:36:44.718075 after 0.51 seconds
[0m08:36:44.718295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a31a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126c1bb0>]}
[0m08:36:44.718459 [debug] [MainThread]: Flushing usage events
[0m08:37:08.765419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108435010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108865ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088657c0>]}


============================== 08:37:08.768146 | a8d3caac-603f-4459-a392-4351e317a1ee ==============================
[0m08:37:08.768146 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:37:08.768456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:37:08.955163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d3caac-603f-4459-a392-4351e317a1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088194c0>]}
[0m08:37:08.977821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d3caac-603f-4459-a392-4351e317a1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108607110>]}
[0m08:37:08.979617 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:37:08.989240 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:37:09.044875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:09.045256 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m08:37:09.155361 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.my_first_dbt_model' (dbt_project/models/my_first_dbt_model.sql) depends on a source named 'moovai_data.tracks' which was not found
[0m08:37:09.156965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.42220697, "process_user_time": 0.857713, "process_kernel_time": 0.116341, "process_mem_max_rss": "120750080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:37:09.157253 [debug] [MainThread]: Command `dbt run` failed at 08:37:09.157201 after 0.42 seconds
[0m08:37:09.157464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108437b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e20f0>]}
[0m08:37:09.157636 [debug] [MainThread]: Flushing usage events
[0m08:37:25.420613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061919a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061916a0>]}


============================== 08:37:25.423335 | fc174725-c1ab-4942-af20-b1283558667b ==============================
[0m08:37:25.423335 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:37:25.423636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:37:25.599993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc174725-c1ab-4942-af20-b1283558667b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106272b40>]}
[0m08:37:25.623136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc174725-c1ab-4942-af20-b1283558667b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b1ac0>]}
[0m08:37:25.624742 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:37:25.635080 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:37:25.692089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:25.692462 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m08:37:25.802226 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.my_first_dbt_model' (dbt_project/models/my_first_dbt_model.sql) depends on a source named 'moovai_data.tracks' which was not found
[0m08:37:25.804143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.41320404, "process_user_time": 0.850146, "process_kernel_time": 0.123467, "process_mem_max_rss": "121274368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:37:25.804430 [debug] [MainThread]: Command `dbt run` failed at 08:37:25.804380 after 0.41 seconds
[0m08:37:25.804643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d63b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629ba40>]}
[0m08:37:25.804820 [debug] [MainThread]: Flushing usage events
[0m08:44:39.654845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111afd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274d670>]}


============================== 08:44:39.657967 | 0e6767d0-120e-41e7-a107-03aafdf5b782 ==============================
[0m08:44:39.657967 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:44:39.658309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:39.920732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e6767d0-120e-41e7-a107-03aafdf5b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112829310>]}
[0m08:44:39.947993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e6767d0-120e-41e7-a107-03aafdf5b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123af230>]}
[0m08:44:39.949776 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:44:39.960549 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:44:40.028379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:44:40.028869 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m08:44:40.180072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e6767d0-120e-41e7-a107-03aafdf5b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f075c0>]}
[0m08:44:40.226777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e6767d0-120e-41e7-a107-03aafdf5b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b5cce0>]}
[0m08:44:40.227103 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:44:40.227289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6767d0-120e-41e7-a107-03aafdf5b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1b830>]}
[0m08:44:40.228174 [info ] [MainThread]: 
[0m08:44:40.228472 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:44:40.229016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:44:40.260688 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:44:40.260946 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:44:40.261102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:40.272880 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:44:40.274399 [debug] [ThreadPool]: On list_memory: Close
[0m08:44:40.274803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:44:40.275025 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:44:40.278562 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:44:40.278785 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:44:40.278931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:40.279788 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:44:40.280900 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:44:40.281148 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:44:40.281526 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:44:40.281982 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:44:40.282179 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:44:40.282815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:44:40.284219 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:44:40.284442 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:44:40.284582 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:44:40.284824 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:44:40.284963 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:44:40.285514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:44:40.289205 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:44:40.289393 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:44:40.289525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:40.289782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:44:40.289909 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:44:40.290045 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:44:40.303665 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:44:40.304385 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:44:40.305252 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:44:40.305416 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:44:40.305764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e6767d0-120e-41e7-a107-03aafdf5b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ad1f10>]}
[0m08:44:40.306035 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:40.306188 [debug] [MainThread]: On master: BEGIN
[0m08:44:40.306319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:40.306558 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:44:40.306690 [debug] [MainThread]: On master: COMMIT
[0m08:44:40.306812 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:40.306931 [debug] [MainThread]: On master: COMMIT
[0m08:44:40.307107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:44:40.307251 [debug] [MainThread]: On master: Close
[0m08:44:40.307448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:44:40.307598 [info ] [MainThread]: 
[0m08:44:40.309024 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:44:40.309295 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:44:40.309508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:44:40.309816 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:44:40.313506 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:44:40.313870 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:44:40.331664 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:44:40.332157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:44:40.332334 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:44:40.332487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:40.332800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:44:40.332951 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:44:40.333104 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data.duckdb"."moovai_data"."tracks"
  );

[0m08:44:40.338643 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data.duckdb"."moovai_data"."tracks"
  );

[0m08:44:40.338823 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:44:40.339036 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:44:40.347077 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:44:40.347328 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:44:40.348774 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data.duckdb" does not exist!
[0m08:44:40.349567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e6767d0-120e-41e7-a107-03aafdf5b782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111be9250>]}
[0m08:44:40.349914 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m08:44:40.350204 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:44:40.351130 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:40.351326 [debug] [MainThread]: On master: BEGIN
[0m08:44:40.351465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:44:40.351780 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:44:40.351963 [debug] [MainThread]: On master: COMMIT
[0m08:44:40.352102 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:40.352231 [debug] [MainThread]: On master: COMMIT
[0m08:44:40.352411 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:44:40.352542 [debug] [MainThread]: On master: Close
[0m08:44:40.352718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:40.352844 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:44:40.352984 [info ] [MainThread]: 
[0m08:44:40.353131 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:44:40.353435 [debug] [MainThread]: Command end result
[0m08:44:40.366095 [info ] [MainThread]: 
[0m08:44:40.366396 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:44:40.366553 [info ] [MainThread]: 
[0m08:44:40.366743 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data.duckdb" does not exist!
[0m08:44:40.366882 [info ] [MainThread]: 
[0m08:44:40.367023 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:44:40.370007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7525884, "process_user_time": 1.120816, "process_kernel_time": 0.166958, "process_mem_max_rss": "131383296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:44:40.370259 [debug] [MainThread]: Command `dbt run` failed at 08:44:40.370219 after 0.75 seconds
[0m08:44:40.370452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112423b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111afd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113418740>]}
[0m08:44:40.370616 [debug] [MainThread]: Flushing usage events
[0m08:45:13.884093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086fbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d41a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d417c0>]}


============================== 08:45:13.886934 | f1cc8b21-d1e2-4d06-b39e-170d33e6f805 ==============================
[0m08:45:13.886934 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:45:13.887254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:14.068659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1cc8b21-d1e2-4d06-b39e-170d33e6f805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd3530>]}
[0m08:45:14.091916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1cc8b21-d1e2-4d06-b39e-170d33e6f805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c19fa0>]}
[0m08:45:14.093535 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:45:14.103423 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:45:14.160050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:45:14.160439 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m08:45:14.299900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1cc8b21-d1e2-4d06-b39e-170d33e6f805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109217c50>]}
[0m08:45:14.338937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1cc8b21-d1e2-4d06-b39e-170d33e6f805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109148dd0>]}
[0m08:45:14.339203 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:45:14.339381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1cc8b21-d1e2-4d06-b39e-170d33e6f805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108866630>]}
[0m08:45:14.340163 [info ] [MainThread]: 
[0m08:45:14.340440 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:45:14.340910 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:45:14.368505 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:45:14.368743 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:45:14.368890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:14.380547 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:45:14.382051 [debug] [ThreadPool]: On list_memory: Close
[0m08:45:14.382405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:45:14.382652 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:45:14.385962 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:45:14.386136 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:45:14.386274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:14.387149 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:45:14.387891 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:45:14.388029 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:45:14.388195 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:45:14.388317 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:45:14.388439 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:45:14.388913 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:45:14.389296 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:45:14.389428 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:45:14.389543 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:45:14.389691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:45:14.389822 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:45:14.390271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:45:14.393486 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:45:14.393653 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:45:14.393771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:14.393963 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:45:14.394092 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:45:14.394224 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:45:14.408091 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m08:45:14.408743 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:45:14.409666 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:45:14.409847 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:45:14.410188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1cc8b21-d1e2-4d06-b39e-170d33e6f805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea68d0>]}
[0m08:45:14.410443 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:14.410590 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.410712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:14.410923 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:45:14.411061 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.411184 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:14.411302 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.411462 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:45:14.411588 [debug] [MainThread]: On master: Close
[0m08:45:14.411771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:45:14.411916 [info ] [MainThread]: 
[0m08:45:14.413072 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:45:14.413323 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:45:14.413524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:45:14.413818 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:45:14.417258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:45:14.417631 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:45:14.434223 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:45:14.434643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:45:14.434806 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:45:14.434951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.435248 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:45:14.435393 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:45:14.435537 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data"."moovai_data"."tracks"
  );

[0m08:45:14.439417 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data"."moovai_data"."tracks"
  );

[0m08:45:14.439615 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:45:14.439825 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:45:14.444623 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:45:14.444784 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:45:14.446019 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data" does not exist!
[0m08:45:14.446659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1cc8b21-d1e2-4d06-b39e-170d33e6f805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e10a0>]}
[0m08:45:14.446945 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.03s]
[0m08:45:14.447221 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:45:14.448278 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:14.448449 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.448579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:14.448848 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:45:14.448983 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.449108 [debug] [MainThread]: Using duckdb connection "master"
[0m08:45:14.449226 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.449388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:45:14.449517 [debug] [MainThread]: On master: Close
[0m08:45:14.449689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:14.449808 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:45:14.449938 [info ] [MainThread]: 
[0m08:45:14.450077 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m08:45:14.450371 [debug] [MainThread]: Command end result
[0m08:45:14.466975 [info ] [MainThread]: 
[0m08:45:14.467235 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:45:14.467380 [info ] [MainThread]: 
[0m08:45:14.467557 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "/Users/brossierlucas/programmation/moovai_pipeline_test/src/01_ingestion/moovai_data" does not exist!
[0m08:45:14.467709 [info ] [MainThread]: 
[0m08:45:14.467847 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:45:14.469133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.61634594, "process_user_time": 1.003574, "process_kernel_time": 0.149049, "process_mem_max_rss": "133218304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:14.469410 [debug] [MainThread]: Command `dbt run` failed at 08:45:14.469368 after 0.62 seconds
[0m08:45:14.469607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d41670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d41a90>]}
[0m08:45:14.469776 [debug] [MainThread]: Flushing usage events
[0m08:46:41.897487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108202ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc5610>]}


============================== 08:46:41.900700 | 85b650e5-0990-4cc6-be8e-56ccf93c3147 ==============================
[0m08:46:41.900700 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:46:41.901035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:46:42.026005 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'
[0m08:46:42.027945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.16244796, "process_user_time": 0.64124, "process_kernel_time": 0.108045, "process_mem_max_rss": "109723648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:46:42.028195 [debug] [MainThread]: Command `dbt run` failed at 08:46:42.028149 after 0.16 seconds
[0m08:46:42.028365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108202ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080dc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0bdd0>]}
[0m08:46:42.028542 [debug] [MainThread]: Flushing usage events
[0m08:47:00.323426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106175280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c16a0>]}


============================== 08:47:00.326190 | fbec40ce-f514-4510-9736-99e5a42800c0 ==============================
[0m08:47:00.326190 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:47:00.326618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:47:00.488954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbec40ce-f514-4510-9736-99e5a42800c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c3800>]}
[0m08:47:00.511967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbec40ce-f514-4510-9736-99e5a42800c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622e660>]}
[0m08:47:00.513480 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:47:00.524260 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:47:00.581121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:47:00.581512 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m08:47:00.719378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbec40ce-f514-4510-9736-99e5a42800c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106696690>]}
[0m08:47:00.761336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbec40ce-f514-4510-9736-99e5a42800c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064026c0>]}
[0m08:47:00.761611 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:47:00.761779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbec40ce-f514-4510-9736-99e5a42800c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106713ad0>]}
[0m08:47:00.762592 [info ] [MainThread]: 
[0m08:47:00.762861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:47:00.763336 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:47:00.792000 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:47:00.792224 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:47:00.792369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:00.803305 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m08:47:00.804252 [debug] [ThreadPool]: On list_memory: Close
[0m08:47:00.804593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:47:00.804832 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:47:00.808074 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:47:00.808240 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:47:00.808404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:00.809392 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:47:00.810000 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:47:00.810132 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:47:00.810301 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:47:00.810420 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:47:00.810547 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:47:00.811026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:47:00.811414 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:47:00.811540 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:47:00.811653 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:47:00.811800 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:47:00.811925 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:47:00.812362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:47:00.815594 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:47:00.815756 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:47:00.815874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:00.816060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:47:00.816186 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:47:00.816316 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:47:00.829214 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:47:00.829826 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:47:00.830719 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:47:00.830858 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:47:00.831145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbec40ce-f514-4510-9736-99e5a42800c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064dac30>]}
[0m08:47:00.831372 [debug] [MainThread]: Using duckdb connection "master"
[0m08:47:00.831499 [debug] [MainThread]: On master: BEGIN
[0m08:47:00.831611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:47:00.831794 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:47:00.831924 [debug] [MainThread]: On master: COMMIT
[0m08:47:00.832041 [debug] [MainThread]: Using duckdb connection "master"
[0m08:47:00.832151 [debug] [MainThread]: On master: COMMIT
[0m08:47:00.832299 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:47:00.832419 [debug] [MainThread]: On master: Close
[0m08:47:00.832594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:47:00.832729 [info ] [MainThread]: 
[0m08:47:00.833874 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:47:00.834128 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:47:00.834330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:47:00.834608 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:47:00.838031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:47:00.838359 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:47:00.854960 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:47:00.855667 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:47:00.855837 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:47:00.855975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:00.856271 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:47:00.856421 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:47:00.856569 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m08:47:00.860312 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m08:47:00.860501 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:47:00.860720 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:47:00.865845 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:47:00.866012 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:47:00.867255 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m08:47:00.867901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbec40ce-f514-4510-9736-99e5a42800c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b83aa0>]}
[0m08:47:00.868192 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.03s]
[0m08:47:00.868460 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:47:00.869275 [debug] [MainThread]: Using duckdb connection "master"
[0m08:47:00.869421 [debug] [MainThread]: On master: BEGIN
[0m08:47:00.869532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:47:00.869746 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:47:00.869868 [debug] [MainThread]: On master: COMMIT
[0m08:47:00.869983 [debug] [MainThread]: Using duckdb connection "master"
[0m08:47:00.870095 [debug] [MainThread]: On master: COMMIT
[0m08:47:00.870242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:47:00.870359 [debug] [MainThread]: On master: Close
[0m08:47:00.870513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:00.870626 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:47:00.870749 [info ] [MainThread]: 
[0m08:47:00.870881 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m08:47:00.871145 [debug] [MainThread]: Command end result
[0m08:47:00.882817 [info ] [MainThread]: 
[0m08:47:00.883027 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:47:00.883166 [info ] [MainThread]: 
[0m08:47:00.883344 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m08:47:00.883472 [info ] [MainThread]: 
[0m08:47:00.883610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:47:00.885232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5916117, "process_user_time": 1.001233, "process_kernel_time": 0.133987, "process_mem_max_rss": "133496832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:47:00.885494 [debug] [MainThread]: Command `dbt run` failed at 08:47:00.885456 after 0.59 seconds
[0m08:47:00.885666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e93b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f4590>]}
[0m08:47:00.885817 [debug] [MainThread]: Flushing usage events
[0m08:48:30.225334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e193a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f899a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f896d0>]}


============================== 08:48:30.228409 | cfa514c9-9f08-4339-b101-2f384416110d ==============================
[0m08:48:30.228409 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:48:30.228726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:48:30.230227 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_project'
[0m08:48:30.231763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.037929293, "process_user_time": 0.575502, "process_kernel_time": 0.086457, "process_mem_max_rss": "92274688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:48:30.232044 [debug] [MainThread]: Command `dbt run` failed at 08:48:30.231997 after 0.04 seconds
[0m08:48:30.232215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022ca960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3e1e0>]}
[0m08:48:30.232373 [debug] [MainThread]: Flushing usage events
[0m08:48:41.154963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f897c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f89520>]}


============================== 08:48:41.157675 | f58d6297-f4b0-454d-81d8-8c96eccc8d7d ==============================
[0m08:48:41.157675 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:48:41.157993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:48:41.294266 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'memory' to match the 'path'
[0m08:48:41.296333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.17080559, "process_user_time": 0.636902, "process_kernel_time": 0.104923, "process_mem_max_rss": "109723648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:48:41.296605 [debug] [MainThread]: Command `dbt run` failed at 08:48:41.296557 after 0.17 seconds
[0m08:48:41.296784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f89520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055176e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106008e60>]}
[0m08:48:41.296959 [debug] [MainThread]: Flushing usage events
[0m08:48:51.978090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470d6a0>]}


============================== 08:48:51.980873 | 9610d8e4-065f-4c72-a469-ca08ff3cbaf4 ==============================
[0m08:48:51.980873 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:48:51.981198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:48:52.158553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9610d8e4-065f-4c72-a469-ca08ff3cbaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477d4f0>]}
[0m08:48:52.181523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9610d8e4-065f-4c72-a469-ca08ff3cbaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103355790>]}
[0m08:48:52.183129 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:48:52.193381 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:48:52.251085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:48:52.251433 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m08:48:52.290807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9610d8e4-065f-4c72-a469-ca08ff3cbaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104accf20>]}
[0m08:48:52.331699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9610d8e4-065f-4c72-a469-ca08ff3cbaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af1910>]}
[0m08:48:52.331981 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:48:52.332160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9610d8e4-065f-4c72-a469-ca08ff3cbaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac3ec0>]}
[0m08:48:52.332972 [info ] [MainThread]: 
[0m08:48:52.333255 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:48:52.333661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m08:48:52.362648 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m08:48:52.362877 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m08:48:52.363024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:52.375462 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:48:52.377068 [debug] [ThreadPool]: On list_memory: Close
[0m08:48:52.377463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m08:48:52.377715 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m08:48:52.380940 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:48:52.381108 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m08:48:52.381242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:52.382070 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:48:52.382783 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:48:52.382915 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m08:48:52.383082 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:52.383204 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:48:52.383326 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m08:48:52.383720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:52.384101 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:48:52.384231 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m08:48:52.384349 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m08:48:52.384511 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:52.384640 [debug] [ThreadPool]: On create_memory_main: Close
[0m08:48:52.385117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m08:48:52.387614 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:48:52.387761 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m08:48:52.387878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:52.388063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:52.388191 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m08:48:52.388326 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m08:48:52.401035 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:48:52.401692 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m08:48:52.402631 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m08:48:52.402799 [debug] [ThreadPool]: On list_memory_main: Close
[0m08:48:52.403103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9610d8e4-065f-4c72-a469-ca08ff3cbaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103315a00>]}
[0m08:48:52.403329 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:52.403461 [debug] [MainThread]: On master: BEGIN
[0m08:48:52.403572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:48:52.403765 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:52.403894 [debug] [MainThread]: On master: COMMIT
[0m08:48:52.404010 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:52.404122 [debug] [MainThread]: On master: COMMIT
[0m08:48:52.404275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:52.404393 [debug] [MainThread]: On master: Close
[0m08:48:52.404581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:48:52.404723 [info ] [MainThread]: 
[0m08:48:52.405965 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:48:52.406198 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:48:52.406380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m08:48:52.406526 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:48:52.409921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:48:52.410281 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:48:52.426476 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:48:52.427102 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:48:52.427287 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:48:52.427434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:52.427748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:52.427894 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:48:52.428044 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m08:48:52.431829 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m08:48:52.431999 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:48:52.432192 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:48:52.436843 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:48:52.437013 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:48:52.438232 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m08:48:52.438924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9610d8e4-065f-4c72-a469-ca08ff3cbaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5aea0>]}
[0m08:48:52.439216 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.03s]
[0m08:48:52.439486 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:48:52.440293 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:52.440434 [debug] [MainThread]: On master: BEGIN
[0m08:48:52.440550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:48:52.440748 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:52.440872 [debug] [MainThread]: On master: COMMIT
[0m08:48:52.440988 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:52.441098 [debug] [MainThread]: On master: COMMIT
[0m08:48:52.441252 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:52.441370 [debug] [MainThread]: On master: Close
[0m08:48:52.441528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:52.441641 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:48:52.441762 [info ] [MainThread]: 
[0m08:48:52.441891 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m08:48:52.442165 [debug] [MainThread]: Command end result
[0m08:48:52.455479 [info ] [MainThread]: 
[0m08:48:52.455738 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:48:52.455887 [info ] [MainThread]: 
[0m08:48:52.456067 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m08:48:52.456196 [info ] [MainThread]: 
[0m08:48:52.456328 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:48:52.457610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5125454, "process_user_time": 0.904974, "process_kernel_time": 0.142308, "process_mem_max_rss": "131219456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:48:52.457851 [debug] [MainThread]: Command `dbt run` failed at 08:48:52.457814 after 0.51 seconds
[0m08:48:52.458033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104230a10>]}
[0m08:48:52.458187 [debug] [MainThread]: Flushing usage events
[0m08:49:36.308159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ff830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fe7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d55b0>]}


============================== 08:49:36.311001 | c56491c0-64ac-47a8-b26f-7c1ef38c3387 ==============================
[0m08:49:36.311001 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:49:36.311347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:49:36.313444 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.local'
[0m08:49:36.313704 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Could not find adapter type local!
[0m08:49:36.315004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.039746206, "process_user_time": 0.576034, "process_kernel_time": 0.089267, "process_mem_max_rss": "92307456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:49:36.315288 [debug] [MainThread]: Command `dbt run` failed at 08:49:36.315240 after 0.04 seconds
[0m08:49:36.315459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d7c20>]}
[0m08:49:36.315616 [debug] [MainThread]: Flushing usage events
[0m08:50:34.206012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c52420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088399d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088396d0>]}


============================== 08:50:34.208993 | 7c415628-476c-4690-9345-ea1bbbe47a35 ==============================
[0m08:50:34.208993 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:50:34.209340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:50:34.390529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b7890>]}
[0m08:50:34.413737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108183ec0>]}
[0m08:50:34.415307 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:50:34.425634 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:50:34.466723 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:50:34.467077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcc110>]}
[0m08:50:34.947593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb98e0>]}
[0m08:50:34.988292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de57f0>]}
[0m08:50:34.988595 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m08:50:34.988764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bacbf0>]}
[0m08:50:34.989554 [info ] [MainThread]: 
[0m08:50:34.989846 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:50:34.990339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m08:50:35.020039 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m08:50:35.020276 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m08:50:35.020418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:35.034448 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m08:50:35.035407 [debug] [ThreadPool]: On list_moovai_data: Close
[0m08:50:35.036818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m08:50:35.037065 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m08:50:35.040326 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m08:50:35.040498 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m08:50:35.040630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:35.043628 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:50:35.044312 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m08:50:35.044454 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m08:50:35.044620 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:35.044741 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m08:50:35.044865 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m08:50:35.045309 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:35.045738 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m08:50:35.045884 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m08:50:35.046015 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m08:50:35.046187 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:50:35.046317 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m08:50:35.047136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m08:50:35.049704 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m08:50:35.049855 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m08:50:35.049972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:35.052553 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:50:35.052722 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m08:50:35.052885 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m08:50:35.064858 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:50:35.065562 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m08:50:35.066448 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m08:50:35.066588 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m08:50:35.067589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2ef90>]}
[0m08:50:35.067810 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:35.067937 [debug] [MainThread]: On master: BEGIN
[0m08:50:35.068048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:35.070549 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m08:50:35.070713 [debug] [MainThread]: On master: COMMIT
[0m08:50:35.070845 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:35.070966 [debug] [MainThread]: On master: COMMIT
[0m08:50:35.071125 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:50:35.071249 [debug] [MainThread]: On master: Close
[0m08:50:35.071726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:35.071877 [info ] [MainThread]: 
[0m08:50:35.073196 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m08:50:35.073441 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m08:50:35.073641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m08:50:35.073794 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m08:50:35.077209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m08:50:35.077559 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m08:50:35.093659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m08:50:35.094024 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:50:35.094186 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m08:50:35.094332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:35.097240 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:50:35.097483 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m08:50:35.097653 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m08:50:35.101053 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m08:50:35.101245 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:50:35.101475 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m08:50:35.106165 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m08:50:35.106331 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m08:50:35.108079 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m08:50:35.108938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c415628-476c-4690-9345-ea1bbbe47a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcd3d0>]}
[0m08:50:35.109246 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.03s]
[0m08:50:35.109524 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m08:50:35.110331 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:35.110480 [debug] [MainThread]: On master: BEGIN
[0m08:50:35.110595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:35.113296 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:50:35.113460 [debug] [MainThread]: On master: COMMIT
[0m08:50:35.113590 [debug] [MainThread]: Using duckdb connection "master"
[0m08:50:35.113704 [debug] [MainThread]: On master: COMMIT
[0m08:50:35.113850 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:50:35.113974 [debug] [MainThread]: On master: Close
[0m08:50:35.114462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:35.114625 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m08:50:35.114773 [info ] [MainThread]: 
[0m08:50:35.114922 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m08:50:35.115214 [debug] [MainThread]: Command end result
[0m08:50:35.155540 [info ] [MainThread]: 
[0m08:50:35.155799 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:50:35.155941 [info ] [MainThread]: 
[0m08:50:35.156113 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m08:50:35.156246 [info ] [MainThread]: 
[0m08:50:35.156382 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:50:35.157875 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.98436385, "process_user_time": 1.362423, "process_kernel_time": 0.153907, "process_mem_max_rss": "137199616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:50:35.158097 [debug] [MainThread]: Command `dbt run` failed at 08:50:35.158056 after 0.98 seconds
[0m08:50:35.158270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108433b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925ad80>]}
[0m08:50:35.158428 [debug] [MainThread]: Flushing usage events
[0m08:54:53.748657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047be120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bddf0>]}


============================== 08:54:53.751827 | 7e0f9500-c3e9-4fcf-9a18-f04e619fab78 ==============================
[0m08:54:53.751827 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:54:53.752156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:54:53.754317 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m08:54:53.754547 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m08:54:53.756028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.039001666, "process_user_time": 0.579373, "process_kernel_time": 0.096434, "process_mem_max_rss": "92536832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:54:53.756307 [debug] [MainThread]: Command `dbt run` failed at 08:54:53.756264 after 0.04 seconds
[0m08:54:53.756469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e3ec0>]}
[0m08:54:53.756624 [debug] [MainThread]: Flushing usage events
[0m08:55:09.944069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081378f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd5d30>]}


============================== 08:55:09.946926 | baa46e20-bc8c-47c6-b800-73664f3f4da2 ==============================
[0m08:55:09.946926 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:55:09.947249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:09.949482 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m08:55:09.949806 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m08:55:09.951490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.038016126, "process_user_time": 0.586613, "process_kernel_time": 0.086668, "process_mem_max_rss": "92864512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:55:09.951851 [debug] [MainThread]: Command `dbt run` failed at 08:55:09.951798 after 0.04 seconds
[0m08:55:09.952061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089602c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b85280>]}
[0m08:55:09.952258 [debug] [MainThread]: Flushing usage events
[0m09:00:14.274809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a65160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6dd30>]}


============================== 09:00:14.278719 | 724bd444-dfeb-45d1-bd70-b2800c3be50d ==============================
[0m09:00:14.278719 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:00:14.279091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:00:14.281335 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb-duckdb'
[0m09:00:14.281624 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb-duckdb!
[0m09:00:14.282883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.052466083, "process_user_time": 0.589116, "process_kernel_time": 0.107704, "process_mem_max_rss": "92995584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:00:14.283184 [debug] [MainThread]: Command `dbt run` failed at 09:00:14.283135 after 0.05 seconds
[0m09:00:14.283352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033672c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002b6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103344a70>]}
[0m09:00:14.283519 [debug] [MainThread]: Flushing usage events
[0m09:00:40.167473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107687410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b49ee0>]}


============================== 09:00:40.170404 | 705aad31-4dc9-4121-bf70-b2af71937f5b ==============================
[0m09:00:40.170404 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:00:40.170732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:00:40.172782 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.dbt-duckdb'
[0m09:00:40.173023 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Could not find adapter type dbt-duckdb!
[0m09:00:40.174501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.038886417, "process_user_time": 0.584064, "process_kernel_time": 0.088326, "process_mem_max_rss": "92307456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:00:40.174817 [debug] [MainThread]: Command `dbt run` failed at 09:00:40.174768 after 0.04 seconds
[0m09:00:40.174986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897c650>]}
[0m09:00:40.175144 [debug] [MainThread]: Flushing usage events
[0m09:01:54.825295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949df0>]}


============================== 09:01:54.828483 | a7f0328b-7235-4bda-b624-b6f0e26ef858 ==============================
[0m09:01:54.828483 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:01:54.828822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:01:54.830959 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.dbt-duckdb'
[0m09:01:54.831227 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_project", target "dev" invalid: Runtime Error
    Could not find adapter type dbt-duckdb!
[0m09:01:54.832609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.042370543, "process_user_time": 0.580996, "process_kernel_time": 0.089593, "process_mem_max_rss": "92733440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:01:54.832979 [debug] [MainThread]: Command `dbt run` failed at 09:01:54.832917 after 0.04 seconds
[0m09:01:54.833225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949e20>]}
[0m09:01:54.833467 [debug] [MainThread]: Flushing usage events
[0m09:01:59.987188 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:02:19.217437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fca6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c91d00>]}


============================== 09:02:19.220127 | 04edf1f7-17b8-4706-b413-ec9048e5f163 ==============================
[0m09:02:19.220127 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:02:19.220432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:02:19.407263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb0ef0>]}
[0m09:02:19.430262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106927bc0>]}
[0m09:02:19.432040 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:02:19.442659 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:02:19.479761 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:02:19.480076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd13a0>]}
[0m09:02:19.955962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071171a0>]}
[0m09:02:19.997665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107054e90>]}
[0m09:02:19.997958 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:02:19.998127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711dc40>]}
[0m09:02:19.998924 [info ] [MainThread]: 
[0m09:02:19.999195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:02:19.999689 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m09:02:20.029333 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m09:02:20.029561 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m09:02:20.029706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:02:20.042287 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:02:20.043696 [debug] [ThreadPool]: On list_memory: Close
[0m09:02:20.044044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m09:02:20.044284 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m09:02:20.047548 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:02:20.047725 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m09:02:20.048034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:02:20.048878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:02:20.049609 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:02:20.049743 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m09:02:20.049911 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:02:20.050034 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:02:20.050158 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m09:02:20.050581 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:02:20.051062 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m09:02:20.051217 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:02:20.051349 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m09:02:20.051541 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:02:20.051676 [debug] [ThreadPool]: On create_memory_main: Close
[0m09:02:20.052159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m09:02:20.054616 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m09:02:20.054771 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m09:02:20.054890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:02:20.055069 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:02:20.055195 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m09:02:20.055326 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m09:02:20.068430 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:02:20.069060 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m09:02:20.070019 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m09:02:20.070159 [debug] [ThreadPool]: On list_memory_main: Close
[0m09:02:20.070445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107094500>]}
[0m09:02:20.070669 [debug] [MainThread]: Using duckdb connection "master"
[0m09:02:20.070804 [debug] [MainThread]: On master: BEGIN
[0m09:02:20.070922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:02:20.071126 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:02:20.071259 [debug] [MainThread]: On master: COMMIT
[0m09:02:20.071379 [debug] [MainThread]: Using duckdb connection "master"
[0m09:02:20.071496 [debug] [MainThread]: On master: COMMIT
[0m09:02:20.071656 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:02:20.071781 [debug] [MainThread]: On master: Close
[0m09:02:20.071967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:02:20.072112 [info ] [MainThread]: 
[0m09:02:20.073236 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:02:20.073484 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:02:20.073681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m09:02:20.073957 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:02:20.077404 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:02:20.077755 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:02:20.095640 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:02:20.096547 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:02:20.097008 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:02:20.097279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:02:20.097621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:02:20.097953 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:02:20.098178 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m09:02:20.105459 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m09:02:20.105674 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:02:20.105897 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m09:02:20.111097 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m09:02:20.111273 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:02:20.112529 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m09:02:20.113192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04edf1f7-17b8-4706-b413-ec9048e5f163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768e0f0>]}
[0m09:02:20.113490 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m09:02:20.113768 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:02:20.114609 [debug] [MainThread]: Using duckdb connection "master"
[0m09:02:20.114772 [debug] [MainThread]: On master: BEGIN
[0m09:02:20.114894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:02:20.115108 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:02:20.115238 [debug] [MainThread]: On master: COMMIT
[0m09:02:20.115358 [debug] [MainThread]: Using duckdb connection "master"
[0m09:02:20.115476 [debug] [MainThread]: On master: COMMIT
[0m09:02:20.115622 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:02:20.115743 [debug] [MainThread]: On master: Close
[0m09:02:20.115900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:02:20.116016 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:02:20.116141 [info ] [MainThread]: 
[0m09:02:20.116283 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m09:02:20.116557 [debug] [MainThread]: Command end result
[0m09:02:20.156197 [info ] [MainThread]: 
[0m09:02:20.156456 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:02:20.156607 [info ] [MainThread]: 
[0m09:02:20.156788 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m09:02:20.156924 [info ] [MainThread]: 
[0m09:02:20.157060 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:02:20.158706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9724727, "process_user_time": 1.342779, "process_kernel_time": 0.142911, "process_mem_max_rss": "134856704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:02:20.158965 [debug] [MainThread]: Command `dbt run` failed at 09:02:20.158921 after 0.97 seconds
[0m09:02:20.159160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105662e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b2c30>]}
[0m09:02:20.159329 [debug] [MainThread]: Flushing usage events
[0m09:02:20.323571 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:06:53.340764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107522a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe1e20>]}


============================== 09:06:53.343614 | c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38 ==============================
[0m09:06:53.343614 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:06:53.343930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:06:53.527947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c38f0>]}
[0m09:06:53.550890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108068080>]}
[0m09:06:53.552995 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:06:53.595751 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:06:53.655328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:06:53.655574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:06:53.670551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108143f80>]}
[0m09:06:53.714182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b2660>]}
[0m09:06:53.715741 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:06:53.717475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108069040>]}
[0m09:06:53.718336 [info ] [MainThread]: 
[0m09:06:53.718629 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:06:53.719042 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_memory'
[0m09:06:53.749382 [debug] [ThreadPool]: Using duckdb connection "list_memory"
[0m09:06:53.749618 [debug] [ThreadPool]: On list_memory: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"memory"'
    
  
  
[0m09:06:53.749765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:06:53.761903 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m09:06:53.763271 [debug] [ThreadPool]: On list_memory: Close
[0m09:06:53.763627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_memory, now create_memory_main)
[0m09:06:53.763873 [debug] [ThreadPool]: Creating schema "database: "memory"
schema: "main"
"
[0m09:06:53.767246 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:06:53.767422 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
        select type from duckdb_databases()
        where database_name='memory'
        and type='sqlite'
    
  
[0m09:06:53.767559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:53.768284 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:06:53.769046 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:06:53.769183 [debug] [ThreadPool]: On create_memory_main: BEGIN
[0m09:06:53.769352 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:06:53.769471 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:06:53.769593 [debug] [ThreadPool]: On create_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_memory_main"} */

    
    
        create schema if not exists "memory"."main"
    
[0m09:06:53.770269 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:06:53.770654 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m09:06:53.770776 [debug] [ThreadPool]: Using duckdb connection "create_memory_main"
[0m09:06:53.770887 [debug] [ThreadPool]: On create_memory_main: COMMIT
[0m09:06:53.771033 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:06:53.771160 [debug] [ThreadPool]: On create_memory_main: Close
[0m09:06:53.771620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_memory_main, now list_memory_main)
[0m09:06:53.774195 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m09:06:53.774341 [debug] [ThreadPool]: On list_memory_main: BEGIN
[0m09:06:53.774458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:53.774637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:06:53.774760 [debug] [ThreadPool]: Using duckdb connection "list_memory_main"
[0m09:06:53.774892 [debug] [ThreadPool]: On list_memory_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_memory_main"} */
select
      'memory' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'memory'
  
[0m09:06:53.787554 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:06:53.788161 [debug] [ThreadPool]: On list_memory_main: ROLLBACK
[0m09:06:53.789096 [debug] [ThreadPool]: Failed to rollback 'list_memory_main'
[0m09:06:53.789234 [debug] [ThreadPool]: On list_memory_main: Close
[0m09:06:53.789519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831d070>]}
[0m09:06:53.789740 [debug] [MainThread]: Using duckdb connection "master"
[0m09:06:53.789867 [debug] [MainThread]: On master: BEGIN
[0m09:06:53.789981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:06:53.790169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:06:53.790299 [debug] [MainThread]: On master: COMMIT
[0m09:06:53.790418 [debug] [MainThread]: Using duckdb connection "master"
[0m09:06:53.790534 [debug] [MainThread]: On master: COMMIT
[0m09:06:53.790679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:06:53.790801 [debug] [MainThread]: On master: Close
[0m09:06:53.790979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:06:53.791116 [info ] [MainThread]: 
[0m09:06:53.792394 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:06:53.792652 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:06:53.792851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_memory_main, now model.dbt_project.my_first_dbt_model)
[0m09:06:53.793014 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:06:53.796694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:06:53.797176 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:06:53.814695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:06:53.815291 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:06:53.815457 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:06:53.815603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:53.815921 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:06:53.816073 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:06:53.816217 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m09:06:53.821000 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "memory"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m09:06:53.821200 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:06:53.821409 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m09:06:53.826767 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m09:06:53.826941 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:06:53.828183 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m09:06:53.828862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4d4e6ea-2a28-48e4-a7fa-ed91654b5e38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757d6a0>]}
[0m09:06:53.829153 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m09:06:53.829453 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:06:53.830339 [debug] [MainThread]: Using duckdb connection "master"
[0m09:06:53.830497 [debug] [MainThread]: On master: BEGIN
[0m09:06:53.830621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:06:53.830857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:06:53.830981 [debug] [MainThread]: On master: COMMIT
[0m09:06:53.831100 [debug] [MainThread]: Using duckdb connection "master"
[0m09:06:53.831208 [debug] [MainThread]: On master: COMMIT
[0m09:06:53.831354 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:06:53.831472 [debug] [MainThread]: On master: Close
[0m09:06:53.831631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:06:53.831741 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:06:53.831865 [info ] [MainThread]: 
[0m09:06:53.831999 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m09:06:53.832283 [debug] [MainThread]: Command end result
[0m09:06:53.847988 [info ] [MainThread]: 
[0m09:06:53.848423 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:06:53.848581 [info ] [MainThread]: 
[0m09:06:53.848764 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m09:06:53.848904 [info ] [MainThread]: 
[0m09:06:53.849046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:06:53.878585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5731087, "process_user_time": 0.925175, "process_kernel_time": 0.171437, "process_mem_max_rss": "129384448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:06:53.880565 [debug] [MainThread]: Command `dbt run` failed at 09:06:53.880498 after 0.58 seconds
[0m09:06:53.880818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e87860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe20c0>]}
[0m09:06:53.884475 [debug] [MainThread]: Flushing usage events
[0m09:27:13.062639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107925160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a461b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a45eb0>]}


============================== 09:27:13.066222 | f87de908-e669-479e-8a86-bd3af70b5bf9 ==============================
[0m09:27:13.066222 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:27:13.066581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:27:13.244895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105453da0>]}
[0m09:27:13.267994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107925a90>]}
[0m09:27:13.269712 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:27:13.279643 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:27:13.316925 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:27:13.317261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787fdd0>]}
[0m09:27:13.795885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6eb10>]}
[0m09:27:13.842867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108107560>]}
[0m09:27:13.843172 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:27:13.843345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd1c40>]}
[0m09:27:13.844155 [info ] [MainThread]: 
[0m09:27:13.844455 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:27:13.844944 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:27:13.874316 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:27:13.874608 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:27:13.874771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:13.889212 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:27:13.890494 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:27:13.891940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:27:13.892163 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:27:13.895413 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:27:13.895587 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:27:13.895721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:13.898869 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:27:13.899678 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:27:13.899819 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:27:13.899982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:27:13.900107 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:27:13.900231 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:27:13.900803 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:27:13.901202 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:27:13.901362 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:27:13.901475 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:27:13.901625 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:27:13.901755 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:27:13.902541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:27:13.905077 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:27:13.905232 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:27:13.905352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:13.907931 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:27:13.908090 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:27:13.908235 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:27:13.920987 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:27:13.921738 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:27:13.922670 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:27:13.922813 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:27:13.923932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809a3f0>]}
[0m09:27:13.924174 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:13.924311 [debug] [MainThread]: On master: BEGIN
[0m09:27:13.924433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:13.927188 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:27:13.927365 [debug] [MainThread]: On master: COMMIT
[0m09:27:13.927506 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:13.927629 [debug] [MainThread]: On master: COMMIT
[0m09:27:13.927787 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:27:13.927916 [debug] [MainThread]: On master: Close
[0m09:27:13.928465 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:27:13.928616 [info ] [MainThread]: 
[0m09:27:13.929946 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:27:13.930223 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:27:13.930441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m09:27:13.930608 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:27:13.934011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:27:13.934392 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:27:13.951173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:27:13.951680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:27:13.951855 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:27:13.952008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:13.954883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:27:13.955066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:27:13.955242 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m09:27:13.959840 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "duckdb"."moovai_data"."tracks"
  );

[0m09:27:13.960046 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:27:13.960266 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m09:27:13.965822 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m09:27:13.966009 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:27:13.967954 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m09:27:13.968666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f87de908-e669-479e-8a86-bd3af70b5bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108064980>]}
[0m09:27:13.968989 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.04s]
[0m09:27:13.969274 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:27:13.970243 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:13.970415 [debug] [MainThread]: On master: BEGIN
[0m09:27:13.970544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:27:13.973458 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:27:13.973610 [debug] [MainThread]: On master: COMMIT
[0m09:27:13.973736 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:13.973854 [debug] [MainThread]: On master: COMMIT
[0m09:27:13.974015 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:27:13.974145 [debug] [MainThread]: On master: Close
[0m09:27:13.974739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:13.974886 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:27:13.975028 [info ] [MainThread]: 
[0m09:27:13.975176 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m09:27:13.975477 [debug] [MainThread]: Command end result
[0m09:27:14.017693 [info ] [MainThread]: 
[0m09:27:14.017961 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:27:14.018110 [info ] [MainThread]: 
[0m09:27:14.018288 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Binder Error: Catalog "duckdb" does not exist!
[0m09:27:14.018427 [info ] [MainThread]: 
[0m09:27:14.018569 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:27:14.020125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.99209344, "process_user_time": 1.358152, "process_kernel_time": 0.163693, "process_mem_max_rss": "137068544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:27:14.020368 [debug] [MainThread]: Command `dbt run` failed at 09:27:14.020326 after 0.99 seconds
[0m09:27:14.020545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106115340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107342810>]}
[0m09:27:14.020721 [debug] [MainThread]: Flushing usage events
[0m09:28:59.179987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104545310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104822240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104821f40>]}


============================== 09:28:59.182813 | 18820a8f-7b24-42d5-bd18-468e871e2794 ==============================
[0m09:28:59.182813 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:28:59.183130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:28:59.348280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18820a8f-7b24-42d5-bd18-468e871e2794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373cef0>]}
[0m09:28:59.371854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18820a8f-7b24-42d5-bd18-468e871e2794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451fc20>]}
[0m09:28:59.374460 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:28:59.384830 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:28:59.441610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:59.442033 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m09:28:59.578850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18820a8f-7b24-42d5-bd18-468e871e2794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf2660>]}
[0m09:28:59.619012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18820a8f-7b24-42d5-bd18-468e871e2794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103282840>]}
[0m09:28:59.619296 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:28:59.619471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18820a8f-7b24-42d5-bd18-468e871e2794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0d580>]}
[0m09:28:59.620269 [info ] [MainThread]: 
[0m09:28:59.620554 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:28:59.621066 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:28:59.649271 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:28:59.649505 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:28:59.649651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:59.664403 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:28:59.665394 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:28:59.666933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:28:59.667195 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:28:59.670455 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:28:59.670619 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:28:59.670750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:59.674173 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:28:59.675014 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:28:59.675160 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:28:59.675325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:59.675451 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:28:59.675578 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:28:59.675964 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:59.676359 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:28:59.676487 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:28:59.676598 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:28:59.676745 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:28:59.676872 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:28:59.677660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:28:59.680932 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:28:59.681096 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:28:59.681221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:59.683914 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:28:59.684077 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:28:59.684223 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:28:59.697555 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:28:59.698280 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:28:59.699242 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:28:59.699385 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:28:59.700418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18820a8f-7b24-42d5-bd18-468e871e2794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032a0590>]}
[0m09:28:59.700628 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:59.700753 [debug] [MainThread]: On master: BEGIN
[0m09:28:59.700862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:59.703439 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:28:59.703610 [debug] [MainThread]: On master: COMMIT
[0m09:28:59.703739 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:59.703853 [debug] [MainThread]: On master: COMMIT
[0m09:28:59.704037 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:28:59.704164 [debug] [MainThread]: On master: Close
[0m09:28:59.704660 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:28:59.704836 [info ] [MainThread]: 
[0m09:28:59.706006 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:28:59.706394 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:28:59.706602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m09:28:59.706773 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:28:59.710210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:28:59.710585 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:28:59.727194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:28:59.727684 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:28:59.727847 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:28:59.727996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:59.730868 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:28:59.731072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:28:59.731233 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
  );

[0m09:28:59.744813 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
  );

[0m09:28:59.745020 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:28:59.745245 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m09:28:59.750624 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m09:28:59.750803 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:28:59.752657 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:28:59.753349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18820a8f-7b24-42d5-bd18-468e871e2794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd6db0>]}
[0m09:28:59.753663 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.05s]
[0m09:28:59.753957 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:28:59.754821 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:59.754972 [debug] [MainThread]: On master: BEGIN
[0m09:28:59.755090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:59.757816 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:28:59.757985 [debug] [MainThread]: On master: COMMIT
[0m09:28:59.758113 [debug] [MainThread]: Using duckdb connection "master"
[0m09:28:59.758227 [debug] [MainThread]: On master: COMMIT
[0m09:28:59.758383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:28:59.758508 [debug] [MainThread]: On master: Close
[0m09:28:59.759057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:59.759212 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:28:59.759354 [info ] [MainThread]: 
[0m09:28:59.759501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:28:59.759798 [debug] [MainThread]: Command end result
[0m09:28:59.772068 [info ] [MainThread]: 
[0m09:28:59.772319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:28:59.772463 [info ] [MainThread]: 
[0m09:28:59.772643 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:28:59.772778 [info ] [MainThread]: 
[0m09:28:59.772919 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:28:59.774664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6255989, "process_user_time": 1.024466, "process_kernel_time": 0.144854, "process_mem_max_rss": "135315456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:28:59.774954 [debug] [MainThread]: Command `dbt run` failed at 09:28:59.774912 after 0.63 seconds
[0m09:28:59.775157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e8a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048221e0>]}
[0m09:28:59.775319 [debug] [MainThread]: Flushing usage events
[0m09:29:14.294728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103def680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104226390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104226060>]}


============================== 09:29:14.297670 | 63e0a376-de96-4c2b-bc77-d51f4f1c3f6c ==============================
[0m09:29:14.297670 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:29:14.297988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:29:14.470680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63e0a376-de96-4c2b-bc77-d51f4f1c3f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102afbb60>]}
[0m09:29:14.493587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63e0a376-de96-4c2b-bc77-d51f4f1c3f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc30e0>]}
[0m09:29:14.496128 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:29:14.506004 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:29:14.563452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:29:14.563839 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m09:29:14.700813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63e0a376-de96-4c2b-bc77-d51f4f1c3f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ec560>]}
[0m09:29:14.740156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63e0a376-de96-4c2b-bc77-d51f4f1c3f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dc380>]}
[0m09:29:14.740424 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:29:14.740591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e0a376-de96-4c2b-bc77-d51f4f1c3f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436e630>]}
[0m09:29:14.741381 [info ] [MainThread]: 
[0m09:29:14.741649 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:29:14.742134 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:29:14.770565 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:29:14.770801 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:29:14.770950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:14.785265 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:29:14.786534 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:29:14.788025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:29:14.788245 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:29:14.791495 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:29:14.791662 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:29:14.791793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:14.794942 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:29:14.795754 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:29:14.795898 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:29:14.796060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:29:14.796183 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:29:14.796309 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:29:14.796893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:29:14.797293 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:29:14.797424 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:29:14.797537 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:29:14.797683 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:29:14.797809 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:29:14.798565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:29:14.801838 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:29:14.802003 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:29:14.802124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:14.804980 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:29:14.805156 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:29:14.805302 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:29:14.818137 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:29:14.818859 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:29:14.819761 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:29:14.819903 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:29:14.820946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e0a376-de96-4c2b-bc77-d51f4f1c3f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104294950>]}
[0m09:29:14.821172 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:14.821302 [debug] [MainThread]: On master: BEGIN
[0m09:29:14.821417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:14.824076 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:29:14.824253 [debug] [MainThread]: On master: COMMIT
[0m09:29:14.824387 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:14.824504 [debug] [MainThread]: On master: COMMIT
[0m09:29:14.824655 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:29:14.824784 [debug] [MainThread]: On master: Close
[0m09:29:14.825282 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:29:14.825431 [info ] [MainThread]: 
[0m09:29:14.826624 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:29:14.827004 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:29:14.827204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m09:29:14.827363 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:29:14.830735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:29:14.831082 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:29:14.847729 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:29:14.848244 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:29:14.848409 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:29:14.848556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:14.851449 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:29:14.851647 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:29:14.851811 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
  );

[0m09:29:14.865415 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
  );

[0m09:29:14.865730 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:29:14.865985 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m09:29:14.872390 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m09:29:14.872565 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:29:14.874450 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:29:14.875139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e0a376-de96-4c2b-bc77-d51f4f1c3f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b96a0>]}
[0m09:29:14.875439 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.05s]
[0m09:29:14.875723 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:29:14.876571 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:14.876753 [debug] [MainThread]: On master: BEGIN
[0m09:29:14.876880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:29:14.879592 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:29:14.879761 [debug] [MainThread]: On master: COMMIT
[0m09:29:14.879891 [debug] [MainThread]: Using duckdb connection "master"
[0m09:29:14.880004 [debug] [MainThread]: On master: COMMIT
[0m09:29:14.880160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:29:14.880283 [debug] [MainThread]: On master: Close
[0m09:29:14.880754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:14.880881 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:29:14.881019 [info ] [MainThread]: 
[0m09:29:14.881156 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:29:14.881456 [debug] [MainThread]: Command end result
[0m09:29:14.894283 [info ] [MainThread]: 
[0m09:29:14.894537 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:29:14.894684 [info ] [MainThread]: 
[0m09:29:14.894866 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:29:14.895001 [info ] [MainThread]: 
[0m09:29:14.895140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:29:14.896428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6320346, "process_user_time": 1.029421, "process_kernel_time": 0.147003, "process_mem_max_rss": "136216576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:29:14.896678 [debug] [MainThread]: Command `dbt run` failed at 09:29:14.896639 after 0.63 seconds
[0m09:29:14.896863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104226390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb09e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ee030>]}
[0m09:29:14.897024 [debug] [MainThread]: Flushing usage events
[0m09:30:16.684747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d577d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a99eb0>]}


============================== 09:30:16.687574 | 22d0352c-5885-4201-8d26-b2d27c003767 ==============================
[0m09:30:16.687574 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:30:16.687929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:30:16.866462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22d0352c-5885-4201-8d26-b2d27c003767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b147d0>]}
[0m09:30:16.889441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22d0352c-5885-4201-8d26-b2d27c003767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e7830>]}
[0m09:30:16.891256 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:30:16.902254 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:30:16.960834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:30:16.961211 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/sources.yml
[0m09:30:17.070032 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.my_first_dbt_model' (dbt_project/models/my_first_dbt_model.sql) depends on a source named 'moovai_data.tracks' which was not found
[0m09:30:17.071672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.41655117, "process_user_time": 0.852287, "process_kernel_time": 0.120865, "process_mem_max_rss": "118767616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:30:17.071964 [debug] [MainThread]: Command `dbt run` failed at 09:30:17.071909 after 0.42 seconds
[0m09:30:17.072196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a99eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108797fb0>]}
[0m09:30:17.072382 [debug] [MainThread]: Flushing usage events
[0m09:30:33.212104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108076030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108075d60>]}


============================== 09:30:33.214281 | 7e29f451-f51e-4ff5-af84-e0608adc8e78 ==============================
[0m09:30:33.214281 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:30:33.214592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:30:33.324445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e29f451-f51e-4ff5-af84-e0608adc8e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108076000>]}
[0m09:30:33.347289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e29f451-f51e-4ff5-af84-e0608adc8e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f4530>]}
[0m09:30:33.348618 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:30:33.357107 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:30:33.400464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:30:33.400709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:30:33.415396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e29f451-f51e-4ff5-af84-e0608adc8e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080df500>]}
[0m09:30:33.457651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e29f451-f51e-4ff5-af84-e0608adc8e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108309310>]}
[0m09:30:33.457932 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:30:33.458101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e29f451-f51e-4ff5-af84-e0608adc8e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108324680>]}
[0m09:30:33.458934 [info ] [MainThread]: 
[0m09:30:33.459226 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:30:33.459635 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:30:33.489209 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:30:33.489457 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:30:33.489602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:33.504158 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:30:33.505421 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:30:33.506473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:30:33.506732 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:30:33.509975 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:30:33.510149 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:30:33.510283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:33.513558 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:30:33.514392 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:30:33.514535 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:30:33.514703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:33.514824 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:30:33.514949 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:30:33.515596 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:33.515998 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:30:33.516121 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:30:33.516236 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:30:33.516386 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:33.516517 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:30:33.517318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:30:33.519886 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:30:33.520038 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:30:33.520161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:33.522775 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:30:33.522935 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:30:33.523079 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:30:33.536646 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:30:33.537386 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:30:33.538311 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:30:33.538453 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:30:33.539508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e29f451-f51e-4ff5-af84-e0608adc8e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846a690>]}
[0m09:30:33.539715 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:33.539842 [debug] [MainThread]: On master: BEGIN
[0m09:30:33.539961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:33.542553 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:30:33.542714 [debug] [MainThread]: On master: COMMIT
[0m09:30:33.542845 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:33.542960 [debug] [MainThread]: On master: COMMIT
[0m09:30:33.543110 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:30:33.543234 [debug] [MainThread]: On master: Close
[0m09:30:33.543715 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:30:33.543860 [info ] [MainThread]: 
[0m09:30:33.545147 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:30:33.545422 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:30:33.545632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m09:30:33.545799 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:30:33.549280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:30:33.549649 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:30:33.567197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:30:33.567667 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:30:33.567860 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:30:33.568007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:33.570830 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:30:33.571019 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:30:33.571178 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
  );

[0m09:30:33.583811 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
  );

[0m09:30:33.584020 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:30:33.584242 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m09:30:33.589991 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m09:30:33.590177 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:30:33.592005 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:30:33.592752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e29f451-f51e-4ff5-af84-e0608adc8e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760d610>]}
[0m09:30:33.593058 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.05s]
[0m09:30:33.593336 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:30:33.594145 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:33.594288 [debug] [MainThread]: On master: BEGIN
[0m09:30:33.594402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:30:33.597133 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:30:33.597298 [debug] [MainThread]: On master: COMMIT
[0m09:30:33.597427 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:33.597539 [debug] [MainThread]: On master: COMMIT
[0m09:30:33.597692 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:30:33.597815 [debug] [MainThread]: On master: Close
[0m09:30:33.598273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:33.598391 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:30:33.598522 [info ] [MainThread]: 
[0m09:30:33.598663 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:30:33.598948 [debug] [MainThread]: Command end result
[0m09:30:33.610943 [info ] [MainThread]: 
[0m09:30:33.611156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:30:33.611297 [info ] [MainThread]: 
[0m09:30:33.611470 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:30:33.611602 [info ] [MainThread]: 
[0m09:30:33.611735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:30:33.612679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.42863593, "process_user_time": 0.900397, "process_kernel_time": 0.103723, "process_mem_max_rss": "132349952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:30:33.613010 [debug] [MainThread]: Command `dbt run` failed at 09:30:33.612961 after 0.43 seconds
[0m09:30:33.613228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a15730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c5640>]}
[0m09:30:33.613414 [debug] [MainThread]: Flushing usage events
[0m09:31:02.457738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bb740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106816270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106815fa0>]}


============================== 09:31:02.459918 | 043f425a-cf9d-4c86-bedd-45b859f2b8b9 ==============================
[0m09:31:02.459918 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:31:02.460232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:31:02.569389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '043f425a-cf9d-4c86-bedd-45b859f2b8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e5fa0>]}
[0m09:31:02.592272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '043f425a-cf9d-4c86-bedd-45b859f2b8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b55b0>]}
[0m09:31:02.593557 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:31:02.602239 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:31:02.646133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:31:02.646466 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/my_first_dbt_model.sql
[0m09:31:02.716720 [error] [MainThread]: Encountered an error:
Compilation Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  source() takes exactly two arguments (1 given)
[0m09:31:02.717638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28869724, "process_user_time": 0.808074, "process_kernel_time": 0.081453, "process_mem_max_rss": "119226368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:31:02.717917 [debug] [MainThread]: Command `dbt run` failed at 09:31:02.717867 after 0.29 seconds
[0m09:31:02.718122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106815df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b62ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691bd10>]}
[0m09:31:02.718294 [debug] [MainThread]: Flushing usage events
[0m09:31:30.891493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108521d60>]}


============================== 09:31:30.894420 | 100839ea-e563-4e24-81d8-a43ad78d79d2 ==============================
[0m09:31:30.894420 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:31:30.894750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:31:31.071738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100839ea-e563-4e24-81d8-a43ad78d79d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dff920>]}
[0m09:31:31.094800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '100839ea-e563-4e24-81d8-a43ad78d79d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a7bf0>]}
[0m09:31:31.097285 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:31:31.107327 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:31:31.165676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:31:31.166025 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/my_first_dbt_model.sql
[0m09:31:31.268140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100839ea-e563-4e24-81d8-a43ad78d79d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1f740>]}
[0m09:31:31.308617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100839ea-e563-4e24-81d8-a43ad78d79d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a11310>]}
[0m09:31:31.308898 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:31:31.309073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100839ea-e563-4e24-81d8-a43ad78d79d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a23530>]}
[0m09:31:31.309875 [info ] [MainThread]: 
[0m09:31:31.310154 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:31:31.310597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:31:31.339160 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:31:31.339397 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:31:31.339543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:31.356386 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m09:31:31.357744 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:31:31.359350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:31:31.359609 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:31:31.363429 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:31:31.363625 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:31:31.363772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:31.367209 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:31:31.368056 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:31:31.368199 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:31:31.368380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:31.368510 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:31:31.368633 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:31:31.369122 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:31.369580 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:31:31.369720 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:31:31.369842 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:31:31.370000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:31.370137 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:31:31.370953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:31:31.373554 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:31:31.373718 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:31:31.373837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:31.376601 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:31:31.376772 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:31:31.376919 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:31:31.390646 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:31:31.391367 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:31:31.392278 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:31:31.392419 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:31:31.393470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100839ea-e563-4e24-81d8-a43ad78d79d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc6870>]}
[0m09:31:31.393690 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:31.393817 [debug] [MainThread]: On master: BEGIN
[0m09:31:31.393929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:31.396516 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:31:31.396675 [debug] [MainThread]: On master: COMMIT
[0m09:31:31.396807 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:31.396924 [debug] [MainThread]: On master: COMMIT
[0m09:31:31.397078 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:31:31.397232 [debug] [MainThread]: On master: Close
[0m09:31:31.397709 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:31:31.397859 [info ] [MainThread]: 
[0m09:31:31.399172 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:31:31.399441 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:31:31.399666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m09:31:31.399837 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:31:31.403268 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:31:31.403634 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:31:31.420499 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:31:31.421018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:31:31.421185 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:31:31.421337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:31.424253 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:31:31.424463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:31:31.424629 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
LIMIT 10
  );

[0m09:31:31.438303 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM "moovai_data"."moovai_data"."tracks"
LIMIT 10
  );

[0m09:31:31.438524 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:31:31.438762 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: ROLLBACK
[0m09:31:31.444247 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.my_first_dbt_model'
[0m09:31:31.444431 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:31:31.446268 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:31:31.446973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100839ea-e563-4e24-81d8-a43ad78d79d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6e6c0>]}
[0m09:31:31.447299 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.my_first_dbt_model ................... [[31mERROR[0m in 0.05s]
[0m09:31:31.447591 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:31:31.448433 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:31.448582 [debug] [MainThread]: On master: BEGIN
[0m09:31:31.448698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:31:31.451428 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:31:31.451593 [debug] [MainThread]: On master: COMMIT
[0m09:31:31.451723 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:31.451837 [debug] [MainThread]: On master: COMMIT
[0m09:31:31.451988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:31:31.452116 [debug] [MainThread]: On master: Close
[0m09:31:31.452601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:31.452747 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:31:31.452877 [info ] [MainThread]: 
[0m09:31:31.453020 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:31:31.453314 [debug] [MainThread]: Command end result
[0m09:31:31.465919 [info ] [MainThread]: 
[0m09:31:31.466153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:31:31.466301 [info ] [MainThread]: 
[0m09:31:31.466488 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (dbt_project/models/my_first_dbt_model.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovai_data.tracks"?
  LINE 6: FROM "moovai_data"."moovai_data"."tracks"
               ^
[0m09:31:31.466631 [info ] [MainThread]: 
[0m09:31:31.466775 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:31:31.468534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6070427, "process_user_time": 0.992519, "process_kernel_time": 0.146545, "process_mem_max_rss": "136445952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:31:31.468822 [debug] [MainThread]: Command `dbt run` failed at 09:31:31.468783 after 0.61 seconds
[0m09:31:31.469012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f88170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108522060>]}
[0m09:31:31.469176 [debug] [MainThread]: Flushing usage events
[0m09:32:19.408241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107518fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f822a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81fa0>]}


============================== 09:32:19.411182 | 427a7606-9c47-443a-be8d-dc79c0787ff0 ==============================
[0m09:32:19.411182 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:32:19.411514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:32:19.591547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '427a7606-9c47-443a-be8d-dc79c0787ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751b200>]}
[0m09:32:19.615112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '427a7606-9c47-443a-be8d-dc79c0787ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108053110>]}
[0m09:32:19.616957 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:32:19.627280 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:32:19.686388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:32:19.686726 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/my_first_dbt_model.sql
[0m09:32:19.788034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '427a7606-9c47-443a-be8d-dc79c0787ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fb320>]}
[0m09:32:19.828545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '427a7606-9c47-443a-be8d-dc79c0787ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e1490>]}
[0m09:32:19.828824 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:32:19.828995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427a7606-9c47-443a-be8d-dc79c0787ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c1850>]}
[0m09:32:19.829785 [info ] [MainThread]: 
[0m09:32:19.830063 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:32:19.830478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:32:19.858646 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:32:19.858874 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:32:19.859016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:19.873919 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:32:19.875318 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:32:19.876833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:32:19.877054 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:32:19.880897 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:32:19.881081 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:32:19.881222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:19.884389 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:32:19.885246 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:32:19.885396 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:32:19.885558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:32:19.885679 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:32:19.885802 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:32:19.886513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:32:19.886914 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:32:19.887039 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:32:19.887149 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:32:19.887291 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:32:19.887416 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:32:19.888207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:32:19.890864 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:32:19.891025 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:32:19.891154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:19.893941 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:32:19.894181 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:32:19.894331 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:32:19.907552 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:32:19.908256 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:32:19.909174 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:32:19.909305 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:32:19.910448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427a7606-9c47-443a-be8d-dc79c0787ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107518f50>]}
[0m09:32:19.910713 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:19.910860 [debug] [MainThread]: On master: BEGIN
[0m09:32:19.910990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:19.913612 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:32:19.913780 [debug] [MainThread]: On master: COMMIT
[0m09:32:19.913915 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:19.914030 [debug] [MainThread]: On master: COMMIT
[0m09:32:19.914183 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:32:19.914311 [debug] [MainThread]: On master: Close
[0m09:32:19.914799 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:32:19.914945 [info ] [MainThread]: 
[0m09:32:19.916510 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:32:19.916843 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:32:19.917145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m09:32:19.917321 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:32:19.920368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:32:19.920742 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:32:19.937586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:32:19.938097 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:32:19.938267 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:32:19.938413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:19.941541 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:32:19.941745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:32:19.941904 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    SELECT *
FROM moovai_data.tracks
LIMIT 10
  );

[0m09:32:19.942215 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:32:19.945301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:32:19.945518 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:32:19.946398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:19.953458 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m09:32:19.953652 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:32:19.953809 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m09:32:19.954597 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:32:19.956936 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:32:19.957115 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop view if exists "moovai_data"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:32:19.957346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:32:19.958390 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:32:19.962626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '427a7606-9c47-443a-be8d-dc79c0787ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b70c50>]}
[0m09:32:19.962925 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.my_first_dbt_model ....................... [[32mOK[0m in 0.05s]
[0m09:32:19.963200 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:32:19.963727 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:19.963859 [debug] [MainThread]: On master: BEGIN
[0m09:32:19.963972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:32:19.966850 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:32:19.967017 [debug] [MainThread]: On master: COMMIT
[0m09:32:19.967145 [debug] [MainThread]: Using duckdb connection "master"
[0m09:32:19.967257 [debug] [MainThread]: On master: COMMIT
[0m09:32:19.967406 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:32:19.967530 [debug] [MainThread]: On master: Close
[0m09:32:19.967988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:19.968120 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:32:19.968256 [info ] [MainThread]: 
[0m09:32:19.968398 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:32:19.968689 [debug] [MainThread]: Command end result
[0m09:32:19.981838 [info ] [MainThread]: 
[0m09:32:19.982098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:32:19.982245 [info ] [MainThread]: 
[0m09:32:19.982390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:32:19.983665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.60728425, "process_user_time": 0.995066, "process_kernel_time": 0.147204, "process_mem_max_rss": "135528448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:32:19.983915 [debug] [MainThread]: Command `dbt run` succeeded at 09:32:19.983874 after 0.61 seconds
[0m09:32:19.984113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c79e0>]}
[0m09:32:19.984268 [debug] [MainThread]: Flushing usage events
[0m09:33:42.612895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108225550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108502180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108501e50>]}


============================== 09:33:42.615874 | 9a11a075-9efb-4d53-b2be-a6ca39802267 ==============================
[0m09:33:42.615874 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:33:42.616222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:33:42.791198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a11a075-9efb-4d53-b2be-a6ca39802267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c123c0>]}
[0m09:33:42.814193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a11a075-9efb-4d53-b2be-a6ca39802267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de3770>]}
[0m09:33:42.816770 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:33:42.826742 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:33:42.884031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:33:42.884365 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/my_first_dbt_model.sql
[0m09:33:42.986390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a11a075-9efb-4d53-b2be-a6ca39802267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089142f0>]}
[0m09:33:43.027116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a11a075-9efb-4d53-b2be-a6ca39802267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ed310>]}
[0m09:33:43.027395 [info ] [MainThread]: Found 1 model, 3 sources, 416 macros
[0m09:33:43.027574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a11a075-9efb-4d53-b2be-a6ca39802267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a57f0>]}
[0m09:33:43.028408 [info ] [MainThread]: 
[0m09:33:43.028691 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:33:43.029102 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:33:43.057625 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:33:43.057872 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:33:43.058019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:43.073355 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:33:43.074639 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:33:43.076107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:33:43.076329 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:33:43.080185 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:33:43.080358 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:33:43.080538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:43.083774 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:33:43.084612 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:33:43.084751 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:33:43.084910 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:33:43.085033 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:33:43.085156 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:33:43.085786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:33:43.086264 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:33:43.086413 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:33:43.086539 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:33:43.086708 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:33:43.086844 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:33:43.087669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:33:43.090289 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:33:43.090443 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:33:43.090566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:43.093297 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:33:43.093463 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:33:43.093609 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:33:43.106690 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:33:43.107467 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:33:43.108443 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:33:43.108601 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:33:43.109737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a11a075-9efb-4d53-b2be-a6ca39802267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ffec0>]}
[0m09:33:43.109980 [debug] [MainThread]: Using duckdb connection "master"
[0m09:33:43.110124 [debug] [MainThread]: On master: BEGIN
[0m09:33:43.110242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:33:43.112826 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:33:43.112992 [debug] [MainThread]: On master: COMMIT
[0m09:33:43.113125 [debug] [MainThread]: Using duckdb connection "master"
[0m09:33:43.113248 [debug] [MainThread]: On master: COMMIT
[0m09:33:43.113405 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:33:43.113532 [debug] [MainThread]: On master: Close
[0m09:33:43.114031 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:33:43.114234 [info ] [MainThread]: 
[0m09:33:43.115617 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m09:33:43.115895 [info ] [Thread-1 (]: 1 of 1 START sql view model main.my_first_dbt_model ............................ [RUN]
[0m09:33:43.116148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.my_first_dbt_model)
[0m09:33:43.116315 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m09:33:43.119381 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m09:33:43.119740 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m09:33:43.136377 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m09:33:43.136833 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:33:43.136995 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m09:33:43.137140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:43.139982 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:33:43.140187 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:33:43.140343 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
  create view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:33:43.140726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:33:43.143871 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:33:43.144061 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter view "moovai_data"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:33:43.144773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:33:43.146110 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:33:43.146265 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter view "moovai_data"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:33:43.146480 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:33:43.154288 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m09:33:43.154477 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:33:43.154623 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m09:33:43.155357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:33:43.157739 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.my_first_dbt_model"
[0m09:33:43.157925 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop view if exists "moovai_data"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:33:43.158218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:33:43.159277 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m09:33:43.163510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a11a075-9efb-4d53-b2be-a6ca39802267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de2990>]}
[0m09:33:43.163839 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.my_first_dbt_model ....................... [[32mOK[0m in 0.05s]
[0m09:33:43.164127 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m09:33:43.164681 [debug] [MainThread]: Using duckdb connection "master"
[0m09:33:43.164844 [debug] [MainThread]: On master: BEGIN
[0m09:33:43.164959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:33:43.168100 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:33:43.168375 [debug] [MainThread]: On master: COMMIT
[0m09:33:43.168507 [debug] [MainThread]: Using duckdb connection "master"
[0m09:33:43.168627 [debug] [MainThread]: On master: COMMIT
[0m09:33:43.168787 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:33:43.168918 [debug] [MainThread]: On master: Close
[0m09:33:43.169434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:43.169559 [debug] [MainThread]: Connection 'model.dbt_project.my_first_dbt_model' was properly closed.
[0m09:33:43.169703 [info ] [MainThread]: 
[0m09:33:43.169850 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:33:43.170161 [debug] [MainThread]: Command end result
[0m09:33:43.183365 [info ] [MainThread]: 
[0m09:33:43.183645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:33:43.183797 [info ] [MainThread]: 
[0m09:33:43.183942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:33:43.185294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.60237586, "process_user_time": 0.997571, "process_kernel_time": 0.15167, "process_mem_max_rss": "135266304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:33:43.185563 [debug] [MainThread]: Command `dbt run` succeeded at 09:33:43.185520 after 0.60 seconds
[0m09:33:43.185763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081972c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108914230>]}
[0m09:33:43.185922 [debug] [MainThread]: Flushing usage events
[0m09:34:20.522969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107629f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce1d30>]}


============================== 09:34:20.525872 | f6db7f57-c4c9-40c0-b283-83beb8462366 ==============================
[0m09:34:20.525872 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:34:20.526201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:34:20.698871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d65d90>]}
[0m09:34:20.722099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105066030>]}
[0m09:34:20.724149 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:34:20.734199 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:34:20.790980 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m09:34:20.791286 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/src_users.sql
[0m09:34:20.791445 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/src_tracks.sql
[0m09:34:20.791576 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/my_first_dbt_model.sql
[0m09:34:20.892896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f3ec0>]}
[0m09:34:20.932527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900a870>]}
[0m09:34:20.932810 [info ] [MainThread]: Found 2 models, 3 sources, 416 macros
[0m09:34:20.932983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ccf20>]}
[0m09:34:20.933828 [info ] [MainThread]: 
[0m09:34:20.934102 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:34:20.936293 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:34:20.962853 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:34:20.963082 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:34:20.963229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:20.977944 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:34:20.979215 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:34:20.980633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:34:20.980852 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:34:20.984161 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:20.984332 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:34:20.984466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:20.987616 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:34:20.988449 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:20.988599 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:34:20.988777 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:34:20.988904 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:20.989031 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:34:20.989712 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:34:20.990129 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:34:20.990255 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:20.990369 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:34:20.990545 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:34:20.990675 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:34:20.991909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:34:20.994610 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:34:20.994764 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:34:20.994884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:20.997723 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:34:20.997895 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:34:20.998043 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:34:21.013036 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:34:21.013809 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:34:21.014782 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:34:21.014946 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:34:21.016069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b9250>]}
[0m09:34:21.016290 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:21.016421 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.016544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:21.019247 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:34:21.019417 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.019553 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:21.019673 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.019827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:34:21.019956 [debug] [MainThread]: On master: Close
[0m09:34:21.020469 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:34:21.020651 [info ] [MainThread]: 
[0m09:34:21.021977 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m09:34:21.022238 [info ] [Thread-1 (]: 1 of 2 START sql view model main.src_tracks .................................... [RUN]
[0m09:34:21.022445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_tracks)
[0m09:34:21.022604 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m09:34:21.025629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m09:34:21.025999 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m09:34:21.041160 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m09:34:21.041675 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:21.041850 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m09:34:21.042000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:21.044955 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:34:21.045151 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:21.045317 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:34:21.045878 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:21.048926 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:21.049123 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m09:34:21.049895 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:34:21.056763 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:34:21.056947 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:21.057096 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:34:21.057675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:21.059941 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:21.060127 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m09:34:21.060369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:21.061434 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m09:34:21.065407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ca9c0>]}
[0m09:34:21.065713 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.04s]
[0m09:34:21.065993 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m09:34:21.066188 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m09:34:21.066426 [info ] [Thread-1 (]: 2 of 2 START sql view model main.src_users ..................................... [RUN]
[0m09:34:21.066617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m09:34:21.066770 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m09:34:21.067616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m09:34:21.067928 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m09:34:21.070112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m09:34:21.070479 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:21.070642 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m09:34:21.070792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:21.073875 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:34:21.074097 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:21.074260 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:34:21.074547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:21.076013 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:21.076171 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m09:34:21.076399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:21.077038 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:34:21.077190 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:21.077323 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:34:21.077696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:21.078669 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:21.078822 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m09:34:21.079019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:21.079599 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m09:34:21.081968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6db7f57-c4c9-40c0-b283-83beb8462366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b17c0>]}
[0m09:34:21.082268 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m09:34:21.082565 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m09:34:21.083171 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:21.083334 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.083460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:21.086208 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:34:21.086373 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.086505 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:21.086619 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.086774 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:34:21.086900 [debug] [MainThread]: On master: Close
[0m09:34:21.087413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:21.087552 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m09:34:21.087719 [info ] [MainThread]: 
[0m09:34:21.087870 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m09:34:21.088213 [debug] [MainThread]: Command end result
[0m09:34:21.100667 [info ] [MainThread]: 
[0m09:34:21.100906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:21.101053 [info ] [MainThread]: 
[0m09:34:21.101204 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:34:21.102475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.60962236, "process_user_time": 1.009433, "process_kernel_time": 0.137267, "process_mem_max_rss": "135987200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:34:21.102723 [debug] [MainThread]: Command `dbt run` succeeded at 09:34:21.102684 after 0.61 seconds
[0m09:34:21.102904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091663c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f5b80>]}
[0m09:34:21.103064 [debug] [MainThread]: Flushing usage events
[0m09:34:53.814528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103238830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041de300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041de000>]}


============================== 09:34:53.817449 | 0ed7704d-c572-4ea2-9620-b8b4f75959b1 ==============================
[0m09:34:53.817449 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:34:53.817786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:34:54.007270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041de090>]}
[0m09:34:54.030860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042649b0>]}
[0m09:34:54.032631 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:34:54.043166 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:34:54.103448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:34:54.103766 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/src_listen.sql
[0m09:34:54.206367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e3e90>]}
[0m09:34:54.247973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104720ef0>]}
[0m09:34:54.248260 [info ] [MainThread]: Found 3 models, 3 sources, 416 macros
[0m09:34:54.248444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439ddc0>]}
[0m09:34:54.249331 [info ] [MainThread]: 
[0m09:34:54.249616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:34:54.251927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:34:54.281252 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:34:54.281488 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:34:54.281638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:54.296718 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:34:54.298067 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:34:54.299554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:34:54.299774 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:34:54.303036 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:54.303211 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:34:54.303394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:54.306726 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:34:54.307567 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:54.307710 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:34:54.307876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:34:54.308000 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:54.308123 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:34:54.308763 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:34:54.309201 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:34:54.309351 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:34:54.309469 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:34:54.309637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:34:54.309765 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:34:54.310648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:34:54.313266 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:34:54.313427 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:34:54.313546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:54.316181 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:34:54.316343 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:34:54.316490 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:34:54.330327 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:34:54.331087 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:34:54.332047 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:34:54.332191 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:34:54.333390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a78290>]}
[0m09:34:54.333608 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:54.333747 [debug] [MainThread]: On master: BEGIN
[0m09:34:54.333876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:54.336582 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:34:54.336749 [debug] [MainThread]: On master: COMMIT
[0m09:34:54.336880 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:54.337011 [debug] [MainThread]: On master: COMMIT
[0m09:34:54.337179 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:34:54.337313 [debug] [MainThread]: On master: Close
[0m09:34:54.337799 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:34:54.337977 [info ] [MainThread]: 
[0m09:34:54.339285 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m09:34:54.339548 [info ] [Thread-1 (]: 1 of 3 START sql view model main.src_listen .................................... [RUN]
[0m09:34:54.339766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m09:34:54.339960 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m09:34:54.343041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m09:34:54.343405 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m09:34:54.358522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m09:34:54.359010 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:34:54.359184 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m09:34:54.359340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:54.362305 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:34:54.362518 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:34:54.362701 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:34:54.363044 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.366154 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:34:54.366349 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m09:34:54.366929 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.374024 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:34:54.374227 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:34:54.374392 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:34:54.375447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:34:54.377699 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:34:54.377892 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m09:34:54.378161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.379315 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m09:34:54.383887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102abe990>]}
[0m09:34:54.384226 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.04s]
[0m09:34:54.384526 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m09:34:54.384732 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m09:34:54.384977 [info ] [Thread-1 (]: 2 of 3 START sql view model main.src_tracks .................................... [RUN]
[0m09:34:54.385172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m09:34:54.385329 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m09:34:54.386219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m09:34:54.386653 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m09:34:54.388169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m09:34:54.388477 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:54.388642 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m09:34:54.388806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:54.391677 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:34:54.391868 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:54.392033 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:34:54.392358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.394665 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:54.394852 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m09:34:54.395133 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.396472 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:54.396635 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m09:34:54.396879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.398609 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:34:54.398780 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:54.398923 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:34:54.399327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.400395 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:34:54.400565 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m09:34:54.400835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.401441 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m09:34:54.403962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10377b140>]}
[0m09:34:54.404360 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:34:54.404672 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m09:34:54.404885 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m09:34:54.405156 [info ] [Thread-1 (]: 3 of 3 START sql view model main.src_users ..................................... [RUN]
[0m09:34:54.405394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m09:34:54.405561 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m09:34:54.406580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m09:34:54.407056 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m09:34:54.408516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m09:34:54.408809 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:54.408959 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m09:34:54.409099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:54.412266 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:34:54.412493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:54.412657 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:34:54.412958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.414500 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:54.414667 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m09:34:54.414906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.416205 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:54.416368 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m09:34:54.416579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.417272 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:34:54.417423 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:54.417562 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:34:54.417947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.419030 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:34:54.419187 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m09:34:54.419460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:34:54.420051 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m09:34:54.422772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7704d-c572-4ea2-9620-b8b4f75959b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aab140>]}
[0m09:34:54.423077 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m09:34:54.423331 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m09:34:54.423904 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:54.424063 [debug] [MainThread]: On master: BEGIN
[0m09:34:54.424188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:54.427415 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:34:54.427602 [debug] [MainThread]: On master: COMMIT
[0m09:34:54.427737 [debug] [MainThread]: Using duckdb connection "master"
[0m09:34:54.427856 [debug] [MainThread]: On master: COMMIT
[0m09:34:54.428022 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:34:54.428158 [debug] [MainThread]: On master: Close
[0m09:34:54.428664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:54.428797 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m09:34:54.428995 [info ] [MainThread]: 
[0m09:34:54.429160 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m09:34:54.429617 [debug] [MainThread]: Command end result
[0m09:34:54.443170 [info ] [MainThread]: 
[0m09:34:54.443421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:54.443570 [info ] [MainThread]: 
[0m09:34:54.443718 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:34:54.445315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.66283894, "process_user_time": 1.040811, "process_kernel_time": 0.155896, "process_mem_max_rss": "136675328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:34:54.445573 [debug] [MainThread]: Command `dbt run` succeeded at 09:34:54.445534 after 0.66 seconds
[0m09:34:54.445755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041de270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104257d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10377b140>]}
[0m09:34:54.445914 [debug] [MainThread]: Flushing usage events
[0m09:35:13.318173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026b1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045de1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ddee0>]}


============================== 09:35:13.321484 | dce6ac9d-c922-49b4-990c-b5314e97b7e7 ==============================
[0m09:35:13.321484 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:35:13.321816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:35:13.493920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475f4d0>]}
[0m09:35:13.516758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437f260>]}
[0m09:35:13.518520 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:35:13.528929 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:35:13.586154 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m09:35:13.586460 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/source/src_listen.sql
[0m09:35:13.586618 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/source/src_tracks.sql
[0m09:35:13.586755 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/source/src_users.sql
[0m09:35:13.586881 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/src_tracks.sql
[0m09:35:13.587002 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/src_listen.sql
[0m09:35:13.587118 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/src_users.sql
[0m09:35:13.690125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d9e50>]}
[0m09:35:13.730466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823ec0>]}
[0m09:35:13.730742 [info ] [MainThread]: Found 3 models, 3 sources, 416 macros
[0m09:35:13.730915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104919550>]}
[0m09:35:13.731776 [info ] [MainThread]: 
[0m09:35:13.732060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:35:13.734267 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:35:13.761468 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:35:13.761705 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:35:13.761853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:13.777170 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:35:13.778462 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:35:13.779948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:35:13.780176 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:35:13.783476 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:35:13.783648 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:35:13.783780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:13.786906 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:35:13.787720 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:35:13.787862 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:35:13.788021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:35:13.788147 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:35:13.788269 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:35:13.788964 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:35:13.789360 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:35:13.789485 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:35:13.789608 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:35:13.789772 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:35:13.789896 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:35:13.790753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:35:13.793326 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:35:13.793492 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:35:13.793625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:13.796358 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:35:13.796527 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:35:13.796682 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:35:13.809722 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:35:13.810510 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:35:13.811480 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:35:13.811637 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:35:13.812962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e8590>]}
[0m09:35:13.813210 [debug] [MainThread]: Using duckdb connection "master"
[0m09:35:13.813350 [debug] [MainThread]: On master: BEGIN
[0m09:35:13.813475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:35:13.816117 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:35:13.816284 [debug] [MainThread]: On master: COMMIT
[0m09:35:13.816415 [debug] [MainThread]: Using duckdb connection "master"
[0m09:35:13.816532 [debug] [MainThread]: On master: COMMIT
[0m09:35:13.816684 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:35:13.816809 [debug] [MainThread]: On master: Close
[0m09:35:13.817316 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:35:13.817468 [info ] [MainThread]: 
[0m09:35:13.818782 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m09:35:13.819047 [info ] [Thread-1 (]: 1 of 3 START sql view model main.src_listen .................................... [RUN]
[0m09:35:13.819256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m09:35:13.819416 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m09:35:13.822405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m09:35:13.822810 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m09:35:13.837850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m09:35:13.838401 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:35:13.838578 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m09:35:13.838733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:13.841859 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:35:13.842072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:35:13.842240 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:35:13.842541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.845597 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:35:13.845783 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m09:35:13.846540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:35:13.847862 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:35:13.848020 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m09:35:13.848252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.856112 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:35:13.856301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:35:13.856454 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:35:13.857327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:35:13.859647 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:35:13.859828 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m09:35:13.860123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.861184 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m09:35:13.865422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475f6e0>]}
[0m09:35:13.865728 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m09:35:13.866005 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m09:35:13.866198 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m09:35:13.866454 [info ] [Thread-1 (]: 2 of 3 START sql view model main.src_tracks .................................... [RUN]
[0m09:35:13.866667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m09:35:13.866827 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m09:35:13.868420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m09:35:13.868770 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m09:35:13.870169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m09:35:13.870477 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:35:13.870631 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m09:35:13.870768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:13.873634 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:35:13.873858 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:35:13.874023 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:35:13.874381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.875986 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:35:13.876168 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m09:35:13.876436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.877714 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:35:13.877877 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m09:35:13.878127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.878814 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:35:13.878962 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:35:13.879097 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:35:13.879529 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.880627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:35:13.880801 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m09:35:13.881087 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.881695 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m09:35:13.884125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f11be0>]}
[0m09:35:13.884420 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:35:13.884675 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m09:35:13.884865 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m09:35:13.885083 [info ] [Thread-1 (]: 3 of 3 START sql view model main.src_users ..................................... [RUN]
[0m09:35:13.885267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m09:35:13.885416 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m09:35:13.886176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m09:35:13.886610 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m09:35:13.887978 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m09:35:13.888256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:35:13.888402 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m09:35:13.888538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:13.891566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:35:13.891763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:35:13.891925 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:35:13.892204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.893632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:35:13.893789 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m09:35:13.894006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.895276 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:35:13.895436 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m09:35:13.895645 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.896347 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:35:13.896490 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:35:13.896619 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:35:13.896989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.898053 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:35:13.898222 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m09:35:13.898517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:35:13.899181 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m09:35:13.901719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce6ac9d-c922-49b4-990c-b5314e97b7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5f020>]}
[0m09:35:13.902006 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m09:35:13.902251 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m09:35:13.902785 [debug] [MainThread]: Using duckdb connection "master"
[0m09:35:13.902930 [debug] [MainThread]: On master: BEGIN
[0m09:35:13.903047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:13.905800 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:35:13.905967 [debug] [MainThread]: On master: COMMIT
[0m09:35:13.906099 [debug] [MainThread]: Using duckdb connection "master"
[0m09:35:13.906226 [debug] [MainThread]: On master: COMMIT
[0m09:35:13.906388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:35:13.906514 [debug] [MainThread]: On master: Close
[0m09:35:13.907186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:13.907339 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m09:35:13.907518 [info ] [MainThread]: 
[0m09:35:13.907675 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m09:35:13.908079 [debug] [MainThread]: Command end result
[0m09:35:13.921250 [info ] [MainThread]: 
[0m09:35:13.921455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:35:13.921603 [info ] [MainThread]: 
[0m09:35:13.921750 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:35:13.923411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.63589567, "process_user_time": 1.030665, "process_kernel_time": 0.140947, "process_mem_max_rss": "136167424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:35:13.923696 [debug] [MainThread]: Command `dbt run` succeeded at 09:35:13.923653 after 0.64 seconds
[0m09:35:13.923925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045de180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823da0>]}
[0m09:35:13.924106 [debug] [MainThread]: Flushing usage events
[0m09:42:47.875690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106239910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106499ee0>]}


============================== 09:42:47.878859 | d343ad77-67eb-410d-a39f-1ae7fda19d1f ==============================
[0m09:42:47.878859 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:42:47.879196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:42:48.062292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd343ad77-67eb-410d-a39f-1ae7fda19d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b4fe0>]}
[0m09:42:48.086569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd343ad77-67eb-410d-a39f-1ae7fda19d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106470ce0>]}
[0m09:42:48.088590 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:42:48.099489 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:42:48.163933 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 13 files added, 0 files changed.
[0m09:42:48.164254 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m09:42:48.164426 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/schema.yml
[0m09:42:48.164579 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/sources.yml
[0m09:42:48.164717 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/schema.yml
[0m09:42:48.164851 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/src_users.sql
[0m09:42:48.164977 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:42:48.165103 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m09:42:48.165224 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_users.sql
[0m09:42:48.165345 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/src_listen.sql
[0m09:42:48.165464 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m09:42:48.165582 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m09:42:48.165704 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_tracks.sql
[0m09:42:48.165821 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/src_tracks.sql
[0m09:42:48.165972 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/source/src_tracks.sql
[0m09:42:48.166091 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/source/src_listen.sql
[0m09:42:48.166205 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/source/src_users.sql
[0m09:42:48.244777 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "src_users".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("src_users").
  
  To fix this, change the name of one of these resources:
  - model.dbt_project.src_users (dbt_project/models/01_source_layer/src_users.sql)
  - model.dbt_project.src_users (dbt_project/models/03_mart_layer/src_users.sql)
[0m09:42:48.246851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4096259, "process_user_time": 0.852405, "process_kernel_time": 0.137525, "process_mem_max_rss": "119848960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:42:48.247147 [debug] [MainThread]: Command `dbt run` failed at 09:42:48.247097 after 0.41 seconds
[0m09:42:48.247358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106684290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066add90>]}
[0m09:42:48.247540 [debug] [MainThread]: Flushing usage events
[0m09:43:35.228597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017d2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104582000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104581d00>]}


============================== 09:43:35.231453 | d9e9d2e6-7f9f-4967-94cd-c5348f323a85 ==============================
[0m09:43:35.231453 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:43:35.231773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:43:35.408002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ce6f0>]}
[0m09:43:35.431308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104321a30>]}
[0m09:43:35.432988 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:43:35.442946 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:43:35.501269 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 11 files added, 0 files changed.
[0m09:43:35.501594 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m09:43:35.501760 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m09:43:35.501906 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m09:43:35.502057 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m09:43:35.502208 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/01_source_layer/sources.yml
[0m09:43:35.502345 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:43:35.502483 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/mart_users.sql
[0m09:43:35.502660 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_users.sql
[0m09:43:35.502788 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_tracks.sql
[0m09:43:35.502912 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/mart_listen.sql
[0m09:43:35.503035 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/mart_tracks.sql
[0m09:43:35.503202 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/source/src_listen.sql
[0m09:43:35.503332 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/source/src_tracks.sql
[0m09:43:35.503450 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/source/src_users.sql
[0m09:43:35.649644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104706fc0>]}
[0m09:43:35.692537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048100b0>]}
[0m09:43:35.692817 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m09:43:35.692987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6a660>]}
[0m09:43:35.694023 [info ] [MainThread]: 
[0m09:43:35.694305 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:43:35.696656 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:43:35.726289 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:43:35.726522 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:43:35.726662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:35.741924 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:43:35.743198 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:43:35.744660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:43:35.744889 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:43:35.748144 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:43:35.748312 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:43:35.748446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:35.751618 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:43:35.752479 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:43:35.752632 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:43:35.752814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:35.752945 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:43:35.753069 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:43:35.753822 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:43:35.754285 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:43:35.754432 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:43:35.754553 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:43:35.754711 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:35.754842 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:43:35.755887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:43:35.758427 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:43:35.758575 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:43:35.758692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:35.761223 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:43:35.761385 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:43:35.761532 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:43:35.774469 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:43:35.775209 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:43:35.776148 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:43:35.776307 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:43:35.777610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6a570>]}
[0m09:43:35.777845 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:35.777975 [debug] [MainThread]: On master: BEGIN
[0m09:43:35.778089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:35.780887 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:43:35.781069 [debug] [MainThread]: On master: COMMIT
[0m09:43:35.781206 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:35.781323 [debug] [MainThread]: On master: COMMIT
[0m09:43:35.781479 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:43:35.781608 [debug] [MainThread]: On master: Close
[0m09:43:35.782108 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:43:35.782276 [info ] [MainThread]: 
[0m09:43:35.783611 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m09:43:35.783867 [info ] [Thread-1 (]: 1 of 9 START sql view model main.int_listen .................................... [RUN]
[0m09:43:35.784064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.int_listen)
[0m09:43:35.784220 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m09:43:35.787174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m09:43:35.787589 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m09:43:35.802858 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m09:43:35.803688 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:43:35.803863 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m09:43:35.804006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.807108 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.807334 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:43:35.807495 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:43:35.807802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.810859 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:43:35.811040 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen__dbt_tmp" rename to "int_listen"
[0m09:43:35.811754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:43:35.818785 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:43:35.818971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:43:35.819120 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:43:35.819911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:43:35.822233 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:43:35.822412 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
drop view if exists "moovai_data"."main"."int_listen__dbt_backup" cascade
[0m09:43:35.822643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.823689 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m09:43:35.827999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e62600>]}
[0m09:43:35.828308 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main.int_listen ............................... [[32mOK[0m in 0.04s]
[0m09:43:35.828589 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m09:43:35.828792 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m09:43:35.829027 [info ] [Thread-1 (]: 2 of 9 START sql view model main.int_tracks .................................... [RUN]
[0m09:43:35.829220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_listen, now model.dbt_project.int_tracks)
[0m09:43:35.829376 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_tracks
[0m09:43:35.830948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_tracks"
[0m09:43:35.831312 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_tracks
[0m09:43:35.832767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_tracks"
[0m09:43:35.833050 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:43:35.833197 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: BEGIN
[0m09:43:35.833335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.836306 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.836493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:43:35.836652 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */

  
  create view "moovai_data"."main"."int_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:43:35.836954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.838534 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:43:35.838749 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
alter view "moovai_data"."main"."int_tracks__dbt_tmp" rename to "int_tracks"
[0m09:43:35.839033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.839890 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m09:43:35.840110 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:43:35.840265 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m09:43:35.840743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.841847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:43:35.842012 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
drop view if exists "moovai_data"."main"."int_tracks__dbt_backup" cascade
[0m09:43:35.842238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.842889 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: Close
[0m09:43:35.845317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff9040>]}
[0m09:43:35.845618 [info ] [Thread-1 (]: 2 of 9 OK created sql view model main.int_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:43:35.845884 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m09:43:35.846074 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m09:43:35.846330 [info ] [Thread-1 (]: 3 of 9 START sql view model main.int_users ..................................... [RUN]
[0m09:43:35.846532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_tracks, now model.dbt_project.int_users)
[0m09:43:35.846684 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_users
[0m09:43:35.847524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_users"
[0m09:43:35.847828 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_users
[0m09:43:35.849290 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_users"
[0m09:43:35.849601 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:43:35.849748 [debug] [Thread-1 (]: On model.dbt_project.int_users: BEGIN
[0m09:43:35.849886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.852661 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.852839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:43:35.852989 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */

  
  create view "moovai_data"."main"."int_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:43:35.853264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.854595 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:43:35.854754 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
alter view "moovai_data"."main"."int_users__dbt_tmp" rename to "int_users"
[0m09:43:35.854972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.855605 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m09:43:35.855758 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:43:35.855887 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m09:43:35.856379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.857429 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:43:35.857587 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
drop view if exists "moovai_data"."main"."int_users__dbt_backup" cascade
[0m09:43:35.857800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.858385 [debug] [Thread-1 (]: On model.dbt_project.int_users: Close
[0m09:43:35.860726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050341d0>]}
[0m09:43:35.861048 [info ] [Thread-1 (]: 3 of 9 OK created sql view model main.int_users ................................ [[32mOK[0m in 0.01s]
[0m09:43:35.861317 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m09:43:35.861506 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m09:43:35.861745 [info ] [Thread-1 (]: 4 of 9 START sql view model main.mart_listen ................................... [RUN]
[0m09:43:35.861949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_users, now model.dbt_project.mart_listen)
[0m09:43:35.862100 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen
[0m09:43:35.862976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen"
[0m09:43:35.863379 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen
[0m09:43:35.865026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen"
[0m09:43:35.865489 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:43:35.865652 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: BEGIN
[0m09:43:35.865793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.868765 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.868959 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:43:35.869121 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */

  
  create view "moovai_data"."main"."mart_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:43:35.869405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.870840 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:43:35.870999 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter view "moovai_data"."main"."mart_listen__dbt_tmp" rename to "mart_listen"
[0m09:43:35.871226 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.871855 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m09:43:35.872013 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:43:35.872157 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m09:43:35.872636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.873730 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:43:35.873896 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
drop view if exists "moovai_data"."main"."mart_listen__dbt_backup" cascade
[0m09:43:35.874110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.874711 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: Close
[0m09:43:35.877107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504dfd0>]}
[0m09:43:35.877407 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main.mart_listen .............................. [[32mOK[0m in 0.02s]
[0m09:43:35.877658 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m09:43:35.877842 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m09:43:35.878053 [info ] [Thread-1 (]: 5 of 9 START sql view model main.mart_tracks ................................... [RUN]
[0m09:43:35.878230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen, now model.dbt_project.mart_tracks)
[0m09:43:35.878379 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_tracks
[0m09:43:35.880116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_tracks"
[0m09:43:35.880419 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_tracks
[0m09:43:35.881838 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_tracks"
[0m09:43:35.882130 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:43:35.882287 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: BEGIN
[0m09:43:35.882425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.885229 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.885421 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:43:35.885577 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */

  
  create view "moovai_data"."main"."mart_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:43:35.885863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.887226 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:43:35.887393 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter view "moovai_data"."main"."mart_tracks__dbt_tmp" rename to "mart_tracks"
[0m09:43:35.887642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.888303 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m09:43:35.888495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:43:35.888666 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m09:43:35.889089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.890428 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:43:35.890628 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
drop view if exists "moovai_data"."main"."mart_tracks__dbt_backup" cascade
[0m09:43:35.890925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.891542 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: Close
[0m09:43:35.893980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105042630>]}
[0m09:43:35.894278 [info ] [Thread-1 (]: 5 of 9 OK created sql view model main.mart_tracks .............................. [[32mOK[0m in 0.02s]
[0m09:43:35.894528 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m09:43:35.894725 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m09:43:35.894939 [info ] [Thread-1 (]: 6 of 9 START sql view model main.mart_users .................................... [RUN]
[0m09:43:35.895115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_tracks, now model.dbt_project.mart_users)
[0m09:43:35.895268 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_users
[0m09:43:35.896102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_users"
[0m09:43:35.896416 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_users
[0m09:43:35.897887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_users"
[0m09:43:35.898181 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:43:35.898332 [debug] [Thread-1 (]: On model.dbt_project.mart_users: BEGIN
[0m09:43:35.898480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.901251 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.901428 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:43:35.901578 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */

  
  create view "moovai_data"."main"."mart_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:43:35.901855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.903202 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:43:35.903363 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter view "moovai_data"."main"."mart_users__dbt_tmp" rename to "mart_users"
[0m09:43:35.903576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.904203 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m09:43:35.904350 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:43:35.904490 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m09:43:35.904819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.905845 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:43:35.906004 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
drop view if exists "moovai_data"."main"."mart_users__dbt_backup" cascade
[0m09:43:35.906240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.906845 [debug] [Thread-1 (]: On model.dbt_project.mart_users: Close
[0m09:43:35.909223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e6f00>]}
[0m09:43:35.909535 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main.mart_users ............................... [[32mOK[0m in 0.01s]
[0m09:43:35.909801 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m09:43:35.909988 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m09:43:35.910212 [info ] [Thread-1 (]: 7 of 9 START sql view model main.src_listen .................................... [RUN]
[0m09:43:35.910397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_users, now model.dbt_project.src_listen)
[0m09:43:35.910549 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m09:43:35.911369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m09:43:35.911749 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m09:43:35.913296 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m09:43:35.913711 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:43:35.913877 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m09:43:35.914024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.917109 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.917316 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:43:35.917479 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:43:35.917757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.919293 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:43:35.919472 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m09:43:35.919708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.921004 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:43:35.921160 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m09:43:35.921370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.923311 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:43:35.923496 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:43:35.923643 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:43:35.924068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.926062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:43:35.926233 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m09:43:35.926513 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.927110 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m09:43:35.929597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503f410>]}
[0m09:43:35.929897 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.02s]
[0m09:43:35.930146 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m09:43:35.930327 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m09:43:35.930540 [info ] [Thread-1 (]: 8 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m09:43:35.930716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m09:43:35.930870 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m09:43:35.931789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m09:43:35.932087 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m09:43:35.933556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m09:43:35.933843 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:43:35.933990 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m09:43:35.934125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.936971 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.937164 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:43:35.937323 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:43:35.937628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.939430 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:43:35.939661 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m09:43:35.940053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.941523 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:43:35.941687 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m09:43:35.941920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.942595 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:43:35.942737 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:43:35.942868 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:43:35.943228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.944239 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:43:35.944395 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m09:43:35.944649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.945222 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m09:43:35.947705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc7980>]}
[0m09:43:35.948011 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:43:35.948277 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m09:43:35.948467 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m09:43:35.948690 [info ] [Thread-1 (]: 9 of 9 START sql view model main.src_users ..................................... [RUN]
[0m09:43:35.948872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m09:43:35.949027 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m09:43:35.949888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m09:43:35.950205 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m09:43:35.951611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m09:43:35.951887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:43:35.952045 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m09:43:35.952179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:35.954947 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:43:35.955132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:43:35.955289 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:43:35.955583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.957289 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:43:35.957454 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m09:43:35.957678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.958937 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:43:35.959090 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m09:43:35.959296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.959956 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:43:35.960098 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:43:35.960230 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:43:35.960630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.961735 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:43:35.961916 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m09:43:35.962235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:35.963027 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m09:43:35.965537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e9d2e6-7f9f-4967-94cd-c5348f323a85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505a8d0>]}
[0m09:43:35.965824 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m09:43:35.966074 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m09:43:35.966614 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:35.966753 [debug] [MainThread]: On master: BEGIN
[0m09:43:35.966868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:35.969599 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:43:35.969760 [debug] [MainThread]: On master: COMMIT
[0m09:43:35.969891 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:35.970004 [debug] [MainThread]: On master: COMMIT
[0m09:43:35.970149 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:43:35.970273 [debug] [MainThread]: On master: Close
[0m09:43:35.970754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:35.970908 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m09:43:35.971086 [info ] [MainThread]: 
[0m09:43:35.971240 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m09:43:35.971933 [debug] [MainThread]: Command end result
[0m09:43:35.992627 [info ] [MainThread]: 
[0m09:43:35.992895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:43:35.993052 [info ] [MainThread]: 
[0m09:43:35.993203 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:43:35.994799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7959637, "process_user_time": 1.174168, "process_kernel_time": 0.154218, "process_mem_max_rss": "139214848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:43:35.995045 [debug] [MainThread]: Command `dbt run` succeeded at 09:43:35.995005 after 0.80 seconds
[0m09:43:35.995226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a96f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104946120>]}
[0m09:43:35.995383 [debug] [MainThread]: Flushing usage events
[0m09:45:50.430359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103478e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee1eb0>]}


============================== 09:45:50.433535 | ec6720a9-17d8-4c81-81ba-28ba32c9ec1c ==============================
[0m09:45:50.433535 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:45:50.433879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:45:50.617924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec6720a9-17d8-4c81-81ba-28ba32c9ec1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103478e60>]}
[0m09:45:50.640925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec6720a9-17d8-4c81-81ba-28ba32c9ec1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10347bb30>]}
[0m09:45:50.642776 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:45:50.652874 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:45:50.715166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:45:50.715513 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:45:50.789894 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:45:50.791391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39499626, "process_user_time": 0.819224, "process_kernel_time": 0.126947, "process_mem_max_rss": "118390784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:45:50.791679 [debug] [MainThread]: Command `dbt run` failed at 09:45:50.791628 after 0.40 seconds
[0m09:45:50.791915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042cc080>]}
[0m09:45:50.792089 [debug] [MainThread]: Flushing usage events
[0m09:47:35.225726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c7ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104869c40>]}


============================== 09:47:35.228839 | 2cc01a3d-75a1-4439-8b80-e31a28c2867a ==============================
[0m09:47:35.228839 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:47:35.229153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m09:47:35.409394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc01a3d-75a1-4439-8b80-e31a28c2867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d3830>]}
[0m09:47:35.432953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc01a3d-75a1-4439-8b80-e31a28c2867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cbf20>]}
[0m09:47:35.435533 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:47:35.446251 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:47:35.507048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:47:35.507390 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:47:35.581975 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:47:35.584205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3886818, "process_user_time": 0.815787, "process_kernel_time": 0.097545, "process_mem_max_rss": "119685120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:47:35.584604 [debug] [MainThread]: Command `dbt run` failed at 09:47:35.584544 after 0.39 seconds
[0m09:47:35.584950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104869f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b939b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c58410>]}
[0m09:47:35.585152 [debug] [MainThread]: Flushing usage events
[0m09:47:58.387988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10350aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6df10>]}


============================== 09:47:58.391519 | ca0195ea-7421-4343-9553-9b3d52d86b92 ==============================
[0m09:47:58.391519 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:47:58.391880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select /Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/dbt_project/models/01_source_layer/src_listen.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:47:58.566117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca0195ea-7421-4343-9553-9b3d52d86b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10284f800>]}
[0m09:47:58.589814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca0195ea-7421-4343-9553-9b3d52d86b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028de060>]}
[0m09:47:58.592268 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:47:58.602468 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:47:58.662641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:47:58.662973 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:47:58.738767 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:47:58.740303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38430732, "process_user_time": 0.82494, "process_kernel_time": 0.118637, "process_mem_max_rss": "119046144", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:47:58.740650 [debug] [MainThread]: Command `dbt run` failed at 09:47:58.740595 after 0.38 seconds
[0m09:47:58.740864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f22d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104297aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439bad0>]}
[0m09:47:58.741050 [debug] [MainThread]: Flushing usage events
[0m09:48:21.458899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c0dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c0dbe0>]}


============================== 09:48:21.462031 | e0cbc840-2873-42e5-8ec0-1af97cff922d ==============================
[0m09:48:21.462031 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:48:21.462354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/01_source_layer/src_listen.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:48:21.615783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0cbc840-2873-42e5-8ec0-1af97cff922d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107201580>]}
[0m09:48:21.638704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0cbc840-2873-42e5-8ec0-1af97cff922d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cab500>]}
[0m09:48:21.641223 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:48:21.651157 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:48:21.709791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:21.710117 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:48:21.782124 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:48:21.783891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3544759, "process_user_time": 0.814458, "process_kernel_time": 0.107723, "process_mem_max_rss": "117276672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:48:21.784180 [debug] [MainThread]: Command `dbt run` failed at 09:48:21.784133 after 0.35 seconds
[0m09:48:21.784387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c0dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c718e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f21580>]}
[0m09:48:21.784564 [debug] [MainThread]: Flushing usage events
[0m09:48:26.249410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014ada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105446390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105446060>]}


============================== 09:48:26.251633 | 5c2de7da-81fb-419e-8bff-374e6e43c559 ==============================
[0m09:48:26.251633 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:48:26.251940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select /models/01_source_layer/src_listen.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:48:26.363854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c2de7da-81fb-419e-8bff-374e6e43c559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ea210>]}
[0m09:48:26.386973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c2de7da-81fb-419e-8bff-374e6e43c559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a85250>]}
[0m09:48:26.388282 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:48:26.397298 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:48:26.441642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:26.441990 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:48:26.512367 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:48:26.513347 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29172233, "process_user_time": 0.813854, "process_kernel_time": 0.079799, "process_mem_max_rss": "118620160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:48:26.513623 [debug] [MainThread]: Command `dbt run` failed at 09:48:26.513573 after 0.29 seconds
[0m09:48:26.513829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cbb00>]}
[0m09:48:26.514002 [debug] [MainThread]: Flushing usage events
[0m09:48:33.441298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10604b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634dfa0>]}


============================== 09:48:33.443567 | 442b2356-3a69-438a-8c30-d44b5633b724 ==============================
[0m09:48:33.443567 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:48:33.443874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select 01_source_layer/src_listen.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:48:33.562879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '442b2356-3a69-438a-8c30-d44b5633b724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064affe0>]}
[0m09:48:33.585779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '442b2356-3a69-438a-8c30-d44b5633b724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106420d70>]}
[0m09:48:33.587097 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:48:33.595682 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:48:33.643432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:33.643784 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:48:33.715039 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:48:33.716808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.30373317, "process_user_time": 0.8117, "process_kernel_time": 0.08595, "process_mem_max_rss": "119242752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:48:33.717140 [debug] [MainThread]: Command `dbt run` failed at 09:48:33.717086 after 0.30 seconds
[0m09:48:33.717373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106302390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ae480>]}
[0m09:48:33.717565 [debug] [MainThread]: Flushing usage events
[0m09:48:44.867601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b29fd0>]}


============================== 09:48:44.869835 | 8d0b5a5b-5c00-4422-ba50-28beb8701f00 ==============================
[0m09:48:44.869835 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:48:44.870149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:48:44.980550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d0b5a5b-5c00-4422-ba50-28beb8701f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92990>]}
[0m09:48:45.003432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d0b5a5b-5c00-4422-ba50-28beb8701f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d5a90>]}
[0m09:48:45.004806 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:48:45.013789 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:48:45.059815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:45.060173 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:48:45.130637 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:48:45.131652 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.291397, "process_user_time": 0.814097, "process_kernel_time": 0.078931, "process_mem_max_rss": "119701504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:48:45.131941 [debug] [MainThread]: Command `dbt run` failed at 09:48:45.131890 after 0.29 seconds
[0m09:48:45.132143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d498b0>]}
[0m09:48:45.132313 [debug] [MainThread]: Flushing usage events
[0m09:48:52.306280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4e1b0>]}


============================== 09:48:52.308480 | 3ce2ecbf-dcf5-4a2f-b754-78e8a8af6bed ==============================
[0m09:48:52.308480 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:48:52.308781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_tracks.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:48:52.422483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ce2ecbf-dcf5-4a2f-b754-78e8a8af6bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c28a10>]}
[0m09:48:52.445412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ce2ecbf-dcf5-4a2f-b754-78e8a8af6bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ced6a0>]}
[0m09:48:52.446696 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:48:52.455621 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:48:52.501142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:52.501488 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:48:52.572821 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:48:52.574688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29596937, "process_user_time": 0.816962, "process_kernel_time": 0.081769, "process_mem_max_rss": "119373824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:48:52.574987 [debug] [MainThread]: Command `dbt run` failed at 09:48:52.574936 after 0.30 seconds
[0m09:48:52.575191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105045c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b683e0>]}
[0m09:48:52.575397 [debug] [MainThread]: Flushing usage events
[0m09:49:18.958865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a462a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a45eb0>]}


============================== 09:49:18.961703 | 62a55d7c-4d3f-4cf4-9cba-d63d80b4df94 ==============================
[0m09:49:18.961703 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:49:18.962013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select src_tracks.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:49:19.137758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a55d7c-4d3f-4cf4-9cba-d63d80b4df94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a47d70>]}
[0m09:49:19.161048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a55d7c-4d3f-4cf4-9cba-d63d80b4df94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f5a90>]}
[0m09:49:19.162849 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:49:19.173885 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:49:19.235547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:49:19.235900 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:49:19.336614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62a55d7c-4d3f-4cf4-9cba-d63d80b4df94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110225d90>]}
[0m09:49:19.385238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62a55d7c-4d3f-4cf4-9cba-d63d80b4df94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110454470>]}
[0m09:49:19.385528 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m09:49:19.385708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a55d7c-4d3f-4cf4-9cba-d63d80b4df94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100efbc0>]}
[0m09:49:19.386555 [info ] [MainThread]: 
[0m09:49:19.386855 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:49:19.387329 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:49:19.416586 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:49:19.416812 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:49:19.417000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:19.433601 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m09:49:19.434669 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:49:19.436213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:49:19.436439 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:49:19.439684 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:19.439850 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:49:19.439983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:19.443151 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:49:19.443820 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:19.443961 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:49:19.444126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:49:19.444258 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:19.444382 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:49:19.444948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:49:19.445416 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:49:19.445563 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:19.445688 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:49:19.445867 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:49:19.446007 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:49:19.448795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:49:19.451339 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:49:19.451494 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:49:19.451624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:19.454297 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:49:19.454447 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:49:19.454584 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:49:19.467983 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:49:19.468810 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:49:19.469813 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:49:19.469963 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:49:19.471515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a55d7c-4d3f-4cf4-9cba-d63d80b4df94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110227470>]}
[0m09:49:19.471738 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:19.471863 [debug] [MainThread]: On master: BEGIN
[0m09:49:19.471977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:49:19.474648 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:49:19.474809 [debug] [MainThread]: On master: COMMIT
[0m09:49:19.474942 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:19.475056 [debug] [MainThread]: On master: COMMIT
[0m09:49:19.475211 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:49:19.475340 [debug] [MainThread]: On master: Close
[0m09:49:19.475831 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:49:19.475999 [info ] [MainThread]: 
[0m09:49:19.477169 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m09:49:19.477424 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_tracks .................................... [RUN]
[0m09:49:19.477622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_tracks)
[0m09:49:19.477782 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m09:49:19.480748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m09:49:19.481400 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m09:49:19.496234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m09:49:19.496685 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:49:19.496854 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m09:49:19.497000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:19.499967 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:49:19.500188 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:49:19.500356 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:49:19.500678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:19.503979 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:49:19.504179 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m09:49:19.504754 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:19.506058 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:49:19.506230 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m09:49:19.506453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:19.514254 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:49:19.514444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:49:19.514600 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:49:19.515468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:49:19.518513 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:49:19.518716 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m09:49:19.519036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:19.520139 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m09:49:19.523708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a55d7c-4d3f-4cf4-9cba-d63d80b4df94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de17c0>]}
[0m09:49:19.524046 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.05s]
[0m09:49:19.524322 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m09:49:19.524860 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:19.525002 [debug] [MainThread]: On master: BEGIN
[0m09:49:19.525123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:19.527947 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:49:19.528110 [debug] [MainThread]: On master: COMMIT
[0m09:49:19.528237 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:19.528352 [debug] [MainThread]: On master: COMMIT
[0m09:49:19.528509 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:49:19.528633 [debug] [MainThread]: On master: Close
[0m09:49:19.529108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:19.529232 [debug] [MainThread]: Connection 'model.dbt_project.src_tracks' was properly closed.
[0m09:49:19.529365 [info ] [MainThread]: 
[0m09:49:19.529506 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:49:19.529790 [debug] [MainThread]: Command end result
[0m09:49:19.542817 [info ] [MainThread]: 
[0m09:49:19.543072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:19.543217 [info ] [MainThread]: 
[0m09:49:19.543368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:49:19.544779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61529493, "process_user_time": 1.00085, "process_kernel_time": 0.131245, "process_mem_max_rss": "135659520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:49:19.545059 [debug] [MainThread]: Command `dbt run` succeeded at 09:49:19.545016 after 0.62 seconds
[0m09:49:19.545249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106664f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a462a0>]}
[0m09:49:19.545417 [debug] [MainThread]: Flushing usage events
[0m09:49:40.402991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0de20>]}


============================== 09:49:40.405141 | 735e3868-6ba6-4e08-a814-6a9270cfed86 ==============================
[0m09:49:40.405141 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:49:40.405456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_listen.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:49:40.515205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '735e3868-6ba6-4e08-a814-6a9270cfed86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b8f80>]}
[0m09:49:40.538241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '735e3868-6ba6-4e08-a814-6a9270cfed86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2c1a0>]}
[0m09:49:40.539571 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:49:40.547814 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:49:40.592788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:49:40.593027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:49:40.607417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '735e3868-6ba6-4e08-a814-6a9270cfed86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c82c60>]}
[0m09:49:40.646302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '735e3868-6ba6-4e08-a814-6a9270cfed86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7fa40>]}
[0m09:49:40.646560 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m09:49:40.646732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735e3868-6ba6-4e08-a814-6a9270cfed86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e9910>]}
[0m09:49:40.647591 [info ] [MainThread]: 
[0m09:49:40.647863 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:49:40.648265 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:49:40.671022 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:49:40.671263 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:49:40.671409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:40.675313 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:49:40.676004 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:49:40.676702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:49:40.676920 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:49:40.680113 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:40.680274 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:49:40.680406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:40.683104 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:49:40.683735 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:40.683873 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:49:40.684035 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:49:40.684160 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:40.684275 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:49:40.684448 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:49:40.684843 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:49:40.684969 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:49:40.685089 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:49:40.685262 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:49:40.685455 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:49:40.688557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:49:40.691151 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:49:40.691346 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:49:40.691511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:40.694350 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:49:40.694512 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:49:40.694668 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:49:40.705222 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m09:49:40.705995 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:49:40.707505 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:49:40.707663 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:49:40.709213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '735e3868-6ba6-4e08-a814-6a9270cfed86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062528a0>]}
[0m09:49:40.709429 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:40.709556 [debug] [MainThread]: On master: BEGIN
[0m09:49:40.709677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:49:40.712399 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:49:40.712555 [debug] [MainThread]: On master: COMMIT
[0m09:49:40.712677 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:40.712791 [debug] [MainThread]: On master: COMMIT
[0m09:49:40.712944 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:49:40.713066 [debug] [MainThread]: On master: Close
[0m09:49:40.713582 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:49:40.713748 [info ] [MainThread]: 
[0m09:49:40.714719 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m09:49:40.714972 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m09:49:40.715173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m09:49:40.715334 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m09:49:40.718669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m09:49:40.719479 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m09:49:40.734229 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m09:49:40.734612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:49:40.734776 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m09:49:40.734923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:40.737779 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:49:40.737956 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:49:40.738112 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:49:40.738415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:40.741467 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:49:40.741651 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m09:49:40.741923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:40.743322 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:49:40.743487 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m09:49:40.743712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:40.751500 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:49:40.751690 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:49:40.751846 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:49:40.752300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:40.754538 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:49:40.754711 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m09:49:40.754994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:49:40.756033 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m09:49:40.758928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '735e3868-6ba6-4e08-a814-6a9270cfed86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516acc0>]}
[0m09:49:40.759255 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.04s]
[0m09:49:40.759534 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m09:49:40.760087 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:40.760239 [debug] [MainThread]: On master: BEGIN
[0m09:49:40.760360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:40.763125 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:49:40.763289 [debug] [MainThread]: On master: COMMIT
[0m09:49:40.763423 [debug] [MainThread]: Using duckdb connection "master"
[0m09:49:40.763541 [debug] [MainThread]: On master: COMMIT
[0m09:49:40.763693 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:49:40.763820 [debug] [MainThread]: On master: Close
[0m09:49:40.764374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:40.764508 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m09:49:40.764648 [info ] [MainThread]: 
[0m09:49:40.764793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m09:49:40.765082 [debug] [MainThread]: Command end result
[0m09:49:40.781606 [info ] [MainThread]: 
[0m09:49:40.781873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:40.782023 [info ] [MainThread]: 
[0m09:49:40.782171 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:49:40.782925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40756074, "process_user_time": 0.910471, "process_kernel_time": 0.09939, "process_mem_max_rss": "132775936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:49:40.783169 [debug] [MainThread]: Command `dbt run` succeeded at 09:49:40.783129 after 0.41 seconds
[0m09:49:40.783351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063140e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b7b30>]}
[0m09:49:40.783509 [debug] [MainThread]: Flushing usage events
[0m09:50:25.554538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890df10>]}


============================== 09:50:25.557494 | c1f5ce03-3da1-413d-a456-cdcd77816004 ==============================
[0m09:50:25.557494 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:50:25.557810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_listen.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:25.745098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f5ce03-3da1-413d-a456-cdcd77816004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108930650>]}
[0m09:50:25.768134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f5ce03-3da1-413d-a456-cdcd77816004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108975ac0>]}
[0m09:50:25.769971 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:50:25.779967 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:50:25.842788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:25.843147 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:50:25.915732 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.int_listen' (dbt_project/models/02_intermediate_layer/int_listen.sql) depends on a node named 'src_listen.sql' which was not found
[0m09:50:25.917660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39465132, "process_user_time": 0.818826, "process_kernel_time": 0.126004, "process_mem_max_rss": "119209984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:50:25.918038 [debug] [MainThread]: Command `dbt run` failed at 09:50:25.917989 after 0.40 seconds
[0m09:50:25.918263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108995640>]}
[0m09:50:25.918571 [debug] [MainThread]: Flushing usage events
[0m09:50:39.161590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104369430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a030>]}


============================== 09:50:39.164552 | 26e59775-2890-4d78-ad83-8ee81545b4bf ==============================
[0m09:50:39.164552 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:50:39.164875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select int_listen.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:50:39.343335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26e59775-2890-4d78-ad83-8ee81545b4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e77a0>]}
[0m09:50:39.366112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26e59775-2890-4d78-ad83-8ee81545b4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea4da0>]}
[0m09:50:39.368577 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:50:39.378583 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:50:39.438168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:39.438507 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m09:50:39.540414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26e59775-2890-4d78-ad83-8ee81545b4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105259b50>]}
[0m09:50:39.585572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26e59775-2890-4d78-ad83-8ee81545b4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105854dd0>]}
[0m09:50:39.585867 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m09:50:39.586044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e59775-2890-4d78-ad83-8ee81545b4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512c470>]}
[0m09:50:39.586900 [info ] [MainThread]: 
[0m09:50:39.587188 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:50:39.587665 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:50:39.616592 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:50:39.616830 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:50:39.616977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:39.633880 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m09:50:39.635266 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:50:39.636914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:50:39.637145 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:50:39.640341 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:50:39.640508 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:50:39.640646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:39.644322 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:50:39.645205 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:50:39.645357 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:50:39.645529 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:50:39.645655 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:50:39.645784 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:50:39.646384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:50:39.646794 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:50:39.646922 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:50:39.647037 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:50:39.647188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:50:39.647317 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:50:39.650181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:50:39.652813 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:50:39.652965 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:50:39.653086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:39.655725 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:50:39.655891 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:50:39.656038 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:50:39.670639 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:50:39.671484 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:50:39.672608 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:50:39.672769 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:50:39.674359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e59775-2890-4d78-ad83-8ee81545b4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587be00>]}
[0m09:50:39.674578 [debug] [MainThread]: Using duckdb connection "master"
[0m09:50:39.674709 [debug] [MainThread]: On master: BEGIN
[0m09:50:39.674823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:39.677492 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:50:39.677659 [debug] [MainThread]: On master: COMMIT
[0m09:50:39.677823 [debug] [MainThread]: Using duckdb connection "master"
[0m09:50:39.677942 [debug] [MainThread]: On master: COMMIT
[0m09:50:39.678096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:50:39.678222 [debug] [MainThread]: On master: Close
[0m09:50:39.678715 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:50:39.678868 [info ] [MainThread]: 
[0m09:50:39.680044 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m09:50:39.680320 [info ] [Thread-1 (]: 1 of 1 START sql view model main.int_listen .................................... [RUN]
[0m09:50:39.680527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.int_listen)
[0m09:50:39.680695 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m09:50:39.684116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m09:50:39.685032 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m09:50:39.700295 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m09:50:39.700749 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:50:39.700914 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m09:50:39.701061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:39.704200 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:50:39.704411 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:50:39.704571 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    with int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

select *
from src_listen
  );

[0m09:50:39.705084 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:50:39.708180 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:50:39.708365 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen" rename to "int_listen__dbt_backup"
[0m09:50:39.709054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:50:39.710368 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:50:39.710530 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen__dbt_tmp" rename to "int_listen"
[0m09:50:39.710784 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:50:39.718730 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:50:39.718917 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:50:39.719066 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:50:39.720055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:50:39.723120 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:50:39.723303 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
drop view if exists "moovai_data"."main"."int_listen__dbt_backup" cascade
[0m09:50:39.723606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:50:39.724637 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m09:50:39.729078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26e59775-2890-4d78-ad83-8ee81545b4bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b4eab0>]}
[0m09:50:39.729416 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.int_listen ............................... [[32mOK[0m in 0.05s]
[0m09:50:39.729693 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m09:50:39.730220 [debug] [MainThread]: Using duckdb connection "master"
[0m09:50:39.730364 [debug] [MainThread]: On master: BEGIN
[0m09:50:39.730478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:39.733221 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:50:39.733382 [debug] [MainThread]: On master: COMMIT
[0m09:50:39.733507 [debug] [MainThread]: Using duckdb connection "master"
[0m09:50:39.733621 [debug] [MainThread]: On master: COMMIT
[0m09:50:39.733766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:50:39.733890 [debug] [MainThread]: On master: Close
[0m09:50:39.734372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:39.734489 [debug] [MainThread]: Connection 'model.dbt_project.int_listen' was properly closed.
[0m09:50:39.734620 [info ] [MainThread]: 
[0m09:50:39.734764 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m09:50:39.735068 [debug] [MainThread]: Command end result
[0m09:50:39.749006 [info ] [MainThread]: 
[0m09:50:39.749261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:50:39.749412 [info ] [MainThread]: 
[0m09:50:39.749564 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:50:39.751250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61932135, "process_user_time": 1.005352, "process_kernel_time": 0.151112, "process_mem_max_rss": "136200192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:50:39.751531 [debug] [MainThread]: Command `dbt run` succeeded at 09:50:39.751490 after 0.62 seconds
[0m09:50:39.751741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105181760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105109d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a300>]}
[0m09:50:39.751918 [debug] [MainThread]: Flushing usage events
[0m09:51:21.152624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108751580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a32240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a31f70>]}


============================== 09:51:21.155216 | 07611851-75f9-41b7-b8ea-cb4fe6e4664e ==============================
[0m09:51:21.155216 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:51:21.155517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:51:21.268362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108687560>]}
[0m09:51:21.291185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad1ac0>]}
[0m09:51:21.293677 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:51:21.301876 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:51:21.360994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:51:21.361340 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_users.sql
[0m09:51:21.361524 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_tracks.sql
[0m09:51:21.460177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8e270>]}
[0m09:51:21.501549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8cb60>]}
[0m09:51:21.501833 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m09:51:21.502004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f53d40>]}
[0m09:51:21.503044 [info ] [MainThread]: 
[0m09:51:21.503332 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:51:21.505646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:51:21.530979 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:51:21.531232 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:51:21.531390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:21.535612 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:51:21.536324 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:51:21.537052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:51:21.537266 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:51:21.540441 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:51:21.540609 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:51:21.540745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:21.543590 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:51:21.544251 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:51:21.544389 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:51:21.544551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:21.544674 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:51:21.544789 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:51:21.544961 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:21.545333 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:51:21.545494 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:51:21.545606 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:51:21.545753 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:51:21.545872 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:51:21.546911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:51:21.549472 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:51:21.549639 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:51:21.549763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:21.552528 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:51:21.552688 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:51:21.552824 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:51:21.563174 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m09:51:21.563922 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:51:21.565064 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:51:21.565228 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:51:21.566769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a96f30>]}
[0m09:51:21.566989 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:21.567118 [debug] [MainThread]: On master: BEGIN
[0m09:51:21.567235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:21.569957 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:51:21.570126 [debug] [MainThread]: On master: COMMIT
[0m09:51:21.570257 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:21.570377 [debug] [MainThread]: On master: COMMIT
[0m09:51:21.570533 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:51:21.570661 [debug] [MainThread]: On master: Close
[0m09:51:21.571169 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:51:21.571324 [info ] [MainThread]: 
[0m09:51:21.572632 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m09:51:21.572880 [info ] [Thread-1 (]: 1 of 9 START sql view model main.mart_listen ................................... [RUN]
[0m09:51:21.573082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen)
[0m09:51:21.573236 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen
[0m09:51:21.576178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen"
[0m09:51:21.576552 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen
[0m09:51:21.591618 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen"
[0m09:51:21.592074 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:51:21.592240 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: BEGIN
[0m09:51:21.592386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.595432 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.595651 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:51:21.595810 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */

  
  create view "moovai_data"."main"."mart_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:51:21.596118 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.599307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:51:21.599493 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter view "moovai_data"."main"."mart_listen" rename to "mart_listen__dbt_backup"
[0m09:51:21.599749 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.601061 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:51:21.601227 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter view "moovai_data"."main"."mart_listen__dbt_tmp" rename to "mart_listen"
[0m09:51:21.601435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.609815 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m09:51:21.610003 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:51:21.610149 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m09:51:21.610585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.612805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:51:21.612981 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
drop view if exists "moovai_data"."main"."mart_listen__dbt_backup" cascade
[0m09:51:21.613273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.614349 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: Close
[0m09:51:21.617244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ab860>]}
[0m09:51:21.617554 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main.mart_listen .............................. [[32mOK[0m in 0.04s]
[0m09:51:21.617829 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m09:51:21.618035 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m09:51:21.618314 [info ] [Thread-1 (]: 2 of 9 START sql view model main.mart_tracks ................................... [RUN]
[0m09:51:21.618541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen, now model.dbt_project.mart_tracks)
[0m09:51:21.618708 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_tracks
[0m09:51:21.619636 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_tracks"
[0m09:51:21.619979 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_tracks
[0m09:51:21.621474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_tracks"
[0m09:51:21.621752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:51:21.621905 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: BEGIN
[0m09:51:21.622046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.624863 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.625046 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:51:21.625203 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */

  
  create view "moovai_data"."main"."mart_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:51:21.625516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.627003 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:51:21.627184 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter view "moovai_data"."main"."mart_tracks" rename to "mart_tracks__dbt_backup"
[0m09:51:21.627430 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.628815 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:51:21.629007 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter view "moovai_data"."main"."mart_tracks__dbt_tmp" rename to "mart_tracks"
[0m09:51:21.629241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.629917 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m09:51:21.630059 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:51:21.630192 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m09:51:21.630563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.631574 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:51:21.631724 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
drop view if exists "moovai_data"."main"."mart_tracks__dbt_backup" cascade
[0m09:51:21.631968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.632541 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: Close
[0m09:51:21.634994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092576b0>]}
[0m09:51:21.635411 [info ] [Thread-1 (]: 2 of 9 OK created sql view model main.mart_tracks .............................. [[32mOK[0m in 0.02s]
[0m09:51:21.635725 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m09:51:21.635945 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m09:51:21.636205 [info ] [Thread-1 (]: 3 of 9 START sql view model main.mart_users .................................... [RUN]
[0m09:51:21.636415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_tracks, now model.dbt_project.mart_users)
[0m09:51:21.636572 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_users
[0m09:51:21.637431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_users"
[0m09:51:21.637731 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_users
[0m09:51:21.639161 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_users"
[0m09:51:21.639422 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:51:21.639567 [debug] [Thread-1 (]: On model.dbt_project.mart_users: BEGIN
[0m09:51:21.639700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.642502 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.642680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:51:21.642835 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */

  
  create view "moovai_data"."main"."mart_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:51:21.643149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.644610 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:51:21.644766 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter view "moovai_data"."main"."mart_users" rename to "mart_users__dbt_backup"
[0m09:51:21.644992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.646231 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:51:21.646377 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter view "moovai_data"."main"."mart_users__dbt_tmp" rename to "mart_users"
[0m09:51:21.646576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.647214 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m09:51:21.647354 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:51:21.647484 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m09:51:21.647824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.648816 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:51:21.648965 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
drop view if exists "moovai_data"."main"."mart_users__dbt_backup" cascade
[0m09:51:21.649211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.649804 [debug] [Thread-1 (]: On model.dbt_project.mart_users: Close
[0m09:51:21.652216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c42de0>]}
[0m09:51:21.652529 [info ] [Thread-1 (]: 3 of 9 OK created sql view model main.mart_users ............................... [[32mOK[0m in 0.02s]
[0m09:51:21.652869 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m09:51:21.653108 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m09:51:21.653373 [info ] [Thread-1 (]: 4 of 9 START sql view model main.src_listen .................................... [RUN]
[0m09:51:21.653614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_users, now model.dbt_project.src_listen)
[0m09:51:21.653816 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m09:51:21.655694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m09:51:21.656056 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m09:51:21.657499 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m09:51:21.657777 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:51:21.657930 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m09:51:21.658070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.660985 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.661179 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:51:21.661343 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:51:21.661642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.663118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:51:21.663295 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m09:51:21.663521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.664779 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:51:21.664943 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m09:51:21.665154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.665815 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:51:21.665960 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:51:21.666093 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:51:21.666452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.667456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:51:21.667607 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m09:51:21.667866 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.668476 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m09:51:21.671003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e46ae0>]}
[0m09:51:21.671278 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.02s]
[0m09:51:21.671524 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m09:51:21.671705 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m09:51:21.671954 [info ] [Thread-1 (]: 5 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m09:51:21.672144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m09:51:21.672302 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m09:51:21.673117 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m09:51:21.673523 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m09:51:21.675074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m09:51:21.675337 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:51:21.675482 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m09:51:21.675619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.678697 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.678996 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:51:21.679159 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:51:21.679557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.681084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:51:21.681289 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m09:51:21.681524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.682727 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:51:21.682932 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m09:51:21.683149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.683820 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:51:21.683971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:51:21.684103 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:51:21.684501 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.685683 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:51:21.685880 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m09:51:21.686183 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.686797 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m09:51:21.689264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941f050>]}
[0m09:51:21.689543 [info ] [Thread-1 (]: 5 of 9 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:51:21.689789 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m09:51:21.689972 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m09:51:21.690238 [info ] [Thread-1 (]: 6 of 9 START sql view model main.src_users ..................................... [RUN]
[0m09:51:21.690443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m09:51:21.690598 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m09:51:21.691350 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m09:51:21.691646 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m09:51:21.693163 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m09:51:21.693419 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:51:21.693563 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m09:51:21.693696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.696557 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.696728 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:51:21.696877 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:51:21.697157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.699386 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:51:21.699554 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m09:51:21.699802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.701019 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:51:21.701175 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m09:51:21.701385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.702180 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:51:21.702382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:51:21.702524 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:51:21.702957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.703972 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:51:21.704143 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m09:51:21.704496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.705163 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m09:51:21.707618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109404dd0>]}
[0m09:51:21.707910 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m09:51:21.708165 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m09:51:21.708354 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m09:51:21.708621 [info ] [Thread-1 (]: 7 of 9 START sql view model main.int_listen .................................... [RUN]
[0m09:51:21.708806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_listen)
[0m09:51:21.708954 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m09:51:21.710288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m09:51:21.710630 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m09:51:21.712105 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m09:51:21.712378 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:51:21.712530 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m09:51:21.712669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.715464 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.715657 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:51:21.715814 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    with int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

select *
from src_listen
  );

[0m09:51:21.716099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.717475 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:51:21.717642 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen" rename to "int_listen__dbt_backup"
[0m09:51:21.717891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.719254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:51:21.719425 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen__dbt_tmp" rename to "int_listen"
[0m09:51:21.719660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.720417 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:51:21.720560 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:51:21.720692 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:51:21.721077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.722071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:51:21.722226 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
drop view if exists "moovai_data"."main"."int_listen__dbt_backup" cascade
[0m09:51:21.722499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.723134 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m09:51:21.725486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e2270>]}
[0m09:51:21.725769 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.int_listen ............................... [[32mOK[0m in 0.02s]
[0m09:51:21.726015 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m09:51:21.726193 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m09:51:21.726401 [info ] [Thread-1 (]: 8 of 9 START sql view model main.int_tracks .................................... [RUN]
[0m09:51:21.726587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_listen, now model.dbt_project.int_tracks)
[0m09:51:21.726743 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_tracks
[0m09:51:21.728217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_tracks"
[0m09:51:21.728636 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_tracks
[0m09:51:21.730461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_tracks"
[0m09:51:21.730799 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:51:21.730951 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: BEGIN
[0m09:51:21.731089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.733920 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.734111 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:51:21.734265 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */

  
  create view "moovai_data"."main"."int_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

select *
from src_tracks
  );

[0m09:51:21.734584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.736256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:51:21.736505 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
alter view "moovai_data"."main"."int_tracks" rename to "int_tracks__dbt_backup"
[0m09:51:21.736737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.737983 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:51:21.738132 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
alter view "moovai_data"."main"."int_tracks__dbt_tmp" rename to "int_tracks"
[0m09:51:21.738331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.739086 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m09:51:21.739228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:51:21.739361 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m09:51:21.739726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.740693 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:51:21.740853 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
drop view if exists "moovai_data"."main"."int_tracks__dbt_backup" cascade
[0m09:51:21.741105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.742275 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: Close
[0m09:51:21.744773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094271a0>]}
[0m09:51:21.745075 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.int_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:51:21.745337 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m09:51:21.745523 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m09:51:21.745731 [info ] [Thread-1 (]: 9 of 9 START sql view model main.int_users ..................................... [RUN]
[0m09:51:21.745911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_tracks, now model.dbt_project.int_users)
[0m09:51:21.746059 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_users
[0m09:51:21.747247 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_users"
[0m09:51:21.747563 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_users
[0m09:51:21.749089 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_users"
[0m09:51:21.749350 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:51:21.749500 [debug] [Thread-1 (]: On model.dbt_project.int_users: BEGIN
[0m09:51:21.749637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:21.752483 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:51:21.752695 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:51:21.752859 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */

  
  create view "moovai_data"."main"."int_users__dbt_tmp" as (
    with src_users as (

    select * from "moovai_data"."main"."src_users"

)

select *
from src_users
  );

[0m09:51:21.753243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.754948 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:51:21.755221 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
alter view "moovai_data"."main"."int_users" rename to "int_users__dbt_backup"
[0m09:51:21.755487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.756726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:51:21.756910 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
alter view "moovai_data"."main"."int_users__dbt_tmp" rename to "int_users"
[0m09:51:21.757119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.757890 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m09:51:21.758034 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:51:21.758169 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m09:51:21.758562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.759550 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:51:21.759699 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
drop view if exists "moovai_data"."main"."int_users__dbt_backup" cascade
[0m09:51:21.759957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:51:21.760598 [debug] [Thread-1 (]: On model.dbt_project.int_users: Close
[0m09:51:21.763081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07611851-75f9-41b7-b8ea-cb4fe6e4664e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a00b0>]}
[0m09:51:21.763384 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.int_users ................................ [[32mOK[0m in 0.02s]
[0m09:51:21.763650 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m09:51:21.764188 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:21.764333 [debug] [MainThread]: On master: BEGIN
[0m09:51:21.764454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:21.767246 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:51:21.767419 [debug] [MainThread]: On master: COMMIT
[0m09:51:21.767549 [debug] [MainThread]: Using duckdb connection "master"
[0m09:51:21.767663 [debug] [MainThread]: On master: COMMIT
[0m09:51:21.767818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:51:21.767940 [debug] [MainThread]: On master: Close
[0m09:51:21.768459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:21.768630 [debug] [MainThread]: Connection 'model.dbt_project.int_users' was properly closed.
[0m09:51:21.768874 [info ] [MainThread]: 
[0m09:51:21.769058 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m09:51:21.769811 [debug] [MainThread]: Command end result
[0m09:51:21.783511 [info ] [MainThread]: 
[0m09:51:21.783755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:51:21.783908 [info ] [MainThread]: 
[0m09:51:21.784060 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:51:21.785048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6611141, "process_user_time": 1.138849, "process_kernel_time": 0.125488, "process_mem_max_rss": "137822208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:51:21.785416 [debug] [MainThread]: Command `dbt run` succeeded at 09:51:21.785366 after 0.66 seconds
[0m09:51:21.785664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ee360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847be00>]}
[0m09:51:21.785856 [debug] [MainThread]: Flushing usage events
[0m09:56:25.550755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b6fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffa0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff9d90>]}


============================== 09:56:25.554256 | 2fe9b6c5-9b46-4a38-a449-a300b0307480 ==============================
[0m09:56:25.554256 [info ] [MainThread]: Running with dbt=1.8.6
[0m09:56:25.554578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:56:25.717343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041579b0>]}
[0m09:56:25.740439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10365cfe0>]}
[0m09:56:25.742311 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m09:56:25.752719 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m09:56:25.815203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:56:25.815538 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_tracks.sql
[0m09:56:25.815721 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_users.sql
[0m09:56:25.815887 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_listen.sql
[0m09:56:25.918482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e5280>]}
[0m09:56:25.960422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450e6c0>]}
[0m09:56:25.960691 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m09:56:25.960863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043efc20>]}
[0m09:56:25.961883 [info ] [MainThread]: 
[0m09:56:25.962164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:56:25.964516 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m09:56:25.993679 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m09:56:25.993905 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m09:56:25.994048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:26.003595 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m09:56:26.004436 [debug] [ThreadPool]: On list_moovai_data: Close
[0m09:56:26.005895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m09:56:26.006181 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m09:56:26.009448 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:56:26.009625 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m09:56:26.009763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:26.012924 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:56:26.013613 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:56:26.013755 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m09:56:26.013918 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:56:26.014043 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:56:26.014172 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m09:56:26.014594 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:56:26.015002 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:56:26.015131 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m09:56:26.015242 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m09:56:26.015390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:56:26.015516 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m09:56:26.016535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m09:56:26.019127 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:56:26.019276 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m09:56:26.019391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:26.022076 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:56:26.022241 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m09:56:26.022391 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m09:56:26.034330 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m09:56:26.035159 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m09:56:26.036184 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m09:56:26.036358 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m09:56:26.037960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104156b40>]}
[0m09:56:26.038195 [debug] [MainThread]: Using duckdb connection "master"
[0m09:56:26.038332 [debug] [MainThread]: On master: BEGIN
[0m09:56:26.038452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:26.041188 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:56:26.041352 [debug] [MainThread]: On master: COMMIT
[0m09:56:26.041485 [debug] [MainThread]: Using duckdb connection "master"
[0m09:56:26.041609 [debug] [MainThread]: On master: COMMIT
[0m09:56:26.041806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:56:26.041934 [debug] [MainThread]: On master: Close
[0m09:56:26.042444 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m09:56:26.042625 [info ] [MainThread]: 
[0m09:56:26.043952 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m09:56:26.044210 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m09:56:26.044415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m09:56:26.044571 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m09:56:26.047516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m09:56:26.048057 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m09:56:26.062720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m09:56:26.063154 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:56:26.063315 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m09:56:26.063458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.066493 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.066686 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:56:26.066836 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m09:56:26.067331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.070767 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:56:26.070957 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m09:56:26.071263 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.072569 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:56:26.072723 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m09:56:26.072933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.081365 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:56:26.081560 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:56:26.081706 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m09:56:26.082820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:56:26.085088 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m09:56:26.085267 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m09:56:26.085553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.086622 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m09:56:26.090028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028caea0>]}
[0m09:56:26.090338 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m09:56:26.090641 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m09:56:26.090840 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m09:56:26.091121 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m09:56:26.091312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m09:56:26.091468 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m09:56:26.092374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m09:56:26.092825 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m09:56:26.094269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m09:56:26.094568 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:56:26.094719 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m09:56:26.094858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.097664 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.097852 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:56:26.098008 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m09:56:26.098306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.099702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:56:26.099865 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m09:56:26.100090 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.101367 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:56:26.101518 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m09:56:26.101744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.102416 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:56:26.102559 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:56:26.102695 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m09:56:26.103050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.104042 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m09:56:26.104185 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m09:56:26.104471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.105141 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m09:56:26.107522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481c200>]}
[0m09:56:26.107836 [info ] [Thread-1 (]: 2 of 9 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:56:26.108108 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m09:56:26.108383 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m09:56:26.108721 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m09:56:26.108971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m09:56:26.109143 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m09:56:26.110182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m09:56:26.110535 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m09:56:26.111987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m09:56:26.112254 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:56:26.112407 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m09:56:26.112543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.115431 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.115616 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:56:26.115773 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m09:56:26.116058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.117454 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:56:26.117625 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m09:56:26.117884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.119301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:56:26.119459 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m09:56:26.119678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.120356 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:56:26.120499 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:56:26.120629 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m09:56:26.121036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.122036 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m09:56:26.122184 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m09:56:26.122432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.123005 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m09:56:26.125404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dcf80>]}
[0m09:56:26.125675 [info ] [Thread-1 (]: 3 of 9 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m09:56:26.125920 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m09:56:26.126098 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m09:56:26.126343 [info ] [Thread-1 (]: 4 of 9 START sql view model main.int_listen .................................... [RUN]
[0m09:56:26.126541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_listen)
[0m09:56:26.126690 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m09:56:26.129082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m09:56:26.129668 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m09:56:26.131271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m09:56:26.131563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:56:26.131714 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m09:56:26.131859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.134940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.135182 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:56:26.135342 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    with int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

select *
from src_listen
  );

[0m09:56:26.135655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.137095 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:56:26.137258 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen" rename to "int_listen__dbt_backup"
[0m09:56:26.137482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.138822 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:56:26.138970 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen__dbt_tmp" rename to "int_listen"
[0m09:56:26.139177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.139875 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:56:26.140018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:56:26.140150 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m09:56:26.140552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.141595 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m09:56:26.141765 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
drop view if exists "moovai_data"."main"."int_listen__dbt_backup" cascade
[0m09:56:26.142035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.142612 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m09:56:26.145079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405e870>]}
[0m09:56:26.145368 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main.int_listen ............................... [[32mOK[0m in 0.02s]
[0m09:56:26.145622 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m09:56:26.145804 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m09:56:26.146046 [info ] [Thread-1 (]: 5 of 9 START sql view model main.int_tracks .................................... [RUN]
[0m09:56:26.146224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_listen, now model.dbt_project.int_tracks)
[0m09:56:26.146408 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_tracks
[0m09:56:26.147684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_tracks"
[0m09:56:26.148006 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_tracks
[0m09:56:26.149581 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_tracks"
[0m09:56:26.149930 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:56:26.150100 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: BEGIN
[0m09:56:26.150247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.153348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.153550 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:56:26.153707 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */

  
  create view "moovai_data"."main"."int_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

select *
from src_tracks
  );

[0m09:56:26.154039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.155502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:56:26.155662 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
alter view "moovai_data"."main"."int_tracks" rename to "int_tracks__dbt_backup"
[0m09:56:26.155892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.157137 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:56:26.157295 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
alter view "moovai_data"."main"."int_tracks__dbt_tmp" rename to "int_tracks"
[0m09:56:26.157503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.158183 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m09:56:26.158341 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:56:26.158474 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m09:56:26.158882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.159971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m09:56:26.160145 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
drop view if exists "moovai_data"."main"."int_tracks__dbt_backup" cascade
[0m09:56:26.160461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.161108 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: Close
[0m09:56:26.163505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fb710>]}
[0m09:56:26.163787 [info ] [Thread-1 (]: 5 of 9 OK created sql view model main.int_tracks ............................... [[32mOK[0m in 0.02s]
[0m09:56:26.164039 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m09:56:26.164222 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m09:56:26.164472 [info ] [Thread-1 (]: 6 of 9 START sql view model main.int_users ..................................... [RUN]
[0m09:56:26.164649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_tracks, now model.dbt_project.int_users)
[0m09:56:26.164819 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_users
[0m09:56:26.166058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_users"
[0m09:56:26.166366 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_users
[0m09:56:26.167802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_users"
[0m09:56:26.168111 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:56:26.168268 [debug] [Thread-1 (]: On model.dbt_project.int_users: BEGIN
[0m09:56:26.168414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.171562 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.171770 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:56:26.171938 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */

  
  create view "moovai_data"."main"."int_users__dbt_tmp" as (
    with src_users as (

    select * from "moovai_data"."main"."src_users"

)

select *
from src_users
  );

[0m09:56:26.172245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.174713 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:56:26.174883 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
alter view "moovai_data"."main"."int_users" rename to "int_users__dbt_backup"
[0m09:56:26.175115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.176372 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:56:26.176524 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
alter view "moovai_data"."main"."int_users__dbt_tmp" rename to "int_users"
[0m09:56:26.176729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.177399 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m09:56:26.177551 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:56:26.177685 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m09:56:26.178096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.179136 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m09:56:26.179293 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
drop view if exists "moovai_data"."main"."int_users__dbt_backup" cascade
[0m09:56:26.179562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.180145 [debug] [Thread-1 (]: On model.dbt_project.int_users: Close
[0m09:56:26.182490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10496f170>]}
[0m09:56:26.182770 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main.int_users ................................ [[32mOK[0m in 0.02s]
[0m09:56:26.183023 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m09:56:26.183203 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m09:56:26.183458 [info ] [Thread-1 (]: 7 of 9 START sql view model main.mart_listen ................................... [RUN]
[0m09:56:26.183636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_users, now model.dbt_project.mart_listen)
[0m09:56:26.183786 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen
[0m09:56:26.185331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen"
[0m09:56:26.185868 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen
[0m09:56:26.187338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen"
[0m09:56:26.187623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:56:26.187773 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: BEGIN
[0m09:56:26.187913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.191015 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.191250 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:56:26.191403 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */

  
  create view "moovai_data"."main"."mart_listen__dbt_tmp" as (
    with src_listen as (

    select * from  "moovai_data"."main"."int_listen"

)

select *
from src_listen
  );

[0m09:56:26.191701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.193228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:56:26.193398 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter view "moovai_data"."main"."mart_listen" rename to "mart_listen__dbt_backup"
[0m09:56:26.193630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.194917 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:56:26.195071 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter view "moovai_data"."main"."mart_listen__dbt_tmp" rename to "mart_listen"
[0m09:56:26.195284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.195969 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m09:56:26.196118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:56:26.196250 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m09:56:26.196638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.197619 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m09:56:26.197767 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
drop view if exists "moovai_data"."main"."mart_listen__dbt_backup" cascade
[0m09:56:26.198008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.198569 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: Close
[0m09:56:26.200933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104490e30>]}
[0m09:56:26.201315 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main.mart_listen .............................. [[32mOK[0m in 0.02s]
[0m09:56:26.201617 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m09:56:26.201843 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m09:56:26.202088 [info ] [Thread-1 (]: 8 of 9 START sql view model main.mart_tracks ................................... [RUN]
[0m09:56:26.202297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen, now model.dbt_project.mart_tracks)
[0m09:56:26.202456 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_tracks
[0m09:56:26.203758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_tracks"
[0m09:56:26.204101 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_tracks
[0m09:56:26.205530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_tracks"
[0m09:56:26.205796 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:56:26.205947 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: BEGIN
[0m09:56:26.206085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.208979 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.209190 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:56:26.209349 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */

  
  create view "moovai_data"."main"."mart_tracks__dbt_tmp" as (
    with src_tracks as (

    select * from "moovai_data"."main"."int_tracks"

)

select *
from src_tracks
  );

[0m09:56:26.209766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.211422 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:56:26.211592 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter view "moovai_data"."main"."mart_tracks" rename to "mart_tracks__dbt_backup"
[0m09:56:26.211830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.213093 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:56:26.213248 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter view "moovai_data"."main"."mart_tracks__dbt_tmp" rename to "mart_tracks"
[0m09:56:26.213453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.214114 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m09:56:26.214259 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:56:26.214392 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m09:56:26.214786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.216788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m09:56:26.216955 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
drop view if exists "moovai_data"."main"."mart_tracks__dbt_backup" cascade
[0m09:56:26.217232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.217860 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: Close
[0m09:56:26.220424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a30d40>]}
[0m09:56:26.220727 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main.mart_tracks .............................. [[32mOK[0m in 0.02s]
[0m09:56:26.220987 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m09:56:26.221171 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m09:56:26.221403 [info ] [Thread-1 (]: 9 of 9 START sql view model main.mart_users .................................... [RUN]
[0m09:56:26.221600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_tracks, now model.dbt_project.mart_users)
[0m09:56:26.221753 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_users
[0m09:56:26.223071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_users"
[0m09:56:26.223396 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_users
[0m09:56:26.224856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_users"
[0m09:56:26.225125 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:56:26.225276 [debug] [Thread-1 (]: On model.dbt_project.mart_users: BEGIN
[0m09:56:26.225420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:26.228431 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:56:26.228653 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:56:26.228843 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */

  
  create view "moovai_data"."main"."mart_users__dbt_tmp" as (
    with src_users as (

    select * from "moovai_data"."main"."int_users"

)

select *
from src_users
  );

[0m09:56:26.229228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.230901 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:56:26.231090 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter view "moovai_data"."main"."mart_users" rename to "mart_users__dbt_backup"
[0m09:56:26.231387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.232761 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:56:26.232925 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter view "moovai_data"."main"."mart_users__dbt_tmp" rename to "mart_users"
[0m09:56:26.233145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.233836 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m09:56:26.233988 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:56:26.234127 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m09:56:26.234565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.235760 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m09:56:26.235916 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
drop view if exists "moovai_data"."main"."mart_users__dbt_backup" cascade
[0m09:56:26.236184 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:56:26.236796 [debug] [Thread-1 (]: On model.dbt_project.mart_users: Close
[0m09:56:26.239260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe9b6c5-9b46-4a38-a449-a300b0307480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ed190>]}
[0m09:56:26.239545 [info ] [Thread-1 (]: 9 of 9 OK created sql view model main.mart_users ............................... [[32mOK[0m in 0.02s]
[0m09:56:26.239805 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m09:56:26.240355 [debug] [MainThread]: Using duckdb connection "master"
[0m09:56:26.240511 [debug] [MainThread]: On master: BEGIN
[0m09:56:26.240634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:26.243453 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m09:56:26.243634 [debug] [MainThread]: On master: COMMIT
[0m09:56:26.243767 [debug] [MainThread]: Using duckdb connection "master"
[0m09:56:26.243883 [debug] [MainThread]: On master: COMMIT
[0m09:56:26.244035 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:56:26.244159 [debug] [MainThread]: On master: Close
[0m09:56:26.244660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:26.244784 [debug] [MainThread]: Connection 'model.dbt_project.mart_users' was properly closed.
[0m09:56:26.244980 [info ] [MainThread]: 
[0m09:56:26.245123 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m09:56:26.245812 [debug] [MainThread]: Command end result
[0m09:56:26.261704 [info ] [MainThread]: 
[0m09:56:26.261953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:26.262101 [info ] [MainThread]: 
[0m09:56:26.262248 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:56:26.263573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7443855, "process_user_time": 1.141629, "process_kernel_time": 0.156224, "process_mem_max_rss": "136790016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:56:26.263830 [debug] [MainThread]: Command `dbt run` succeeded at 09:56:26.263790 after 0.74 seconds
[0m09:56:26.264009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10398c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a43da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff9eb0>]}
[0m09:56:26.264170 [debug] [MainThread]: Flushing usage events
[0m10:36:06.474311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c1fd0>]}


============================== 10:36:06.477889 | c55dd2bc-7934-4b45-acc8-18100a568a77 ==============================
[0m10:36:06.477889 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:36:06.478216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:36:06.640779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c3e60>]}
[0m10:36:06.664144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105892600>]}
[0m10:36:06.665986 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m10:36:06.675520 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m10:36:06.738960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
[0m10:36:06.739317 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_tracks.sql
[0m10:36:06.739508 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m10:36:06.739677 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m10:36:06.739836 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_users.sql
[0m10:36:06.740201 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_tracks.sql
[0m10:36:06.740361 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_users.sql
[0m10:36:06.740516 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_listen.sql
[0m10:36:06.740668 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m10:36:06.740818 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m10:36:06.848483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbd340>]}
[0m10:36:06.897902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e67740>]}
[0m10:36:06.898178 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m10:36:06.898352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebf560>]}
[0m10:36:06.899387 [info ] [MainThread]: 
[0m10:36:06.899663 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:36:06.902064 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m10:36:06.931527 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m10:36:06.931756 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m10:36:06.931907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:06.941827 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m10:36:06.942876 [debug] [ThreadPool]: On list_moovai_data: Close
[0m10:36:06.944191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m10:36:06.944423 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m10:36:06.947702 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:36:06.947876 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m10:36:06.948010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:06.951025 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:36:06.951721 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:36:06.951867 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m10:36:06.952031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:36:06.952157 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:36:06.952280 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m10:36:06.952704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:36:06.953104 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:36:06.953230 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:36:06.953368 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:36:06.953512 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:36:06.953636 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m10:36:06.954688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m10:36:06.957252 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:36:06.957396 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m10:36:06.957512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:06.960125 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:36:06.960292 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:36:06.960438 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m10:36:06.972748 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:36:06.973544 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m10:36:06.974496 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m10:36:06.974664 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m10:36:06.976193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105440bc0>]}
[0m10:36:06.976433 [debug] [MainThread]: Using duckdb connection "master"
[0m10:36:06.976566 [debug] [MainThread]: On master: BEGIN
[0m10:36:06.976682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:06.979399 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:36:06.979590 [debug] [MainThread]: On master: COMMIT
[0m10:36:06.979736 [debug] [MainThread]: Using duckdb connection "master"
[0m10:36:06.979861 [debug] [MainThread]: On master: COMMIT
[0m10:36:06.980025 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:36:06.980159 [debug] [MainThread]: On master: Close
[0m10:36:06.980660 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m10:36:06.980830 [info ] [MainThread]: 
[0m10:36:06.982139 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m10:36:06.982405 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m10:36:06.982607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m10:36:06.982762 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m10:36:06.986103 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m10:36:06.986806 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m10:36:07.001640 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m10:36:07.002085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:36:07.002245 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m10:36:07.002386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.005346 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.005540 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:36:07.005701 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    


with src_listen as (

    select * from moovai_data.listen_history

)

select *
from src_listen
  );

[0m10:36:07.006208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.009222 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:36:07.009419 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m10:36:07.009755 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.011819 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:36:07.012015 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m10:36:07.012332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.020272 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m10:36:07.020454 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:36:07.020601 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m10:36:07.021483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:07.023853 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:36:07.024029 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m10:36:07.024319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.025369 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m10:36:07.029556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a2870>]}
[0m10:36:07.029868 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m10:36:07.030152 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m10:36:07.030348 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m10:36:07.030617 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m10:36:07.030838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m10:36:07.031011 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m10:36:07.032212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m10:36:07.032711 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m10:36:07.034198 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m10:36:07.034516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:36:07.034678 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m10:36:07.034823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.037884 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.038101 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:36:07.038266 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with src_tracks as (

    select * from moovai_data.tracks

)

select *
from src_tracks
  );

[0m10:36:07.038594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.040100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:36:07.040266 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m10:36:07.040495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.041740 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:36:07.041901 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m10:36:07.042110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.042861 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m10:36:07.043009 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:36:07.043141 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m10:36:07.043561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.044625 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:36:07.044786 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m10:36:07.045060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.045632 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m10:36:07.048131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e67620>]}
[0m10:36:07.048428 [info ] [Thread-1 (]: 2 of 9 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m10:36:07.048688 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m10:36:07.048869 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m10:36:07.049124 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m10:36:07.049308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m10:36:07.049458 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m10:36:07.050691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m10:36:07.051005 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m10:36:07.052448 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m10:36:07.052729 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:36:07.052878 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m10:36:07.053016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.056097 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.056485 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:36:07.056662 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with src_users as (

    select * from moovai_data.users

)

select *
from src_users
  );

[0m10:36:07.056995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.058592 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:36:07.058759 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m10:36:07.058989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.060285 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:36:07.060445 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m10:36:07.060657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.061333 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m10:36:07.061479 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:36:07.061609 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m10:36:07.062025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.064044 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:36:07.064221 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m10:36:07.064533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.065161 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m10:36:07.067601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d0290>]}
[0m10:36:07.067884 [info ] [Thread-1 (]: 3 of 9 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m10:36:07.068131 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m10:36:07.068308 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m10:36:07.068574 [info ] [Thread-1 (]: 4 of 9 START sql view model main.int_listen .................................... [RUN]
[0m10:36:07.068773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_listen)
[0m10:36:07.068926 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m10:36:07.070285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m10:36:07.070762 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m10:36:07.072240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m10:36:07.072530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:36:07.072683 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m10:36:07.072822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.075798 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.076028 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:36:07.076188 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    

with int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

select *
from src_listen
  );

[0m10:36:07.076540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.078116 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:36:07.078307 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen" rename to "int_listen__dbt_backup"
[0m10:36:07.078534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.079874 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:36:07.080036 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen__dbt_tmp" rename to "int_listen"
[0m10:36:07.080288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.081030 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m10:36:07.081194 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:36:07.081337 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m10:36:07.081735 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.082764 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:36:07.082918 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
drop view if exists "moovai_data"."main"."int_listen__dbt_backup" cascade
[0m10:36:07.083178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.083751 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m10:36:07.086281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c0980>]}
[0m10:36:07.086584 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main.int_listen ............................... [[32mOK[0m in 0.02s]
[0m10:36:07.086845 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m10:36:07.087028 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m10:36:07.087276 [info ] [Thread-1 (]: 5 of 9 START sql view model main.int_tracks .................................... [RUN]
[0m10:36:07.087454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_listen, now model.dbt_project.int_tracks)
[0m10:36:07.087605 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_tracks
[0m10:36:07.089098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_tracks"
[0m10:36:07.089434 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_tracks
[0m10:36:07.090889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_tracks"
[0m10:36:07.091175 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m10:36:07.091327 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: BEGIN
[0m10:36:07.091465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.094288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.094501 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m10:36:07.094671 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */

  
  create view "moovai_data"."main"."int_tracks__dbt_tmp" as (
    

with src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

select *
from src_tracks
  );

[0m10:36:07.095093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.096885 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m10:36:07.097156 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
alter view "moovai_data"."main"."int_tracks" rename to "int_tracks__dbt_backup"
[0m10:36:07.097585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.098948 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m10:36:07.099107 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
alter view "moovai_data"."main"."int_tracks__dbt_tmp" rename to "int_tracks"
[0m10:36:07.099335 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.100031 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m10:36:07.100186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m10:36:07.100320 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: COMMIT
[0m10:36:07.100737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.101788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m10:36:07.101949 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */
drop view if exists "moovai_data"."main"."int_tracks__dbt_backup" cascade
[0m10:36:07.102223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.102820 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: Close
[0m10:36:07.105390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073db230>]}
[0m10:36:07.105716 [info ] [Thread-1 (]: 5 of 9 OK created sql view model main.int_tracks ............................... [[32mOK[0m in 0.02s]
[0m10:36:07.105981 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m10:36:07.106166 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m10:36:07.106444 [info ] [Thread-1 (]: 6 of 9 START sql view model main.int_users ..................................... [RUN]
[0m10:36:07.106647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_tracks, now model.dbt_project.int_users)
[0m10:36:07.106801 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_users
[0m10:36:07.108196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_users"
[0m10:36:07.108543 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_users
[0m10:36:07.110907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_users"
[0m10:36:07.111196 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m10:36:07.111341 [debug] [Thread-1 (]: On model.dbt_project.int_users: BEGIN
[0m10:36:07.111478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.114577 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.114793 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m10:36:07.114962 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */

  
  create view "moovai_data"."main"."int_users__dbt_tmp" as (
    

with src_users as (

    select * from "moovai_data"."main"."src_users"

)

select *
from src_users
  );

[0m10:36:07.115289 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.116925 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m10:36:07.117139 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
alter view "moovai_data"."main"."int_users" rename to "int_users__dbt_backup"
[0m10:36:07.117477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.118803 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m10:36:07.118953 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
alter view "moovai_data"."main"."int_users__dbt_tmp" rename to "int_users"
[0m10:36:07.119174 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.119842 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m10:36:07.119987 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m10:36:07.120125 [debug] [Thread-1 (]: On model.dbt_project.int_users: COMMIT
[0m10:36:07.120508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.121565 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m10:36:07.121730 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */
drop view if exists "moovai_data"."main"."int_users__dbt_backup" cascade
[0m10:36:07.122011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.122618 [debug] [Thread-1 (]: On model.dbt_project.int_users: Close
[0m10:36:07.125037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107257ce0>]}
[0m10:36:07.125307 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main.int_users ................................ [[32mOK[0m in 0.02s]
[0m10:36:07.125552 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m10:36:07.125731 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m10:36:07.125979 [info ] [Thread-1 (]: 7 of 9 START sql table model main.mart_listen .................................. [RUN]
[0m10:36:07.126153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_users, now model.dbt_project.mart_listen)
[0m10:36:07.126301 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen
[0m10:36:07.127657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen"
[0m10:36:07.127957 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen
[0m10:36:07.137435 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen"
[0m10:36:07.138011 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m10:36:07.138191 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: BEGIN
[0m10:36:07.138331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.141291 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.141497 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m10:36:07.141661 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen__dbt_tmp"
  
    as (
      

with src_listen as (

    select * from  "moovai_data"."main"."int_listen"

)

select *
from src_listen
    );
  
  
[0m10:36:07.143360 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:36:07.144885 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m10:36:07.145052 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter view "moovai_data"."main"."mart_listen" rename to "mart_listen__dbt_backup"
[0m10:36:07.145302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.146847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m10:36:07.147057 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter table "moovai_data"."main"."mart_listen__dbt_tmp" rename to "mart_listen"
[0m10:36:07.147334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.149960 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m10:36:07.150157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m10:36:07.150314 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m10:36:07.150784 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.151981 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m10:36:07.152158 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
drop view if exists "moovai_data"."main"."mart_listen__dbt_backup" cascade
[0m10:36:07.152492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.153247 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: Close
[0m10:36:07.157492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732f4d0>]}
[0m10:36:07.160030 [info ] [Thread-1 (]: 7 of 9 OK created sql table model main.mart_listen ............................. [[32mOK[0m in 0.03s]
[0m10:36:07.160353 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m10:36:07.160559 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m10:36:07.160840 [info ] [Thread-1 (]: 8 of 9 START sql table model main.mart_tracks .................................. [RUN]
[0m10:36:07.161154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen, now model.dbt_project.mart_tracks)
[0m10:36:07.161344 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_tracks
[0m10:36:07.162960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_tracks"
[0m10:36:07.163377 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_tracks
[0m10:36:07.165003 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_tracks"
[0m10:36:07.165311 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m10:36:07.165468 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: BEGIN
[0m10:36:07.165609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.168556 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.168741 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m10:36:07.168901 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_tracks__dbt_tmp"
  
    as (
      

with src_tracks as (

    select * from "moovai_data"."main"."int_tracks"

)

select *
from src_tracks
    );
  
  
[0m10:36:07.170320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:07.171785 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m10:36:07.171958 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter view "moovai_data"."main"."mart_tracks" rename to "mart_tracks__dbt_backup"
[0m10:36:07.172208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.174407 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m10:36:07.174577 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter table "moovai_data"."main"."mart_tracks__dbt_tmp" rename to "mart_tracks"
[0m10:36:07.174813 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.175551 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m10:36:07.175702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m10:36:07.175840 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m10:36:07.176497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:07.177495 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m10:36:07.177654 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
drop view if exists "moovai_data"."main"."mart_tracks__dbt_backup" cascade
[0m10:36:07.177904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.178508 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: Close
[0m10:36:07.185625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107415970>]}
[0m10:36:07.186022 [info ] [Thread-1 (]: 8 of 9 OK created sql table model main.mart_tracks ............................. [[32mOK[0m in 0.02s]
[0m10:36:07.186299 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m10:36:07.186494 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m10:36:07.186713 [info ] [Thread-1 (]: 9 of 9 START sql table model main.mart_users ................................... [RUN]
[0m10:36:07.186907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_tracks, now model.dbt_project.mart_users)
[0m10:36:07.187068 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_users
[0m10:36:07.188820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_users"
[0m10:36:07.189279 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_users
[0m10:36:07.190838 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_users"
[0m10:36:07.191156 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m10:36:07.191320 [debug] [Thread-1 (]: On model.dbt_project.mart_users: BEGIN
[0m10:36:07.191464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:07.194803 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:36:07.195027 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m10:36:07.195199 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_users__dbt_tmp"
  
    as (
      

with src_users as (

    select * from "moovai_data"."main"."int_users"

)

select *
from src_users
    );
  
  
[0m10:36:07.195980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:36:07.197825 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m10:36:07.198004 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter view "moovai_data"."main"."mart_users" rename to "mart_users__dbt_backup"
[0m10:36:07.198257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.199570 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m10:36:07.199769 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter table "moovai_data"."main"."mart_users__dbt_tmp" rename to "mart_users"
[0m10:36:07.200017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.200820 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m10:36:07.200986 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m10:36:07.201135 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m10:36:07.201642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.202930 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m10:36:07.203134 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
drop view if exists "moovai_data"."main"."mart_users__dbt_backup" cascade
[0m10:36:07.203504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:36:07.204252 [debug] [Thread-1 (]: On model.dbt_project.mart_users: Close
[0m10:36:07.209369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dd2bc-7934-4b45-acc8-18100a568a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072573b0>]}
[0m10:36:07.209704 [info ] [Thread-1 (]: 9 of 9 OK created sql table model main.mart_users .............................. [[32mOK[0m in 0.02s]
[0m10:36:07.209974 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m10:36:07.210588 [debug] [MainThread]: Using duckdb connection "master"
[0m10:36:07.210738 [debug] [MainThread]: On master: BEGIN
[0m10:36:07.210857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:07.214021 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:36:07.214220 [debug] [MainThread]: On master: COMMIT
[0m10:36:07.214349 [debug] [MainThread]: Using duckdb connection "master"
[0m10:36:07.214473 [debug] [MainThread]: On master: COMMIT
[0m10:36:07.214646 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:36:07.214777 [debug] [MainThread]: On master: Close
[0m10:36:07.215415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:07.215552 [debug] [MainThread]: Connection 'model.dbt_project.mart_users' was properly closed.
[0m10:36:07.215746 [info ] [MainThread]: 
[0m10:36:07.215906 [info ] [MainThread]: Finished running 6 view models, 3 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m10:36:07.216658 [debug] [MainThread]: Command end result
[0m10:36:07.233741 [info ] [MainThread]: 
[0m10:36:07.233994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:07.234145 [info ] [MainThread]: 
[0m10:36:07.234295 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m10:36:07.235560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7948436, "process_user_time": 1.168989, "process_kernel_time": 0.176724, "process_mem_max_rss": "147390464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:36:07.235834 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:07.235792 after 0.80 seconds
[0m10:36:07.236019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bfb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c2150>]}
[0m10:36:07.236180 [debug] [MainThread]: Flushing usage events
[0m10:56:09.857333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108557140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108579e50>]}


============================== 10:56:09.860378 | 335a6b8a-b131-4578-98f9-c819a94bc193 ==============================
[0m10:56:09.860378 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:56:09.860700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:56:10.048524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086000e0>]}
[0m10:56:10.071643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108619850>]}
[0m10:56:10.073509 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m10:56:10.083612 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m10:56:10.146809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m10:56:10.147140 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m10:56:10.147322 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_users.sql
[0m10:56:10.147490 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m10:56:10.147648 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m10:56:10.147805 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m10:56:10.147957 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_tracks.sql
[0m10:56:10.255794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a66c0>]}
[0m10:56:10.304107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a13cb0>]}
[0m10:56:10.304394 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m10:56:10.304572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108978110>]}
[0m10:56:10.305600 [info ] [MainThread]: 
[0m10:56:10.305894 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:56:10.308227 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m10:56:10.337462 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m10:56:10.337698 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m10:56:10.337996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:10.355395 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:56:10.356747 [debug] [ThreadPool]: On list_moovai_data: Close
[0m10:56:10.358353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m10:56:10.358609 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m10:56:10.361843 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:10.362017 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m10:56:10.362154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:10.366132 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:56:10.367017 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:10.367176 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m10:56:10.367351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:56:10.367477 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:10.367605 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m10:56:10.368194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:56:10.368592 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:56:10.368723 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:10.368839 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:56:10.368994 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:56:10.369121 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m10:56:10.370236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m10:56:10.372852 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:56:10.373006 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m10:56:10.373135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:10.376542 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:56:10.376755 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:56:10.376914 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m10:56:10.396403 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m10:56:10.397298 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m10:56:10.398415 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m10:56:10.398590 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m10:56:10.400221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bf4a0>]}
[0m10:56:10.400522 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:10.400667 [debug] [MainThread]: On master: BEGIN
[0m10:56:10.400790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:10.403658 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:56:10.403829 [debug] [MainThread]: On master: COMMIT
[0m10:56:10.403962 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:10.404084 [debug] [MainThread]: On master: COMMIT
[0m10:56:10.404242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:56:10.404372 [debug] [MainThread]: On master: Close
[0m10:56:10.404907 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m10:56:10.405083 [info ] [MainThread]: 
[0m10:56:10.406438 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m10:56:10.406703 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m10:56:10.406906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m10:56:10.407066 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m10:56:10.410501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m10:56:10.411322 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m10:56:10.426170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m10:56:10.426651 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:56:10.426816 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m10:56:10.426957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:10.429946 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:56:10.430138 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:56:10.430318 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    


with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE date = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m10:56:10.435847 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    


with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE date = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m10:56:10.436039 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:56:10.436251 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m10:56:10.441916 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m10:56:10.442089 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m10:56:10.443863 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "listen_history.listen_timestamp"
  LINE 11:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:10.444585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b157c0>]}
[0m10:56:10.444905 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m10:56:10.445194 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m10:56:10.445384 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m10:56:10.446148 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m10:56:10.446380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m10:56:10.446539 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m10:56:10.447762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m10:56:10.448080 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m10:56:10.450363 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m10:56:10.450697 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:56:10.450854 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m10:56:10.450995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:10.453947 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:56:10.454131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:56:10.454289 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:56:10.454727 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:56:10.454879 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:56:10.455057 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m10:56:10.456558 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m10:56:10.456722 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m10:56:10.458322 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:10.458533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee8f80>]}
[0m10:56:10.458800 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.01s]
[0m10:56:10.459054 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m10:56:10.459231 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m10:56:10.459495 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m10:56:10.459681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m10:56:10.459828 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m10:56:10.461083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m10:56:10.461449 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m10:56:10.462906 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m10:56:10.463197 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:56:10.463358 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m10:56:10.463509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:10.466442 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:56:10.466636 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:56:10.466798 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:56:10.467212 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:56:10.467367 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:56:10.467551 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m10:56:10.469015 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m10:56:10.469163 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m10:56:10.470860 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:10.471091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335a6b8a-b131-4578-98f9-c819a94bc193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ffa70>]}
[0m10:56:10.471419 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.01s]
[0m10:56:10.471715 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m10:56:10.471901 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m10:56:10.472208 [info ] [Thread-1 (]: 4 of 9 SKIP relation main.int_listen ........................................... [[33mSKIP[0m]
[0m10:56:10.472406 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m10:56:10.472579 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m10:56:10.472757 [info ] [Thread-1 (]: 5 of 9 SKIP relation main.int_tracks ........................................... [[33mSKIP[0m]
[0m10:56:10.472966 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m10:56:10.473142 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m10:56:10.473318 [info ] [Thread-1 (]: 6 of 9 SKIP relation main.int_users ............................................ [[33mSKIP[0m]
[0m10:56:10.473514 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m10:56:10.473674 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m10:56:10.473856 [info ] [Thread-1 (]: 7 of 9 SKIP relation main.mart_listen .......................................... [[33mSKIP[0m]
[0m10:56:10.474018 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m10:56:10.474166 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m10:56:10.474323 [info ] [Thread-1 (]: 8 of 9 SKIP relation main.mart_tracks .......................................... [[33mSKIP[0m]
[0m10:56:10.474481 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m10:56:10.474629 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m10:56:10.474781 [info ] [Thread-1 (]: 9 of 9 SKIP relation main.mart_users ........................................... [[33mSKIP[0m]
[0m10:56:10.474966 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m10:56:10.475472 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:10.475609 [debug] [MainThread]: On master: BEGIN
[0m10:56:10.475721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:10.478773 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:56:10.478999 [debug] [MainThread]: On master: COMMIT
[0m10:56:10.479132 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:10.479265 [debug] [MainThread]: On master: COMMIT
[0m10:56:10.479430 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:56:10.479567 [debug] [MainThread]: On master: Close
[0m10:56:10.480184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:10.480383 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m10:56:10.480670 [info ] [MainThread]: 
[0m10:56:10.480898 [info ] [MainThread]: Finished running 6 view models, 3 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m10:56:10.481516 [debug] [MainThread]: Command end result
[0m10:56:10.497572 [info ] [MainThread]: 
[0m10:56:10.497927 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:56:10.498219 [info ] [MainThread]: 
[0m10:56:10.498471 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "listen_history.listen_timestamp"
  LINE 11:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:10.498638 [info ] [MainThread]: 
[0m10:56:10.498814 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:10.498959 [info ] [MainThread]: 
[0m10:56:10.499123 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:10.499265 [info ] [MainThread]: 
[0m10:56:10.499451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=6 TOTAL=9
[0m10:56:10.501687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.67874736, "process_user_time": 1.029348, "process_kernel_time": 0.175033, "process_mem_max_rss": "137248768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:56:10.502128 [debug] [MainThread]: Command `dbt run` failed at 10:56:10.502078 after 0.68 seconds
[0m10:56:10.502506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f17b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc7dd0>]}
[0m10:56:10.502750 [debug] [MainThread]: Flushing usage events
[0m10:56:45.280043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106449730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069de0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dddf0>]}


============================== 10:56:45.283358 | 6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896 ==============================
[0m10:56:45.283358 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:56:45.283709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:56:45.457498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bf9b0>]}
[0m10:56:45.480506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053233b0>]}
[0m10:56:45.483040 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m10:56:45.493467 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m10:56:45.553095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:56:45.553435 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m10:56:45.654258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e28b00>]}
[0m10:56:45.696753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eece30>]}
[0m10:56:45.697035 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m10:56:45.697210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e06360>]}
[0m10:56:45.698225 [info ] [MainThread]: 
[0m10:56:45.698524 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:56:45.700807 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m10:56:45.727278 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m10:56:45.727514 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m10:56:45.727662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:45.744992 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:56:45.746345 [debug] [ThreadPool]: On list_moovai_data: Close
[0m10:56:45.747892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m10:56:45.748112 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m10:56:45.751406 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:45.751583 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m10:56:45.751716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:45.755619 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:56:45.756472 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:45.756614 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m10:56:45.756810 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:56:45.756975 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:45.757114 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m10:56:45.757699 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:56:45.758109 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:56:45.758238 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:56:45.758357 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:56:45.758510 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:56:45.758637 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m10:56:45.759729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m10:56:45.762353 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:56:45.762511 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m10:56:45.762632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:45.765356 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:56:45.765550 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:56:45.765706 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m10:56:45.780121 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m10:56:45.780913 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m10:56:45.781940 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m10:56:45.782096 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m10:56:45.783714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105323680>]}
[0m10:56:45.783966 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:45.784101 [debug] [MainThread]: On master: BEGIN
[0m10:56:45.784220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:45.786950 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:56:45.787115 [debug] [MainThread]: On master: COMMIT
[0m10:56:45.787248 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:45.787362 [debug] [MainThread]: On master: COMMIT
[0m10:56:45.787514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:56:45.787641 [debug] [MainThread]: On master: Close
[0m10:56:45.788130 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m10:56:45.788302 [info ] [MainThread]: 
[0m10:56:45.789604 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m10:56:45.789867 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m10:56:45.790076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m10:56:45.790235 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m10:56:45.793642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m10:56:45.793997 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m10:56:45.809194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m10:56:45.809713 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:56:45.809884 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m10:56:45.810030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:45.813074 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:56:45.813262 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:56:45.813421 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --


with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE date = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m10:56:45.818591 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --


with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE date = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m10:56:45.818782 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:56:45.818997 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m10:56:45.824298 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m10:56:45.824469 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m10:56:45.826176 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "listen_history.listen_timestamp"
  LINE 11:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:45.826881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40ce0>]}
[0m10:56:45.827183 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m10:56:45.827466 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m10:56:45.827660 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m10:56:45.828367 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m10:56:45.828612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m10:56:45.828783 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m10:56:45.829969 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m10:56:45.830300 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m10:56:45.832480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m10:56:45.832791 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:56:45.832945 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m10:56:45.833084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:45.836024 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:56:45.836215 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:56:45.836376 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:56:45.836813 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:56:45.836964 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:56:45.837145 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m10:56:45.838599 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m10:56:45.838750 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m10:56:45.840382 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:45.840588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734c350>]}
[0m10:56:45.840885 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.01s]
[0m10:56:45.841227 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m10:56:45.841414 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m10:56:45.841733 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m10:56:45.841948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m10:56:45.842109 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m10:56:45.843688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m10:56:45.844062 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m10:56:45.845543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m10:56:45.845812 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:56:45.845963 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m10:56:45.846096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:45.849120 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:56:45.849353 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:56:45.849505 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:56:45.849971 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:56:45.850136 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:56:45.850360 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m10:56:45.851852 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m10:56:45.852000 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m10:56:45.853628 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:45.853831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa5b92d-e650-4fc6-9ec3-1ce74ce7f896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c3470>]}
[0m10:56:45.854102 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.01s]
[0m10:56:45.854350 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m10:56:45.854527 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m10:56:45.854800 [info ] [Thread-1 (]: 4 of 9 SKIP relation main.int_listen ........................................... [[33mSKIP[0m]
[0m10:56:45.855012 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m10:56:45.855198 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m10:56:45.855405 [info ] [Thread-1 (]: 5 of 9 SKIP relation main.int_tracks ........................................... [[33mSKIP[0m]
[0m10:56:45.855590 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m10:56:45.855758 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m10:56:45.855955 [info ] [Thread-1 (]: 6 of 9 SKIP relation main.int_users ............................................ [[33mSKIP[0m]
[0m10:56:45.856128 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m10:56:45.856291 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m10:56:45.856493 [info ] [Thread-1 (]: 7 of 9 SKIP relation main.mart_listen .......................................... [[33mSKIP[0m]
[0m10:56:45.856666 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m10:56:45.856823 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m10:56:45.856986 [info ] [Thread-1 (]: 8 of 9 SKIP relation main.mart_tracks .......................................... [[33mSKIP[0m]
[0m10:56:45.857148 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m10:56:45.857301 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m10:56:45.857457 [info ] [Thread-1 (]: 9 of 9 SKIP relation main.mart_users ........................................... [[33mSKIP[0m]
[0m10:56:45.857617 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m10:56:45.858127 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:45.858279 [debug] [MainThread]: On master: BEGIN
[0m10:56:45.858389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:45.861393 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:56:45.861601 [debug] [MainThread]: On master: COMMIT
[0m10:56:45.861758 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:45.861883 [debug] [MainThread]: On master: COMMIT
[0m10:56:45.862056 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:56:45.862184 [debug] [MainThread]: On master: Close
[0m10:56:45.862753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:45.862884 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m10:56:45.863104 [info ] [MainThread]: 
[0m10:56:45.863268 [info ] [MainThread]: Finished running 6 view models, 3 table models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:56:45.863907 [debug] [MainThread]: Command end result
[0m10:56:45.879698 [info ] [MainThread]: 
[0m10:56:45.879945 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:56:45.880088 [info ] [MainThread]: 
[0m10:56:45.880264 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "listen_history.listen_timestamp"
  LINE 11:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:45.880399 [info ] [MainThread]: 
[0m10:56:45.880553 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:45.880676 [info ] [MainThread]: 
[0m10:56:45.880833 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:56:45.880966 [info ] [MainThread]: 
[0m10:56:45.881107 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=6 TOTAL=9
[0m10:56:45.882870 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6333486, "process_user_time": 1.012961, "process_kernel_time": 0.139896, "process_mem_max_rss": "137625600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:56:45.883297 [debug] [MainThread]: Command `dbt run` failed at 10:56:45.883239 after 0.63 seconds
[0m10:56:45.883578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069de060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fed80>]}
[0m10:56:45.883786 [debug] [MainThread]: Flushing usage events
[0m10:57:00.006107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106442090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106441d90>]}


============================== 10:57:00.008864 | 195362eb-3bf3-4d8a-a12a-f432ec37c970 ==============================
[0m10:57:00.008864 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:57:00.009194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:57:00.187014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065475f0>]}
[0m10:57:00.210329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c8200>]}
[0m10:57:00.212935 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m10:57:00.223091 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m10:57:00.283618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:00.283981 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m10:57:00.385290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106942240>]}
[0m10:57:00.428478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668a690>]}
[0m10:57:00.428772 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m10:57:00.428945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106957830>]}
[0m10:57:00.429978 [info ] [MainThread]: 
[0m10:57:00.430260 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:57:00.432751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m10:57:00.459467 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m10:57:00.459711 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m10:57:00.459856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:00.476774 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:57:00.478080 [debug] [ThreadPool]: On list_moovai_data: Close
[0m10:57:00.479592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m10:57:00.479817 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m10:57:00.483112 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:00.483289 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m10:57:00.483429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:00.487082 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:57:00.487898 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:00.488036 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m10:57:00.488202 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:57:00.488328 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:00.488452 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m10:57:00.489028 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:57:00.489424 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:57:00.489554 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:00.489667 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:57:00.489814 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:57:00.489941 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m10:57:00.490989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m10:57:00.493634 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:57:00.493812 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m10:57:00.493941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:00.496797 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:57:00.496968 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:57:00.497117 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m10:57:00.513872 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:57:00.514796 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m10:57:00.515867 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m10:57:00.516032 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m10:57:00.517653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d83470>]}
[0m10:57:00.517897 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:00.518032 [debug] [MainThread]: On master: BEGIN
[0m10:57:00.518149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:00.520935 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:57:00.521098 [debug] [MainThread]: On master: COMMIT
[0m10:57:00.521228 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:00.521347 [debug] [MainThread]: On master: COMMIT
[0m10:57:00.521496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:57:00.521623 [debug] [MainThread]: On master: Close
[0m10:57:00.522141 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m10:57:00.522316 [info ] [MainThread]: 
[0m10:57:00.523687 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m10:57:00.523944 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m10:57:00.524152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m10:57:00.524310 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m10:57:00.527696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m10:57:00.528048 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m10:57:00.542828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m10:57:00.543292 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:00.543454 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m10:57:00.543600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:00.546635 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:00.546823 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:00.546979 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --


with cte_src_listen as (

    select * from moovai_data.listen_history
    --WHERE date = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m10:57:00.547491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:57:00.550732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:00.550922 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m10:57:00.551648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:57:00.552969 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:00.553121 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m10:57:00.553331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:57:00.561828 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m10:57:00.562015 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:00.562161 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m10:57:00.563067 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:57:00.565291 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:00.565475 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m10:57:00.565758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:57:00.566789 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m10:57:00.572452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d226c0>]}
[0m10:57:00.572758 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m10:57:00.573039 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m10:57:00.573231 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m10:57:00.573501 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m10:57:00.573704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m10:57:00.573855 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m10:57:00.575079 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m10:57:00.575412 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m10:57:00.576859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m10:57:00.577132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:57:00.577284 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m10:57:00.577422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:00.580409 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:00.580626 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:57:00.580791 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:57:00.585883 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:57:00.586095 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:00.586313 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m10:57:00.591712 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m10:57:00.591883 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m10:57:00.593625 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:00.593880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d29b50>]}
[0m10:57:00.594175 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.02s]
[0m10:57:00.594446 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m10:57:00.594628 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m10:57:00.595217 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m10:57:00.595429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m10:57:00.595586 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m10:57:00.596876 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m10:57:00.597207 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m10:57:00.598704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m10:57:00.599021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:57:00.599175 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m10:57:00.599314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:00.602532 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:00.602763 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:57:00.602919 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:57:00.603336 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:57:00.603488 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:00.603696 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m10:57:00.605181 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m10:57:00.605334 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m10:57:00.607023 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:00.607266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6ef60>]}
[0m10:57:00.607551 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.01s]
[0m10:57:00.607812 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m10:57:00.607992 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m10:57:00.608261 [info ] [Thread-1 (]: 4 of 9 START sql view model main.int_listen .................................... [RUN]
[0m10:57:00.608443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_listen)
[0m10:57:00.608594 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m10:57:00.609926 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m10:57:00.610569 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m10:57:00.612087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m10:57:00.612355 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:57:00.612503 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m10:57:00.612637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:00.615498 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:00.615689 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m10:57:00.615855 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
  );

[0m10:57:00.616978 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
  );

[0m10:57:00.617139 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:00.617326 [debug] [Thread-1 (]: On model.dbt_project.int_listen: ROLLBACK
[0m10:57:00.618767 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_listen'
[0m10:57:00.618919 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m10:57:00.620499 [debug] [Thread-1 (]: Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m10:57:00.620682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '195362eb-3bf3-4d8a-a12a-f432ec37c970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e711f0>]}
[0m10:57:00.620945 [error] [Thread-1 (]: 4 of 9 ERROR creating sql view model main.int_listen ........................... [[31mERROR[0m in 0.01s]
[0m10:57:00.621191 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m10:57:00.621364 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m10:57:00.621612 [info ] [Thread-1 (]: 5 of 9 SKIP relation main.int_tracks ........................................... [[33mSKIP[0m]
[0m10:57:00.621810 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m10:57:00.622002 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m10:57:00.622195 [info ] [Thread-1 (]: 6 of 9 SKIP relation main.int_users ............................................ [[33mSKIP[0m]
[0m10:57:00.622359 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m10:57:00.622512 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m10:57:00.622701 [info ] [Thread-1 (]: 7 of 9 SKIP relation main.mart_listen .......................................... [[33mSKIP[0m]
[0m10:57:00.622883 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m10:57:00.623038 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m10:57:00.623202 [info ] [Thread-1 (]: 8 of 9 SKIP relation main.mart_tracks .......................................... [[33mSKIP[0m]
[0m10:57:00.623371 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m10:57:00.623519 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m10:57:00.623674 [info ] [Thread-1 (]: 9 of 9 SKIP relation main.mart_users ........................................... [[33mSKIP[0m]
[0m10:57:00.623836 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m10:57:00.624313 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:00.624444 [debug] [MainThread]: On master: BEGIN
[0m10:57:00.624555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:00.627954 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:57:00.628167 [debug] [MainThread]: On master: COMMIT
[0m10:57:00.628287 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:00.628399 [debug] [MainThread]: On master: COMMIT
[0m10:57:00.628563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:57:00.628693 [debug] [MainThread]: On master: Close
[0m10:57:00.629341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:00.629504 [debug] [MainThread]: Connection 'model.dbt_project.int_listen' was properly closed.
[0m10:57:00.629697 [info ] [MainThread]: 
[0m10:57:00.629860 [info ] [MainThread]: Finished running 6 view models, 3 table models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m10:57:00.630407 [debug] [MainThread]: Command end result
[0m10:57:00.646391 [info ] [MainThread]: 
[0m10:57:00.646601 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:57:00.646731 [info ] [MainThread]: 
[0m10:57:00.646906 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:00.647035 [info ] [MainThread]: 
[0m10:57:00.647183 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:00.647307 [info ] [MainThread]: 
[0m10:57:00.647445 [error] [MainThread]:   Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m10:57:00.647563 [info ] [MainThread]: 
[0m10:57:00.647701 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=5 TOTAL=9
[0m10:57:00.649207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.67246765, "process_user_time": 1.052488, "process_kernel_time": 0.136983, "process_mem_max_rss": "138149888", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:57:00.649458 [debug] [MainThread]: Command `dbt run` failed at 10:57:00.649419 after 0.67 seconds
[0m10:57:00.649633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106442090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a9b20>]}
[0m10:57:00.649813 [debug] [MainThread]: Flushing usage events
[0m10:57:39.281674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f20f0>]}


============================== 10:57:39.284559 | 6b91c904-4bb9-4140-8e9f-8510a0ebcdf9 ==============================
[0m10:57:39.284559 [info ] [MainThread]: Running with dbt=1.8.6
[0m10:57:39.284886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:57:39.469027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108741730>]}
[0m10:57:39.492097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107511100>]}
[0m10:57:39.493768 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m10:57:39.504010 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m10:57:39.567688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:39.568038 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m10:57:39.671198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af1f70>]}
[0m10:57:39.713848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afcdd0>]}
[0m10:57:39.714127 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m10:57:39.714298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866b680>]}
[0m10:57:39.715324 [info ] [MainThread]: 
[0m10:57:39.715616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:57:39.717892 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m10:57:39.747336 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m10:57:39.747568 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m10:57:39.747741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:39.764901 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:57:39.766297 [debug] [ThreadPool]: On list_moovai_data: Close
[0m10:57:39.767878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m10:57:39.768100 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m10:57:39.771328 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:39.771490 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m10:57:39.771621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:39.775312 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:57:39.776138 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:39.776282 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m10:57:39.776447 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:57:39.776574 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:39.776700 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m10:57:39.777278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:57:39.777679 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:57:39.777806 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m10:57:39.777918 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m10:57:39.778066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:57:39.778193 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m10:57:39.779217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m10:57:39.781760 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:57:39.781909 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m10:57:39.782025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:39.784745 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:57:39.784909 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m10:57:39.785060 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m10:57:39.799750 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:57:39.800566 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m10:57:39.801568 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m10:57:39.801744 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m10:57:39.803288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f376b0>]}
[0m10:57:39.803518 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:39.803651 [debug] [MainThread]: On master: BEGIN
[0m10:57:39.803797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:39.806742 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:57:39.806926 [debug] [MainThread]: On master: COMMIT
[0m10:57:39.807064 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:39.807181 [debug] [MainThread]: On master: COMMIT
[0m10:57:39.807334 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:57:39.807467 [debug] [MainThread]: On master: Close
[0m10:57:39.808005 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m10:57:39.808170 [info ] [MainThread]: 
[0m10:57:39.809494 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m10:57:39.809752 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m10:57:39.809952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m10:57:39.810105 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m10:57:39.813508 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m10:57:39.814187 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m10:57:39.829058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m10:57:39.829535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:39.829694 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m10:57:39.829837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:39.832834 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:39.833020 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m10:57:39.833184 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --


with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m10:57:39.838338 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --


with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m10:57:39.838544 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:39.838765 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m10:57:39.844381 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m10:57:39.844550 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m10:57:39.846276 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 11:     WHERE created_at = CURRENT_DATE
                     ^
[0m10:57:39.846979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66000>]}
[0m10:57:39.847293 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m10:57:39.847598 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m10:57:39.847799 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m10:57:39.848511 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m10:57:39.848764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m10:57:39.848925 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m10:57:39.850382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m10:57:39.850761 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m10:57:39.852939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m10:57:39.853249 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:57:39.853405 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m10:57:39.853549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:39.856493 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:39.856677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m10:57:39.856834 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:57:39.857259 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE


)

select *
from cte_src_tracks
  );

[0m10:57:39.857410 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:39.857595 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m10:57:39.859122 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m10:57:39.859277 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m10:57:39.860914 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:39.861131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f718e0>]}
[0m10:57:39.861409 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.01s]
[0m10:57:39.861669 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m10:57:39.861856 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m10:57:39.862122 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m10:57:39.862306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m10:57:39.862455 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m10:57:39.863726 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m10:57:39.864071 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m10:57:39.865557 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m10:57:39.865834 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:57:39.865987 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m10:57:39.866124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:39.869106 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:57:39.869329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m10:57:39.869502 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:57:39.869990 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE


)

select *
from cte_src_users
  );

[0m10:57:39.870160 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:39.870353 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m10:57:39.871829 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m10:57:39.871977 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m10:57:39.873628 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:39.873828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b91c904-4bb9-4140-8e9f-8510a0ebcdf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ead310>]}
[0m10:57:39.874112 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.01s]
[0m10:57:39.874366 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m10:57:39.874543 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m10:57:39.874805 [info ] [Thread-1 (]: 4 of 9 SKIP relation main.int_listen ........................................... [[33mSKIP[0m]
[0m10:57:39.875004 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m10:57:39.875178 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m10:57:39.875376 [info ] [Thread-1 (]: 5 of 9 SKIP relation main.int_tracks ........................................... [[33mSKIP[0m]
[0m10:57:39.875545 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m10:57:39.875701 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m10:57:39.875884 [info ] [Thread-1 (]: 6 of 9 SKIP relation main.int_users ............................................ [[33mSKIP[0m]
[0m10:57:39.876047 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m10:57:39.876198 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m10:57:39.876373 [info ] [Thread-1 (]: 7 of 9 SKIP relation main.mart_listen .......................................... [[33mSKIP[0m]
[0m10:57:39.876533 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m10:57:39.876692 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m10:57:39.876852 [info ] [Thread-1 (]: 8 of 9 SKIP relation main.mart_tracks .......................................... [[33mSKIP[0m]
[0m10:57:39.877011 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m10:57:39.877160 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m10:57:39.877312 [info ] [Thread-1 (]: 9 of 9 SKIP relation main.mart_users ........................................... [[33mSKIP[0m]
[0m10:57:39.877470 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m10:57:39.877990 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:39.878133 [debug] [MainThread]: On master: BEGIN
[0m10:57:39.878249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:39.881077 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:57:39.881230 [debug] [MainThread]: On master: COMMIT
[0m10:57:39.881350 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:39.881462 [debug] [MainThread]: On master: COMMIT
[0m10:57:39.881610 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:57:39.881729 [debug] [MainThread]: On master: Close
[0m10:57:39.882238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:39.882360 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m10:57:39.882548 [info ] [MainThread]: 
[0m10:57:39.882708 [info ] [MainThread]: Finished running 6 view models, 3 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m10:57:39.883220 [debug] [MainThread]: Command end result
[0m10:57:39.898253 [info ] [MainThread]: 
[0m10:57:39.898499 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:57:39.898645 [info ] [MainThread]: 
[0m10:57:39.898824 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 11:     WHERE created_at = CURRENT_DATE
                     ^
[0m10:57:39.898958 [info ] [MainThread]: 
[0m10:57:39.899113 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:39.899241 [info ] [MainThread]: 
[0m10:57:39.899470 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m10:57:39.899640 [info ] [MainThread]: 
[0m10:57:39.899803 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=6 TOTAL=9
[0m10:57:39.901526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.65356797, "process_user_time": 1.016929, "process_kernel_time": 0.158676, "process_mem_max_rss": "136298496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:57:39.901784 [debug] [MainThread]: Command `dbt run` failed at 10:57:39.901743 after 0.65 seconds
[0m10:57:39.901970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f20f0>]}
[0m10:57:39.902129 [debug] [MainThread]: Flushing usage events
[0m11:11:19.116815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b85f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b85c40>]}


============================== 11:11:19.119965 | ecdf7738-c653-4a07-bf67-a417577672db ==============================
[0m11:11:19.119965 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:11:19.120287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:11:19.304732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103463b30>]}
[0m11:11:19.327802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b64d70>]}
[0m11:11:19.329625 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:11:19.339424 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:11:19.404642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:11:19.405014 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m11:11:19.405204 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m11:11:19.405370 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:11:19.509623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105019790>]}
[0m11:11:19.558346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc9d60>]}
[0m11:11:19.558639 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:11:19.558811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce7ad0>]}
[0m11:11:19.559833 [info ] [MainThread]: 
[0m11:11:19.560114 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:11:19.562414 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:11:19.592314 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:11:19.592545 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:11:19.592693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:19.609462 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m11:11:19.610805 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:11:19.612312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:11:19.612535 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:11:19.615775 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:19.615941 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:11:19.616109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:19.619736 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:11:19.620567 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:19.620706 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:11:19.620869 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:19.620996 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:19.621123 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:11:19.621701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:19.622101 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:11:19.622227 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:19.622341 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:11:19.622491 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:19.622617 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:11:19.623667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:11:19.626293 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:11:19.626455 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:11:19.626578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:19.629615 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:11:19.632767 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:11:19.632924 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:11:19.649412 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:11:19.650235 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:11:19.651238 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:11:19.651407 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:11:19.652948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa89b0>]}
[0m11:11:19.653180 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:19.653315 [debug] [MainThread]: On master: BEGIN
[0m11:11:19.653438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:19.656232 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:11:19.656392 [debug] [MainThread]: On master: COMMIT
[0m11:11:19.656526 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:19.656652 [debug] [MainThread]: On master: COMMIT
[0m11:11:19.656801 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:11:19.656926 [debug] [MainThread]: On master: Close
[0m11:11:19.657435 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:11:19.657632 [info ] [MainThread]: 
[0m11:11:19.658908 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:11:19.659174 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m11:11:19.659387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:11:19.659611 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:11:19.663021 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:11:19.663901 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:11:19.678484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:11:19.678962 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:11:19.679127 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:11:19.679270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:19.682280 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:11:19.682473 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:11:19.682628 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m11:11:19.687879 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m11:11:19.688060 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:11:19.688272 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:11:19.693812 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:11:19.693984 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:11:19.695759 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 10:     WHERE created_at = CURRENT_DATE
                     ^
[0m11:11:19.696494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411d910>]}
[0m11:11:19.696800 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m11:11:19.697087 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:11:19.697282 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m11:11:19.698009 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m11:11:19.698222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m11:11:19.698378 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m11:11:19.699589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m11:11:19.700113 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m11:11:19.702290 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m11:11:19.702599 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:11:19.702756 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m11:11:19.702904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:19.705836 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:11:19.706042 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:11:19.706194 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m11:11:19.706606 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (

    select * from moovai_data.tracks
    WHERE date = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m11:11:19.706756 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:11:19.706936 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m11:11:19.708380 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m11:11:19.708531 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m11:11:19.710152 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m11:11:19.710379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105505370>]}
[0m11:11:19.710687 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.01s]
[0m11:11:19.710958 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m11:11:19.711148 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m11:11:19.711419 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m11:11:19.711603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m11:11:19.711754 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m11:11:19.713011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m11:11:19.713349 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m11:11:19.714784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m11:11:19.715072 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:11:19.715220 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m11:11:19.715359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:19.718186 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:11:19.718368 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:11:19.718527 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    --

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m11:11:19.718920 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    --

with cte_src_users as (

    select * from moovai_data.users
    WHERE date = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m11:11:19.719090 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:11:19.719266 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m11:11:19.720757 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m11:11:19.720932 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m11:11:19.722682 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m11:11:19.723021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecdf7738-c653-4a07-bf67-a417577672db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105441a90>]}
[0m11:11:19.723330 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.01s]
[0m11:11:19.723597 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m11:11:19.723775 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m11:11:19.723940 [info ] [Thread-1 (]: 4 of 9 SKIP relation main.int_listen ........................................... [[33mSKIP[0m]
[0m11:11:19.724194 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m11:11:19.724381 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m11:11:19.724546 [info ] [Thread-1 (]: 5 of 9 SKIP relation main.int_tracks ........................................... [[33mSKIP[0m]
[0m11:11:19.724756 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m11:11:19.724916 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m11:11:19.725066 [info ] [Thread-1 (]: 6 of 9 SKIP relation main.int_users ............................................ [[33mSKIP[0m]
[0m11:11:19.725271 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m11:11:19.725442 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m11:11:19.725599 [info ] [Thread-1 (]: 7 of 9 SKIP relation main.mart_listen .......................................... [[33mSKIP[0m]
[0m11:11:19.725799 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m11:11:19.725964 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m11:11:19.726118 [info ] [Thread-1 (]: 8 of 9 SKIP relation main.mart_tracks .......................................... [[33mSKIP[0m]
[0m11:11:19.726332 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m11:11:19.726516 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m11:11:19.726672 [info ] [Thread-1 (]: 9 of 9 SKIP relation main.mart_users ........................................... [[33mSKIP[0m]
[0m11:11:19.726842 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m11:11:19.727368 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:19.727512 [debug] [MainThread]: On master: BEGIN
[0m11:11:19.727629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:19.730732 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:11:19.730908 [debug] [MainThread]: On master: COMMIT
[0m11:11:19.731034 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:19.731151 [debug] [MainThread]: On master: COMMIT
[0m11:11:19.731308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:11:19.731430 [debug] [MainThread]: On master: Close
[0m11:11:19.731993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:19.732160 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m11:11:19.732344 [info ] [MainThread]: 
[0m11:11:19.732500 [info ] [MainThread]: Finished running 6 view models, 3 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:11:19.733018 [debug] [MainThread]: Command end result
[0m11:11:19.750338 [info ] [MainThread]: 
[0m11:11:19.750586 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:11:19.750726 [info ] [MainThread]: 
[0m11:11:19.750906 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 10:     WHERE created_at = CURRENT_DATE
                     ^
[0m11:11:19.751039 [info ] [MainThread]: 
[0m11:11:19.751192 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "tracks.updated_at", "tracks.duration", "tracks.name", "tracks.artist", "tracks.id"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m11:11:19.751316 [info ] [MainThread]: 
[0m11:11:19.751468 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "users.updated_at", "users.name", "users.id", "users.created_at"
  LINE 10:     WHERE date = CURRENT_DATE
                     ^
[0m11:11:19.751593 [info ] [MainThread]: 
[0m11:11:19.751735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=6 TOTAL=9
[0m11:11:19.753453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.67190444, "process_user_time": 1.018451, "process_kernel_time": 0.166329, "process_mem_max_rss": "138428416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:11:19.753738 [debug] [MainThread]: Command `dbt run` failed at 11:11:19.753696 after 0.67 seconds
[0m11:11:19.753941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105803e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b85dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b85f10>]}
[0m11:11:19.754101 [debug] [MainThread]: Flushing usage events
[0m11:11:41.213982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b51c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105409f10>]}


============================== 11:11:41.216751 | 8b88a05c-f7f6-4e49-9d66-df2b94ebe849 ==============================
[0m11:11:41.216751 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:11:41.217059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:11:41.394689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b88a05c-f7f6-4e49-9d66-df2b94ebe849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054df3b0>]}
[0m11:11:41.417771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b88a05c-f7f6-4e49-9d66-df2b94ebe849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542c200>]}
[0m11:11:41.420346 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:11:41.430772 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:11:41.492089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:41.492322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:41.507097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b88a05c-f7f6-4e49-9d66-df2b94ebe849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057674d0>]}
[0m11:11:41.554781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b88a05c-f7f6-4e49-9d66-df2b94ebe849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589eea0>]}
[0m11:11:41.555058 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:11:41.555250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b88a05c-f7f6-4e49-9d66-df2b94ebe849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105473380>]}
[0m11:11:41.556110 [info ] [MainThread]: 
[0m11:11:41.556393 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:11:41.556829 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:11:41.583991 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:11:41.584240 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:11:41.584393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:41.603633 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m11:11:41.605013 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:11:41.606420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:11:41.606655 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:11:41.610013 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:41.610187 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:11:41.610319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:41.613665 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:11:41.614514 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:41.614659 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:11:41.614825 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:41.614951 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:41.615073 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:11:41.615468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:41.615870 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:11:41.615993 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:11:41.616147 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:11:41.616294 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:11:41.616422 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:11:41.619224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:11:41.621829 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:11:41.621983 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:11:41.622102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:41.624916 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:11:41.625079 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:11:41.625220 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:11:41.638537 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:11:41.639331 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:11:41.641203 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:11:41.641351 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:11:41.642880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b88a05c-f7f6-4e49-9d66-df2b94ebe849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c345f0>]}
[0m11:11:41.643143 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:41.643285 [debug] [MainThread]: On master: BEGIN
[0m11:11:41.643405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:41.646329 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:11:41.646504 [debug] [MainThread]: On master: COMMIT
[0m11:11:41.646636 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:41.646750 [debug] [MainThread]: On master: COMMIT
[0m11:11:41.646902 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:11:41.647030 [debug] [MainThread]: On master: Close
[0m11:11:41.647548 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:11:41.647691 [info ] [MainThread]: 
[0m11:11:41.648881 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:11:41.649138 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:11:41.649337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:11:41.649490 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:11:41.652899 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:11:41.653299 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:11:41.668197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:11:41.668634 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:11:41.668809 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:11:41.668965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:41.672188 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:11:41.672391 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:11:41.672549 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m11:11:41.677423 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m11:11:41.677597 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:11:41.677796 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:11:41.683144 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:11:41.683318 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:11:41.685040 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 10:     WHERE created_at = CURRENT_DATE
                     ^
[0m11:11:41.685777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b88a05c-f7f6-4e49-9d66-df2b94ebe849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee1700>]}
[0m11:11:41.686101 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m11:11:41.686405 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:11:41.687276 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:41.687424 [debug] [MainThread]: On master: BEGIN
[0m11:11:41.687541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:41.690391 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:11:41.690553 [debug] [MainThread]: On master: COMMIT
[0m11:11:41.690680 [debug] [MainThread]: Using duckdb connection "master"
[0m11:11:41.690790 [debug] [MainThread]: On master: COMMIT
[0m11:11:41.690939 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:11:41.691063 [debug] [MainThread]: On master: Close
[0m11:11:41.691555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:41.691725 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:11:41.691876 [info ] [MainThread]: 
[0m11:11:41.692029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:11:41.692334 [debug] [MainThread]: Command end result
[0m11:11:41.707021 [info ] [MainThread]: 
[0m11:11:41.707404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:11:41.707564 [info ] [MainThread]: 
[0m11:11:41.707778 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 10:     WHERE created_at = CURRENT_DATE
                     ^
[0m11:11:41.707922 [info ] [MainThread]: 
[0m11:11:41.708061 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:11:41.709606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5254454, "process_user_time": 0.909657, "process_kernel_time": 0.142076, "process_mem_max_rss": "131563520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:11:41.709865 [debug] [MainThread]: Command `dbt run` failed at 11:11:41.709824 after 0.53 seconds
[0m11:11:41.710064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b51c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1afc0>]}
[0m11:11:41.710243 [debug] [MainThread]: Flushing usage events
[0m11:22:56.872600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ab590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108046060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108045d60>]}


============================== 11:22:56.875743 | 89d04127-763d-48fb-b996-4d0b49ac3fbd ==============================
[0m11:22:56.875743 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:22:56.876099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:22:57.097807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89d04127-763d-48fb-b996-4d0b49ac3fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bdd30>]}
[0m11:22:57.122871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89d04127-763d-48fb-b996-4d0b49ac3fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cf890>]}
[0m11:22:57.124895 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:22:57.135788 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:22:57.200569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:57.200817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:57.216252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89d04127-763d-48fb-b996-4d0b49ac3fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10838be30>]}
[0m11:22:57.263168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89d04127-763d-48fb-b996-4d0b49ac3fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859e450>]}
[0m11:22:57.263449 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:22:57.263628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89d04127-763d-48fb-b996-4d0b49ac3fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108635310>]}
[0m11:22:57.264476 [info ] [MainThread]: 
[0m11:22:57.264770 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:22:57.265189 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:22:57.295384 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:22:57.295625 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:22:57.295781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:57.311636 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:22:57.312900 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:22:57.314385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:22:57.314599 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:22:57.317935 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:22:57.318132 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:22:57.318282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:57.321853 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:22:57.322720 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:22:57.322864 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:22:57.323029 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:22:57.323157 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:22:57.323279 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:22:57.323866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:22:57.324262 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:22:57.324384 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:22:57.324492 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:22:57.324633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:22:57.324756 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:22:57.327644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:22:57.330340 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:22:57.330507 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:22:57.330640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:57.333608 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:22:57.333776 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:22:57.333925 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:22:57.347777 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m11:22:57.348581 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:22:57.350420 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:22:57.350567 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:22:57.352119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89d04127-763d-48fb-b996-4d0b49ac3fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d3290>]}
[0m11:22:57.352347 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:57.352483 [debug] [MainThread]: On master: BEGIN
[0m11:22:57.352601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:57.355676 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:22:57.355881 [debug] [MainThread]: On master: COMMIT
[0m11:22:57.356020 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:57.356141 [debug] [MainThread]: On master: COMMIT
[0m11:22:57.356332 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:22:57.356485 [debug] [MainThread]: On master: Close
[0m11:22:57.357027 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:22:57.357181 [info ] [MainThread]: 
[0m11:22:57.358357 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:22:57.358613 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:22:57.358804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:22:57.358955 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:22:57.362454 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:22:57.362820 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:22:57.378313 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:22:57.378798 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:22:57.378967 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:22:57.379112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:57.382093 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:22:57.382296 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:22:57.382471 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m11:22:57.387474 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_listen
  );

[0m11:22:57.387653 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:22:57.387860 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:22:57.393702 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:22:57.393884 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:22:57.395687 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 10:     WHERE created_at = CURRENT_DATE
                     ^
[0m11:22:57.396428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89d04127-763d-48fb-b996-4d0b49ac3fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a656a0>]}
[0m11:22:57.396747 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m11:22:57.397052 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:22:57.397958 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:57.398139 [debug] [MainThread]: On master: BEGIN
[0m11:22:57.398270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:22:57.401306 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:22:57.401492 [debug] [MainThread]: On master: COMMIT
[0m11:22:57.401622 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:57.401782 [debug] [MainThread]: On master: COMMIT
[0m11:22:57.401951 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:22:57.402079 [debug] [MainThread]: On master: Close
[0m11:22:57.402583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:57.402701 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:22:57.402831 [info ] [MainThread]: 
[0m11:22:57.402967 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:22:57.403266 [debug] [MainThread]: Command end result
[0m11:22:57.418838 [info ] [MainThread]: 
[0m11:22:57.419109 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:22:57.419267 [info ] [MainThread]: 
[0m11:22:57.419462 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Binder Error: Referenced column "created_at" not found in FROM clause!
  Candidate bindings: "listen_history.track_id"
  LINE 10:     WHERE created_at = CURRENT_DATE
                     ^
[0m11:22:57.419605 [info ] [MainThread]: 
[0m11:22:57.419749 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:22:57.421327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.58285415, "process_user_time": 0.919459, "process_kernel_time": 0.167692, "process_mem_max_rss": "134709248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:22:57.421649 [debug] [MainThread]: Command `dbt run` failed at 11:22:57.421610 after 0.58 seconds
[0m11:22:57.421859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107993e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069eecf0>]}
[0m11:22:57.422075 [debug] [MainThread]: Flushing usage events
[0m11:23:36.723989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d46210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d45f40>]}


============================== 11:23:36.727800 | 194ef79a-6b3c-475c-9e3a-a396994d40b8 ==============================
[0m11:23:36.727800 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:23:36.728248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:23:36.927051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '194ef79a-6b3c-475c-9e3a-a396994d40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11393f500>]}
[0m11:23:36.950689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '194ef79a-6b3c-475c-9e3a-a396994d40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f68f20>]}
[0m11:23:36.952504 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:23:36.962183 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:23:37.029003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:23:37.029415 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:23:37.132912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '194ef79a-6b3c-475c-9e3a-a396994d40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144f5fd0>]}
[0m11:23:37.178872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '194ef79a-6b3c-475c-9e3a-a396994d40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11450ce30>]}
[0m11:23:37.179147 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:23:37.179321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194ef79a-6b3c-475c-9e3a-a396994d40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144fb170>]}
[0m11:23:37.180146 [info ] [MainThread]: 
[0m11:23:37.180425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:37.180918 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:23:37.211120 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:23:37.211343 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:23:37.211483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:37.230820 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m11:23:37.231810 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:23:37.233888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:23:37.234106 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:23:37.237331 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:23:37.237497 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:23:37.237629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:37.241079 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:23:37.241921 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:23:37.242060 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:23:37.242220 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:23:37.242344 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:23:37.242469 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:23:37.243421 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:23:37.243820 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:23:37.243953 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:23:37.244065 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:23:37.244209 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:23:37.244333 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:23:37.247114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:23:37.249767 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:23:37.249934 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:23:37.250062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:37.253025 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:23:37.253189 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:23:37.253328 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:23:37.267148 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m11:23:37.268003 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:23:37.269213 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:23:37.269382 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:23:37.271017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194ef79a-6b3c-475c-9e3a-a396994d40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149767b0>]}
[0m11:23:37.271274 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:37.271411 [debug] [MainThread]: On master: BEGIN
[0m11:23:37.271538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:37.274564 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:23:37.274753 [debug] [MainThread]: On master: COMMIT
[0m11:23:37.274890 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:37.275008 [debug] [MainThread]: On master: COMMIT
[0m11:23:37.275155 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:23:37.275286 [debug] [MainThread]: On master: Close
[0m11:23:37.275795 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:23:37.275968 [info ] [MainThread]: 
[0m11:23:37.277153 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:23:37.277415 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:23:37.277616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:23:37.277779 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:23:37.281246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:23:37.282745 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:23:37.298056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:23:37.298482 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:23:37.298643 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:23:37.298785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:37.301721 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:23:37.301909 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:23:37.302074 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    /*
    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE
*/
)

select *
from cte_src_listen
  );

[0m11:23:37.306209 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (

    /*
    select * from moovai_data.listen_history
    WHERE created_at = CURRENT_DATE
*/
)

select *
from cte_src_listen
  );

[0m11:23:37.306409 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:23:37.306619 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:23:37.312559 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:23:37.312740 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:23:37.314423 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Parser Error: syntax error at or near ")"
[0m11:23:37.315131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194ef79a-6b3c-475c-9e3a-a396994d40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b666c0>]}
[0m11:23:37.315428 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m11:23:37.315704 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:23:37.316534 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:37.316680 [debug] [MainThread]: On master: BEGIN
[0m11:23:37.316800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:37.319719 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:23:37.319896 [debug] [MainThread]: On master: COMMIT
[0m11:23:37.320027 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:37.320144 [debug] [MainThread]: On master: COMMIT
[0m11:23:37.320295 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:23:37.320420 [debug] [MainThread]: On master: Close
[0m11:23:37.320923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:37.321089 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:23:37.321242 [info ] [MainThread]: 
[0m11:23:37.321397 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:23:37.321710 [debug] [MainThread]: Command end result
[0m11:23:37.337681 [info ] [MainThread]: 
[0m11:23:37.337944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:23:37.338092 [info ] [MainThread]: 
[0m11:23:37.338280 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Parser Error: syntax error at or near ")"
[0m11:23:37.338419 [info ] [MainThread]: 
[0m11:23:37.338564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:23:37.340119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.70621735, "process_user_time": 1.000188, "process_kernel_time": 0.16177, "process_mem_max_rss": "134578176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:37.340372 [debug] [MainThread]: Command `dbt run` failed at 11:23:37.340331 after 0.71 seconds
[0m11:23:37.340559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111456360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114221be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d22330>]}
[0m11:23:37.340717 [debug] [MainThread]: Flushing usage events
[0m11:26:03.491026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d16300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d15fd0>]}


============================== 11:26:03.494123 | cc150704-5b6b-432c-841a-bda86bbacddb ==============================
[0m11:26:03.494123 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:26:03.494440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:26:03.675289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc150704-5b6b-432c-841a-bda86bbacddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d79c10>]}
[0m11:26:03.698286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc150704-5b6b-432c-841a-bda86bbacddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de09b0>]}
[0m11:26:03.699916 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:26:03.709955 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:26:03.773430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:26:03.773782 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:26:03.773979 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m11:26:03.876377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc150704-5b6b-432c-841a-bda86bbacddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105057c80>]}
[0m11:26:03.920660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc150704-5b6b-432c-841a-bda86bbacddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5a030>]}
[0m11:26:03.920944 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:26:03.921118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc150704-5b6b-432c-841a-bda86bbacddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f01970>]}
[0m11:26:03.921965 [info ] [MainThread]: 
[0m11:26:03.922237 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:26:03.922702 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:26:03.951897 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:26:03.952140 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:26:03.952287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:03.968555 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:26:03.969845 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:26:03.971322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:26:03.971541 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:26:03.974826 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:03.974990 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:26:03.975123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:03.978281 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:26:03.979126 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:03.979266 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:26:03.979427 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:26:03.979551 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:03.979675 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:26:03.980324 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:26:03.980733 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:26:03.980868 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:03.980986 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:26:03.981133 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:26:03.981261 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:26:03.984111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:26:03.986743 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:26:03.986899 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:26:03.987022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:03.989782 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:26:03.989938 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:26:03.990076 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:26:04.003329 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:26:04.004154 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:26:04.005486 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:26:04.005648 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:26:04.007141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc150704-5b6b-432c-841a-bda86bbacddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa5820>]}
[0m11:26:04.007401 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:04.007540 [debug] [MainThread]: On master: BEGIN
[0m11:26:04.007665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:04.010560 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:26:04.010736 [debug] [MainThread]: On master: COMMIT
[0m11:26:04.010872 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:04.010992 [debug] [MainThread]: On master: COMMIT
[0m11:26:04.011147 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:26:04.011277 [debug] [MainThread]: On master: Close
[0m11:26:04.011826 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:26:04.011975 [info ] [MainThread]: 
[0m11:26:04.013139 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:26:04.013388 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:26:04.013582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:26:04.013735 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:26:04.017145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:26:04.017734 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:26:04.032553 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:26:04.032994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:26:04.033160 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:26:04.033306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:04.036247 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:26:04.036438 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:26:04.036595 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select column_name, data_type from moovai_data.listen_history.columns
    WHERE created_at = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:26:04.050669 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select column_name, data_type from moovai_data.listen_history.columns
    WHERE created_at = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:26:04.050892 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:26:04.051114 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:26:04.056677 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:26:04.056845 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:26:04.058761 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name columns does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 10:     select column_name, data_type from moovai_data.listen_history.columns
                                                  ^
[0m11:26:04.059471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc150704-5b6b-432c-841a-bda86bbacddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a1c10>]}
[0m11:26:04.059777 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.05s]
[0m11:26:04.060068 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:26:04.060864 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:04.061006 [debug] [MainThread]: On master: BEGIN
[0m11:26:04.061120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:04.063979 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:26:04.064147 [debug] [MainThread]: On master: COMMIT
[0m11:26:04.064278 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:04.064392 [debug] [MainThread]: On master: COMMIT
[0m11:26:04.064544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:26:04.064671 [debug] [MainThread]: On master: Close
[0m11:26:04.065209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:04.065326 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:26:04.065454 [info ] [MainThread]: 
[0m11:26:04.065592 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:26:04.065882 [debug] [MainThread]: Command end result
[0m11:26:04.080833 [info ] [MainThread]: 
[0m11:26:04.081184 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:26:04.081329 [info ] [MainThread]: 
[0m11:26:04.081512 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name columns does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 10:     select column_name, data_type from moovai_data.listen_history.columns
                                                  ^
[0m11:26:04.081649 [info ] [MainThread]: 
[0m11:26:04.081788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:26:04.083365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.62574273, "process_user_time": 1.003318, "process_kernel_time": 0.151821, "process_mem_max_rss": "135954432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:26:04.083649 [debug] [MainThread]: Command `dbt run` failed at 11:26:04.083602 after 0.63 seconds
[0m11:26:04.083851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ba1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105126e40>]}
[0m11:26:04.084022 [debug] [MainThread]: Flushing usage events
[0m11:26:38.755147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106535880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd6060>]}


============================== 11:26:38.758241 | 75135f29-d629-4b4f-9dd4-e59da7aadbf9 ==============================
[0m11:26:38.758241 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:26:38.758558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:26:38.932991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75135f29-d629-4b4f-9dd4-e59da7aadbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd61b0>]}
[0m11:26:38.956358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75135f29-d629-4b4f-9dd4-e59da7aadbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108071550>]}
[0m11:26:38.958604 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:26:38.969894 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:26:39.031662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:26:39.032056 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:26:39.134480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75135f29-d629-4b4f-9dd4-e59da7aadbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084da150>]}
[0m11:26:39.176896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75135f29-d629-4b4f-9dd4-e59da7aadbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e0da0>]}
[0m11:26:39.177172 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:26:39.177347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75135f29-d629-4b4f-9dd4-e59da7aadbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c1d00>]}
[0m11:26:39.178168 [info ] [MainThread]: 
[0m11:26:39.178448 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:26:39.178942 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:26:39.216573 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:26:39.217542 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:26:39.218117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:39.240662 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:26:39.242149 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:26:39.243948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:26:39.244179 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:26:39.247643 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:39.247825 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:26:39.247965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:39.251478 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:26:39.252394 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:39.252566 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:26:39.252755 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:26:39.252890 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:39.253019 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:26:39.253710 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:26:39.254168 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:26:39.254314 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:39.254435 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:26:39.254599 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:26:39.254732 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:26:39.257770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:26:39.260462 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:26:39.260650 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:26:39.260775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:39.263664 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:26:39.263839 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:26:39.263987 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:26:39.278243 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m11:26:39.279032 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:26:39.280154 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:26:39.280300 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:26:39.281843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75135f29-d629-4b4f-9dd4-e59da7aadbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088909b0>]}
[0m11:26:39.282110 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:39.282258 [debug] [MainThread]: On master: BEGIN
[0m11:26:39.282395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:39.285356 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:26:39.285535 [debug] [MainThread]: On master: COMMIT
[0m11:26:39.285677 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:39.285810 [debug] [MainThread]: On master: COMMIT
[0m11:26:39.285990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:26:39.286129 [debug] [MainThread]: On master: Close
[0m11:26:39.286675 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:26:39.286875 [info ] [MainThread]: 
[0m11:26:39.288112 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:26:39.288375 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:26:39.288577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:26:39.288740 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:26:39.292308 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:26:39.292784 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:26:39.308175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:26:39.308649 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:26:39.308827 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:26:39.309041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:39.312217 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:26:39.312418 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:26:39.312589 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select column_name, data_type from moovai_data.listen_history.columns
    --WHERE created_at = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:26:39.325828 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select column_name, data_type from moovai_data.listen_history.columns
    --WHERE created_at = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:26:39.326074 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:26:39.326303 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:26:39.331866 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:26:39.332044 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:26:39.334023 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name columns does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 10:     select column_name, data_type from moovai_data.listen_history.columns
                                                  ^
[0m11:26:39.334792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75135f29-d629-4b4f-9dd4-e59da7aadbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107569670>]}
[0m11:26:39.335120 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.05s]
[0m11:26:39.335425 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:26:39.336266 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:39.336428 [debug] [MainThread]: On master: BEGIN
[0m11:26:39.336553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:39.339555 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:26:39.339742 [debug] [MainThread]: On master: COMMIT
[0m11:26:39.339874 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:39.339997 [debug] [MainThread]: On master: COMMIT
[0m11:26:39.340165 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:26:39.340299 [debug] [MainThread]: On master: Close
[0m11:26:39.340807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:39.340943 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:26:39.341080 [info ] [MainThread]: 
[0m11:26:39.341220 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:26:39.341537 [debug] [MainThread]: Command end result
[0m11:26:39.356682 [info ] [MainThread]: 
[0m11:26:39.356951 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:26:39.357110 [info ] [MainThread]: 
[0m11:26:39.357313 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name columns does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 10:     select column_name, data_type from moovai_data.listen_history.columns
                                                  ^
[0m11:26:39.357462 [info ] [MainThread]: 
[0m11:26:39.357627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:26:39.359341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.639648, "process_user_time": 1.014657, "process_kernel_time": 0.149068, "process_mem_max_rss": "135856128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:26:39.359611 [debug] [MainThread]: Command `dbt run` failed at 11:26:39.359567 after 0.64 seconds
[0m11:26:39.359816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108070bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a7740>]}
[0m11:26:39.359987 [debug] [MainThread]: Flushing usage events
[0m11:26:45.858650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf6000>]}


============================== 11:26:45.861347 | 2509662c-345e-43f6-97f3-0b8990541375 ==============================
[0m11:26:45.861347 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:26:45.861684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:26:45.977556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2509662c-345e-43f6-97f3-0b8990541375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba9ee0>]}
[0m11:26:46.000627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2509662c-345e-43f6-97f3-0b8990541375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1a150>]}
[0m11:26:46.002233 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:26:46.010822 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:26:46.070808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:26:46.071157 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:26:46.169273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2509662c-345e-43f6-97f3-0b8990541375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f60c0>]}
[0m11:26:46.210879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2509662c-345e-43f6-97f3-0b8990541375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109104f50>]}
[0m11:26:46.211154 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:26:46.211331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2509662c-345e-43f6-97f3-0b8990541375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f71a0>]}
[0m11:26:46.212160 [info ] [MainThread]: 
[0m11:26:46.212437 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:26:46.212918 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:26:46.238267 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:26:46.238498 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:26:46.238654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:46.242752 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:26:46.243460 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:26:46.244198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:26:46.244437 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:26:46.247644 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:46.247809 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:26:46.247940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:46.250872 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:26:46.251528 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:46.251669 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:26:46.251901 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:26:46.252026 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:46.252151 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:26:46.252325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:26:46.252717 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:26:46.252842 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:26:46.252954 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:26:46.253097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:26:46.253224 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:26:46.255994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:26:46.258575 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:26:46.258732 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:26:46.258857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:46.261609 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:26:46.261760 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:26:46.261895 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:26:46.272311 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:26:46.273089 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:26:46.274260 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:26:46.274434 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:26:46.275942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2509662c-345e-43f6-97f3-0b8990541375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b4620>]}
[0m11:26:46.276164 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:46.276300 [debug] [MainThread]: On master: BEGIN
[0m11:26:46.276420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:46.279156 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:26:46.279313 [debug] [MainThread]: On master: COMMIT
[0m11:26:46.279436 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:46.279549 [debug] [MainThread]: On master: COMMIT
[0m11:26:46.279700 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:26:46.279846 [debug] [MainThread]: On master: Close
[0m11:26:46.280343 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:26:46.280505 [info ] [MainThread]: 
[0m11:26:46.281658 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:26:46.281910 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:26:46.282108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:26:46.282260 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:26:46.285644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:26:46.285988 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:26:46.300461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:26:46.300913 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:26:46.301076 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:26:46.301216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:46.304254 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:26:46.304455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:26:46.304619 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history.columns
    --WHERE created_at = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:26:46.313384 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history.columns
    --WHERE created_at = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:26:46.313573 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:26:46.313791 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:26:46.319271 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:26:46.319438 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:26:46.321243 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name columns does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 10:     select * from moovai_data.listen_history.columns
                             ^
[0m11:26:46.321929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2509662c-345e-43f6-97f3-0b8990541375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956a6f0>]}
[0m11:26:46.322223 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m11:26:46.322495 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:26:46.323289 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:46.323426 [debug] [MainThread]: On master: BEGIN
[0m11:26:46.323543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:46.326611 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:26:46.326821 [debug] [MainThread]: On master: COMMIT
[0m11:26:46.326954 [debug] [MainThread]: Using duckdb connection "master"
[0m11:26:46.327074 [debug] [MainThread]: On master: COMMIT
[0m11:26:46.327221 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:26:46.327348 [debug] [MainThread]: On master: Close
[0m11:26:46.327903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:46.328023 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:26:46.328154 [info ] [MainThread]: 
[0m11:26:46.328293 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m11:26:46.328590 [debug] [MainThread]: Command end result
[0m11:26:46.342496 [info ] [MainThread]: 
[0m11:26:46.342729 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:26:46.342873 [info ] [MainThread]: 
[0m11:26:46.343057 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name columns does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 10:     select * from moovai_data.listen_history.columns
                             ^
[0m11:26:46.343198 [info ] [MainThread]: 
[0m11:26:46.343336 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:26:46.344257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5153101, "process_user_time": 1.006344, "process_kernel_time": 0.11551, "process_mem_max_rss": "136429568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:26:46.344501 [debug] [MainThread]: Command `dbt run` failed at 11:26:46.344461 after 0.52 seconds
[0m11:26:46.344698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955f170>]}
[0m11:26:46.344868 [debug] [MainThread]: Flushing usage events
[0m11:28:42.278363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11069e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d46060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d45d30>]}


============================== 11:28:42.281316 | 895471d3-6b64-45cd-bc47-c9a4df7a4661 ==============================
[0m11:28:42.281316 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:28:42.281639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:42.471313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '895471d3-6b64-45cd-bc47-c9a4df7a4661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111daf0e0>]}
[0m11:28:42.494466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '895471d3-6b64-45cd-bc47-c9a4df7a4661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b291f0>]}
[0m11:28:42.496239 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:28:42.506629 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:28:42.570494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:28:42.570868 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:28:42.671112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '895471d3-6b64-45cd-bc47-c9a4df7a4661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120fbf80>]}
[0m11:28:42.719239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '895471d3-6b64-45cd-bc47-c9a4df7a4661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112151df0>]}
[0m11:28:42.719524 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:28:42.719699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '895471d3-6b64-45cd-bc47-c9a4df7a4661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231ed20>]}
[0m11:28:42.720561 [info ] [MainThread]: 
[0m11:28:42.720860 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:28:42.721379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:28:42.750629 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:28:42.750857 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:28:42.751001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:42.766821 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:28:42.768078 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:28:42.769615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:28:42.769875 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:28:42.773157 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:28:42.773332 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:28:42.773473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:42.776995 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:28:42.777826 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:28:42.777964 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:28:42.778128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:42.778252 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:28:42.778376 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:28:42.778952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:42.779345 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:28:42.779474 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:28:42.779588 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:28:42.779736 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:42.779861 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:28:42.782731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:28:42.785360 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:28:42.785516 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:28:42.785669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:42.788506 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:28:42.788681 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:28:42.788832 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:28:42.802070 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:28:42.802899 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:28:42.804022 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:28:42.804182 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:28:42.805757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '895471d3-6b64-45cd-bc47-c9a4df7a4661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b87a0>]}
[0m11:28:42.805995 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:42.806135 [debug] [MainThread]: On master: BEGIN
[0m11:28:42.806255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:42.809050 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:28:42.809216 [debug] [MainThread]: On master: COMMIT
[0m11:28:42.809348 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:42.809466 [debug] [MainThread]: On master: COMMIT
[0m11:28:42.809616 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:28:42.809742 [debug] [MainThread]: On master: Close
[0m11:28:42.810271 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:28:42.810467 [info ] [MainThread]: 
[0m11:28:42.811697 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:28:42.811978 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:28:42.812208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:28:42.812371 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:28:42.815906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:28:42.816573 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:28:42.831399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:28:42.832066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:28:42.832248 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:28:42.832398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:42.835637 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:28:42.835855 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:28:42.836017 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    --WHERE created_at = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:28:42.836316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:42.839503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:28:42.839686 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m11:28:42.840596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:42.842040 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:28:42.842204 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m11:28:42.842442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:42.850894 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:28:42.851089 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:28:42.851236 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:28:42.852243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:42.854615 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:28:42.854810 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m11:28:42.855117 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:42.856181 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:28:42.861964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '895471d3-6b64-45cd-bc47-c9a4df7a4661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11316af90>]}
[0m11:28:42.862266 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m11:28:42.862551 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:28:42.863096 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:42.863234 [debug] [MainThread]: On master: BEGIN
[0m11:28:42.863350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:42.866225 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:28:42.866395 [debug] [MainThread]: On master: COMMIT
[0m11:28:42.866522 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:42.866636 [debug] [MainThread]: On master: COMMIT
[0m11:28:42.866786 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:28:42.866913 [debug] [MainThread]: On master: Close
[0m11:28:42.867405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:42.867545 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:28:42.867685 [info ] [MainThread]: 
[0m11:28:42.867829 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:28:42.868118 [debug] [MainThread]: Command end result
[0m11:28:42.885894 [info ] [MainThread]: 
[0m11:28:42.886174 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:28:42.886313 [info ] [MainThread]: 
[0m11:28:42.886461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:28:42.888032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6423384, "process_user_time": 1.014261, "process_kernel_time": 0.152445, "process_mem_max_rss": "134463488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:28:42.888272 [debug] [MainThread]: Command `dbt run` succeeded at 11:28:42.888235 after 0.64 seconds
[0m11:28:42.888448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d45ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d45f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d46060>]}
[0m11:28:42.888622 [debug] [MainThread]: Flushing usage events
[0m11:33:35.953861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a009b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0ddc0>]}


============================== 11:33:35.956693 | d40e0a93-0798-436f-a1a6-f01dc02a7115 ==============================
[0m11:33:35.956693 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:33:35.957016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:36.145606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd40e0a93-0798-436f-a1a6-f01dc02a7115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a705f0>]}
[0m11:33:36.168799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd40e0a93-0798-436f-a1a6-f01dc02a7115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d64f20>]}
[0m11:33:36.170517 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:33:36.180347 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:33:36.242512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:36.242841 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:33:36.343616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd40e0a93-0798-436f-a1a6-f01dc02a7115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f421b0>]}
[0m11:33:36.389096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd40e0a93-0798-436f-a1a6-f01dc02a7115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4db80>]}
[0m11:33:36.389367 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:33:36.389538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40e0a93-0798-436f-a1a6-f01dc02a7115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e12bd0>]}
[0m11:33:36.390373 [info ] [MainThread]: 
[0m11:33:36.390645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:36.391114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:33:36.421952 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:33:36.422212 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:33:36.422365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:36.439603 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m11:33:36.440958 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:33:36.442590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:33:36.442814 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:33:36.446166 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:36.446351 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:33:36.446490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:36.450004 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:33:36.450803 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:36.450949 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:33:36.451125 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:36.451249 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:36.451375 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:33:36.451838 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:36.452236 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:33:36.452366 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:36.452485 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:33:36.452632 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:36.452759 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:33:36.455597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:33:36.458226 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:33:36.458381 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:33:36.458506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:36.461278 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:33:36.461441 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:33:36.461587 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:33:36.475392 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m11:33:36.476192 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:33:36.477201 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:33:36.477364 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:33:36.478916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40e0a93-0798-436f-a1a6-f01dc02a7115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a72b10>]}
[0m11:33:36.479143 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:36.479276 [debug] [MainThread]: On master: BEGIN
[0m11:33:36.479390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:36.482269 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:33:36.482444 [debug] [MainThread]: On master: COMMIT
[0m11:33:36.482610 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:36.482729 [debug] [MainThread]: On master: COMMIT
[0m11:33:36.482883 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:36.483010 [debug] [MainThread]: On master: Close
[0m11:33:36.483522 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:33:36.483673 [info ] [MainThread]: 
[0m11:33:36.484868 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:33:36.485133 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:33:36.485339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:33:36.485495 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:33:36.488904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:33:36.489969 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:33:36.505072 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:33:36.505941 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:36.506103 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:33:36.506241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:36.509253 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:33:36.509440 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:36.509605 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp, = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:33:36.513301 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp, = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:33:36.513510 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:33:36.513725 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m11:33:36.519240 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m11:33:36.519426 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:33:36.521111 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Parser Error: syntax error at or near ","
[0m11:33:36.521830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40e0a93-0798-436f-a1a6-f01dc02a7115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e16a0>]}
[0m11:33:36.522127 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m11:33:36.522407 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:33:36.523216 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:36.523357 [debug] [MainThread]: On master: BEGIN
[0m11:33:36.523471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:36.526308 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:33:36.526485 [debug] [MainThread]: On master: COMMIT
[0m11:33:36.526616 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:36.526728 [debug] [MainThread]: On master: COMMIT
[0m11:33:36.526874 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:36.527032 [debug] [MainThread]: On master: Close
[0m11:33:36.527556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:36.527691 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:33:36.527830 [info ] [MainThread]: 
[0m11:33:36.527970 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:33:36.528253 [debug] [MainThread]: Command end result
[0m11:33:36.545243 [info ] [MainThread]: 
[0m11:33:36.545479 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:33:36.545626 [info ] [MainThread]: 
[0m11:33:36.545802 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Parser Error: syntax error at or near ","
[0m11:33:36.545939 [info ] [MainThread]: 
[0m11:33:36.546087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:33:36.547718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6262728, "process_user_time": 0.990589, "process_kernel_time": 0.136811, "process_mem_max_rss": "131219456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:33:36.548064 [debug] [MainThread]: Command `dbt run` failed at 11:33:36.548020 after 0.63 seconds
[0m11:33:36.548272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a93a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a27e0>]}
[0m11:33:36.548449 [debug] [MainThread]: Flushing usage events
[0m11:33:58.531550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef1e80>]}


============================== 11:33:58.534654 | fbbf710e-6874-4864-b0ee-1eafc58ddbda ==============================
[0m11:33:58.534654 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:33:58.534967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_listen.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:33:58.707838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbbf710e-6874-4864-b0ee-1eafc58ddbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bff20>]}
[0m11:33:58.731203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbbf710e-6874-4864-b0ee-1eafc58ddbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c6de0>]}
[0m11:33:58.732885 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:33:58.742751 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:33:58.807355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:58.807704 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m11:33:58.907411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbbf710e-6874-4864-b0ee-1eafc58ddbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f68f20>]}
[0m11:33:58.950532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbbf710e-6874-4864-b0ee-1eafc58ddbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fd1c0>]}
[0m11:33:58.950805 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:33:58.950976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbbf710e-6874-4864-b0ee-1eafc58ddbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ee000>]}
[0m11:33:58.951820 [info ] [MainThread]: 
[0m11:33:58.952094 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:58.952569 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:33:58.979222 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:33:58.979450 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:33:58.979600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:58.994688 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:33:58.995919 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:33:58.997407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:33:58.997637 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:33:59.000884 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:59.001047 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:33:59.001179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:59.004504 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:33:59.005291 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:59.005432 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:33:59.005594 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:59.005716 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:59.005841 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:33:59.006450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:59.006843 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:33:59.006967 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:33:59.007078 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:33:59.007223 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:33:59.007352 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:33:59.010181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:33:59.012780 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:33:59.012938 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:33:59.013061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:59.015974 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:33:59.016143 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:33:59.016293 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:33:59.029398 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:33:59.030184 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:33:59.031300 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:33:59.031446 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:33:59.033033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbbf710e-6874-4864-b0ee-1eafc58ddbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067be570>]}
[0m11:33:59.033255 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:59.033377 [debug] [MainThread]: On master: BEGIN
[0m11:33:59.033491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:59.036290 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:33:59.036456 [debug] [MainThread]: On master: COMMIT
[0m11:33:59.036590 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:59.036706 [debug] [MainThread]: On master: COMMIT
[0m11:33:59.036861 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:59.036988 [debug] [MainThread]: On master: Close
[0m11:33:59.037486 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:33:59.037655 [info ] [MainThread]: 
[0m11:33:59.038844 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:33:59.039099 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m11:33:59.039294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:33:59.039448 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:33:59.042870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:33:59.043221 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:33:59.057710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:33:59.058120 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:59.058322 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:33:59.058482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:59.061691 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:33:59.061907 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:59.062070 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:33:59.063996 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:33:59.067163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:59.067347 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m11:33:59.068071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:59.069403 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:59.069618 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m11:33:59.069919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:59.078533 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:33:59.078746 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:59.078903 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:33:59.079797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:33:59.082071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:33:59.082250 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m11:33:59.082546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:33:59.083610 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:33:59.089333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbbf710e-6874-4864-b0ee-1eafc58ddbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105489730>]}
[0m11:33:59.089641 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m11:33:59.089920 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:33:59.090486 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:59.090628 [debug] [MainThread]: On master: BEGIN
[0m11:33:59.090742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:59.093603 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:33:59.093763 [debug] [MainThread]: On master: COMMIT
[0m11:33:59.093889 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:59.094003 [debug] [MainThread]: On master: COMMIT
[0m11:33:59.094156 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:33:59.094280 [debug] [MainThread]: On master: Close
[0m11:33:59.094788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:59.094924 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m11:33:59.095061 [info ] [MainThread]: 
[0m11:33:59.095208 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:33:59.095499 [debug] [MainThread]: Command end result
[0m11:33:59.114718 [info ] [MainThread]: 
[0m11:33:59.115023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:59.115174 [info ] [MainThread]: 
[0m11:33:59.115329 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:33:59.116983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61762077, "process_user_time": 1.007583, "process_kernel_time": 0.140717, "process_mem_max_rss": "137461760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:33:59.117230 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:59.117192 after 0.62 seconds
[0m11:33:59.117407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105960500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106385910>]}
[0m11:33:59.117561 [debug] [MainThread]: Flushing usage events
[0m11:35:48.771090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e05af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112809e80>]}


============================== 11:35:48.774159 | 50396e74-96a7-4862-bbef-0bc6adde970d ==============================
[0m11:35:48.774159 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:35:48.774473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_tracks.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:35:48.955616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50396e74-96a7-4862-bbef-0bc6adde970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128903e0>]}
[0m11:35:48.978978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50396e74-96a7-4862-bbef-0bc6adde970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd8b30>]}
[0m11:35:48.980746 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:35:48.991051 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:35:49.056494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:35:49.056853 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m11:35:49.157369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50396e74-96a7-4862-bbef-0bc6adde970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ac57c0>]}
[0m11:35:49.205684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50396e74-96a7-4862-bbef-0bc6adde970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113959040>]}
[0m11:35:49.205965 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:35:49.206139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50396e74-96a7-4862-bbef-0bc6adde970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1e780>]}
[0m11:35:49.206976 [info ] [MainThread]: 
[0m11:35:49.207251 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:35:49.207727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:35:49.236895 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:35:49.237122 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:35:49.237265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:49.252509 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:35:49.253759 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:35:49.255276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:35:49.255489 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:35:49.258682 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:35:49.258844 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:35:49.258976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:49.262195 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:35:49.263044 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:35:49.263187 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:35:49.263349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:49.263475 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:35:49.263595 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:35:49.264339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:35:49.264826 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:35:49.264973 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:35:49.265096 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:35:49.265266 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:35:49.265401 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:35:49.268228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:35:49.270839 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:35:49.270991 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:35:49.271114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:49.273925 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:35:49.274094 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:35:49.274241 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:35:49.287442 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:35:49.288247 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:35:49.289385 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:35:49.289552 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:35:49.291183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50396e74-96a7-4862-bbef-0bc6adde970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110387950>]}
[0m11:35:49.291424 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:49.291556 [debug] [MainThread]: On master: BEGIN
[0m11:35:49.291673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:49.294580 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:35:49.294754 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.294891 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:49.295041 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.295195 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:35:49.295329 [debug] [MainThread]: On master: Close
[0m11:35:49.295841 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:35:49.296002 [info ] [MainThread]: 
[0m11:35:49.297233 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m11:35:49.297488 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_tracks .................................... [RUN]
[0m11:35:49.297691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_tracks)
[0m11:35:49.297844 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m11:35:49.301249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m11:35:49.302578 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m11:35:49.317298 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m11:35:49.317788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:35:49.317959 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m11:35:49.318110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:49.321186 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:35:49.321385 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:35:49.321545 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m11:35:49.324012 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:35:49.327111 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:35:49.327294 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m11:35:49.327978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:49.329329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:35:49.329501 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m11:35:49.329760 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:49.338386 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:35:49.338602 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:35:49.338757 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:35:49.339832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:35:49.342346 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:35:49.342544 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m11:35:49.342875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:35:49.344003 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m11:35:49.349804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50396e74-96a7-4862-bbef-0bc6adde970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d6d760>]}
[0m11:35:49.350175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.05s]
[0m11:35:49.350475 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m11:35:49.351037 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:49.351188 [debug] [MainThread]: On master: BEGIN
[0m11:35:49.351305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:49.354255 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:35:49.354422 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.354553 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:49.354671 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.354820 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:35:49.354947 [debug] [MainThread]: On master: Close
[0m11:35:49.355439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:49.355556 [debug] [MainThread]: Connection 'model.dbt_project.src_tracks' was properly closed.
[0m11:35:49.355693 [info ] [MainThread]: 
[0m11:35:49.355832 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:35:49.356128 [debug] [MainThread]: Command end result
[0m11:35:49.377008 [info ] [MainThread]: 
[0m11:35:49.377317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:49.377475 [info ] [MainThread]: 
[0m11:35:49.377633 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:35:49.379114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6397617, "process_user_time": 1.005135, "process_kernel_time": 0.15907, "process_mem_max_rss": "137265152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:35:49.379386 [debug] [MainThread]: Command `dbt run` succeeded at 11:35:49.379345 after 0.64 seconds
[0m11:35:49.379573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ac6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba78f0>]}
[0m11:35:49.379739 [debug] [MainThread]: Flushing usage events
[0m11:43:08.745391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108529700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a546150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a545e80>]}


============================== 11:43:08.748534 | da425066-a4f0-4903-b244-256fbae9102e ==============================
[0m11:43:08.748534 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:43:08.748870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select src_tracks.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:08.937151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da425066-a4f0-4903-b244-256fbae9102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5460f0>]}
[0m11:43:08.960184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da425066-a4f0-4903-b244-256fbae9102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ac3b0>]}
[0m11:43:08.961991 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:43:08.971923 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:43:09.037326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:09.037571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:09.052448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da425066-a4f0-4903-b244-256fbae9102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ccf50>]}
[0m11:43:09.105382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da425066-a4f0-4903-b244-256fbae9102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9f410>]}
[0m11:43:09.105659 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:43:09.105831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da425066-a4f0-4903-b244-256fbae9102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1e3f0>]}
[0m11:43:09.106687 [info ] [MainThread]: 
[0m11:43:09.106966 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:43:09.107391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:43:09.136728 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:43:09.136963 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:43:09.137109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:09.152719 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:43:09.154024 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:43:09.155506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:43:09.155733 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:43:09.158950 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:43:09.159113 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:43:09.159249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:09.162498 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:43:09.163318 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:43:09.163459 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:43:09.163624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:43:09.163750 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:43:09.163873 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:43:09.164571 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:43:09.164973 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:43:09.165097 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:43:09.165209 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:43:09.165398 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:43:09.165523 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:43:09.168325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:43:09.170955 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:43:09.171106 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:43:09.171227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:09.173967 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:43:09.174117 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:43:09.174252 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:43:09.187691 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:43:09.188487 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:43:09.190347 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:43:09.190505 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:43:09.192100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da425066-a4f0-4903-b244-256fbae9102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187830>]}
[0m11:43:09.192319 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:09.192448 [debug] [MainThread]: On master: BEGIN
[0m11:43:09.192567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:09.195350 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:43:09.195513 [debug] [MainThread]: On master: COMMIT
[0m11:43:09.195640 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:09.195751 [debug] [MainThread]: On master: COMMIT
[0m11:43:09.195897 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:43:09.196022 [debug] [MainThread]: On master: Close
[0m11:43:09.196517 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:43:09.196661 [info ] [MainThread]: 
[0m11:43:09.197811 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m11:43:09.198057 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_tracks .................................... [RUN]
[0m11:43:09.198245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_tracks)
[0m11:43:09.198395 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m11:43:09.201896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m11:43:09.202825 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m11:43:09.217691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m11:43:09.218100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:43:09.218259 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m11:43:09.218403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:09.221385 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:43:09.221598 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:43:09.221763 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m11:43:09.223711 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:43:09.226828 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:43:09.227015 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m11:43:09.227745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:43:09.229098 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:43:09.229263 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m11:43:09.229492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:43:09.237242 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:43:09.237434 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:43:09.237583 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:43:09.238376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:43:09.240628 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:43:09.240803 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m11:43:09.241096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:43:09.242180 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m11:43:09.247952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da425066-a4f0-4903-b244-256fbae9102e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108126b70>]}
[0m11:43:09.248256 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.05s]
[0m11:43:09.248532 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m11:43:09.249072 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:09.249211 [debug] [MainThread]: On master: BEGIN
[0m11:43:09.249326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:09.252553 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:43:09.252774 [debug] [MainThread]: On master: COMMIT
[0m11:43:09.252898 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:09.253017 [debug] [MainThread]: On master: COMMIT
[0m11:43:09.253169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:43:09.253298 [debug] [MainThread]: On master: Close
[0m11:43:09.253877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:09.253999 [debug] [MainThread]: Connection 'model.dbt_project.src_tracks' was properly closed.
[0m11:43:09.254135 [info ] [MainThread]: 
[0m11:43:09.254282 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:43:09.254580 [debug] [MainThread]: Command end result
[0m11:43:09.272306 [info ] [MainThread]: 
[0m11:43:09.272547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:09.272695 [info ] [MainThread]: 
[0m11:43:09.272843 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:43:09.274414 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.56342775, "process_user_time": 0.923027, "process_kernel_time": 0.158158, "process_mem_max_rss": "131219456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:43:09.274684 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:09.274643 after 0.56 seconds
[0m11:43:09.274865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109693bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14b980>]}
[0m11:43:09.275019 [debug] [MainThread]: Flushing usage events
[0m11:44:47.282953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f96270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f95f70>]}


============================== 11:44:47.285994 | 914a1963-412f-43f4-8cd7-6f67018b9b4c ==============================
[0m11:44:47.285994 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:44:47.286302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_users.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:47.465898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '914a1963-412f-43f4-8cd7-6f67018b9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f6c30>]}
[0m11:44:47.489039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '914a1963-412f-43f4-8cd7-6f67018b9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105599d00>]}
[0m11:44:47.490763 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:44:47.500717 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:44:47.563531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:44:47.563875 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m11:44:47.663489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '914a1963-412f-43f4-8cd7-6f67018b9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f0cb0>]}
[0m11:44:47.711627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '914a1963-412f-43f4-8cd7-6f67018b9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f4a70>]}
[0m11:44:47.711909 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:44:47.712084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '914a1963-412f-43f4-8cd7-6f67018b9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106482630>]}
[0m11:44:47.712911 [info ] [MainThread]: 
[0m11:44:47.713183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:44:47.713644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:44:47.740340 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:44:47.740569 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:44:47.740750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:47.756421 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:44:47.757693 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:44:47.759200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:44:47.759423 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:44:47.762662 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:47.762838 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:44:47.762977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:47.766212 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:44:47.767037 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:47.767178 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:44:47.767339 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:47.767463 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:47.767587 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:44:47.768281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:47.768679 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:44:47.768806 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:47.768919 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:44:47.769066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:47.769190 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:44:47.771987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:44:47.774581 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:44:47.774737 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:44:47.774856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:47.777671 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:44:47.777835 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:44:47.777979 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:44:47.791238 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:44:47.792061 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:44:47.793153 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:44:47.793311 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:44:47.794862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '914a1963-412f-43f4-8cd7-6f67018b9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061aa900>]}
[0m11:44:47.795153 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:47.795297 [debug] [MainThread]: On master: BEGIN
[0m11:44:47.795424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:47.798364 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:44:47.798538 [debug] [MainThread]: On master: COMMIT
[0m11:44:47.798672 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:47.798789 [debug] [MainThread]: On master: COMMIT
[0m11:44:47.798947 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:47.799073 [debug] [MainThread]: On master: Close
[0m11:44:47.799608 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:44:47.799761 [info ] [MainThread]: 
[0m11:44:47.801146 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m11:44:47.801400 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_users ..................................... [RUN]
[0m11:44:47.801593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_users)
[0m11:44:47.801744 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m11:44:47.805115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m11:44:47.806059 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m11:44:47.820959 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m11:44:47.821411 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:47.821572 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m11:44:47.821718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:47.824728 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:47.824933 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:47.825091 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    --

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m11:44:47.826937 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:47.830083 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:47.830264 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m11:44:47.830979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:47.832227 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:47.832429 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m11:44:47.832673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:47.841008 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:44:47.841195 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:47.841346 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:44:47.842224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:47.844467 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:47.844644 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m11:44:47.844942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:47.845983 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m11:44:47.851832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914a1963-412f-43f4-8cd7-6f67018b9b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d820>]}
[0m11:44:47.852141 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.05s]
[0m11:44:47.852419 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m11:44:47.852966 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:47.853114 [debug] [MainThread]: On master: BEGIN
[0m11:44:47.853228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:47.856430 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:44:47.856658 [debug] [MainThread]: On master: COMMIT
[0m11:44:47.856792 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:47.856909 [debug] [MainThread]: On master: COMMIT
[0m11:44:47.857064 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:47.857193 [debug] [MainThread]: On master: Close
[0m11:44:47.857766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:47.857904 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m11:44:47.858046 [info ] [MainThread]: 
[0m11:44:47.858192 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:44:47.858495 [debug] [MainThread]: Command end result
[0m11:44:47.878240 [info ] [MainThread]: 
[0m11:44:47.878487 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:47.878641 [info ] [MainThread]: 
[0m11:44:47.878796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:44:47.880390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6294625, "process_user_time": 1.003278, "process_kernel_time": 0.141796, "process_mem_max_rss": "135643136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:44:47.880749 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:47.880700 after 0.63 seconds
[0m11:44:47.880954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f961e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063db5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dba70>]}
[0m11:44:47.881121 [debug] [MainThread]: Flushing usage events
[0m11:44:51.679621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108215700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880df70>]}


============================== 11:44:51.681796 | b43a75d5-7210-4430-9a9c-268f3faf9c0b ==============================
[0m11:44:51.681796 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:44:51.682115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:51.792947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882c050>]}
[0m11:44:51.816022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a87560>]}
[0m11:44:51.817320 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:44:51.826509 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:44:51.872150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:51.872381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:51.886973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8b8f0>]}
[0m11:44:51.931107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce9880>]}
[0m11:44:51.931385 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:44:51.931563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8a210>]}
[0m11:44:51.932533 [info ] [MainThread]: 
[0m11:44:51.932817 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:44:51.935255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:44:51.962207 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:44:51.962461 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:44:51.962622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:51.966592 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:44:51.967320 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:44:51.968112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:44:51.968323 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:44:51.971567 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:51.971739 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:44:51.971873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:51.974866 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:44:51.975521 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:51.975666 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:44:51.975830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:51.975948 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:51.976063 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:44:51.976282 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:51.976657 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:44:51.976780 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:44:51.976891 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:44:51.977039 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:51.977161 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:44:51.978182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:44:51.980768 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:44:51.980934 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:44:51.981059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:51.983892 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:44:51.984062 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:44:51.984208 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:44:51.995001 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:44:51.995801 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:44:51.996470 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:44:51.996614 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:44:51.998095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f91820>]}
[0m11:44:51.998304 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:51.998428 [debug] [MainThread]: On master: BEGIN
[0m11:44:51.998541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:52.001457 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:44:52.001623 [debug] [MainThread]: On master: COMMIT
[0m11:44:52.001748 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:52.001866 [debug] [MainThread]: On master: COMMIT
[0m11:44:52.002021 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:52.002147 [debug] [MainThread]: On master: Close
[0m11:44:52.002697 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:44:52.002886 [info ] [MainThread]: 
[0m11:44:52.004727 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:44:52.004989 [info ] [Thread-1 (]: 1 of 9 START sql view model main.src_listen .................................... [RUN]
[0m11:44:52.005197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m11:44:52.005350 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:44:52.008706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:44:52.009430 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:44:52.025117 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:44:52.025622 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:44:52.025795 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:44:52.025940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:52.028993 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:52.029193 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:44:52.029369 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:44:52.029811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.033116 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:44:52.033310 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m11:44:52.033566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.034904 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:44:52.035065 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m11:44:52.035281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.043083 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:44:52.043274 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:44:52.043428 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:44:52.043889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.046135 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:44:52.046310 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m11:44:52.046636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.047727 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:44:52.052206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109080c50>]}
[0m11:44:52.052515 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m11:44:52.052791 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:44:52.052989 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m11:44:52.053259 [info ] [Thread-1 (]: 2 of 9 START sql view model main.src_tracks .................................... [RUN]
[0m11:44:52.053451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m11:44:52.053604 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m11:44:52.054822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m11:44:52.055117 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m11:44:52.056615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m11:44:52.056877 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:44:52.057021 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m11:44:52.057160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:52.060177 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:52.060410 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:44:52.060576 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m11:44:52.061036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.062638 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:44:52.062872 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m11:44:52.063130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.064344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:44:52.064502 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m11:44:52.064713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.066270 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:44:52.066427 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:44:52.066574 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:44:52.066989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.068037 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:44:52.068188 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m11:44:52.068444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.069048 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m11:44:52.073041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936d430>]}
[0m11:44:52.073369 [info ] [Thread-1 (]: 2 of 9 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m11:44:52.073641 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m11:44:52.073827 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m11:44:52.074119 [info ] [Thread-1 (]: 3 of 9 START sql view model main.src_users ..................................... [RUN]
[0m11:44:52.074351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m11:44:52.074530 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m11:44:52.075825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m11:44:52.076136 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m11:44:52.077698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m11:44:52.077971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:52.078129 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m11:44:52.078273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:52.081296 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:52.081503 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:52.081692 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    --

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m11:44:52.082055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.083680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:52.083855 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m11:44:52.084097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.085329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:52.085481 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m11:44:52.085689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.086453 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:44:52.086596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:52.086727 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:44:52.087132 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.088062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:44:52.088206 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m11:44:52.088468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:52.089132 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m11:44:52.093114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10905e1b0>]}
[0m11:44:52.093401 [info ] [Thread-1 (]: 3 of 9 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m11:44:52.093656 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m11:44:52.093834 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m11:44:52.094119 [info ] [Thread-1 (]: 4 of 9 START sql view model main.int_listen .................................... [RUN]
[0m11:44:52.094347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_listen)
[0m11:44:52.094521 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m11:44:52.095945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m11:44:52.096712 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m11:44:52.098249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m11:44:52.098533 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:44:52.098684 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m11:44:52.098825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:52.101775 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:52.101966 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:44:52.102125 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
  );

[0m11:44:52.104358 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
  );

[0m11:44:52.104530 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:44:52.104727 [debug] [Thread-1 (]: On model.dbt_project.int_listen: ROLLBACK
[0m11:44:52.110677 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_listen'
[0m11:44:52.110882 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m11:44:52.112650 [debug] [Thread-1 (]: Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:44:52.112866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109069df0>]}
[0m11:44:52.113154 [error] [Thread-1 (]: 4 of 9 ERROR creating sql view model main.int_listen ........................... [[31mERROR[0m in 0.02s]
[0m11:44:52.113412 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m11:44:52.113592 [debug] [Thread-1 (]: Began running node model.dbt_project.int_tracks
[0m11:44:52.114160 [info ] [Thread-1 (]: 5 of 9 START sql view model main.int_tracks .................................... [RUN]
[0m11:44:52.114376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_listen, now model.dbt_project.int_tracks)
[0m11:44:52.114542 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_tracks
[0m11:44:52.116052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_tracks"
[0m11:44:52.116731 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_tracks
[0m11:44:52.118216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_tracks"
[0m11:44:52.118517 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m11:44:52.118671 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: BEGIN
[0m11:44:52.118813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:52.121779 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:52.121964 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_tracks"
[0m11:44:52.122122 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */

  
  create view "moovai_data"."main"."int_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m11:44:52.122397 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_tracks"} */

  
  create view "moovai_data"."main"."int_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m11:44:52.122543 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:44:52.122722 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: ROLLBACK
[0m11:44:52.124196 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_tracks'
[0m11:44:52.124374 [debug] [Thread-1 (]: On model.dbt_project.int_tracks: Close
[0m11:44:52.125977 [debug] [Thread-1 (]: Runtime Error in model int_tracks (dbt_project/models/02_intermediate_layer/int_tracks.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:44:52.126179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f5a30>]}
[0m11:44:52.126450 [error] [Thread-1 (]: 5 of 9 ERROR creating sql view model main.int_tracks ........................... [[31mERROR[0m in 0.01s]
[0m11:44:52.126703 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_tracks
[0m11:44:52.126881 [debug] [Thread-1 (]: Began running node model.dbt_project.int_users
[0m11:44:52.127166 [info ] [Thread-1 (]: 6 of 9 START sql view model main.int_users ..................................... [RUN]
[0m11:44:52.127364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_tracks, now model.dbt_project.int_users)
[0m11:44:52.127519 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_users
[0m11:44:52.128857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_users"
[0m11:44:52.129182 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_users
[0m11:44:52.131628 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_users"
[0m11:44:52.132043 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m11:44:52.132205 [debug] [Thread-1 (]: On model.dbt_project.int_users: BEGIN
[0m11:44:52.132346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:52.135320 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:52.135507 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_users"
[0m11:44:52.135668 [debug] [Thread-1 (]: On model.dbt_project.int_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */

  
  create view "moovai_data"."main"."int_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

INSERT INTO int_users
select *
from cte_src_users
  );

[0m11:44:52.135948 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_users"} */

  
  create view "moovai_data"."main"."int_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

INSERT INTO int_users
select *
from cte_src_users
  );

[0m11:44:52.136095 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:44:52.136274 [debug] [Thread-1 (]: On model.dbt_project.int_users: ROLLBACK
[0m11:44:52.137741 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_users'
[0m11:44:52.137891 [debug] [Thread-1 (]: On model.dbt_project.int_users: Close
[0m11:44:52.139440 [debug] [Thread-1 (]: Runtime Error in model int_users (dbt_project/models/02_intermediate_layer/int_users.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:44:52.139697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43a75d5-7210-4430-9a9c-268f3faf9c0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f71a0>]}
[0m11:44:52.140058 [error] [Thread-1 (]: 6 of 9 ERROR creating sql view model main.int_users ............................ [[31mERROR[0m in 0.01s]
[0m11:44:52.140322 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_users
[0m11:44:52.140504 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m11:44:52.140757 [info ] [Thread-1 (]: 7 of 9 SKIP relation main.mart_listen .......................................... [[33mSKIP[0m]
[0m11:44:52.140951 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m11:44:52.141105 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m11:44:52.141266 [info ] [Thread-1 (]: 8 of 9 SKIP relation main.mart_tracks .......................................... [[33mSKIP[0m]
[0m11:44:52.141428 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m11:44:52.141580 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m11:44:52.141735 [info ] [Thread-1 (]: 9 of 9 SKIP relation main.mart_users ........................................... [[33mSKIP[0m]
[0m11:44:52.141892 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m11:44:52.142386 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:52.142533 [debug] [MainThread]: On master: BEGIN
[0m11:44:52.142650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:52.145489 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:44:52.145666 [debug] [MainThread]: On master: COMMIT
[0m11:44:52.145791 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:52.145902 [debug] [MainThread]: On master: COMMIT
[0m11:44:52.146051 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:52.146171 [debug] [MainThread]: On master: Close
[0m11:44:52.146674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:52.146803 [debug] [MainThread]: Connection 'model.dbt_project.int_users' was properly closed.
[0m11:44:52.146970 [info ] [MainThread]: 
[0m11:44:52.147115 [info ] [MainThread]: Finished running 6 view models, 3 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m11:44:52.147691 [debug] [MainThread]: Command end result
[0m11:44:52.165411 [info ] [MainThread]: 
[0m11:44:52.165665 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:44:52.165808 [info ] [MainThread]: 
[0m11:44:52.165991 [error] [MainThread]:   Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:44:52.166125 [info ] [MainThread]: 
[0m11:44:52.166274 [error] [MainThread]:   Runtime Error in model int_tracks (dbt_project/models/02_intermediate_layer/int_tracks.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:44:52.166394 [info ] [MainThread]: 
[0m11:44:52.166538 [error] [MainThread]:   Runtime Error in model int_users (dbt_project/models/02_intermediate_layer/int_users.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:44:52.166660 [info ] [MainThread]: 
[0m11:44:52.166795 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=3 TOTAL=9
[0m11:44:52.167547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5154516, "process_user_time": 0.996043, "process_kernel_time": 0.111382, "process_mem_max_rss": "136708096", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:44:52.167779 [debug] [MainThread]: Command `dbt run` failed at 11:44:52.167739 after 0.52 seconds
[0m11:44:52.167957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea5a60>]}
[0m11:44:52.168108 [debug] [MainThread]: Flushing usage events
[0m11:45:25.103523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fdd90>]}


============================== 11:45:25.106541 | efc412e0-d359-410e-a9a5-b6478c101eb0 ==============================
[0m11:45:25.106541 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:45:25.107142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select int_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:45:25.287133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc412e0-d359-410e-a9a5-b6478c101eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fdfd0>]}
[0m11:45:25.310125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc412e0-d359-410e-a9a5-b6478c101eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891c1a0>]}
[0m11:45:25.311952 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:45:25.321734 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:45:25.386713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:25.386962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:25.401835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efc412e0-d359-410e-a9a5-b6478c101eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b934d0>]}
[0m11:45:25.470043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efc412e0-d359-410e-a9a5-b6478c101eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8daf0>]}
[0m11:45:25.470345 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:45:25.470528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc412e0-d359-410e-a9a5-b6478c101eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cee390>]}
[0m11:45:25.471459 [info ] [MainThread]: 
[0m11:45:25.471748 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:45:25.472175 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:45:25.499432 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:45:25.499673 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:45:25.499827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:25.515301 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:45:25.516564 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:45:25.518030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:45:25.518252 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:45:25.521478 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:45:25.521642 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:45:25.521805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:25.525080 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:45:25.525924 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:45:25.526063 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:45:25.526228 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:25.526358 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:45:25.526482 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:45:25.527199 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:45:25.527603 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:45:25.527732 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:45:25.527842 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:45:25.527988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:45:25.528115 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:45:25.530889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:45:25.533508 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:45:25.533668 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:45:25.533793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:25.536709 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:45:25.536905 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:45:25.537061 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:45:25.550120 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:45:25.550927 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:45:25.552797 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:45:25.552952 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:45:25.554517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc412e0-d359-410e-a9a5-b6478c101eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3f7d0>]}
[0m11:45:25.554783 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:25.554934 [debug] [MainThread]: On master: BEGIN
[0m11:45:25.555055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:25.557982 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:45:25.558154 [debug] [MainThread]: On master: COMMIT
[0m11:45:25.558288 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:25.558411 [debug] [MainThread]: On master: COMMIT
[0m11:45:25.558601 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:45:25.558748 [debug] [MainThread]: On master: Close
[0m11:45:25.559242 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:45:25.559393 [info ] [MainThread]: 
[0m11:45:25.560541 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m11:45:25.560794 [info ] [Thread-1 (]: 1 of 1 START sql view model main.int_listen .................................... [RUN]
[0m11:45:25.560992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.int_listen)
[0m11:45:25.561179 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m11:45:25.564742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m11:45:25.565541 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m11:45:25.580120 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m11:45:25.580470 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:45:25.580629 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m11:45:25.580774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:25.583715 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:45:25.583946 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:45:25.584116 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
  );

[0m11:45:25.587559 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
  create view "moovai_data"."main"."int_listen__dbt_tmp" as (
    

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
  );

[0m11:45:25.587752 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:45:25.587965 [debug] [Thread-1 (]: On model.dbt_project.int_listen: ROLLBACK
[0m11:45:25.593527 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_listen'
[0m11:45:25.593714 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m11:45:25.595442 [debug] [Thread-1 (]: Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:45:25.596398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc412e0-d359-410e-a9a5-b6478c101eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d57320>]}
[0m11:45:25.596735 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.int_listen ........................... [[31mERROR[0m in 0.03s]
[0m11:45:25.597034 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m11:45:25.597852 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:25.598004 [debug] [MainThread]: On master: BEGIN
[0m11:45:25.598121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:25.601003 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:45:25.601181 [debug] [MainThread]: On master: COMMIT
[0m11:45:25.601318 [debug] [MainThread]: Using duckdb connection "master"
[0m11:45:25.601429 [debug] [MainThread]: On master: COMMIT
[0m11:45:25.601589 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:45:25.601715 [debug] [MainThread]: On master: Close
[0m11:45:25.602240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:25.602379 [debug] [MainThread]: Connection 'model.dbt_project.int_listen' was properly closed.
[0m11:45:25.602521 [info ] [MainThread]: 
[0m11:45:25.602663 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m11:45:25.602948 [debug] [MainThread]: Command end result
[0m11:45:25.621072 [info ] [MainThread]: 
[0m11:45:25.621368 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:45:25.621516 [info ] [MainThread]: 
[0m11:45:25.621697 [error] [MainThread]:   Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:45:25.621847 [info ] [MainThread]: 
[0m11:45:25.621984 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:45:25.623521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.55277306, "process_user_time": 0.909907, "process_kernel_time": 0.141948, "process_mem_max_rss": "133365760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:45:25.623784 [debug] [MainThread]: Command `dbt run` failed at 11:45:25.623742 after 0.55 seconds
[0m11:45:25.623985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107305970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931ffb0>]}
[0m11:45:25.624157 [debug] [MainThread]: Flushing usage events
[0m11:46:38.476611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d87650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b09fa0>]}


============================== 11:46:38.479585 | f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e ==============================
[0m11:46:38.479585 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:46:38.479901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select int_listen.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:38.661154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0bd10>]}
[0m11:46:38.684397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10393cad0>]}
[0m11:46:38.686156 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:46:38.695608 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:46:38.759907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:46:38.760271 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m11:46:38.864960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8f740>]}
[0m11:46:38.917603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c050a0>]}
[0m11:46:38.917884 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:46:38.918060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ff530>]}
[0m11:46:38.918926 [info ] [MainThread]: 
[0m11:46:38.919199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:46:38.919658 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:46:38.949359 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:46:38.949601 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:46:38.949746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:38.965248 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:46:38.966511 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:46:38.967915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:46:38.968141 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:46:38.971497 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:38.971673 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:46:38.971806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:38.975055 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:46:38.975960 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:38.976104 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:46:38.976268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:38.976393 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:38.976517 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:46:38.977310 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:46:38.977807 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:46:38.977957 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:38.978085 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:46:38.978256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:38.978396 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:46:38.981267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:46:38.983893 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:46:38.984046 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:46:38.984169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:38.986952 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:46:38.987102 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:46:38.987238 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:46:39.000919 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:46:39.001726 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:46:39.002837 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:46:39.003000 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:46:39.004531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ff530>]}
[0m11:46:39.004754 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:39.004881 [debug] [MainThread]: On master: BEGIN
[0m11:46:39.004995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:39.007872 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:46:39.008039 [debug] [MainThread]: On master: COMMIT
[0m11:46:39.008174 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:39.008291 [debug] [MainThread]: On master: COMMIT
[0m11:46:39.008445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:39.008571 [debug] [MainThread]: On master: Close
[0m11:46:39.009066 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:46:39.009209 [info ] [MainThread]: 
[0m11:46:39.010391 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m11:46:39.010642 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_listen ................................... [RUN]
[0m11:46:39.010832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.int_listen)
[0m11:46:39.010984 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m11:46:39.014630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m11:46:39.015319 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m11:46:39.031057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m11:46:39.031469 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:39.031626 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m11:46:39.031769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:39.034925 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:46:39.035162 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:39.035341 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
[0m11:46:39.038506 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
[0m11:46:39.038700 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:46:39.038911 [debug] [Thread-1 (]: On model.dbt_project.int_listen: ROLLBACK
[0m11:46:39.044617 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_listen'
[0m11:46:39.044782 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m11:46:39.046422 [debug] [Thread-1 (]: Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:46:39.047117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2bc2eb8-6adf-4c4f-8bdb-130f82020a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7c20>]}
[0m11:46:39.047448 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.int_listen .......................... [[31mERROR[0m in 0.04s]
[0m11:46:39.047726 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m11:46:39.048514 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:39.048656 [debug] [MainThread]: On master: BEGIN
[0m11:46:39.048770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:39.051627 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:46:39.051796 [debug] [MainThread]: On master: COMMIT
[0m11:46:39.051920 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:39.052030 [debug] [MainThread]: On master: COMMIT
[0m11:46:39.052179 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:39.052303 [debug] [MainThread]: On master: Close
[0m11:46:39.052799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:39.052958 [debug] [MainThread]: Connection 'model.dbt_project.int_listen' was properly closed.
[0m11:46:39.053104 [info ] [MainThread]: 
[0m11:46:39.053252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m11:46:39.053550 [debug] [MainThread]: Command end result
[0m11:46:39.073304 [info ] [MainThread]: 
[0m11:46:39.073573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:46:39.073718 [info ] [MainThread]: 
[0m11:46:39.073905 [error] [MainThread]:   Runtime Error in model int_listen (dbt_project/models/02_intermediate_layer/int_listen.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:46:39.074047 [info ] [MainThread]: 
[0m11:46:39.074190 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:46:39.075838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.63155043, "process_user_time": 0.991245, "process_kernel_time": 0.15466, "process_mem_max_rss": "136298496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:46:39.076182 [debug] [MainThread]: Command `dbt run` failed at 11:46:39.076128 after 0.63 seconds
[0m11:46:39.076400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104921700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0a2a0>]}
[0m11:46:39.076624 [debug] [MainThread]: Flushing usage events
[0m11:46:45.645635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b09490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de6030>]}


============================== 11:46:45.648277 | ee6ae098-eba1-4187-92b6-6397046df93d ==============================
[0m11:46:45.648277 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:46:45.648577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select int_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:46:45.762541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee6ae098-eba1-4187-92b6-6397046df93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eef980>]}
[0m11:46:45.785518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee6ae098-eba1-4187-92b6-6397046df93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c29a90>]}
[0m11:46:45.787851 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:46:45.796427 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:46:45.857074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:46:45.857456 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m11:46:45.957124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee6ae098-eba1-4187-92b6-6397046df93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8a9f0>]}
[0m11:46:46.001919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee6ae098-eba1-4187-92b6-6397046df93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f4d10>]}
[0m11:46:46.002207 [info ] [MainThread]: Found 9 models, 3 sources, 416 macros
[0m11:46:46.002384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6ae098-eba1-4187-92b6-6397046df93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa6d20>]}
[0m11:46:46.003267 [info ] [MainThread]: 
[0m11:46:46.003541 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:46:46.004030 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:46:46.031396 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:46:46.031621 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:46:46.031766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:46.036011 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:46:46.036764 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:46:46.037578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:46:46.037812 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:46:46.041167 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:46.041339 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:46:46.041478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:46.044447 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:46:46.045108 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:46.045245 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:46:46.045410 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:46.045540 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:46.045665 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:46:46.045882 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:46.046283 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:46:46.046410 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:46:46.046522 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:46:46.046669 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:46.046797 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:46:46.049567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:46:46.052175 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:46:46.052337 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:46:46.052461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:46.055188 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:46:46.055341 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:46:46.055478 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:46:46.066025 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:46:46.066808 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:46:46.067966 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:46:46.068141 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:46:46.069702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6ae098-eba1-4187-92b6-6397046df93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920dee0>]}
[0m11:46:46.069924 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:46.070053 [debug] [MainThread]: On master: BEGIN
[0m11:46:46.070171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:46.072924 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:46:46.073081 [debug] [MainThread]: On master: COMMIT
[0m11:46:46.073203 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:46.073329 [debug] [MainThread]: On master: COMMIT
[0m11:46:46.073481 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:46.073602 [debug] [MainThread]: On master: Close
[0m11:46:46.074101 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:46:46.074252 [info ] [MainThread]: 
[0m11:46:46.075453 [debug] [Thread-1 (]: Began running node model.dbt_project.int_listen
[0m11:46:46.075718 [info ] [Thread-1 (]: 1 of 1 START sql table model main.int_listen ................................... [RUN]
[0m11:46:46.075934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.int_listen)
[0m11:46:46.076109 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_listen
[0m11:46:46.079637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_listen"
[0m11:46:46.079979 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_listen
[0m11:46:46.095645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_listen"
[0m11:46:46.096155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:46.096319 [debug] [Thread-1 (]: On model.dbt_project.int_listen: BEGIN
[0m11:46:46.096462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:46.099480 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:46:46.099671 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:46.099840 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
[0m11:46:46.102417 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:46:46.105486 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:46.105678 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter view "moovai_data"."main"."int_listen" rename to "int_listen__dbt_backup"
[0m11:46:46.106519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:46.107824 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:46.107987 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
alter table "moovai_data"."main"."int_listen__dbt_tmp" rename to "int_listen"
[0m11:46:46.108222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:46.118161 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m11:46:46.118354 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:46.118510 [debug] [Thread-1 (]: On model.dbt_project.int_listen: COMMIT
[0m11:46:46.119343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:46:46.121648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_listen"
[0m11:46:46.121823 [debug] [Thread-1 (]: On model.dbt_project.int_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_listen"} */
drop view if exists "moovai_data"."main"."int_listen__dbt_backup" cascade
[0m11:46:46.122115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:46.123180 [debug] [Thread-1 (]: On model.dbt_project.int_listen: Close
[0m11:46:46.128836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6ae098-eba1-4187-92b6-6397046df93d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bae40>]}
[0m11:46:46.129148 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.int_listen .............................. [[32mOK[0m in 0.05s]
[0m11:46:46.129423 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_listen
[0m11:46:46.129951 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:46.130114 [debug] [MainThread]: On master: BEGIN
[0m11:46:46.130239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:46.133213 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:46:46.133444 [debug] [MainThread]: On master: COMMIT
[0m11:46:46.133594 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:46.133726 [debug] [MainThread]: On master: COMMIT
[0m11:46:46.133943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:46.134104 [debug] [MainThread]: On master: Close
[0m11:46:46.134826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:46.134987 [debug] [MainThread]: Connection 'model.dbt_project.int_listen' was properly closed.
[0m11:46:46.135142 [info ] [MainThread]: 
[0m11:46:46.135289 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m11:46:46.135594 [debug] [MainThread]: Command end result
[0m11:46:46.151665 [info ] [MainThread]: 
[0m11:46:46.151928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:46.152085 [info ] [MainThread]: 
[0m11:46:46.152236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:46:46.153319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.53613585, "process_user_time": 1.009785, "process_kernel_time": 0.132744, "process_mem_max_rss": "135725056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:46:46.153638 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:46.153590 after 0.54 seconds
[0m11:46:46.153867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108848110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d059a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096972f0>]}
[0m11:46:46.154055 [debug] [MainThread]: Flushing usage events
[0m11:58:03.622673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c62180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c61e80>]}


============================== 11:58:03.625885 | a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde ==============================
[0m11:58:03.625885 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:58:03.626214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:58:03.805593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccad80>]}
[0m11:58:03.828494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccad80>]}
[0m11:58:03.830291 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:58:03.840576 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:58:03.904282 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 4 files added, 4 files changed.
[0m11:58:03.904597 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_fact_listen.sql
[0m11:58:03.904756 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_dim_tracks.sql
[0m11:58:03.904892 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/02_intermediate_layer/int_dim_users.sql
[0m11:58:03.905023 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql
[0m11:58:03.905171 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/02_intermediate_layer/int_tracks.sql
[0m11:58:03.905322 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/02_intermediate_layer/int_listen.sql
[0m11:58:03.905494 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/02_intermediate_layer/int_users.sql
[0m11:58:03.905632 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_listen.sql
[0m11:58:03.905785 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m11:58:03.905914 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_users.sql
[0m11:58:03.906039 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_tracks.sql
[0m11:58:04.015149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105102cc0>]}
[0m11:58:04.071074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef5df0>]}
[0m11:58:04.071355 [info ] [MainThread]: Found 10 models, 3 sources, 416 macros
[0m11:58:04.071529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e50bc0>]}
[0m11:58:04.072492 [info ] [MainThread]: 
[0m11:58:04.072778 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:04.075095 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:58:04.104349 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:58:04.104577 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:58:04.104723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:04.120328 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:58:04.121579 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:58:04.123118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:58:04.123334 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:58:04.126537 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:04.126703 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:58:04.126835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:04.130015 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:58:04.130845 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:04.130987 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:58:04.131148 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:04.131271 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:04.131397 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:58:04.132080 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:58:04.132484 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:58:04.132645 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:04.132757 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:58:04.132903 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:04.133027 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:58:04.134116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:58:04.136721 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:58:04.136886 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:58:04.137013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:04.139912 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:58:04.140092 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:58:04.140244 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:58:04.153332 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:58:04.154164 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:58:04.155225 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:58:04.155390 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:58:04.156936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef5e50>]}
[0m11:58:04.157190 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:04.157330 [debug] [MainThread]: On master: BEGIN
[0m11:58:04.157456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:04.160199 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:58:04.160369 [debug] [MainThread]: On master: COMMIT
[0m11:58:04.160504 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:04.160622 [debug] [MainThread]: On master: COMMIT
[0m11:58:04.160775 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:04.160901 [debug] [MainThread]: On master: Close
[0m11:58:04.161377 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:58:04.161526 [info ] [MainThread]: 
[0m11:58:04.162834 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m11:58:04.163104 [info ] [Thread-1 (]: 1 of 10 START sql view model main.mart_listen_and_tracks ....................... [RUN]
[0m11:58:04.163305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen_and_tracks)
[0m11:58:04.163471 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m11:58:04.166400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m11:58:04.166976 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m11:58:04.181930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m11:58:04.182596 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m11:58:04.182758 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m11:58:04.182899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.185809 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.185997 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m11:58:04.186328 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
  create view "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" as (
    SELECT *
FROM
  );

[0m11:58:04.190033 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
  create view "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" as (
    SELECT *
FROM
  );

[0m11:58:04.190241 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:58:04.190461 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: ROLLBACK
[0m11:58:04.195919 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.mart_listen_and_tracks'
[0m11:58:04.196099 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m11:58:04.197787 [debug] [Thread-1 (]: Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near ")"
[0m11:58:04.198477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041fd700>]}
[0m11:58:04.198783 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model main.mart_listen_and_tracks .............. [[31mERROR[0m in 0.03s]
[0m11:58:04.199068 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m11:58:04.199259 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:58:04.199914 [info ] [Thread-1 (]: 2 of 10 START sql view model main.src_listen ................................... [RUN]
[0m11:58:04.200132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.src_listen)
[0m11:58:04.200306 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:58:04.201510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:58:04.202561 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:58:04.205154 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:58:04.205796 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:04.205961 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:58:04.206099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.209313 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.209514 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:04.209673 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:58:04.210228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.213396 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:04.213585 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m11:58:04.214331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:04.215687 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:04.215851 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m11:58:04.216114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.223869 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:58:04.224058 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:04.224206 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:58:04.224994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:04.227245 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:04.227437 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m11:58:04.227734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.228781 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:58:04.235008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103536cf0>]}
[0m11:58:04.235311 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main.src_listen .............................. [[32mOK[0m in 0.03s]
[0m11:58:04.235576 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:58:04.235759 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m11:58:04.236020 [info ] [Thread-1 (]: 3 of 10 START sql view model main.src_tracks ................................... [RUN]
[0m11:58:04.236206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m11:58:04.236363 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m11:58:04.237642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m11:58:04.238236 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m11:58:04.239681 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m11:58:04.239962 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:04.240111 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m11:58:04.240250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.243212 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.243403 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:04.243562 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m11:58:04.243903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.245337 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:04.245505 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m11:58:04.245738 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.247010 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:04.247167 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m11:58:04.247402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.248075 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:58:04.248225 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:04.248357 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:58:04.248740 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.249802 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:04.249961 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m11:58:04.250226 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.250831 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m11:58:04.255594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c61b20>]}
[0m11:58:04.255918 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main.src_tracks .............................. [[32mOK[0m in 0.02s]
[0m11:58:04.256173 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m11:58:04.256351 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m11:58:04.256610 [info ] [Thread-1 (]: 4 of 10 START sql view model main.src_users .................................... [RUN]
[0m11:58:04.256791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m11:58:04.256939 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m11:58:04.258194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m11:58:04.258500 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m11:58:04.259938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m11:58:04.260220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:04.260368 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m11:58:04.260506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.263398 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.263579 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:04.263740 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m11:58:04.264056 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.266257 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:04.266418 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m11:58:04.266647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.267991 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:04.268164 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m11:58:04.268433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.269107 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:58:04.269252 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:04.269383 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:58:04.269969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.271002 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:04.271158 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m11:58:04.271427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.272010 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m11:58:04.276483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d3530>]}
[0m11:58:04.276764 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main.src_users ............................... [[32mOK[0m in 0.02s]
[0m11:58:04.277012 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m11:58:04.277189 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m11:58:04.277493 [info ] [Thread-1 (]: 5 of 10 START sql table model main.int_fact_listen ............................. [RUN]
[0m11:58:04.277686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m11:58:04.277843 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m11:58:04.279389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m11:58:04.279815 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m11:58:04.289187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m11:58:04.289581 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:04.289748 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m11:58:04.289893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.292923 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.293129 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:04.293302 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_fact_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
[0m11:58:04.294790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:04.296246 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:04.296412 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen__dbt_tmp" rename to "int_fact_listen"
[0m11:58:04.296650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.299001 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m11:58:04.299173 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:04.299318 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m11:58:04.299697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.300712 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:04.300868 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
drop table if exists "moovai_data"."main"."int_fact_listen__dbt_backup" cascade
[0m11:58:04.301076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.301687 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m11:58:04.306029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105680230>]}
[0m11:58:04.306361 [info ] [Thread-1 (]: 5 of 10 OK created sql table model main.int_fact_listen ........................ [[32mOK[0m in 0.03s]
[0m11:58:04.306617 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m11:58:04.306802 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m11:58:04.307100 [info ] [Thread-1 (]: 6 of 10 START sql view model main.int_dim_tracks ............................... [RUN]
[0m11:58:04.307322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m11:58:04.307491 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m11:58:04.309207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m11:58:04.309552 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m11:58:04.311015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m11:58:04.311320 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m11:58:04.311474 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m11:58:04.311615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.314708 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.314904 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m11:58:04.315062 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
  create view "moovai_data"."main"."int_dim_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m11:58:04.315344 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
  create view "moovai_data"."main"."int_dim_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m11:58:04.315493 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:58:04.315671 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: ROLLBACK
[0m11:58:04.317154 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_dim_tracks'
[0m11:58:04.317318 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m11:58:04.318939 [debug] [Thread-1 (]: Runtime Error in model int_dim_tracks (dbt_project/models/02_intermediate_layer/int_dim_tracks.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:58:04.319152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056eb260>]}
[0m11:58:04.319437 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model main.int_dim_tracks ...................... [[31mERROR[0m in 0.01s]
[0m11:58:04.319740 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m11:58:04.319928 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m11:58:04.320206 [info ] [Thread-1 (]: 7 of 10 START sql view model main.int_dim_users ................................ [RUN]
[0m11:58:04.320400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m11:58:04.320560 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m11:58:04.322019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m11:58:04.322404 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m11:58:04.323875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m11:58:04.324157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m11:58:04.324308 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m11:58:04.324446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.327787 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.328141 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m11:58:04.328311 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
  create view "moovai_data"."main"."int_dim_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

INSERT INTO int_users
select *
from cte_src_users
  );

[0m11:58:04.328651 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
  create view "moovai_data"."main"."int_dim_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

INSERT INTO int_users
select *
from cte_src_users
  );

[0m11:58:04.328815 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:58:04.329044 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: ROLLBACK
[0m11:58:04.330544 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.int_dim_users'
[0m11:58:04.330697 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m11:58:04.332356 [debug] [Thread-1 (]: Runtime Error in model int_dim_users (dbt_project/models/02_intermediate_layer/int_dim_users.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:58:04.332567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105708c20>]}
[0m11:58:04.332877 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model main.int_dim_users ....................... [[31mERROR[0m in 0.01s]
[0m11:58:04.333134 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m11:58:04.333315 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m11:58:04.333589 [info ] [Thread-1 (]: 8 of 10 START sql table model main.mart_listen ................................. [RUN]
[0m11:58:04.333780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen)
[0m11:58:04.333934 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen
[0m11:58:04.336323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen"
[0m11:58:04.337106 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen
[0m11:58:04.338850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen"
[0m11:58:04.339195 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:04.339350 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: BEGIN
[0m11:58:04.339492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:04.342628 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:04.342821 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:04.342992 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen__dbt_tmp"
  
    as (
      

with src_listen as (

    select * from  "moovai_data"."main"."int_fact_listen"

)

select *
from src_listen
    );
  
  
[0m11:58:04.343506 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.344966 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:04.345139 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter table "moovai_data"."main"."mart_listen" rename to "mart_listen__dbt_backup"
[0m11:58:04.345381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.346650 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:04.346806 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter table "moovai_data"."main"."mart_listen__dbt_tmp" rename to "mart_listen"
[0m11:58:04.347020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.347767 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m11:58:04.347911 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:04.348043 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m11:58:04.348398 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.349392 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:04.349540 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
drop table if exists "moovai_data"."main"."mart_listen__dbt_backup" cascade
[0m11:58:04.349815 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:04.350408 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: Close
[0m11:58:04.354715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c11ea4-92ab-4d18-9f95-bf7dc4d81cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f7a70>]}
[0m11:58:04.355185 [info ] [Thread-1 (]: 8 of 10 OK created sql table model main.mart_listen ............................ [[32mOK[0m in 0.02s]
[0m11:58:04.355453 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m11:58:04.355635 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m11:58:04.355836 [info ] [Thread-1 (]: 9 of 10 SKIP relation main.mart_tracks ......................................... [[33mSKIP[0m]
[0m11:58:04.356017 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m11:58:04.356179 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m11:58:04.356341 [info ] [Thread-1 (]: 10 of 10 SKIP relation main.mart_users ......................................... [[33mSKIP[0m]
[0m11:58:04.356508 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m11:58:04.357093 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:04.357282 [debug] [MainThread]: On master: BEGIN
[0m11:58:04.357415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:04.361327 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m11:58:04.361515 [debug] [MainThread]: On master: COMMIT
[0m11:58:04.361650 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:04.361769 [debug] [MainThread]: On master: COMMIT
[0m11:58:04.361923 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:04.362054 [debug] [MainThread]: On master: Close
[0m11:58:04.362942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:04.363066 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen' was properly closed.
[0m11:58:04.363252 [info ] [MainThread]: 
[0m11:58:04.363404 [info ] [MainThread]: Finished running 6 view models, 4 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m11:58:04.364093 [debug] [MainThread]: Command end result
[0m11:58:04.382622 [info ] [MainThread]: 
[0m11:58:04.383001 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:58:04.383168 [info ] [MainThread]: 
[0m11:58:04.383370 [error] [MainThread]:   Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near ")"
[0m11:58:04.383509 [info ] [MainThread]: 
[0m11:58:04.383667 [error] [MainThread]:   Runtime Error in model int_dim_tracks (dbt_project/models/02_intermediate_layer/int_dim_tracks.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:58:04.383791 [info ] [MainThread]: 
[0m11:58:04.383941 [error] [MainThread]:   Runtime Error in model int_dim_users (dbt_project/models/02_intermediate_layer/int_dim_users.sql)
  Parser Error: syntax error at or near "INSERT"
[0m11:58:04.384067 [info ] [MainThread]: 
[0m11:58:04.384208 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=2 TOTAL=10
[0m11:58:04.385924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8057459, "process_user_time": 1.131516, "process_kernel_time": 0.171455, "process_mem_max_rss": "140050432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:58:04.386220 [debug] [MainThread]: Command `dbt run` failed at 11:58:04.386176 after 0.81 seconds
[0m11:58:04.386431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c61fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c62120>]}
[0m11:58:04.386603 [debug] [MainThread]: Flushing usage events
[0m11:58:51.280517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1dee0>]}


============================== 11:58:51.284102 | 848c1801-d780-4970-90c3-70336a376082 ==============================
[0m11:58:51.284102 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:58:51.284466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:58:51.465189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a02b10>]}
[0m11:58:51.488204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631a420>]}
[0m11:58:51.489918 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m11:58:51.499644 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m11:58:51.561635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:58:51.561978 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_dim_users.sql
[0m11:58:51.562163 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_dim_tracks.sql
[0m11:58:51.665157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a95d90>]}
[0m11:58:51.712276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110eef90>]}
[0m11:58:51.712550 [info ] [MainThread]: Found 10 models, 3 sources, 416 macros
[0m11:58:51.712723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111028680>]}
[0m11:58:51.713718 [info ] [MainThread]: 
[0m11:58:51.713996 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:51.716294 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m11:58:51.743904 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m11:58:51.744140 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m11:58:51.744284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:51.760126 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:58:51.761406 [debug] [ThreadPool]: On list_moovai_data: Close
[0m11:58:51.762849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m11:58:51.763069 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m11:58:51.766329 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:51.766494 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m11:58:51.766629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:51.769964 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:58:51.770784 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:51.770925 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m11:58:51.771086 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:51.771213 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:51.771338 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m11:58:51.772068 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:58:51.772473 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:58:51.772596 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m11:58:51.772709 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m11:58:51.772858 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:58:51.772982 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m11:58:51.774042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m11:58:51.776590 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:58:51.776739 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m11:58:51.776866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:51.779655 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:58:51.779817 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m11:58:51.779969 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m11:58:51.793048 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:58:51.793880 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m11:58:51.794876 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m11:58:51.795037 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m11:58:51.796637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ed550>]}
[0m11:58:51.796864 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:51.796999 [debug] [MainThread]: On master: BEGIN
[0m11:58:51.797118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:51.799959 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:58:51.800131 [debug] [MainThread]: On master: COMMIT
[0m11:58:51.800265 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:51.800386 [debug] [MainThread]: On master: COMMIT
[0m11:58:51.800540 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:51.800666 [debug] [MainThread]: On master: Close
[0m11:58:51.801172 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m11:58:51.801323 [info ] [MainThread]: 
[0m11:58:51.802597 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m11:58:51.802845 [info ] [Thread-1 (]: 1 of 10 START sql view model main.mart_listen_and_tracks ....................... [RUN]
[0m11:58:51.803037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen_and_tracks)
[0m11:58:51.803193 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m11:58:51.806109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m11:58:51.806439 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m11:58:51.821592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m11:58:51.822054 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m11:58:51.822235 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m11:58:51.822386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.825559 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:51.825792 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m11:58:51.825951 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
  create view "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" as (
    SELECT *
FROM
  );

[0m11:58:51.829256 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
  create view "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" as (
    SELECT *
FROM
  );

[0m11:58:51.829452 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:58:51.829669 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: ROLLBACK
[0m11:58:51.835348 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.mart_listen_and_tracks'
[0m11:58:51.835530 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m11:58:51.837266 [debug] [Thread-1 (]: Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near ")"
[0m11:58:51.837952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111776f60>]}
[0m11:58:51.838251 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model main.mart_listen_and_tracks .............. [[31mERROR[0m in 0.03s]
[0m11:58:51.838534 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m11:58:51.838727 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m11:58:51.839395 [info ] [Thread-1 (]: 2 of 10 START sql view model main.src_listen ................................... [RUN]
[0m11:58:51.839618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.src_listen)
[0m11:58:51.839783 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m11:58:51.841010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m11:58:51.841642 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m11:58:51.843822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m11:58:51.844168 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:51.844322 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m11:58:51.844459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.847509 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:51.847707 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:51.847871 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m11:58:51.848424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.851592 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:51.851785 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m11:58:51.852653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:51.854034 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:51.854209 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m11:58:51.854472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.862565 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:58:51.862759 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:51.862911 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m11:58:51.863735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:51.866098 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m11:58:51.866278 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m11:58:51.866564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.867605 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m11:58:51.877193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1ad50>]}
[0m11:58:51.877512 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main.src_listen .............................. [[32mOK[0m in 0.04s]
[0m11:58:51.877780 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m11:58:51.877967 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m11:58:51.878226 [info ] [Thread-1 (]: 3 of 10 START sql view model main.src_tracks ................................... [RUN]
[0m11:58:51.878410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m11:58:51.878570 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m11:58:51.879871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m11:58:51.880194 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m11:58:51.881669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m11:58:51.881956 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:51.882113 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m11:58:51.882253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.885338 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:51.885540 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:51.885716 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m11:58:51.886083 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.887563 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:51.888693 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m11:58:51.888992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.890300 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:51.890462 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m11:58:51.890699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.891383 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:58:51.891530 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:51.891666 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m11:58:51.892186 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.893268 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m11:58:51.893442 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m11:58:51.893707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.894347 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m11:58:51.901472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11167f860>]}
[0m11:58:51.901830 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main.src_tracks .............................. [[32mOK[0m in 0.02s]
[0m11:58:51.902105 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m11:58:51.902308 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m11:58:51.902580 [info ] [Thread-1 (]: 4 of 10 START sql view model main.src_users .................................... [RUN]
[0m11:58:51.902776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m11:58:51.902930 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m11:58:51.904223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m11:58:51.904537 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m11:58:51.906016 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m11:58:51.906298 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:51.906451 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m11:58:51.906589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.909782 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:51.909980 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:51.910145 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m11:58:51.910469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.911939 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:51.912104 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m11:58:51.912327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.914559 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:51.914727 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m11:58:51.914949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.915653 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:58:51.915824 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:51.915968 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m11:58:51.916396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.917584 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m11:58:51.917739 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m11:58:51.918017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.918613 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m11:58:51.922673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a6eb70>]}
[0m11:58:51.922981 [info ] [Thread-1 (]: 4 of 10 OK created sql view model main.src_users ............................... [[32mOK[0m in 0.02s]
[0m11:58:51.923241 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m11:58:51.923429 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m11:58:51.923688 [info ] [Thread-1 (]: 5 of 10 START sql table model main.int_fact_listen ............................. [RUN]
[0m11:58:51.923871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m11:58:51.924024 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m11:58:51.925442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m11:58:51.925984 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m11:58:51.935278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m11:58:51.935602 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:51.935769 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m11:58:51.935918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.939177 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:51.939456 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:51.939630 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_fact_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
[0m11:58:51.941136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:51.942625 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:51.942796 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen" rename to "int_fact_listen__dbt_backup"
[0m11:58:51.943068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.944275 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:51.944434 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen__dbt_tmp" rename to "int_fact_listen"
[0m11:58:51.944666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.947216 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m11:58:51.947392 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:51.947535 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m11:58:51.947919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.948934 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m11:58:51.949084 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
drop table if exists "moovai_data"."main"."int_fact_listen__dbt_backup" cascade
[0m11:58:51.949367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.949961 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m11:58:51.953835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a36030>]}
[0m11:58:51.954165 [info ] [Thread-1 (]: 5 of 10 OK created sql table model main.int_fact_listen ........................ [[32mOK[0m in 0.03s]
[0m11:58:51.954451 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m11:58:51.954640 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m11:58:51.954914 [info ] [Thread-1 (]: 6 of 10 START sql view model main.int_dim_tracks ............................... [RUN]
[0m11:58:51.955117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m11:58:51.955273 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m11:58:51.956553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m11:58:51.956875 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m11:58:51.958400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m11:58:51.958680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m11:58:51.958828 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m11:58:51.958964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.962227 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:51.962546 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m11:58:51.962715 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
  create view "moovai_data"."main"."int_dim_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

--INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m11:58:51.963091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.964554 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m11:58:51.964713 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks__dbt_tmp" rename to "int_dim_tracks"
[0m11:58:51.964967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.965589 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m11:58:51.965739 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m11:58:51.965874 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m11:58:51.966232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.967212 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m11:58:51.967362 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
drop view if exists "moovai_data"."main"."int_dim_tracks__dbt_backup" cascade
[0m11:58:51.967564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.968151 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m11:58:51.972068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1ad50>]}
[0m11:58:51.972398 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main.int_dim_tracks .......................... [[32mOK[0m in 0.02s]
[0m11:58:51.972680 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m11:58:51.972874 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m11:58:51.973153 [info ] [Thread-1 (]: 7 of 10 START sql view model main.int_dim_users ................................ [RUN]
[0m11:58:51.973349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m11:58:51.973504 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m11:58:51.974817 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m11:58:51.975130 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m11:58:51.977543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m11:58:51.977846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m11:58:51.978003 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m11:58:51.978147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.981381 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:51.981612 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m11:58:51.981783 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
  create view "moovai_data"."main"."int_dim_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

--INSERT INTO int_users
select *
from cte_src_users
  );

[0m11:58:51.982188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.983806 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m11:58:51.983974 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users__dbt_tmp" rename to "int_dim_users"
[0m11:58:51.984227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.984862 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m11:58:51.985028 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m11:58:51.985162 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m11:58:51.985557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.986629 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m11:58:51.986796 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
drop view if exists "moovai_data"."main"."int_dim_users__dbt_backup" cascade
[0m11:58:51.987030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:51.987630 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m11:58:51.991648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a965d0>]}
[0m11:58:51.991961 [info ] [Thread-1 (]: 7 of 10 OK created sql view model main.int_dim_users ........................... [[32mOK[0m in 0.02s]
[0m11:58:51.992222 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m11:58:51.992416 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m11:58:51.992687 [info ] [Thread-1 (]: 8 of 10 START sql table model main.mart_listen ................................. [RUN]
[0m11:58:51.992890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen)
[0m11:58:51.993044 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen
[0m11:58:51.994360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen"
[0m11:58:51.994641 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen
[0m11:58:51.996209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen"
[0m11:58:51.996496 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:51.996645 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: BEGIN
[0m11:58:51.996781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:51.999815 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:52.000005 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:52.000174 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen__dbt_tmp"
  
    as (
      

with src_listen as (

    select * from  "moovai_data"."main"."int_fact_listen"

)

select *
from src_listen
    );
  
  
[0m11:58:52.000651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.002177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:52.002358 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter table "moovai_data"."main"."mart_listen" rename to "mart_listen__dbt_backup"
[0m11:58:52.002683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.004153 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:52.004315 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter table "moovai_data"."main"."mart_listen__dbt_tmp" rename to "mart_listen"
[0m11:58:52.004561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.005382 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m11:58:52.005533 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:52.005668 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m11:58:52.006055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.007036 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m11:58:52.007241 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
drop table if exists "moovai_data"."main"."mart_listen__dbt_backup" cascade
[0m11:58:52.007503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.008084 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: Close
[0m11:58:52.011991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1ee10>]}
[0m11:58:52.012279 [info ] [Thread-1 (]: 8 of 10 OK created sql table model main.mart_listen ............................ [[32mOK[0m in 0.02s]
[0m11:58:52.012540 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m11:58:52.012726 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m11:58:52.012943 [info ] [Thread-1 (]: 9 of 10 START sql table model main.mart_tracks ................................. [RUN]
[0m11:58:52.013128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen, now model.dbt_project.mart_tracks)
[0m11:58:52.013283 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_tracks
[0m11:58:52.014609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_tracks"
[0m11:58:52.015285 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_tracks
[0m11:58:52.016867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_tracks"
[0m11:58:52.017144 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m11:58:52.017298 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: BEGIN
[0m11:58:52.017440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:52.020456 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:52.020651 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m11:58:52.020811 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_tracks__dbt_tmp"
  
    as (
      

with src_tracks as (

    select * from "moovai_data"."main"."int_dim_tracks"

)

select *
from src_tracks
    );
  
  
[0m11:58:52.021595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:58:52.023188 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m11:58:52.023377 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter table "moovai_data"."main"."mart_tracks" rename to "mart_tracks__dbt_backup"
[0m11:58:52.023725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.025112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m11:58:52.025278 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter table "moovai_data"."main"."mart_tracks__dbt_tmp" rename to "mart_tracks"
[0m11:58:52.025521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.027024 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m11:58:52.027177 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m11:58:52.027316 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m11:58:52.027727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.028660 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m11:58:52.028892 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
drop table if exists "moovai_data"."main"."mart_tracks__dbt_backup" cascade
[0m11:58:52.029194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.029772 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: Close
[0m11:58:52.033661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a53b90>]}
[0m11:58:52.033987 [info ] [Thread-1 (]: 9 of 10 OK created sql table model main.mart_tracks ............................ [[32mOK[0m in 0.02s]
[0m11:58:52.034252 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m11:58:52.034442 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m11:58:52.034659 [info ] [Thread-1 (]: 10 of 10 START sql table model main.mart_users ................................. [RUN]
[0m11:58:52.034841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_tracks, now model.dbt_project.mart_users)
[0m11:58:52.034991 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_users
[0m11:58:52.036473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_users"
[0m11:58:52.036780 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_users
[0m11:58:52.038371 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_users"
[0m11:58:52.038662 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m11:58:52.038814 [debug] [Thread-1 (]: On model.dbt_project.mart_users: BEGIN
[0m11:58:52.038954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:52.042159 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:58:52.042385 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m11:58:52.042553 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_users__dbt_tmp"
  
    as (
      

with src_users as (

    select * from "moovai_data"."main"."int_dim_users"

)

select *
from src_users
    );
  
  
[0m11:58:52.043227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.044889 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m11:58:52.045070 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter table "moovai_data"."main"."mart_users" rename to "mart_users__dbt_backup"
[0m11:58:52.045354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.046732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m11:58:52.046898 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter table "moovai_data"."main"."mart_users__dbt_tmp" rename to "mart_users"
[0m11:58:52.047122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.047949 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m11:58:52.048095 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m11:58:52.048227 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m11:58:52.048620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.049604 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m11:58:52.049832 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
drop table if exists "moovai_data"."main"."mart_users__dbt_backup" cascade
[0m11:58:52.050177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:58:52.050847 [debug] [Thread-1 (]: On model.dbt_project.mart_users: Close
[0m11:58:52.055364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848c1801-d780-4970-90c3-70336a376082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161c260>]}
[0m11:58:52.055676 [info ] [Thread-1 (]: 10 of 10 OK created sql table model main.mart_users ............................ [[32mOK[0m in 0.02s]
[0m11:58:52.055942 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m11:58:52.056515 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:52.056660 [debug] [MainThread]: On master: BEGIN
[0m11:58:52.056776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:52.059754 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:58:52.059938 [debug] [MainThread]: On master: COMMIT
[0m11:58:52.060075 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:52.060197 [debug] [MainThread]: On master: COMMIT
[0m11:58:52.060348 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:58:52.060476 [debug] [MainThread]: On master: Close
[0m11:58:52.061025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:52.061153 [debug] [MainThread]: Connection 'model.dbt_project.mart_users' was properly closed.
[0m11:58:52.061331 [info ] [MainThread]: 
[0m11:58:52.061478 [info ] [MainThread]: Finished running 6 view models, 4 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:58:52.062221 [debug] [MainThread]: Command end result
[0m11:58:52.076432 [info ] [MainThread]: 
[0m11:58:52.076673 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:58:52.076814 [info ] [MainThread]: 
[0m11:58:52.076989 [error] [MainThread]:   Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near ")"
[0m11:58:52.077125 [info ] [MainThread]: 
[0m11:58:52.077265 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m11:58:52.078836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8310577, "process_user_time": 1.177661, "process_kernel_time": 0.155156, "process_mem_max_rss": "139132928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:58:52.079087 [debug] [MainThread]: Command `dbt run` failed at 11:58:52.079048 after 0.83 seconds
[0m11:58:52.079271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1e1e0>]}
[0m11:58:52.079430 [debug] [MainThread]: Flushing usage events
[0m12:02:46.481541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104036330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104036030>]}


============================== 12:02:46.485218 | 909f977c-76cb-42ac-81e9-f84c75bbdcfd ==============================
[0m12:02:46.485218 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:02:46.485552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:02:46.664745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f54f80>]}
[0m12:02:46.687821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af08f0>]}
[0m12:02:46.689628 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:02:46.699329 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:02:46.764179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:46.764556 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql
[0m12:02:46.867123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104465940>]}
[0m12:02:46.908805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427d370>]}
[0m12:02:46.909084 [info ] [MainThread]: Found 10 models, 3 sources, 416 macros
[0m12:02:46.909259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424da30>]}
[0m12:02:46.910230 [info ] [MainThread]: 
[0m12:02:46.910525 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:46.912875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:02:46.942282 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:02:46.942524 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:02:46.942669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:46.958775 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:02:46.960051 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:02:46.961567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:02:46.961783 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:02:46.965029 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:02:46.965192 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:02:46.965326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:46.968648 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:02:46.969528 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:02:46.969672 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:02:46.969838 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:46.969966 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:02:46.970095 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:02:46.970790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:02:46.971198 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:02:46.971326 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:02:46.971438 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:02:46.971584 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:46.971710 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:02:46.972779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:02:46.975387 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:02:46.975543 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:02:46.975667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:46.978688 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:02:46.978873 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:02:46.979027 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:02:46.992128 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:02:46.992961 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:02:46.993987 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:02:46.994130 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:02:46.995799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bb860>]}
[0m12:02:46.996020 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:46.996144 [debug] [MainThread]: On master: BEGIN
[0m12:02:46.996256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:46.999128 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:02:46.999297 [debug] [MainThread]: On master: COMMIT
[0m12:02:46.999430 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:46.999545 [debug] [MainThread]: On master: COMMIT
[0m12:02:46.999699 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:46.999826 [debug] [MainThread]: On master: Close
[0m12:02:47.000351 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:02:47.000501 [info ] [MainThread]: 
[0m12:02:47.001864 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:02:47.002187 [info ] [Thread-1 (]: 1 of 10 START sql view model main.src_listen ................................... [RUN]
[0m12:02:47.002444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:02:47.002617 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:02:47.006125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:02:47.006922 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:02:47.021666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:02:47.022220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:02:47.022391 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:02:47.022532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.025614 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.025808 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:02:47.025964 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:02:47.028042 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:47.031320 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:02:47.031568 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:02:47.032401 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:47.033692 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:02:47.033852 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:02:47.034080 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.042490 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:02:47.042685 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:02:47.042845 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:02:47.043687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:47.045967 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:02:47.046140 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:02:47.046427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.047482 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:02:47.051938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035d1640>]}
[0m12:02:47.052264 [info ] [Thread-1 (]: 1 of 10 OK created sql view model main.src_listen .............................. [[32mOK[0m in 0.05s]
[0m12:02:47.052547 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:02:47.052745 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m12:02:47.053053 [info ] [Thread-1 (]: 2 of 10 START sql view model main.src_tracks ................................... [RUN]
[0m12:02:47.053269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m12:02:47.053429 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m12:02:47.054696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m12:02:47.055046 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m12:02:47.056555 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m12:02:47.056842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:02:47.056994 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m12:02:47.057134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.060155 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.060346 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:02:47.060503 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m12:02:47.060846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.062303 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:02:47.062463 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m12:02:47.062696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.063963 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:02:47.064119 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m12:02:47.064324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.064994 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:02:47.065140 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:02:47.065273 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:02:47.065658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.066714 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:02:47.066874 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m12:02:47.067133 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.067718 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m12:02:47.070226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048df9b0>]}
[0m12:02:47.070510 [info ] [Thread-1 (]: 2 of 10 OK created sql view model main.src_tracks .............................. [[32mOK[0m in 0.02s]
[0m12:02:47.070762 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m12:02:47.070941 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m12:02:47.071245 [info ] [Thread-1 (]: 3 of 10 START sql view model main.src_users .................................... [RUN]
[0m12:02:47.071444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m12:02:47.071597 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m12:02:47.072819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m12:02:47.073443 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m12:02:47.074910 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m12:02:47.075183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:02:47.075328 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m12:02:47.075466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.078811 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.079093 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:02:47.079264 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m12:02:47.079609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.081183 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:02:47.081356 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m12:02:47.081598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.082882 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:02:47.083039 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m12:02:47.083265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.083927 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:02:47.084071 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:02:47.084201 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:02:47.084634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.085677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:02:47.085837 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m12:02:47.086104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.086682 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m12:02:47.089241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dfce0>]}
[0m12:02:47.089521 [info ] [Thread-1 (]: 3 of 10 OK created sql view model main.src_users ............................... [[32mOK[0m in 0.02s]
[0m12:02:47.089772 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m12:02:47.089953 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m12:02:47.090234 [info ] [Thread-1 (]: 4 of 10 START sql table model main.int_fact_listen ............................. [RUN]
[0m12:02:47.090437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m12:02:47.090588 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m12:02:47.092968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m12:02:47.093443 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m12:02:47.102917 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m12:02:47.103439 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:02:47.103605 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m12:02:47.103746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.106962 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.107157 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:02:47.107323 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_fact_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
[0m12:02:47.108805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:47.110321 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:02:47.110497 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen" rename to "int_fact_listen__dbt_backup"
[0m12:02:47.110741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.112056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:02:47.112235 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen__dbt_tmp" rename to "int_fact_listen"
[0m12:02:47.112476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.114944 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:02:47.115114 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:02:47.115261 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:02:47.115640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.116677 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:02:47.116830 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
drop table if exists "moovai_data"."main"."int_fact_listen__dbt_backup" cascade
[0m12:02:47.117118 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.117721 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m12:02:47.120325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a27e00>]}
[0m12:02:47.120633 [info ] [Thread-1 (]: 4 of 10 OK created sql table model main.int_fact_listen ........................ [[32mOK[0m in 0.03s]
[0m12:02:47.120891 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m12:02:47.121086 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m12:02:47.121348 [info ] [Thread-1 (]: 5 of 10 START sql view model main.int_dim_tracks ............................... [RUN]
[0m12:02:47.121529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m12:02:47.121680 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m12:02:47.123058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m12:02:47.123524 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m12:02:47.125106 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m12:02:47.125644 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:02:47.125800 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m12:02:47.125937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.129354 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.129610 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:02:47.129785 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
  create view "moovai_data"."main"."int_dim_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

--INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m12:02:47.130182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.131853 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:02:47.132044 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks" rename to "int_dim_tracks__dbt_backup"
[0m12:02:47.132324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.133629 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:02:47.133791 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks__dbt_tmp" rename to "int_dim_tracks"
[0m12:02:47.134018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.134702 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:02:47.134849 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:02:47.134987 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:02:47.135405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.136455 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:02:47.136626 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
drop view if exists "moovai_data"."main"."int_dim_tracks__dbt_backup" cascade
[0m12:02:47.136913 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.137521 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m12:02:47.140113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048df920>]}
[0m12:02:47.140399 [info ] [Thread-1 (]: 5 of 10 OK created sql view model main.int_dim_tracks .......................... [[32mOK[0m in 0.02s]
[0m12:02:47.140644 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m12:02:47.140822 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m12:02:47.141104 [info ] [Thread-1 (]: 6 of 10 START sql view model main.int_dim_users ................................ [RUN]
[0m12:02:47.141301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m12:02:47.141460 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m12:02:47.142842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m12:02:47.143183 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m12:02:47.145535 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m12:02:47.145835 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:02:47.145991 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m12:02:47.146131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.149161 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.149363 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:02:47.149518 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
  create view "moovai_data"."main"."int_dim_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

--INSERT INTO int_users
select *
from cte_src_users
  );

[0m12:02:47.149851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.151383 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:02:47.151575 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users" rename to "int_dim_users__dbt_backup"
[0m12:02:47.151835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.153231 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:02:47.153426 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users__dbt_tmp" rename to "int_dim_users"
[0m12:02:47.153762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.154499 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:02:47.154648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:02:47.154786 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:02:47.155231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.156323 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:02:47.156485 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
drop view if exists "moovai_data"."main"."int_dim_users__dbt_backup" cascade
[0m12:02:47.156762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.157394 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m12:02:47.160241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c4320>]}
[0m12:02:47.160529 [info ] [Thread-1 (]: 6 of 10 OK created sql view model main.int_dim_users ........................... [[32mOK[0m in 0.02s]
[0m12:02:47.160781 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m12:02:47.160965 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen
[0m12:02:47.161240 [info ] [Thread-1 (]: 7 of 10 START sql table model main.mart_listen ................................. [RUN]
[0m12:02:47.161536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen)
[0m12:02:47.161714 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen
[0m12:02:47.163286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen"
[0m12:02:47.163707 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen
[0m12:02:47.165206 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen"
[0m12:02:47.165550 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m12:02:47.165700 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: BEGIN
[0m12:02:47.165843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.169013 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.169216 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m12:02:47.169375 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen__dbt_tmp"
  
    as (
      

with src_listen as (

    select * from  "moovai_data"."main"."int_fact_listen"

)

select *
from src_listen
    );
  
  
[0m12:02:47.169826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.171209 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m12:02:47.171372 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter table "moovai_data"."main"."mart_listen" rename to "mart_listen__dbt_backup"
[0m12:02:47.171606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.172835 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m12:02:47.172981 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
alter table "moovai_data"."main"."mart_listen__dbt_tmp" rename to "mart_listen"
[0m12:02:47.173197 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.173953 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m12:02:47.174112 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m12:02:47.174247 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: COMMIT
[0m12:02:47.174634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.175704 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen"
[0m12:02:47.175870 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen"} */
drop table if exists "moovai_data"."main"."mart_listen__dbt_backup" cascade
[0m12:02:47.176166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.176831 [debug] [Thread-1 (]: On model.dbt_project.mart_listen: Close
[0m12:02:47.179561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048eb140>]}
[0m12:02:47.179876 [info ] [Thread-1 (]: 7 of 10 OK created sql table model main.mart_listen ............................ [[32mOK[0m in 0.02s]
[0m12:02:47.180138 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen
[0m12:02:47.180324 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m12:02:47.180549 [info ] [Thread-1 (]: 8 of 10 START sql table model main.mart_listen_and_tracks ...................... [RUN]
[0m12:02:47.180729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen, now model.dbt_project.mart_listen_and_tracks)
[0m12:02:47.180881 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m12:02:47.182667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m12:02:47.183045 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m12:02:47.184476 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m12:02:47.184769 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:02:47.184932 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m12:02:47.185080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.188186 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.188382 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:02:47.188548 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mast_listen_and_tracks.sql as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen"
LEFT JOIN "moovai_data"."main"."int_dim_tracks" USING(track_id)

)

select * from mast_listen_and_tracks
    );
  
  
[0m12:02:47.190466 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mast_listen_and_tracks.sql as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen"
LEFT JOIN "moovai_data"."main"."int_dim_tracks" USING(track_id)

)

select * from mast_listen_and_tracks
    );
  
  
[0m12:02:47.190636 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:02:47.190839 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: ROLLBACK
[0m12:02:47.196529 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.mart_listen_and_tracks'
[0m12:02:47.196695 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m12:02:47.198360 [debug] [Thread-1 (]: Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near "."
[0m12:02:47.198564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7e9c0>]}
[0m12:02:47.198847 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model main.mart_listen_and_tracks ............. [[31mERROR[0m in 0.02s]
[0m12:02:47.199107 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m12:02:47.199287 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_tracks
[0m12:02:47.199829 [info ] [Thread-1 (]: 9 of 10 START sql table model main.mart_tracks ................................. [RUN]
[0m12:02:47.200039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.mart_tracks)
[0m12:02:47.200204 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_tracks
[0m12:02:47.201714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_tracks"
[0m12:02:47.202092 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_tracks
[0m12:02:47.204757 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_tracks"
[0m12:02:47.205098 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m12:02:47.205255 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: BEGIN
[0m12:02:47.205398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.208478 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.208687 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m12:02:47.208874 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_tracks__dbt_tmp"
  
    as (
      

with src_tracks as (

    select * from "moovai_data"."main"."int_dim_tracks"

)

select *
from src_tracks
    );
  
  
[0m12:02:47.209600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:47.211044 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m12:02:47.211219 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter table "moovai_data"."main"."mart_tracks" rename to "mart_tracks__dbt_backup"
[0m12:02:47.211502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.212865 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m12:02:47.213018 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
alter table "moovai_data"."main"."mart_tracks__dbt_tmp" rename to "mart_tracks"
[0m12:02:47.213232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.213953 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m12:02:47.214098 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m12:02:47.214230 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: COMMIT
[0m12:02:47.214600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.215663 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_tracks"
[0m12:02:47.215825 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_tracks"} */
drop table if exists "moovai_data"."main"."mart_tracks__dbt_backup" cascade
[0m12:02:47.216100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.216709 [debug] [Thread-1 (]: On model.dbt_project.mart_tracks: Close
[0m12:02:47.219370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b022a0>]}
[0m12:02:47.219646 [info ] [Thread-1 (]: 9 of 10 OK created sql table model main.mart_tracks ............................ [[32mOK[0m in 0.02s]
[0m12:02:47.219895 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_tracks
[0m12:02:47.220075 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_users
[0m12:02:47.220309 [info ] [Thread-1 (]: 10 of 10 START sql table model main.mart_users ................................. [RUN]
[0m12:02:47.220504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_tracks, now model.dbt_project.mart_users)
[0m12:02:47.220654 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_users
[0m12:02:47.222065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_users"
[0m12:02:47.222368 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_users
[0m12:02:47.223787 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_users"
[0m12:02:47.224073 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m12:02:47.224225 [debug] [Thread-1 (]: On model.dbt_project.mart_users: BEGIN
[0m12:02:47.224361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:47.227537 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:02:47.227769 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m12:02:47.227951 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_users__dbt_tmp"
  
    as (
      

with src_users as (

    select * from "moovai_data"."main"."int_dim_users"

)

select *
from src_users
    );
  
  
[0m12:02:47.228569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.230140 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m12:02:47.230306 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter table "moovai_data"."main"."mart_users" rename to "mart_users__dbt_backup"
[0m12:02:47.230550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.231969 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m12:02:47.232133 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
alter table "moovai_data"."main"."mart_users__dbt_tmp" rename to "mart_users"
[0m12:02:47.232396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.233198 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m12:02:47.233359 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m12:02:47.233500 [debug] [Thread-1 (]: On model.dbt_project.mart_users: COMMIT
[0m12:02:47.233905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.234879 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_users"
[0m12:02:47.235025 [debug] [Thread-1 (]: On model.dbt_project.mart_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_users"} */
drop table if exists "moovai_data"."main"."mart_users__dbt_backup" cascade
[0m12:02:47.235303 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:47.235933 [debug] [Thread-1 (]: On model.dbt_project.mart_users: Close
[0m12:02:47.238598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909f977c-76cb-42ac-81e9-f84c75bbdcfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e8650>]}
[0m12:02:47.238888 [info ] [Thread-1 (]: 10 of 10 OK created sql table model main.mart_users ............................ [[32mOK[0m in 0.02s]
[0m12:02:47.239141 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_users
[0m12:02:47.239694 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:47.239844 [debug] [MainThread]: On master: BEGIN
[0m12:02:47.239959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:47.242898 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:02:47.243065 [debug] [MainThread]: On master: COMMIT
[0m12:02:47.243194 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:47.243311 [debug] [MainThread]: On master: COMMIT
[0m12:02:47.243457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:47.243584 [debug] [MainThread]: On master: Close
[0m12:02:47.244082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:47.244200 [debug] [MainThread]: Connection 'model.dbt_project.mart_users' was properly closed.
[0m12:02:47.244370 [info ] [MainThread]: 
[0m12:02:47.244518 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m12:02:47.245256 [debug] [MainThread]: Command end result
[0m12:02:47.259492 [info ] [MainThread]: 
[0m12:02:47.259744 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:02:47.259891 [info ] [MainThread]: 
[0m12:02:47.260069 [error] [MainThread]:   Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near "."
[0m12:02:47.260216 [info ] [MainThread]: 
[0m12:02:47.260354 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:02:47.262126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81656414, "process_user_time": 1.169427, "process_kernel_time": 0.165301, "process_mem_max_rss": "141393920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:47.262407 [debug] [MainThread]: Command `dbt run` failed at 12:02:47.262361 after 0.82 seconds
[0m12:02:47.262605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104036330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10369cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039d64b0>]}
[0m12:02:47.262763 [debug] [MainThread]: Flushing usage events
[0m12:03:01.067230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073693a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107809df0>]}


============================== 12:03:01.069898 | 6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e ==============================
[0m12:03:01.069898 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:03:01.070220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_listen_and_tracks.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:01.248393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107872600>]}
[0m12:03:01.271371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105920d40>]}
[0m12:03:01.273200 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:03:01.283961 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:03:01.343270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:01.343501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:01.358447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f82f0>]}
[0m12:03:01.400917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9c680>]}
[0m12:03:01.401196 [info ] [MainThread]: Found 10 models, 3 sources, 416 macros
[0m12:03:01.401370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c28260>]}
[0m12:03:01.402240 [info ] [MainThread]: 
[0m12:03:01.402522 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:03:01.402932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:03:01.429545 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:03:01.429778 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:03:01.429924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:01.443739 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:03:01.444988 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:03:01.446275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:03:01.446490 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:03:01.449819 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:01.449992 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:03:01.450126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:01.453680 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:03:01.454512 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:01.454654 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:03:01.454818 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:03:01.454946 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:01.455070 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:03:01.455496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:03:01.455968 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:03:01.456118 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:01.456248 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:03:01.456427 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:03:01.456563 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:03:01.459457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:03:01.462028 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:03:01.462178 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:03:01.462297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:01.465125 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:03:01.465291 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:03:01.465436 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:03:01.479312 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:03:01.481021 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:03:01.482100 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:03:01.482263 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:03:01.485376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105482a20>]}
[0m12:03:01.485618 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:01.485747 [debug] [MainThread]: On master: BEGIN
[0m12:03:01.485861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:01.489081 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:03:01.489262 [debug] [MainThread]: On master: COMMIT
[0m12:03:01.489396 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:01.489514 [debug] [MainThread]: On master: COMMIT
[0m12:03:01.489666 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:03:01.489794 [debug] [MainThread]: On master: Close
[0m12:03:01.490443 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:03:01.490592 [info ] [MainThread]: 
[0m12:03:01.491912 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m12:03:01.492163 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m12:03:01.492361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen_and_tracks)
[0m12:03:01.492519 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m12:03:01.496348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m12:03:01.496719 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m12:03:01.513061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m12:03:01.513528 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:03:01.513766 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m12:03:01.513960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:01.517364 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:03:01.517580 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:03:01.517750 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mast_listen_and_tracks.sql as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen"
LEFT JOIN "moovai_data"."main"."int_dim_tracks" USING(track_id)

)

select * from mast_listen_and_tracks
    );
  
  
[0m12:03:01.520993 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mast_listen_and_tracks.sql as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen"
LEFT JOIN "moovai_data"."main"."int_dim_tracks" USING(track_id)

)

select * from mast_listen_and_tracks
    );
  
  
[0m12:03:01.521191 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:03:01.521415 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: ROLLBACK
[0m12:03:01.526858 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.mart_listen_and_tracks'
[0m12:03:01.527066 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m12:03:01.528820 [debug] [Thread-1 (]: Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near "."
[0m12:03:01.529551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8905b9-c1b4-4ab0-9fff-cf79c90d2a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b218b0>]}
[0m12:03:01.529866 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.mart_listen_and_tracks .............. [[31mERROR[0m in 0.04s]
[0m12:03:01.530164 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m12:03:01.531008 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:01.531152 [debug] [MainThread]: On master: BEGIN
[0m12:03:01.531268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:01.534178 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:03:01.534342 [debug] [MainThread]: On master: COMMIT
[0m12:03:01.534470 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:01.534584 [debug] [MainThread]: On master: COMMIT
[0m12:03:01.534733 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:03:01.534859 [debug] [MainThread]: On master: Close
[0m12:03:01.535403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:01.535549 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_tracks' was properly closed.
[0m12:03:01.535692 [info ] [MainThread]: 
[0m12:03:01.535834 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m12:03:01.536123 [debug] [MainThread]: Command end result
[0m12:03:01.549837 [info ] [MainThread]: 
[0m12:03:01.550199 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:03:01.550358 [info ] [MainThread]: 
[0m12:03:01.550557 [error] [MainThread]:   Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Parser Error: syntax error at or near "."
[0m12:03:01.550691 [info ] [MainThread]: 
[0m12:03:01.550829 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:03:01.552440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5143916, "process_user_time": 0.91102, "process_kernel_time": 0.132374, "process_mem_max_rss": "133234688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:03:01.552698 [debug] [MainThread]: Command `dbt run` failed at 12:03:01.552658 after 0.51 seconds
[0m12:03:01.552889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c299a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073693a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073691f0>]}
[0m12:03:01.553053 [debug] [MainThread]: Flushing usage events
[0m12:03:27.507013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483dd60>]}


============================== 12:03:27.509850 | e9382d94-e253-4e70-ac1a-c4d481d7cc7b ==============================
[0m12:03:27.509850 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:03:27.510174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_listen_and_tracks.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:27.692122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9382d94-e253-4e70-ac1a-c4d481d7cc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104940fb0>]}
[0m12:03:27.715199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9382d94-e253-4e70-ac1a-c4d481d7cc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823980>]}
[0m12:03:27.716916 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:03:27.727506 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:03:27.789732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:27.790070 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql
[0m12:03:27.895357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9382d94-e253-4e70-ac1a-c4d481d7cc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d42390>]}
[0m12:03:27.936954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9382d94-e253-4e70-ac1a-c4d481d7cc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a86030>]}
[0m12:03:27.937231 [info ] [MainThread]: Found 10 models, 3 sources, 416 macros
[0m12:03:27.937412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9382d94-e253-4e70-ac1a-c4d481d7cc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8cbc0>]}
[0m12:03:27.938270 [info ] [MainThread]: 
[0m12:03:27.938537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:03:27.938934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:03:27.966027 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:03:27.966261 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:03:27.966403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:27.989699 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:03:27.990783 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:03:27.992318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:03:27.992536 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:03:27.995835 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:27.996009 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:03:27.996141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:27.999638 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:03:28.000326 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:28.000501 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:03:28.000667 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:03:28.000791 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:28.000919 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:03:28.001409 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:03:28.001811 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:03:28.001944 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:03:28.002056 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:03:28.002202 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:03:28.002327 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:03:28.005235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:03:28.007847 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:03:28.007996 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:03:28.008115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:28.011046 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:03:28.011221 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:03:28.011367 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:03:28.024463 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:03:28.025367 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:03:28.026404 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:03:28.026555 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:03:28.028214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9382d94-e253-4e70-ac1a-c4d481d7cc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a555e0>]}
[0m12:03:28.028478 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:28.028628 [debug] [MainThread]: On master: BEGIN
[0m12:03:28.028763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:28.031735 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:03:28.031906 [debug] [MainThread]: On master: COMMIT
[0m12:03:28.032042 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:28.032160 [debug] [MainThread]: On master: COMMIT
[0m12:03:28.032315 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:03:28.032450 [debug] [MainThread]: On master: Close
[0m12:03:28.032960 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:03:28.033113 [info ] [MainThread]: 
[0m12:03:28.034334 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m12:03:28.034602 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m12:03:28.034809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen_and_tracks)
[0m12:03:28.034967 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m12:03:28.038695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m12:03:28.039441 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m12:03:28.055416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m12:03:28.055855 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:03:28.056027 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m12:03:28.056175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:28.059402 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:03:28.059627 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:03:28.059800 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen"
LEFT JOIN "moovai_data"."main"."int_dim_tracks" USING(track_id)

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:03:28.064141 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen"
LEFT JOIN "moovai_data"."main"."int_dim_tracks" USING(track_id)

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:03:28.064341 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:03:28.064550 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: ROLLBACK
[0m12:03:28.070045 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.mart_listen_and_tracks'
[0m12:03:28.070210 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m12:03:28.071882 [debug] [Thread-1 (]: Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Binder Error: Column "track_id" does not exist on right side of join!
[0m12:03:28.072581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9382d94-e253-4e70-ac1a-c4d481d7cc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd5490>]}
[0m12:03:28.072879 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.mart_listen_and_tracks .............. [[31mERROR[0m in 0.04s]
[0m12:03:28.073161 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m12:03:28.073953 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:28.074094 [debug] [MainThread]: On master: BEGIN
[0m12:03:28.074209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:28.077124 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:03:28.077290 [debug] [MainThread]: On master: COMMIT
[0m12:03:28.077421 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:28.077535 [debug] [MainThread]: On master: COMMIT
[0m12:03:28.077682 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:03:28.077805 [debug] [MainThread]: On master: Close
[0m12:03:28.078317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:28.078443 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_tracks' was properly closed.
[0m12:03:28.078571 [info ] [MainThread]: 
[0m12:03:28.078709 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m12:03:28.078999 [debug] [MainThread]: Command end result
[0m12:03:28.092776 [info ] [MainThread]: 
[0m12:03:28.093023 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:03:28.093180 [info ] [MainThread]: 
[0m12:03:28.093356 [error] [MainThread]:   Runtime Error in model mart_listen_and_tracks (dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql)
  Binder Error: Column "track_id" does not exist on right side of join!
[0m12:03:28.093488 [info ] [MainThread]: 
[0m12:03:28.093627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:03:28.095195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.62119114, "process_user_time": 0.994339, "process_kernel_time": 0.140663, "process_mem_max_rss": "137576448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:03:28.095443 [debug] [MainThread]: Command `dbt run` failed at 12:03:28.095406 after 0.62 seconds
[0m12:03:28.095624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad1a30>]}
[0m12:03:28.095778 [debug] [MainThread]: Flushing usage events
[0m12:05:15.779550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104464b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105946300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105946000>]}


============================== 12:05:15.782517 | 59688375-0435-464e-88f6-76adf266a476 ==============================
[0m12:05:15.782517 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:05:15.782837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_listen_and_tracks.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:05:15.973987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59688375-0435-464e-88f6-76adf266a476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cc8c0>]}
[0m12:05:15.997591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59688375-0435-464e-88f6-76adf266a476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e52b0>]}
[0m12:05:15.999536 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:05:16.010026 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:05:16.073410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:16.073752 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_listen_and_tracks.sql
[0m12:05:16.176570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59688375-0435-464e-88f6-76adf266a476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f24fb0>]}
[0m12:05:16.219615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59688375-0435-464e-88f6-76adf266a476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4aa80>]}
[0m12:05:16.219907 [info ] [MainThread]: Found 10 models, 3 sources, 416 macros
[0m12:05:16.220082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59688375-0435-464e-88f6-76adf266a476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a90290>]}
[0m12:05:16.220944 [info ] [MainThread]: 
[0m12:05:16.221224 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:05:16.221633 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:05:16.250824 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:05:16.251050 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:05:16.251198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:16.267561 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:05:16.268807 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:05:16.270234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:05:16.270459 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:05:16.273686 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:05:16.273856 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:05:16.273990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:16.277409 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:05:16.278233 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:05:16.278374 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:05:16.278538 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:05:16.278666 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:05:16.278791 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:05:16.279379 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:05:16.279782 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:05:16.279910 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:05:16.280023 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:05:16.280171 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:05:16.280297 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:05:16.283117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:05:16.285815 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:05:16.285975 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:05:16.286100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:16.289207 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:05:16.289385 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:05:16.289544 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:05:16.306706 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:05:16.307707 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:05:16.308710 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:05:16.308877 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:05:16.310697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59688375-0435-464e-88f6-76adf266a476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d18a40>]}
[0m12:05:16.310934 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:16.311070 [debug] [MainThread]: On master: BEGIN
[0m12:05:16.311193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:16.314375 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:05:16.314575 [debug] [MainThread]: On master: COMMIT
[0m12:05:16.314711 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:16.314832 [debug] [MainThread]: On master: COMMIT
[0m12:05:16.314984 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:05:16.315114 [debug] [MainThread]: On master: Close
[0m12:05:16.315665 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:05:16.315818 [info ] [MainThread]: 
[0m12:05:16.317106 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m12:05:16.317367 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m12:05:16.317564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen_and_tracks)
[0m12:05:16.317722 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m12:05:16.321413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m12:05:16.321999 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m12:05:16.337890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m12:05:16.338634 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:05:16.338809 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m12:05:16.338953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:16.342003 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:05:16.342202 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:05:16.342378 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_tracks" as r
ON l.track_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:05:16.346358 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:05:16.349535 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:05:16.349725 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" rename to "mart_listen_and_tracks"
[0m12:05:16.350482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:16.358844 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:05:16.359056 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:05:16.359216 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:05:16.359924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:05:16.362845 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:05:16.363029 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
drop table if exists "moovai_data"."main"."mart_listen_and_tracks__dbt_backup" cascade
[0m12:05:16.363263 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:05:16.364308 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m12:05:16.368306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59688375-0435-464e-88f6-76adf266a476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce1a00>]}
[0m12:05:16.368623 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.mart_listen_and_tracks .................. [[32mOK[0m in 0.05s]
[0m12:05:16.368908 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m12:05:16.369452 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:16.369613 [debug] [MainThread]: On master: BEGIN
[0m12:05:16.369734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:16.372854 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:05:16.373047 [debug] [MainThread]: On master: COMMIT
[0m12:05:16.373186 [debug] [MainThread]: Using duckdb connection "master"
[0m12:05:16.373324 [debug] [MainThread]: On master: COMMIT
[0m12:05:16.373516 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:05:16.373689 [debug] [MainThread]: On master: Close
[0m12:05:16.374412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:16.374563 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_tracks' was properly closed.
[0m12:05:16.374714 [info ] [MainThread]: 
[0m12:05:16.374861 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:05:16.375165 [debug] [MainThread]: Command end result
[0m12:05:16.388367 [info ] [MainThread]: 
[0m12:05:16.388616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:16.388760 [info ] [MainThread]: 
[0m12:05:16.388907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:05:16.390254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.64353466, "process_user_time": 1.010592, "process_kernel_time": 0.149903, "process_mem_max_rss": "136839168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:05:16.390513 [debug] [MainThread]: Command `dbt run` succeeded at 12:05:16.390472 after 0.64 seconds
[0m12:05:16.390694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105366cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f261e0>]}
[0m12:05:16.390852 [debug] [MainThread]: Flushing usage events
[0m12:10:55.049218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105728920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b461e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b45ee0>]}


============================== 12:10:55.052120 | 7f254b18-8ab8-4a79-be2b-04793e8f77c9 ==============================
[0m12:10:55.052120 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:10:55.052490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_listen_and_users.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:10:55.233964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f254b18-8ab8-4a79-be2b-04793e8f77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e0fe0>]}
[0m12:10:55.257278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f254b18-8ab8-4a79-be2b-04793e8f77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056914c0>]}
[0m12:10:55.258986 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:10:55.268776 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:10:55.331762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:10:55.332081 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/mart_liste_and_users.sql
[0m12:10:55.433792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f254b18-8ab8-4a79-be2b-04793e8f77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afe630>]}
[0m12:10:55.475796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f254b18-8ab8-4a79-be2b-04793e8f77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784dd90>]}
[0m12:10:55.476087 [info ] [MainThread]: Found 11 models, 3 sources, 416 macros
[0m12:10:55.476264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f254b18-8ab8-4a79-be2b-04793e8f77c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af3d10>]}
[0m12:10:55.476714 [warn ] [MainThread]: The selection criterion 'mart_listen_and_users.sql' does not match any enabled nodes
[0m12:10:55.477264 [info ] [MainThread]: 
[0m12:10:55.477423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:10:55.477649 [debug] [MainThread]: Command end result
[0m12:10:55.491087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.47666892, "process_user_time": 0.894823, "process_kernel_time": 0.134783, "process_mem_max_rss": "121094144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:10:55.491383 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:55.491336 after 0.48 seconds
[0m12:10:55.491573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b461b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b46150>]}
[0m12:10:55.491725 [debug] [MainThread]: Flushing usage events
[0m12:13:57.174855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106566120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106565e20>]}


============================== 12:13:57.177748 | d9a2a4d5-938d-42ef-aaaa-3511af9620ec ==============================
[0m12:13:57.177748 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:13:57.178105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_listen_and_users.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:13:57.366810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9a2a4d5-938d-42ef-aaaa-3511af9620ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106567d10>]}
[0m12:13:57.389804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9a2a4d5-938d-42ef-aaaa-3511af9620ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa1370>]}
[0m12:13:57.391582 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:13:57.401577 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:13:57.464455 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:13:57.464761 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/models/03_mart_layer/mart_listen_and_users.sql
[0m12:13:57.464909 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/03_mart_layer/mart_liste_and_users.sql
[0m12:13:57.566696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9a2a4d5-938d-42ef-aaaa-3511af9620ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a66780>]}
[0m12:13:57.612343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9a2a4d5-938d-42ef-aaaa-3511af9620ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6b560>]}
[0m12:13:57.612624 [info ] [MainThread]: Found 11 models, 3 sources, 416 macros
[0m12:13:57.612795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9a2a4d5-938d-42ef-aaaa-3511af9620ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663b380>]}
[0m12:13:57.613669 [info ] [MainThread]: 
[0m12:13:57.613935 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:13:57.614378 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:13:57.643872 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:13:57.644100 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:13:57.644247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:57.660606 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:13:57.661980 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:13:57.663532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:13:57.663781 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:13:57.667039 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:13:57.667206 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:13:57.667344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:57.671126 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:13:57.671903 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:13:57.672040 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:13:57.672206 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:13:57.672328 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:13:57.672450 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:13:57.673032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:13:57.673428 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:13:57.673559 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:13:57.673671 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:13:57.673818 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:13:57.673948 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:13:57.676894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:13:57.679560 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:13:57.679718 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:13:57.679841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:57.682882 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:13:57.683063 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:13:57.683215 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:13:57.697316 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:13:57.698263 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:13:57.699656 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:13:57.699821 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:13:57.702498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9a2a4d5-938d-42ef-aaaa-3511af9620ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e79b0>]}
[0m12:13:57.702764 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:57.702895 [debug] [MainThread]: On master: BEGIN
[0m12:13:57.703018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:57.706470 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:13:57.706677 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.706817 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:57.706942 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.707101 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:13:57.707262 [debug] [MainThread]: On master: Close
[0m12:13:57.708206 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:13:57.708363 [info ] [MainThread]: 
[0m12:13:57.709785 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m12:13:57.710056 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_listen_and_users ........................ [RUN]
[0m12:13:57.710253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen_and_users)
[0m12:13:57.710409 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_users
[0m12:13:57.714191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_users"
[0m12:13:57.714760 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_users
[0m12:13:57.730750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_users"
[0m12:13:57.731228 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:13:57.731387 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: BEGIN
[0m12:13:57.731528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:57.734701 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:13:57.734921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:13:57.735084 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_users__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_users" as r
ON l.track_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:13:57.740600 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:13:57.743774 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:13:57.743971 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users__dbt_tmp" rename to "mart_listen_and_users"
[0m12:13:57.744836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:13:57.753142 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:13:57.753329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:13:57.753481 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:13:57.754248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:13:57.757216 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:13:57.757403 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
drop table if exists "moovai_data"."main"."mart_listen_and_users__dbt_backup" cascade
[0m12:13:57.757643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:13:57.758725 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: Close
[0m12:13:57.763060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a2a4d5-938d-42ef-aaaa-3511af9620ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b018b0>]}
[0m12:13:57.763382 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.mart_listen_and_users ................... [[32mOK[0m in 0.05s]
[0m12:13:57.763659 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m12:13:57.764228 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:57.764390 [debug] [MainThread]: On master: BEGIN
[0m12:13:57.764508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:57.767550 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:13:57.767715 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.767845 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:57.767958 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.768112 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:13:57.768239 [debug] [MainThread]: On master: Close
[0m12:13:57.768739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:57.768875 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_users' was properly closed.
[0m12:13:57.769012 [info ] [MainThread]: 
[0m12:13:57.769153 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:13:57.769439 [debug] [MainThread]: Command end result
[0m12:13:57.784636 [info ] [MainThread]: 
[0m12:13:57.784888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:57.785036 [info ] [MainThread]: 
[0m12:13:57.785185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:13:57.786761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.64510226, "process_user_time": 1.004877, "process_kernel_time": 0.15772, "process_mem_max_rss": "137576448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:13:57.787010 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:57.786971 after 0.65 seconds
[0m12:13:57.787194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ecbf0>]}
[0m12:13:57.787356 [debug] [MainThread]: Flushing usage events
[0m12:15:23.823775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c91d00>]}


============================== 12:15:23.826806 | e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab ==============================
[0m12:15:23.826806 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:15:23.827168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select mart_listen_and_users.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:15:24.006637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105573bc0>]}
[0m12:15:24.030027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92030>]}
[0m12:15:24.032018 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:15:24.043295 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:15:24.108803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:24.109153 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/03_mart_layer/mart_listen_and_users.sql
[0m12:15:24.210807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e1fd0>]}
[0m12:15:24.257487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed5a30>]}
[0m12:15:24.257804 [info ] [MainThread]: Found 11 models, 3 sources, 416 macros
[0m12:15:24.257998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107187560>]}
[0m12:15:24.258970 [info ] [MainThread]: 
[0m12:15:24.259283 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:15:24.259744 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:15:24.289387 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:15:24.289619 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:15:24.289768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:24.305821 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:15:24.307086 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:15:24.308576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:15:24.308797 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:15:24.312037 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:24.312205 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:15:24.312340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:24.315942 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:15:24.316848 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:24.317030 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:15:24.317234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:15:24.317365 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:24.317491 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:15:24.318235 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:15:24.318642 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:15:24.318768 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:24.318886 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:15:24.319037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:15:24.319206 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:15:24.322141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:15:24.324767 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:15:24.324928 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:15:24.325050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:24.328142 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:15:24.328312 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:15:24.328463 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:15:24.341636 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:15:24.342561 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:15:24.343579 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:15:24.343742 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:15:24.345578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107558260>]}
[0m12:15:24.345800 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:24.345932 [debug] [MainThread]: On master: BEGIN
[0m12:15:24.346049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:24.349077 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:15:24.349250 [debug] [MainThread]: On master: COMMIT
[0m12:15:24.349387 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:24.349511 [debug] [MainThread]: On master: COMMIT
[0m12:15:24.349667 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:15:24.349795 [debug] [MainThread]: On master: Close
[0m12:15:24.350306 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:15:24.350471 [info ] [MainThread]: 
[0m12:15:24.351705 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m12:15:24.351962 [info ] [Thread-1 (]: 1 of 1 START sql table model main.mart_listen_and_users ........................ [RUN]
[0m12:15:24.352158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.mart_listen_and_users)
[0m12:15:24.352317 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_users
[0m12:15:24.356357 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_users"
[0m12:15:24.357042 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_users
[0m12:15:24.372749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_users"
[0m12:15:24.373186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:24.373353 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: BEGIN
[0m12:15:24.373497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:24.376650 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:24.376846 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:24.377020 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_users__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_users" as r
ON l.user_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:15:24.382682 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:15:24.385805 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:24.385993 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users" rename to "mart_listen_and_users__dbt_backup"
[0m12:15:24.386687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:15:24.387955 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:24.388116 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users__dbt_tmp" rename to "mart_listen_and_users"
[0m12:15:24.388346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:24.398286 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:15:24.398477 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:24.398635 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:15:24.399523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:15:24.401786 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:24.401977 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
drop table if exists "moovai_data"."main"."mart_listen_and_users__dbt_backup" cascade
[0m12:15:24.402442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:24.403497 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: Close
[0m12:15:24.407875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e36e63f5-f27a-4d2e-8f0e-2dad25fdc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761bec0>]}
[0m12:15:24.408205 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.mart_listen_and_users ................... [[32mOK[0m in 0.06s]
[0m12:15:24.408491 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m12:15:24.409030 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:24.409188 [debug] [MainThread]: On master: BEGIN
[0m12:15:24.409308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:24.412755 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:15:24.412986 [debug] [MainThread]: On master: COMMIT
[0m12:15:24.413128 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:24.413256 [debug] [MainThread]: On master: COMMIT
[0m12:15:24.413451 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:15:24.413628 [debug] [MainThread]: On master: Close
[0m12:15:24.415112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:24.415252 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_users' was properly closed.
[0m12:15:24.415426 [info ] [MainThread]: 
[0m12:15:24.415581 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:15:24.415896 [debug] [MainThread]: Command end result
[0m12:15:24.433458 [info ] [MainThread]: 
[0m12:15:24.433730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:24.433879 [info ] [MainThread]: 
[0m12:15:24.434249 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:15:24.435793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.644213, "process_user_time": 1.013217, "process_kernel_time": 0.150864, "process_mem_max_rss": "138641408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:15:24.436063 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:24.436020 after 0.64 seconds
[0m12:15:24.436245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c916d0>]}
[0m12:15:24.436409 [debug] [MainThread]: Flushing usage events
[0m12:15:57.661294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105934920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a16240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a15f40>]}


============================== 12:15:57.664495 | 9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b ==============================
[0m12:15:57.664495 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:15:57.664840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:15:57.890153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7f140>]}
[0m12:15:57.914900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ae2d0>]}
[0m12:15:57.916985 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:15:57.928314 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:15:58.001102 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m12:15:58.001520 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/03_mart_layer/mart_tracks.sql
[0m12:15:58.001802 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/03_mart_layer/mart_listen.sql
[0m12:15:58.002135 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/models/03_mart_layer/mart_users.sql
[0m12:15:58.045124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd5d00>]}
[0m12:15:58.088514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105476ed0>]}
[0m12:15:58.088814 [info ] [MainThread]: Found 8 models, 3 sources, 416 macros
[0m12:15:58.089027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e25250>]}
[0m12:15:58.090020 [info ] [MainThread]: 
[0m12:15:58.090303 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:15:58.092685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:15:58.120543 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:15:58.120798 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:15:58.120947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:58.133401 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:15:58.134493 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:15:58.135806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:15:58.136021 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:15:58.139272 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:58.139441 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:15:58.139578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:58.143216 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:15:58.143879 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:58.144022 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:15:58.144188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:15:58.144313 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:58.144440 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:15:58.144989 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:15:58.145441 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:15:58.145580 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:15:58.145703 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:15:58.145863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:15:58.145997 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:15:58.147115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:15:58.149713 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:15:58.149879 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:15:58.150009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:58.153051 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:15:58.153215 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:15:58.153363 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:15:58.166428 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:15:58.167205 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:15:58.168187 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:15:58.168318 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:15:58.170144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b94c80>]}
[0m12:15:58.170397 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:58.170534 [debug] [MainThread]: On master: BEGIN
[0m12:15:58.170654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:58.173636 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:15:58.173811 [debug] [MainThread]: On master: COMMIT
[0m12:15:58.173945 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:58.174064 [debug] [MainThread]: On master: COMMIT
[0m12:15:58.174220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:15:58.174344 [debug] [MainThread]: On master: Close
[0m12:15:58.174855 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:15:58.175021 [info ] [MainThread]: 
[0m12:15:58.176207 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:15:58.176462 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m12:15:58.176663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:15:58.176819 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:15:58.180264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:15:58.181050 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:15:58.196005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:15:58.196770 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:15:58.196942 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:15:58.197087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.200532 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.200813 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:15:58.200980 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    --

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:15:58.202197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:15:58.205305 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:15:58.205499 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:15:58.205812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.207142 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:15:58.207301 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:15:58.207517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.215548 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:15:58.215735 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:15:58.215884 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:15:58.216735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:15:58.219668 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:15:58.219865 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:15:58.220168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.221210 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:15:58.225071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb1730>]}
[0m12:15:58.225371 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:15:58.225645 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:15:58.225843 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m12:15:58.226143 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m12:15:58.226372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m12:15:58.226538 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m12:15:58.227774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m12:15:58.228123 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m12:15:58.229605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m12:15:58.229920 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:15:58.230079 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m12:15:58.230218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.233410 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.233600 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:15:58.233760 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    --

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m12:15:58.234090 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.235647 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:15:58.235831 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m12:15:58.236127 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.237672 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:15:58.237851 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m12:15:58.238100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.238794 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:15:58.238982 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:15:58.239117 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:15:58.239526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.240641 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:15:58.240803 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m12:15:58.241088 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.241690 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m12:15:58.244451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072391c0>]}
[0m12:15:58.244780 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m12:15:58.245055 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m12:15:58.245248 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m12:15:58.245548 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m12:15:58.245759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m12:15:58.245914 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m12:15:58.247203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m12:15:58.247550 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m12:15:58.249040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m12:15:58.249332 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:15:58.249477 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m12:15:58.249612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.252824 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.253021 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:15:58.253182 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m12:15:58.253514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.255014 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:15:58.255178 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m12:15:58.255410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.256665 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:15:58.256818 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m12:15:58.257029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.257693 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:15:58.257839 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:15:58.258012 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:15:58.258396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.259418 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:15:58.259575 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m12:15:58.259849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.260489 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m12:15:58.263330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107251280>]}
[0m12:15:58.263641 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m12:15:58.263897 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m12:15:58.264078 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m12:15:58.264323 [info ] [Thread-1 (]: 4 of 8 START sql table model main.int_fact_listen .............................. [RUN]
[0m12:15:58.264536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m12:15:58.264706 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m12:15:58.266129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m12:15:58.266817 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m12:15:58.277048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m12:15:58.277457 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:15:58.277621 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m12:15:58.277767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.281003 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.281195 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:15:58.281358 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_fact_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
[0m12:15:58.282388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:15:58.283813 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:15:58.283990 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen" rename to "int_fact_listen__dbt_backup"
[0m12:15:58.284245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.285568 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:15:58.285773 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen__dbt_tmp" rename to "int_fact_listen"
[0m12:15:58.286074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.288674 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:15:58.288902 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:15:58.289050 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:15:58.289472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.290732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:15:58.290890 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
drop table if exists "moovai_data"."main"."int_fact_listen__dbt_backup" cascade
[0m12:15:58.291191 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.291794 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m12:15:58.294423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f89b0>]}
[0m12:15:58.294713 [info ] [Thread-1 (]: 4 of 8 OK created sql table model main.int_fact_listen ......................... [[32mOK[0m in 0.03s]
[0m12:15:58.294968 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m12:15:58.295164 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m12:15:58.295415 [info ] [Thread-1 (]: 5 of 8 START sql view model main.int_dim_tracks ................................ [RUN]
[0m12:15:58.295603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m12:15:58.295759 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m12:15:58.297200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m12:15:58.297538 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m12:15:58.299036 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m12:15:58.299550 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:15:58.299707 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m12:15:58.299851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.303006 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.303203 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:15:58.303364 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
  create view "moovai_data"."main"."int_dim_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

--INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m12:15:58.303727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.305236 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:15:58.305403 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks" rename to "int_dim_tracks__dbt_backup"
[0m12:15:58.305626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.306872 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:15:58.307033 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks__dbt_tmp" rename to "int_dim_tracks"
[0m12:15:58.307246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.307913 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:15:58.308104 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:15:58.308240 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:15:58.308609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.309593 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:15:58.309745 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
drop view if exists "moovai_data"."main"."int_dim_tracks__dbt_backup" cascade
[0m12:15:58.310040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.310664 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m12:15:58.313531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f69f0>]}
[0m12:15:58.313844 [info ] [Thread-1 (]: 5 of 8 OK created sql view model main.int_dim_tracks ........................... [[32mOK[0m in 0.02s]
[0m12:15:58.314103 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m12:15:58.314285 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m12:15:58.314565 [info ] [Thread-1 (]: 6 of 8 START sql view model main.int_dim_users ................................. [RUN]
[0m12:15:58.314775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m12:15:58.314934 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m12:15:58.316343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m12:15:58.316941 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m12:15:58.318451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m12:15:58.318902 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:15:58.319055 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m12:15:58.319196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.322529 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.322732 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:15:58.322892 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
  create view "moovai_data"."main"."int_dim_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

--INSERT INTO int_users
select *
from cte_src_users
  );

[0m12:15:58.323231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.324742 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:15:58.324909 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users" rename to "int_dim_users__dbt_backup"
[0m12:15:58.325135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.327344 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:15:58.327511 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users__dbt_tmp" rename to "int_dim_users"
[0m12:15:58.327728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.328443 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:15:58.328590 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:15:58.328728 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:15:58.329115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.330118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:15:58.330272 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
drop view if exists "moovai_data"."main"."int_dim_users__dbt_backup" cascade
[0m12:15:58.330519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.331085 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m12:15:58.333678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732d0a0>]}
[0m12:15:58.333979 [info ] [Thread-1 (]: 6 of 8 OK created sql view model main.int_dim_users ............................ [[32mOK[0m in 0.02s]
[0m12:15:58.334236 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m12:15:58.334420 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m12:15:58.334682 [info ] [Thread-1 (]: 7 of 8 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m12:15:58.334860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen_and_tracks)
[0m12:15:58.335022 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m12:15:58.336636 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.338038 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m12:15:58.339574 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.339885 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.340047 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m12:15:58.340200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.343517 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.343708 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.343878 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_tracks" as r
ON l.track_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:15:58.345653 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:15:58.347119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.347288 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovai_data"."main"."mart_listen_and_tracks" rename to "mart_listen_and_tracks__dbt_backup"
[0m12:15:58.347542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.348795 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.348954 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" rename to "mart_listen_and_tracks"
[0m12:15:58.349214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.349964 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:15:58.350119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.350255 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:15:58.350653 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.351684 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:15:58.351843 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
drop table if exists "moovai_data"."main"."mart_listen_and_tracks__dbt_backup" cascade
[0m12:15:58.352120 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.352698 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m12:15:58.355317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107326510>]}
[0m12:15:58.355609 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.mart_listen_and_tracks .................. [[32mOK[0m in 0.02s]
[0m12:15:58.355870 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m12:15:58.356063 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m12:15:58.356323 [info ] [Thread-1 (]: 8 of 8 START sql table model main.mart_listen_and_users ........................ [RUN]
[0m12:15:58.356553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.mart_listen_and_users)
[0m12:15:58.356735 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_users
[0m12:15:58.358372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_users"
[0m12:15:58.358828 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_users
[0m12:15:58.360444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_users"
[0m12:15:58.360776 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:58.360937 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: BEGIN
[0m12:15:58.361080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:58.364243 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:15:58.364440 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:58.364613 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_users__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_users" as r
ON l.user_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:15:58.365492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:15:58.366952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:58.367118 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users" rename to "mart_listen_and_users__dbt_backup"
[0m12:15:58.367406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.368666 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:58.368819 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users__dbt_tmp" rename to "mart_listen_and_users"
[0m12:15:58.369039 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.369765 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:15:58.369924 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:58.370067 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:15:58.370453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.371489 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:15:58.371660 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
drop table if exists "moovai_data"."main"."mart_listen_and_users__dbt_backup" cascade
[0m12:15:58.371932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:15:58.372517 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: Close
[0m12:15:58.375178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b1ff3e5-54a2-4a76-9b60-16fc3a42c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073109b0>]}
[0m12:15:58.375491 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main.mart_listen_and_users ................... [[32mOK[0m in 0.02s]
[0m12:15:58.375760 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m12:15:58.376314 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:58.376456 [debug] [MainThread]: On master: BEGIN
[0m12:15:58.376571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:58.379663 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:15:58.379841 [debug] [MainThread]: On master: COMMIT
[0m12:15:58.379978 [debug] [MainThread]: Using duckdb connection "master"
[0m12:15:58.380101 [debug] [MainThread]: On master: COMMIT
[0m12:15:58.380254 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:15:58.380380 [debug] [MainThread]: On master: Close
[0m12:15:58.380864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:58.380979 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_users' was properly closed.
[0m12:15:58.381159 [info ] [MainThread]: 
[0m12:15:58.381319 [info ] [MainThread]: Finished running 5 view models, 3 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m12:15:58.382033 [debug] [MainThread]: Command end result
[0m12:15:58.398150 [info ] [MainThread]: 
[0m12:15:58.398403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:58.398554 [info ] [MainThread]: 
[0m12:15:58.398705 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:15:58.400025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7716179, "process_user_time": 1.100473, "process_kernel_time": 0.167352, "process_mem_max_rss": "133906432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:15:58.400275 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:58.400236 after 0.77 seconds
[0m12:15:58.400455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a16180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a15bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b61af0>]}
[0m12:15:58.400790 [debug] [MainThread]: Flushing usage events
[0m12:16:53.581484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8dcd0>]}


============================== 12:16:53.584457 | bd34833f-2855-4ddb-90bb-6a0645808a90 ==============================
[0m12:16:53.584457 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:16:53.584770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:16:53.767761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106680c80>]}
[0m12:16:53.791080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b29850>]}
[0m12:16:53.792853 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:16:53.802885 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:16:53.864864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:16:53.865213 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m12:16:53.865401 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m12:16:53.865573 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_fact_listen.sql
[0m12:16:53.977554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4a090>]}
[0m12:16:54.022501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccdcd0>]}
[0m12:16:54.022775 [info ] [MainThread]: Found 8 models, 3 sources, 416 macros
[0m12:16:54.022947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efb3e0>]}
[0m12:16:54.023934 [info ] [MainThread]: 
[0m12:16:54.024209 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:16:54.026534 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:16:54.055302 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:16:54.055542 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:16:54.055733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:54.071166 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:16:54.072425 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:16:54.073907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:16:54.074124 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:16:54.077409 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:16:54.077584 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:16:54.077718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:54.081421 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:16:54.082254 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:16:54.082396 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:16:54.082561 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:16:54.082687 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:16:54.082814 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:16:54.083428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:16:54.083836 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:16:54.083961 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:16:54.084076 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:16:54.084224 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:16:54.084354 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:16:54.085439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:16:54.088117 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:16:54.088277 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:16:54.088404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:54.091596 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:16:54.091775 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:16:54.091930 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:16:54.105600 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:16:54.106447 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:16:54.107465 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:16:54.107610 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:16:54.109547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107362270>]}
[0m12:16:54.109823 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:54.109951 [debug] [MainThread]: On master: BEGIN
[0m12:16:54.110066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:54.113087 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:16:54.113260 [debug] [MainThread]: On master: COMMIT
[0m12:16:54.113396 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:54.113520 [debug] [MainThread]: On master: COMMIT
[0m12:16:54.113674 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:16:54.113805 [debug] [MainThread]: On master: Close
[0m12:16:54.114353 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:16:54.114500 [info ] [MainThread]: 
[0m12:16:54.115726 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:16:54.115996 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m12:16:54.116200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:16:54.116358 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:16:54.119733 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:16:54.120531 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:16:54.135570 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:16:54.136230 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:16:54.136406 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:16:54.136555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.139842 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.140096 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:16:54.140272 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:16:54.142385 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:16:54.145566 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:16:54.145761 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:16:54.146523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:16:54.148512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:16:54.148683 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:16:54.148918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.156668 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:16:54.156856 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:16:54.157001 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:16:54.157839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:16:54.160106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:16:54.160288 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:16:54.160606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.161657 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:16:54.166126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b2870>]}
[0m12:16:54.166435 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:16:54.166713 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:16:54.166912 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m12:16:54.167182 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m12:16:54.167373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m12:16:54.167524 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m12:16:54.168732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m12:16:54.169044 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m12:16:54.170598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m12:16:54.170889 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:16:54.171042 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m12:16:54.171178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.174411 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.174600 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:16:54.174760 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m12:16:54.175096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.176516 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:16:54.176684 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m12:16:54.176908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.178191 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:16:54.178347 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m12:16:54.178554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.179219 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:16:54.179362 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:16:54.179493 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:16:54.179989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.181199 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:16:54.181384 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m12:16:54.181818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.182442 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m12:16:54.185164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073132f0>]}
[0m12:16:54.185453 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m12:16:54.185708 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m12:16:54.185893 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m12:16:54.186155 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m12:16:54.186335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m12:16:54.186486 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m12:16:54.187741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m12:16:54.188063 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m12:16:54.189582 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m12:16:54.189886 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:16:54.190046 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m12:16:54.190188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.193452 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.193643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:16:54.193805 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m12:16:54.194128 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.195635 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:16:54.195809 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m12:16:54.196042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.197354 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:16:54.197505 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m12:16:54.197710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.198381 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:16:54.198523 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:16:54.198656 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:16:54.199079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.200154 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:16:54.200310 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m12:16:54.200573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.201145 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m12:16:54.203752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073131d0>]}
[0m12:16:54.204042 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m12:16:54.204291 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m12:16:54.204467 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m12:16:54.204771 [info ] [Thread-1 (]: 4 of 8 START sql view model main.int_fact_listen ............................... [RUN]
[0m12:16:54.205028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m12:16:54.205205 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m12:16:54.207591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m12:16:54.208321 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m12:16:54.209901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m12:16:54.210414 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:16:54.210584 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m12:16:54.210734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.213925 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.214110 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:16:54.214270 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
  create view "moovai_data"."main"."int_fact_listen__dbt_tmp" as (
    

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
  );

[0m12:16:54.214604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.216101 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:16:54.216267 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen" rename to "int_fact_listen__dbt_backup"
[0m12:16:54.216501 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.217778 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:16:54.217931 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter view "moovai_data"."main"."int_fact_listen__dbt_tmp" rename to "int_fact_listen"
[0m12:16:54.218144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.218808 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:16:54.218952 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:16:54.219084 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:16:54.219493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.220505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:16:54.220655 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
drop table if exists "moovai_data"."main"."int_fact_listen__dbt_backup" cascade
[0m12:16:54.220904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.221612 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m12:16:54.224197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074575f0>]}
[0m12:16:54.224487 [info ] [Thread-1 (]: 4 of 8 OK created sql view model main.int_fact_listen .......................... [[32mOK[0m in 0.02s]
[0m12:16:54.224739 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m12:16:54.224918 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m12:16:54.225134 [info ] [Thread-1 (]: 5 of 8 START sql view model main.int_dim_tracks ................................ [RUN]
[0m12:16:54.225314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m12:16:54.225464 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m12:16:54.226850 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m12:16:54.227165 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m12:16:54.228626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m12:16:54.228899 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:16:54.229049 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m12:16:54.229185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.232706 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.232958 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:16:54.233126 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
  create view "moovai_data"."main"."int_dim_tracks__dbt_tmp" as (
    

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

--INSERT INTO int_tracks
select *
from cte_src_tracks
  );

[0m12:16:54.233506 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.235085 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:16:54.235252 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks" rename to "int_dim_tracks__dbt_backup"
[0m12:16:54.235484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.236770 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:16:54.236938 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks__dbt_tmp" rename to "int_dim_tracks"
[0m12:16:54.237148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.237818 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:16:54.237965 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:16:54.238098 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:16:54.238532 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.239584 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:16:54.239758 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
drop view if exists "moovai_data"."main"."int_dim_tracks__dbt_backup" cascade
[0m12:16:54.240101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.240763 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m12:16:54.243398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107427380>]}
[0m12:16:54.243686 [info ] [Thread-1 (]: 5 of 8 OK created sql view model main.int_dim_tracks ........................... [[32mOK[0m in 0.02s]
[0m12:16:54.243937 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m12:16:54.244124 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m12:16:54.244414 [info ] [Thread-1 (]: 6 of 8 START sql view model main.int_dim_users ................................. [RUN]
[0m12:16:54.244635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m12:16:54.244804 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m12:16:54.246405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m12:16:54.246802 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m12:16:54.248396 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m12:16:54.248731 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:16:54.248887 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m12:16:54.249032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.252415 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.252648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:16:54.252814 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
  create view "moovai_data"."main"."int_dim_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

--INSERT INTO int_users
select *
from cte_src_users
  );

[0m12:16:54.253171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.255752 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:16:54.255968 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users" rename to "int_dim_users__dbt_backup"
[0m12:16:54.256298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.257931 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:16:54.258125 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users__dbt_tmp" rename to "int_dim_users"
[0m12:16:54.258401 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.259099 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:16:54.259256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:16:54.259395 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:16:54.260033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.261357 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:16:54.261534 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
drop view if exists "moovai_data"."main"."int_dim_users__dbt_backup" cascade
[0m12:16:54.262094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.262751 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m12:16:54.266984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107336660>]}
[0m12:16:54.267337 [info ] [Thread-1 (]: 6 of 8 OK created sql view model main.int_dim_users ............................ [[32mOK[0m in 0.02s]
[0m12:16:54.267601 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m12:16:54.267800 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m12:16:54.268080 [info ] [Thread-1 (]: 7 of 8 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m12:16:54.268281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen_and_tracks)
[0m12:16:54.268441 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m12:16:54.270133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.270670 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m12:16:54.281216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.281693 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.281866 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m12:16:54.282017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.285345 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.285600 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.285772 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_tracks" as r
ON l.track_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:16:54.289260 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.290873 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.291078 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovai_data"."main"."mart_listen_and_tracks" rename to "mart_listen_and_tracks__dbt_backup"
[0m12:16:54.291381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.292653 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.292837 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" rename to "mart_listen_and_tracks"
[0m12:16:54.293096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.295710 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:16:54.295921 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.296076 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:16:54.296602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.297811 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:16:54.298038 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
drop table if exists "moovai_data"."main"."mart_listen_and_tracks__dbt_backup" cascade
[0m12:16:54.298361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.299024 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m12:16:54.301968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073136b0>]}
[0m12:16:54.302327 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.mart_listen_and_tracks .................. [[32mOK[0m in 0.03s]
[0m12:16:54.302593 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m12:16:54.302797 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m12:16:54.303063 [info ] [Thread-1 (]: 8 of 8 START sql table model main.mart_listen_and_users ........................ [RUN]
[0m12:16:54.303313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.mart_listen_and_users)
[0m12:16:54.303490 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_users
[0m12:16:54.305146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_users"
[0m12:16:54.305676 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_users
[0m12:16:54.307292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_users"
[0m12:16:54.307639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:16:54.307803 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: BEGIN
[0m12:16:54.307949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.311324 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:16:54.311571 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:16:54.311740 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_users__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_users" as r
ON l.user_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:16:54.312732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:16:54.314263 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:16:54.314440 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users" rename to "mart_listen_and_users__dbt_backup"
[0m12:16:54.314713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.316981 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:16:54.317161 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users__dbt_tmp" rename to "mart_listen_and_users"
[0m12:16:54.317423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.318182 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:16:54.318381 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:16:54.318521 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:16:54.319121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.320196 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:16:54.320353 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
drop table if exists "moovai_data"."main"."mart_listen_and_users__dbt_backup" cascade
[0m12:16:54.320638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:54.321234 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: Close
[0m12:16:54.324106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd34833f-2855-4ddb-90bb-6a0645808a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c4f50>]}
[0m12:16:54.324457 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main.mart_listen_and_users ................... [[32mOK[0m in 0.02s]
[0m12:16:54.324744 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m12:16:54.325496 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:54.325730 [debug] [MainThread]: On master: BEGIN
[0m12:16:54.325870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:54.329364 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:16:54.329589 [debug] [MainThread]: On master: COMMIT
[0m12:16:54.329724 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:54.329847 [debug] [MainThread]: On master: COMMIT
[0m12:16:54.330014 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:16:54.330142 [debug] [MainThread]: On master: Close
[0m12:16:54.330693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:54.330844 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_users' was properly closed.
[0m12:16:54.331037 [info ] [MainThread]: 
[0m12:16:54.331207 [info ] [MainThread]: Finished running 6 view models, 2 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m12:16:54.331848 [debug] [MainThread]: Command end result
[0m12:16:54.345803 [info ] [MainThread]: 
[0m12:16:54.346063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:54.346214 [info ] [MainThread]: 
[0m12:16:54.346369 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:16:54.347884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.79966754, "process_user_time": 1.156416, "process_kernel_time": 0.1623, "process_mem_max_rss": "141623296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:54.348129 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:54.348091 after 0.80 seconds
[0m12:16:54.348307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d7ce0>]}
[0m12:16:54.348460 [debug] [MainThread]: Flushing usage events
[0m12:28:34.209999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfc800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a346150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a345e50>]}


============================== 12:28:34.213593 | 2525d089-3356-4bb5-9eaa-c64a19aae051 ==============================
[0m12:28:34.213593 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:28:34.213967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:28:34.395650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2525d089-3356-4bb5-9eaa-c64a19aae051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cc0b0>]}
[0m12:28:34.419083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2525d089-3356-4bb5-9eaa-c64a19aae051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a320d10>]}
[0m12:28:34.420968 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:28:34.431796 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:28:34.472873 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:28:34.474507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29910037, "process_user_time": 0.756817, "process_kernel_time": 0.12472, "process_mem_max_rss": "117489664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:34.474799 [debug] [MainThread]: Command `dbt run` failed at 12:28:34.474749 after 0.30 seconds
[0m12:28:34.475015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a345e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b234b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b234950>]}
[0m12:28:34.475190 [debug] [MainThread]: Flushing usage events
[0m12:28:46.321073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a20c0>]}


============================== 12:28:46.323838 | 8ef11ef4-13c1-433a-8172-c2c8fc24b824 ==============================
[0m12:28:46.323838 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:28:46.324174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:46.496066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ef11ef4-13c1-433a-8172-c2c8fc24b824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bd040>]}
[0m12:28:46.519039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ef11ef4-13c1-433a-8172-c2c8fc24b824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfd190>]}
[0m12:28:46.521451 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:28:46.531560 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:28:46.570535 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:28:46.572295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28183085, "process_user_time": 0.760347, "process_kernel_time": 0.111992, "process_mem_max_rss": "116719616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:46.572583 [debug] [MainThread]: Command `dbt run` failed at 12:28:46.572535 after 0.28 seconds
[0m12:28:46.572795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065077a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516900>]}
[0m12:28:46.572977 [debug] [MainThread]: Flushing usage events
[0m12:31:17.914431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635dee0>]}


============================== 12:31:17.917359 | d87df0de-50dc-4d2c-9e5c-91e696ed5a82 ==============================
[0m12:31:17.917359 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:31:17.917682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:18.096143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd87df0de-50dc-4d2c-9e5c-91e696ed5a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064aeff0>]}
[0m12:31:18.119509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd87df0de-50dc-4d2c-9e5c-91e696ed5a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed42f0>]}
[0m12:31:18.121313 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:31:18.131510 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:31:18.171254 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:31:18.173447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29190633, "process_user_time": 0.747301, "process_kernel_time": 0.112371, "process_mem_max_rss": "117768192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:31:18.173764 [debug] [MainThread]: Command `dbt run` failed at 12:31:18.173711 after 0.29 seconds
[0m12:31:18.173993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ac290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052546e0>]}
[0m12:31:18.174171 [debug] [MainThread]: Flushing usage events
[0m12:32:17.170512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042105c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104516270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515f70>]}


============================== 12:32:17.173494 | df59d279-cbb5-4bfe-9504-972a6ab22446 ==============================
[0m12:32:17.173494 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:32:17.173839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:17.360976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df59d279-cbb5-4bfe-9504-972a6ab22446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458cb00>]}
[0m12:32:17.384211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df59d279-cbb5-4bfe-9504-972a6ab22446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a76840>]}
[0m12:32:17.385964 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:32:17.396003 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:32:17.436588 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen.sql
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:32:17.438304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.30047855, "process_user_time": 0.759952, "process_kernel_time": 0.111895, "process_mem_max_rss": "116375552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:17.438598 [debug] [MainThread]: Command `dbt run` failed at 12:32:17.438548 after 0.30 seconds
[0m12:32:17.438818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045160f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461b740>]}
[0m12:32:17.438999 [debug] [MainThread]: Flushing usage events
[0m12:32:29.333365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104669e20>]}


============================== 12:32:29.336145 | 33d52773-fa58-4ccd-a277-e1ca90288cc1 ==============================
[0m12:32:29.336145 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:32:29.336474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:29.516142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33d52773-fa58-4ccd-a277-e1ca90288cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d1580>]}
[0m12:32:29.539388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33d52773-fa58-4ccd-a277-e1ca90288cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461de50>]}
[0m12:32:29.541109 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:32:29.551481 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:32:29.591593 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen.sql
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:32:29.593344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2908239, "process_user_time": 0.752612, "process_kernel_time": 0.101716, "process_mem_max_rss": "116031488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:29.593677 [debug] [MainThread]: Command `dbt run` failed at 12:32:29.593622 after 0.29 seconds
[0m12:32:29.593934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104669ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c0320>]}
[0m12:32:29.594310 [debug] [MainThread]: Flushing usage events
[0m12:37:27.432079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aa8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf1e80>]}


============================== 12:37:27.435063 | e50443aa-a001-424a-bd7b-a9016c29c493 ==============================
[0m12:37:27.435063 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:37:27.435450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:27.615729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e50443aa-a001-424a-bd7b-a9016c29c493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf2600>]}
[0m12:37:27.638977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e50443aa-a001-424a-bd7b-a9016c29c493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d142c0>]}
[0m12:37:27.640818 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:37:27.651643 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:37:27.692969 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen.sql
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:37:27.694614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2964638, "process_user_time": 0.748555, "process_kernel_time": 0.127604, "process_mem_max_rss": "117194752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:37:27.694907 [debug] [MainThread]: Command `dbt run` failed at 12:37:27.694857 after 0.30 seconds
[0m12:37:27.695125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5b7a0>]}
[0m12:37:27.695307 [debug] [MainThread]: Flushing usage events
[0m12:37:48.315645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b89f40>]}


============================== 12:37:48.318502 | 1f276d29-8815-4aed-9854-6a512dd7d341 ==============================
[0m12:37:48.318502 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:37:48.318835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:37:48.491042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f276d29-8815-4aed-9854-6a512dd7d341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bac0e0>]}
[0m12:37:48.514368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f276d29-8815-4aed-9854-6a512dd7d341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf2ae0>]}
[0m12:37:48.516082 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:37:48.525797 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:37:48.566453 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:37:48.568189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28416374, "process_user_time": 0.748998, "process_kernel_time": 0.103402, "process_mem_max_rss": "115982336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:37:48.568505 [debug] [MainThread]: Command `dbt run` failed at 12:37:48.568454 after 0.28 seconds
[0m12:37:48.568722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b89f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c10290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c90aa0>]}
[0m12:37:48.568903 [debug] [MainThread]: Flushing usage events
[0m12:38:05.925146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085add60>]}


============================== 12:38:05.928003 | 2e6e1d46-cfb0-4584-b137-756b9aae9714 ==============================
[0m12:38:05.928003 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:38:05.928345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select src_listen.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:06.110517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e6e1d46-cfb0-4584-b137-756b9aae9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070686b0>]}
[0m12:38:06.133635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e6e1d46-cfb0-4584-b137-756b9aae9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ce0f0>]}
[0m12:38:06.135350 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:38:06.146028 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:38:06.187844 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |  models:
    4  |    - name: src_listen
    5  |      description: "ingestion"
    6  |      columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m12:38:06.189554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2961905, "process_user_time": 0.74556, "process_kernel_time": 0.112448, "process_mem_max_rss": "115523584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:38:06.189881 [debug] [MainThread]: Command `dbt run` failed at 12:38:06.189828 after 0.30 seconds
[0m12:38:06.190114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ae150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a1580>]}
[0m12:38:06.190304 [debug] [MainThread]: Flushing usage events
[0m12:38:32.393150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106965fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106965c70>]}


============================== 12:38:32.396122 | 242fe68f-0059-4fa7-93d2-a9772ad0e3f3 ==============================
[0m12:38:32.396122 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:38:32.396432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:38:32.568708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105572ba0>]}
[0m12:38:32.592547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106915730>]}
[0m12:38:32.594956 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:38:32.604777 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:38:32.665884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:38:32.666237 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m12:38:32.666437 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_dim_tracks.sql
[0m12:38:32.666608 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_fact_listen.sql
[0m12:38:32.666770 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/02_intermediate_layer/int_dim_users.sql
[0m12:38:32.762788 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:38:32.763111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aae780>]}
[0m12:38:32.843736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd6570>]}
[0m12:38:32.895756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f80fe0>]}
[0m12:38:32.896045 [info ] [MainThread]: Found 8 models, 2 data tests, 3 sources, 416 macros
[0m12:38:32.896215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf5d90>]}
[0m12:38:32.897075 [info ] [MainThread]: 
[0m12:38:32.897350 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:38:32.897828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:38:32.927190 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:38:32.927421 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:38:32.927562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:32.944367 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:38:32.945648 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:38:32.947149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:38:32.947375 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:38:32.950624 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:32.950791 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:38:32.951202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:32.954919 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:38:32.955754 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:32.955896 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:38:32.956056 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:32.956182 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:32.956305 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:38:32.956803 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:32.957283 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:38:32.957432 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:32.957559 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:38:32.957735 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:32.957871 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:38:32.960798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:38:32.963437 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:38:32.963604 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:38:32.963742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:32.966788 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:38:32.966957 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:38:32.967105 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:38:32.980515 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:38:32.981390 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:38:32.982395 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:38:32.982567 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:38:32.984335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9a8d0>]}
[0m12:38:32.984566 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:32.984697 [debug] [MainThread]: On master: BEGIN
[0m12:38:32.984814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:32.987799 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:38:32.987972 [debug] [MainThread]: On master: COMMIT
[0m12:38:32.988103 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:32.988231 [debug] [MainThread]: On master: COMMIT
[0m12:38:32.988390 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:32.988520 [debug] [MainThread]: On master: Close
[0m12:38:32.989072 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:38:32.989271 [info ] [MainThread]: 
[0m12:38:32.990557 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:38:32.990833 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m12:38:32.991054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:38:32.991268 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:38:32.994977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:38:32.995859 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:38:33.011762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:38:33.012548 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:33.012740 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:38:33.012899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:33.016567 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:38:33.016783 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:33.016945 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:38:33.019008 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:38:33.022273 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:33.022463 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:38:33.023200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:38:33.024567 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:33.024733 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:38:33.024966 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:33.032699 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:38:33.032887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:33.033035 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:38:33.033853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:38:33.036106 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:33.036278 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:38:33.036553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:33.037588 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:38:33.041991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242fe68f-0059-4fa7-93d2-a9772ad0e3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523ecc0>]}
[0m12:38:33.042300 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:38:33.042583 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:38:33.043132 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:33.043275 [debug] [MainThread]: On master: BEGIN
[0m12:38:33.043391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:33.046488 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:38:33.046670 [debug] [MainThread]: On master: COMMIT
[0m12:38:33.046798 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:33.047096 [debug] [MainThread]: On master: COMMIT
[0m12:38:33.047266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:33.047395 [debug] [MainThread]: On master: Close
[0m12:38:33.047903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:33.048043 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m12:38:33.048185 [info ] [MainThread]: 
[0m12:38:33.048333 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:38:33.048620 [debug] [MainThread]: Command end result
[0m12:38:33.066726 [info ] [MainThread]: 
[0m12:38:33.066994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:33.067140 [info ] [MainThread]: 
[0m12:38:33.067290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:33.069190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.70762885, "process_user_time": 1.088953, "process_kernel_time": 0.143605, "process_mem_max_rss": "138641408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:38:33.069481 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:33.069435 after 0.71 seconds
[0m12:38:33.069690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106965cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106965f40>]}
[0m12:38:33.069857 [debug] [MainThread]: Flushing usage events
[0m12:38:45.464940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbe120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbddf0>]}


============================== 12:38:45.468267 | 173d8ddd-8f23-412c-b0b7-b1f527788011 ==============================
[0m12:38:45.468267 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:38:45.468599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:38:45.656690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebf230>]}
[0m12:38:45.680249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e3b9b0>]}
[0m12:38:45.682075 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:38:45.691737 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:38:45.758959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:45.759358 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m12:38:45.852035 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:38:45.852362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911e6c0>]}
[0m12:38:45.927028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109324500>]}
[0m12:38:45.983098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093025d0>]}
[0m12:38:45.983373 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 416 macros
[0m12:38:45.983542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b61970>]}
[0m12:38:45.984433 [info ] [MainThread]: 
[0m12:38:45.984713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:38:45.985151 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:38:46.012043 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:38:46.012320 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:38:46.012474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:46.027464 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:38:46.028433 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:38:46.029966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:38:46.030188 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:38:46.033497 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:46.033669 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:38:46.033804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:46.037099 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:38:46.037778 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:46.037918 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:38:46.038083 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:46.038209 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:46.038333 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:38:46.039029 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:38:46.039430 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:38:46.039561 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:46.039674 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:38:46.039828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:46.039990 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:38:46.042804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:38:46.045395 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:38:46.045555 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:38:46.045679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:46.048769 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:38:46.048937 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:38:46.049080 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:38:46.061367 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:38:46.062227 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:38:46.063234 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:38:46.063372 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:38:46.065198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cc1a0>]}
[0m12:38:46.065455 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:46.065597 [debug] [MainThread]: On master: BEGIN
[0m12:38:46.065717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:46.068710 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:38:46.068880 [debug] [MainThread]: On master: COMMIT
[0m12:38:46.069015 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:46.069132 [debug] [MainThread]: On master: COMMIT
[0m12:38:46.069285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:46.069411 [debug] [MainThread]: On master: Close
[0m12:38:46.069922 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:38:46.070081 [info ] [MainThread]: 
[0m12:38:46.071273 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:38:46.071533 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m12:38:46.071749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:38:46.071912 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:38:46.075740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:38:46.076194 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:38:46.091727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:38:46.092265 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:46.092443 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:38:46.092600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:46.096100 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:38:46.096317 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:46.096479 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:38:46.097973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:38:46.101209 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:46.101396 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:38:46.101757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:46.103115 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:46.103271 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:38:46.103486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:46.111438 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:38:46.111633 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:46.111786 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:38:46.112418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:46.114693 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:46.114872 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:38:46.115178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:46.116313 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:38:46.120070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '173d8ddd-8f23-412c-b0b7-b1f527788011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107692d80>]}
[0m12:38:46.120384 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:38:46.120664 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:38:46.121203 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:46.121347 [debug] [MainThread]: On master: BEGIN
[0m12:38:46.121466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:46.124612 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:38:46.124794 [debug] [MainThread]: On master: COMMIT
[0m12:38:46.124922 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:46.125035 [debug] [MainThread]: On master: COMMIT
[0m12:38:46.125192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:46.125316 [debug] [MainThread]: On master: Close
[0m12:38:46.125808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:46.125933 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m12:38:46.126073 [info ] [MainThread]: 
[0m12:38:46.126219 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m12:38:46.126511 [debug] [MainThread]: Command end result
[0m12:38:46.147615 [info ] [MainThread]: 
[0m12:38:46.147877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:46.148023 [info ] [MainThread]: 
[0m12:38:46.148173 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:46.149371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.71496475, "process_user_time": 1.102221, "process_kernel_time": 0.148401, "process_mem_max_rss": "143130624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:38:46.149615 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:46.149576 after 0.72 seconds
[0m12:38:46.149809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ea570>]}
[0m12:38:46.149964 [debug] [MainThread]: Flushing usage events
[0m12:38:55.003703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d75730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d74fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd1dc0>]}


============================== 12:38:55.006533 | 116aaf4e-14c9-48dd-b38a-4774c06d2980 ==============================
[0m12:38:55.006533 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:38:55.006840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select src_listen.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:55.121260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812fda0>]}
[0m12:38:55.144336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108039400>]}
[0m12:38:55.146845 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:38:55.155279 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:38:55.222641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:55.223056 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m12:38:55.315235 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:38:55.315585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c15b0>]}
[0m12:38:55.320978 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'src_listen.sql' in the 'models' section of file 'dbt_project/models/01_source_layer/schema.yml'
[0m12:38:55.360783 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_src_listen.sql_user_id.12332cb52d' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:38:55.361083 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_src_listen.sql_user_id.b2efbfddf8' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:38:55.362019 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_src_listen.sql_track_id.66eba8b3b1' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:38:55.362225 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_src_listen.sql_track_id.854f87ab8e' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:38:55.393456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085efc20>]}
[0m12:38:55.446293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862aa80>]}
[0m12:38:55.446581 [info ] [MainThread]: Found 8 models, 3 sources, 416 macros
[0m12:38:55.446751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811d8e0>]}
[0m12:38:55.447599 [info ] [MainThread]: 
[0m12:38:55.447889 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:38:55.448302 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:38:55.475535 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:38:55.475768 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:38:55.475917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:55.480870 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m12:38:55.481836 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:38:55.482991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:38:55.483262 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:38:55.486778 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:55.486970 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:38:55.487124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:55.490859 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:38:55.491572 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:55.491726 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:38:55.491909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:55.492035 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:55.492153 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:38:55.492333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:55.492716 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:38:55.492840 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:38:55.492956 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:38:55.493103 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:55.493224 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:38:55.496185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:38:55.498821 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:38:55.498977 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:38:55.499104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:55.502157 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:38:55.502315 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:38:55.502455 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:38:55.513285 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:38:55.514191 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:38:55.515320 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:38:55.515477 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:38:55.517293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865bef0>]}
[0m12:38:55.517526 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:55.517651 [debug] [MainThread]: On master: BEGIN
[0m12:38:55.517766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:55.520773 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:38:55.520933 [debug] [MainThread]: On master: COMMIT
[0m12:38:55.521057 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:55.521174 [debug] [MainThread]: On master: COMMIT
[0m12:38:55.521326 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:55.521447 [debug] [MainThread]: On master: Close
[0m12:38:55.521989 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:38:55.522161 [info ] [MainThread]: 
[0m12:38:55.523409 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:38:55.523672 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m12:38:55.523881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:38:55.524044 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:38:55.527551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:38:55.527929 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:38:55.544034 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:38:55.544806 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:55.544978 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:38:55.545118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:55.548302 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:38:55.548491 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:55.548650 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:38:55.549008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:55.552197 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:55.552389 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:38:55.552644 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:55.553971 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:55.554133 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:38:55.554354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:55.562230 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:38:55.562422 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:55.562577 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:38:55.563041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:55.565320 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:38:55.565495 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:38:55.565811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:55.566881 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:38:55.570062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '116aaf4e-14c9-48dd-b38a-4774c06d2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b2c30>]}
[0m12:38:55.570377 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:38:55.570662 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:38:55.571213 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:55.571378 [debug] [MainThread]: On master: BEGIN
[0m12:38:55.571520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:55.574666 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:38:55.574871 [debug] [MainThread]: On master: COMMIT
[0m12:38:55.575006 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:55.575129 [debug] [MainThread]: On master: COMMIT
[0m12:38:55.575287 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:55.575414 [debug] [MainThread]: On master: Close
[0m12:38:55.575976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:55.576148 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m12:38:55.576318 [info ] [MainThread]: 
[0m12:38:55.576502 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m12:38:55.576828 [debug] [MainThread]: Command end result
[0m12:38:55.594351 [info ] [MainThread]: 
[0m12:38:55.594611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:55.594757 [info ] [MainThread]: 
[0m12:38:55.594911 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:55.596108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6222043, "process_user_time": 1.092251, "process_kernel_time": 0.135513, "process_mem_max_rss": "139886592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:38:55.596384 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:55.596342 after 0.62 seconds
[0m12:38:55.596590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd20c0>]}
[0m12:38:55.596758 [debug] [MainThread]: Flushing usage events
[0m12:41:10.843954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105352bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b79e80>]}


============================== 12:41:10.847090 | 471d0cad-85ea-4fc0-b549-b2444682f9e3 ==============================
[0m12:41:10.847090 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:41:10.847407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_listen.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:11.031338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106770e60>]}
[0m12:41:11.054363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d35e50>]}
[0m12:41:11.056158 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:41:11.066945 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:41:11.137861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:41:11.138186 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/tests/test_col_type_is_int.sql
[0m12:41:11.138408 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m12:41:11.211382 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:41:11.211708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf39b0>]}
[0m12:41:11.216688 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'src_listen.sql' in the 'models' section of file 'dbt_project/models/01_source_layer/schema.yml'
[0m12:41:11.255896 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_src_listen.sql_user_id.12332cb52d' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:11.256199 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_src_listen.sql_user_id.b2efbfddf8' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:11.257137 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.test_col_type_is_int_sql_src_listen.sql_user_id.409b878bea' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:11.257304 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_src_listen.sql_track_id.66eba8b3b1' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:11.257461 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_src_listen.sql_track_id.854f87ab8e' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:11.257658 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.test_col_type_is_int_sql_src_listen.sql_track_id.7c4cd294d5' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:11.290354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c6750>]}
[0m12:41:11.357027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107176c60>]}
[0m12:41:11.357315 [info ] [MainThread]: Found 8 models, 1 test, 3 sources, 416 macros
[0m12:41:11.357484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716d670>]}
[0m12:41:11.358380 [info ] [MainThread]: 
[0m12:41:11.358657 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:41:11.359077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:41:11.389627 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:41:11.389900 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:41:11.390053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:11.407370 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:41:11.408459 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:41:11.409860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:41:11.410084 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:41:11.413352 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:11.413525 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:41:11.413657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:11.417218 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:41:11.418050 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:11.418190 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:41:11.418357 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:11.418481 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:11.418611 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:41:11.419161 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:11.419641 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:41:11.419789 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:11.419914 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:41:11.420087 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:11.420221 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:41:11.423068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:41:11.425676 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:41:11.425833 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:41:11.425953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:11.429076 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:41:11.429260 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:41:11.429406 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:41:11.442938 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:41:11.443844 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:41:11.444846 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:41:11.444989 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:41:11.446826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbea80>]}
[0m12:41:11.447073 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:11.447203 [debug] [MainThread]: On master: BEGIN
[0m12:41:11.447320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:11.450310 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:41:11.450475 [debug] [MainThread]: On master: COMMIT
[0m12:41:11.450609 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:11.450729 [debug] [MainThread]: On master: COMMIT
[0m12:41:11.450883 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:41:11.451014 [debug] [MainThread]: On master: Close
[0m12:41:11.451527 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:41:11.451683 [info ] [MainThread]: 
[0m12:41:11.452960 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:41:11.453241 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m12:41:11.453457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:41:11.453617 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:41:11.457284 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:41:11.458223 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:41:11.473018 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:41:11.473574 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:11.473740 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:41:11.473898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:11.477171 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:41:11.477366 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:11.477536 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:41:11.479790 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:41:11.484306 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:11.484530 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:41:11.485235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:11.486560 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:11.486727 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:41:11.486965 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:11.494851 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:41:11.495042 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:11.495195 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:41:11.495973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:41:11.498329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:11.498519 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:41:11.498822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:11.499890 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:41:11.504096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471d0cad-85ea-4fc0-b549-b2444682f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545aab0>]}
[0m12:41:11.504414 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:41:11.504691 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:41:11.505249 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:11.505392 [debug] [MainThread]: On master: BEGIN
[0m12:41:11.505509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:11.508595 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:41:11.508767 [debug] [MainThread]: On master: COMMIT
[0m12:41:11.508895 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:11.509006 [debug] [MainThread]: On master: COMMIT
[0m12:41:11.509156 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:41:11.509279 [debug] [MainThread]: On master: Close
[0m12:41:11.509763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:11.509877 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m12:41:11.510002 [info ] [MainThread]: 
[0m12:41:11.510139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:41:11.510423 [debug] [MainThread]: Command end result
[0m12:41:11.525548 [info ] [MainThread]: 
[0m12:41:11.525791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:11.525942 [info ] [MainThread]: 
[0m12:41:11.526092 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:41:11.527691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.71651876, "process_user_time": 1.083948, "process_kernel_time": 0.156803, "process_mem_max_rss": "137543680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:41:11.527974 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:11.527932 after 0.72 seconds
[0m12:41:11.528194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c48b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9d040>]}
[0m12:41:11.528384 [debug] [MainThread]: Flushing usage events
[0m12:41:30.302243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107505040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f69c70>]}


============================== 12:41:30.305628 | 202a24b1-3455-4d2c-98df-a6f515c1c904 ==============================
[0m12:41:30.305628 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:41:30.305962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select src_listen.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:30.489219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '202a24b1-3455-4d2c-98df-a6f515c1c904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cbf80>]}
[0m12:41:30.512343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '202a24b1-3455-4d2c-98df-a6f515c1c904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cae70>]}
[0m12:41:30.514715 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:41:30.525010 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:41:30.574619 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: 01_source_layer/schema.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     columns:
    6  |       - name: user_id
    7  |         description: "ID de l'utilisateur"
    8  |         `data_tests`.:
    9  |           - not_null
    10 |           - unique
    11 |           - test_col_type_is_int.sql
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 8, column 9
[0m12:41:30.576334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3036243, "process_user_time": 0.759021, "process_kernel_time": 0.108938, "process_mem_max_rss": "117948416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:41:30.576653 [debug] [MainThread]: Command `dbt run` failed at 12:41:30.576605 after 0.30 seconds
[0m12:41:30.576870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f69c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd2d20>]}
[0m12:41:30.577044 [debug] [MainThread]: Flushing usage events
[0m12:41:49.739516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11000a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110009dc0>]}


============================== 12:41:49.742959 | dd011348-b01f-469b-994e-662e10ea2484 ==============================
[0m12:41:49.742959 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:41:49.743278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select src_listen.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:41:49.926603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd011348-b01f-469b-994e-662e10ea2484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077edb20>]}
[0m12:41:49.949656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd011348-b01f-469b-994e-662e10ea2484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054844a0>]}
[0m12:41:49.951423 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:41:49.961233 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:41:50.032860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:50.033227 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m12:41:50.062158 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'src_listen.sql' in the 'models' section of file 'dbt_project/models/01_source_layer/schema.yml'
[0m12:41:50.118836 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_src_listen.sql_user_id.12332cb52d' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:50.119155 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_src_listen.sql_user_id.b2efbfddf8' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:50.119340 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.test_col_type_is_int_sql_src_listen.sql_user_id.409b878bea' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:50.119498 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_src_listen.sql_track_id.66eba8b3b1' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:50.119680 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.unique_src_listen.sql_track_id.854f87ab8e' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:50.119822 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.test_col_type_is_int_sql_src_listen.sql_track_id.7c4cd294d5' (dbt_project/models/01_source_layer/schema.yml) depends on a node named 'src_listen.sql' in package '' which was not found
[0m12:41:50.154596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd011348-b01f-469b-994e-662e10ea2484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110610590>]}
[0m12:41:50.210072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd011348-b01f-469b-994e-662e10ea2484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110679d00>]}
[0m12:41:50.210368 [info ] [MainThread]: Found 8 models, 1 test, 3 sources, 416 macros
[0m12:41:50.210536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd011348-b01f-469b-994e-662e10ea2484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a34a0>]}
[0m12:41:50.211415 [info ] [MainThread]: 
[0m12:41:50.211706 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:41:50.212125 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:41:50.239005 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:41:50.239282 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:41:50.239473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:50.255314 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:41:50.256674 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:41:50.258122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:41:50.258351 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:41:50.261702 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:50.261890 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:41:50.262026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:50.266267 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:41:50.267127 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:50.267263 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:41:50.267429 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:50.267557 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:50.267678 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:41:50.268248 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:50.268642 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:41:50.268771 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:41:50.268882 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:41:50.269059 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:41:50.269185 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:41:50.272047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:41:50.274694 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:41:50.274853 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:41:50.274976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:50.277999 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:41:50.278174 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:41:50.278327 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:41:50.292526 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:41:50.293463 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:41:50.294467 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:41:50.294631 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:41:50.296479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd011348-b01f-469b-994e-662e10ea2484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018b920>]}
[0m12:41:50.296720 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:50.296850 [debug] [MainThread]: On master: BEGIN
[0m12:41:50.296963 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:50.300011 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:41:50.300177 [debug] [MainThread]: On master: COMMIT
[0m12:41:50.300309 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:50.300430 [debug] [MainThread]: On master: COMMIT
[0m12:41:50.300583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:41:50.300710 [debug] [MainThread]: On master: Close
[0m12:41:50.301241 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:41:50.301446 [info ] [MainThread]: 
[0m12:41:50.302665 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:41:50.302919 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m12:41:50.303118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:41:50.303271 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:41:50.307906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:41:50.308686 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:41:50.323727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:41:50.324118 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:50.324282 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:41:50.324427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:50.327823 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:41:50.328029 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:50.328197 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:41:50.330639 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:41:50.333780 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:50.333972 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:41:50.334589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:50.335881 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:50.336048 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:41:50.336268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:50.344032 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:41:50.344218 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:50.344382 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:41:50.344949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:50.347163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:41:50.347340 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:41:50.347626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:41:50.348674 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:41:50.352727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd011348-b01f-469b-994e-662e10ea2484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110156150>]}
[0m12:41:50.353039 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:41:50.353318 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:41:50.353855 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:50.354012 [debug] [MainThread]: On master: BEGIN
[0m12:41:50.354132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:50.357305 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:41:50.357483 [debug] [MainThread]: On master: COMMIT
[0m12:41:50.357610 [debug] [MainThread]: Using duckdb connection "master"
[0m12:41:50.357726 [debug] [MainThread]: On master: COMMIT
[0m12:41:50.357877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:41:50.358006 [debug] [MainThread]: On master: Close
[0m12:41:50.358509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:50.358643 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m12:41:50.358777 [info ] [MainThread]: 
[0m12:41:50.358925 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:41:50.359214 [debug] [MainThread]: Command end result
[0m12:41:50.374022 [info ] [MainThread]: 
[0m12:41:50.374277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:50.374423 [info ] [MainThread]: 
[0m12:41:50.374572 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:41:50.376219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6729785, "process_user_time": 1.052204, "process_kernel_time": 0.141763, "process_mem_max_rss": "138985472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:41:50.376482 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:50.376442 after 0.67 seconds
[0m12:41:50.376663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110009dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb4710>]}
[0m12:41:50.376833 [debug] [MainThread]: Flushing usage events
[0m12:43:02.970876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104186150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104185e50>]}


============================== 12:43:02.973961 | 30fb02f6-ca03-4860-9ef4-ee0fe0be89ed ==============================
[0m12:43:02.973961 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:43:02.974289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select src_listen.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:03.155952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30fb02f6-ca03-4860-9ef4-ee0fe0be89ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a5fec0>]}
[0m12:43:03.178820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30fb02f6-ca03-4860-9ef4-ee0fe0be89ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d05820>]}
[0m12:43:03.180487 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:43:03.190411 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:43:03.263071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:43:03.263457 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m12:43:03.379547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30fb02f6-ca03-4860-9ef4-ee0fe0be89ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c6690>]}
[0m12:43:03.435357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30fb02f6-ca03-4860-9ef4-ee0fe0be89ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457edb0>]}
[0m12:43:03.435636 [info ] [MainThread]: Found 8 models, 7 data tests, 3 sources, 416 macros
[0m12:43:03.435813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30fb02f6-ca03-4860-9ef4-ee0fe0be89ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104623650>]}
[0m12:43:03.436715 [info ] [MainThread]: 
[0m12:43:03.436994 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:03.437397 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:43:03.464571 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:43:03.464828 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:43:03.464976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:03.481384 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:43:03.482664 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:43:03.484202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:43:03.484416 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:43:03.487687 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:03.487855 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:43:03.487990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:03.491399 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:43:03.492218 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:03.492362 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:43:03.492610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:03.492777 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:03.492921 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:43:03.493584 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:43:03.493995 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:43:03.494128 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:03.494244 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:43:03.494395 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:03.494525 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:43:03.497303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:43:03.499897 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:43:03.500045 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:43:03.500163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:03.503084 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:43:03.503237 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:43:03.503374 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:43:03.516502 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:43:03.518187 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:43:03.519200 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:43:03.519361 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:43:03.521116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30fb02f6-ca03-4860-9ef4-ee0fe0be89ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c66c0>]}
[0m12:43:03.521364 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:03.521493 [debug] [MainThread]: On master: BEGIN
[0m12:43:03.521611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:03.524727 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:43:03.524898 [debug] [MainThread]: On master: COMMIT
[0m12:43:03.525031 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:03.525155 [debug] [MainThread]: On master: COMMIT
[0m12:43:03.525349 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:03.525534 [debug] [MainThread]: On master: Close
[0m12:43:03.526106 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:43:03.526272 [info ] [MainThread]: 
[0m12:43:03.527436 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:43:03.527683 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m12:43:03.527882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:43:03.528040 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:43:03.531483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:43:03.532187 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:43:03.547325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:43:03.547907 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:03.548076 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:43:03.548226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:03.551528 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:03.551726 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:03.551887 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:43:03.553580 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:03.556743 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:03.556934 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:43:03.557610 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:03.558954 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:03.559121 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:43:03.559343 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:03.567213 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:43:03.567402 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:03.567551 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:43:03.568368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:03.570602 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:03.570777 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:43:03.571081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:03.572122 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:43:03.576501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30fb02f6-ca03-4860-9ef4-ee0fe0be89ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a5ef00>]}
[0m12:43:03.576808 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:43:03.577087 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:43:03.577607 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:03.577753 [debug] [MainThread]: On master: BEGIN
[0m12:43:03.577870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:03.580898 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:43:03.581066 [debug] [MainThread]: On master: COMMIT
[0m12:43:03.581198 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:03.581315 [debug] [MainThread]: On master: COMMIT
[0m12:43:03.581466 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:03.581588 [debug] [MainThread]: On master: Close
[0m12:43:03.582096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:03.582243 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m12:43:03.582385 [info ] [MainThread]: 
[0m12:43:03.582538 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:43:03.582842 [debug] [MainThread]: Command end result
[0m12:43:03.598226 [info ] [MainThread]: 
[0m12:43:03.598562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:03.598710 [info ] [MainThread]: 
[0m12:43:03.598858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:43:03.600482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.661199, "process_user_time": 1.043163, "process_kernel_time": 0.132084, "process_mem_max_rss": "136413184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:43:03.600743 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:03.600699 after 0.66 seconds
[0m12:43:03.600923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104185e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bdbad0>]}
[0m12:43:03.601083 [debug] [MainThread]: Flushing usage events
[0m12:43:24.148935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106743380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d49df0>]}


============================== 12:43:24.151800 | f9ef761b-c902-4e11-bc60-21c73a7a64b9 ==============================
[0m12:43:24.151800 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:43:24.152168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:24.324695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6b860>]}
[0m12:43:24.347884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789c560>]}
[0m12:43:24.350305 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:43:24.360433 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:43:24.437232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:24.437486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:24.459933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae9910>]}
[0m12:43:24.514949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085447d0>]}
[0m12:43:24.515232 [info ] [MainThread]: Found 8 models, 7 data tests, 3 sources, 416 macros
[0m12:43:24.515406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d28f50>]}
[0m12:43:24.516421 [info ] [MainThread]: 
[0m12:43:24.516705 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:24.518974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m12:43:24.545971 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m12:43:24.546204 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m12:43:24.546361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:24.561958 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:43:24.563244 [debug] [ThreadPool]: On list_moovai_data: Close
[0m12:43:24.564713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m12:43:24.564933 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m12:43:24.568823 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:24.569003 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m12:43:24.569136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:24.572780 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:43:24.573629 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:24.573774 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m12:43:24.573938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:24.574067 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:24.574222 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m12:43:24.574871 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:43:24.575346 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:43:24.575498 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m12:43:24.575626 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m12:43:24.575802 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:43:24.575935 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m12:43:24.576978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m12:43:24.579586 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:43:24.579736 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:43:24.579856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:24.583092 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:43:24.583261 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:43:24.583410 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:43:24.596604 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:43:24.597468 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:43:24.598550 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:43:24.598696 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:43:24.600720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc0620>]}
[0m12:43:24.600944 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:24.601071 [debug] [MainThread]: On master: BEGIN
[0m12:43:24.601183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:24.604202 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:43:24.604376 [debug] [MainThread]: On master: COMMIT
[0m12:43:24.604512 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:24.604628 [debug] [MainThread]: On master: COMMIT
[0m12:43:24.604779 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:24.604914 [debug] [MainThread]: On master: Close
[0m12:43:24.605436 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:43:24.605583 [info ] [MainThread]: 
[0m12:43:24.606787 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m12:43:24.607031 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m12:43:24.607230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m12:43:24.607381 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m12:43:24.610873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m12:43:24.611242 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m12:43:24.626157 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m12:43:24.626639 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:24.626808 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m12:43:24.626972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.630353 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.630553 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:24.630714 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m12:43:24.632784 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:24.635899 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:24.636087 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m12:43:24.636822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:24.638318 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:24.638489 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m12:43:24.638715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.646595 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:43:24.646795 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:24.646946 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m12:43:24.647788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:24.650043 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m12:43:24.650224 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m12:43:24.650511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.651566 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m12:43:24.656194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514ec30>]}
[0m12:43:24.656535 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m12:43:24.656820 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m12:43:24.657019 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m12:43:24.657329 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m12:43:24.657559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m12:43:24.657724 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m12:43:24.659006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m12:43:24.659803 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m12:43:24.662092 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m12:43:24.662390 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:43:24.662545 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m12:43:24.662698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.665974 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.666170 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:43:24.666334 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovai_data"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m12:43:24.666685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.668145 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:43:24.668310 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks" rename to "src_tracks__dbt_backup"
[0m12:43:24.668537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.669813 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:43:24.669963 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovai_data"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m12:43:24.670172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.670841 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:43:24.670989 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:43:24.671119 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m12:43:24.671527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.672713 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m12:43:24.672925 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovai_data"."main"."src_tracks__dbt_backup" cascade
[0m12:43:24.673285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.673985 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m12:43:24.676889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8bfb0>]}
[0m12:43:24.677332 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m12:43:24.677619 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m12:43:24.677811 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m12:43:24.678068 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m12:43:24.678249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m12:43:24.678399 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m12:43:24.679672 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m12:43:24.680019 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m12:43:24.681504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m12:43:24.681770 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:43:24.681919 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m12:43:24.682059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.685316 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.685505 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:43:24.685674 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovai_data"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m12:43:24.686004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.687468 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:43:24.687634 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users" rename to "src_users__dbt_backup"
[0m12:43:24.687858 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.689122 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:43:24.689277 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovai_data"."main"."src_users__dbt_tmp" rename to "src_users"
[0m12:43:24.689486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.690156 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:43:24.690302 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:43:24.690439 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m12:43:24.690833 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.691807 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m12:43:24.691951 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovai_data"."main"."src_users__dbt_backup" cascade
[0m12:43:24.692222 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.692828 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m12:43:24.695390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108546fc0>]}
[0m12:43:24.695697 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m12:43:24.695965 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m12:43:24.696157 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m12:43:24.696357 [info ] [Thread-1 (]: 4 of 8 START sql incremental model main.int_fact_listen ........................ [RUN]
[0m12:43:24.696654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m12:43:24.696819 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m12:43:24.698330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m12:43:24.699677 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m12:43:24.719728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m12:43:24.720398 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:43:24.720558 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m12:43:24.720699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.724081 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.724466 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:43:24.724636 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
    
    

    create  table
      "moovai_data"."main"."int_fact_listen__dbt_tmp"
  
    as (
      

with cte_int_listen as (

    select * from "moovai_data"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
  
[0m12:43:24.726084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:24.727762 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:43:24.727935 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter view "moovai_data"."main"."int_fact_listen" rename to "int_fact_listen__dbt_backup"
[0m12:43:24.728181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.729481 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:43:24.729637 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
alter table "moovai_data"."main"."int_fact_listen__dbt_tmp" rename to "int_fact_listen"
[0m12:43:24.729859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.732360 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:43:24.732534 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:43:24.732684 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m12:43:24.733090 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.734049 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m12:43:24.734197 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */
drop view if exists "moovai_data"."main"."int_fact_listen__dbt_backup" cascade
[0m12:43:24.734450 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.735035 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m12:43:24.737730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af3650>]}
[0m12:43:24.738024 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model main.int_fact_listen ................... [[32mOK[0m in 0.04s]
[0m12:43:24.738287 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m12:43:24.738473 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m12:43:24.738690 [info ] [Thread-1 (]: 5 of 8 START sql incremental model main.int_dim_tracks ......................... [RUN]
[0m12:43:24.738873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m12:43:24.739023 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m12:43:24.740402 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m12:43:24.740901 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m12:43:24.742591 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m12:43:24.742869 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:43:24.743018 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m12:43:24.743157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.746330 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.746536 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:43:24.746711 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."int_dim_tracks__dbt_tmp"
  
    as (
      

with cte_src_tracks as (

    select * from "moovai_data"."main"."src_tracks"

)

--INSERT INTO int_tracks
select *
from cte_src_tracks
    );
  
  
  
[0m12:43:24.747453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:24.748967 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:43:24.749230 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter view "moovai_data"."main"."int_dim_tracks" rename to "int_dim_tracks__dbt_backup"
[0m12:43:24.749581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.750844 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:43:24.751000 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
alter table "moovai_data"."main"."int_dim_tracks__dbt_tmp" rename to "int_dim_tracks"
[0m12:43:24.751227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.752050 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:43:24.752197 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:43:24.752331 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m12:43:24.752768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.753771 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m12:43:24.753940 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */
drop view if exists "moovai_data"."main"."int_dim_tracks__dbt_backup" cascade
[0m12:43:24.754210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.754865 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m12:43:24.757756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a4230>]}
[0m12:43:24.758066 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model main.int_dim_tracks .................... [[32mOK[0m in 0.02s]
[0m12:43:24.758327 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m12:43:24.758514 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m12:43:24.758759 [info ] [Thread-1 (]: 6 of 8 START sql incremental model main.int_dim_users .......................... [RUN]
[0m12:43:24.758974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m12:43:24.759149 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m12:43:24.760464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m12:43:24.760773 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m12:43:24.762517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m12:43:24.762790 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:43:24.762937 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m12:43:24.763088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.766255 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.766442 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:43:24.766607 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
    
    

    create  table
      "moovai_data"."main"."int_dim_users__dbt_tmp"
  
    as (
      

with cte_src_users as (

    select * from "moovai_data"."main"."src_users"

)

--INSERT INTO int_users
select *
from cte_src_users
    );
  
  
  
[0m12:43:24.767160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.768529 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:43:24.768706 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter view "moovai_data"."main"."int_dim_users" rename to "int_dim_users__dbt_backup"
[0m12:43:24.768931 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.770131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:43:24.770282 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
alter table "moovai_data"."main"."int_dim_users__dbt_tmp" rename to "int_dim_users"
[0m12:43:24.770500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.771909 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:43:24.772082 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:43:24.772226 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m12:43:24.772712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.773782 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m12:43:24.773957 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */
drop view if exists "moovai_data"."main"."int_dim_users__dbt_backup" cascade
[0m12:43:24.774317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.775054 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m12:43:24.777920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8a900>]}
[0m12:43:24.778206 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model main.int_dim_users ..................... [[32mOK[0m in 0.02s]
[0m12:43:24.778454 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m12:43:24.778637 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m12:43:24.778889 [info ] [Thread-1 (]: 7 of 8 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m12:43:24.779067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen_and_tracks)
[0m12:43:24.779222 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m12:43:24.780649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.781184 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m12:43:24.787117 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.787442 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.787622 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m12:43:24.787770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.791036 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.791233 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.791401 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_tracks" as r
ON l.track_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:43:24.793573 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:43:24.794994 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.795153 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovai_data"."main"."mart_listen_and_tracks" rename to "mart_listen_and_tracks__dbt_backup"
[0m12:43:24.795398 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.796695 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.796866 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovai_data"."main"."mart_listen_and_tracks__dbt_tmp" rename to "mart_listen_and_tracks"
[0m12:43:24.797139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.797994 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:43:24.798162 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.798308 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m12:43:24.798719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.799886 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m12:43:24.800064 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
drop table if exists "moovai_data"."main"."mart_listen_and_tracks__dbt_backup" cascade
[0m12:43:24.800385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.801036 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m12:43:24.803745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a88950>]}
[0m12:43:24.804037 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.mart_listen_and_tracks .................. [[32mOK[0m in 0.02s]
[0m12:43:24.804300 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m12:43:24.804491 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m12:43:24.804713 [info ] [Thread-1 (]: 8 of 8 START sql table model main.mart_listen_and_users ........................ [RUN]
[0m12:43:24.804896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.mart_listen_and_users)
[0m12:43:24.805051 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_users
[0m12:43:24.806620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_users"
[0m12:43:24.807253 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_users
[0m12:43:24.808800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_users"
[0m12:43:24.809141 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:43:24.809305 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: BEGIN
[0m12:43:24.809448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:24.812747 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:24.812966 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:43:24.813133 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */

  
    
    

    create  table
      "moovai_data"."main"."mart_listen_and_users__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovai_data"."main"."int_fact_listen" AS l
LEFT JOIN "moovai_data"."main"."int_dim_users" as r
ON l.user_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m12:43:24.813682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.815162 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:43:24.815335 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users" rename to "mart_listen_and_users__dbt_backup"
[0m12:43:24.815587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.816896 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:43:24.817057 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovai_data"."main"."mart_listen_and_users__dbt_tmp" rename to "mart_listen_and_users"
[0m12:43:24.817284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.818017 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:43:24.818163 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:43:24.818298 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m12:43:24.818689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.819687 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m12:43:24.819838 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
drop table if exists "moovai_data"."main"."mart_listen_and_users__dbt_backup" cascade
[0m12:43:24.820097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:24.820690 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: Close
[0m12:43:24.823786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ef761b-c902-4e11-bc60-21c73a7a64b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af1700>]}
[0m12:43:24.824157 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main.mart_listen_and_users ................... [[32mOK[0m in 0.02s]
[0m12:43:24.824432 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m12:43:24.825014 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:24.825160 [debug] [MainThread]: On master: BEGIN
[0m12:43:24.825332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:24.828839 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:43:24.829041 [debug] [MainThread]: On master: COMMIT
[0m12:43:24.829175 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:24.829292 [debug] [MainThread]: On master: COMMIT
[0m12:43:24.829443 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:24.829576 [debug] [MainThread]: On master: Close
[0m12:43:24.830097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:24.830235 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_users' was properly closed.
[0m12:43:24.830420 [info ] [MainThread]: 
[0m12:43:24.830577 [info ] [MainThread]: Finished running 3 view models, 3 incremental models, 2 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m12:43:24.831247 [debug] [MainThread]: Command end result
[0m12:43:24.847457 [info ] [MainThread]: 
[0m12:43:24.847704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:24.847850 [info ] [MainThread]: 
[0m12:43:24.847997 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:43:24.849368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.73195434, "process_user_time": 1.109415, "process_kernel_time": 0.153963, "process_mem_max_rss": "140804096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:43:24.849670 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:24.849621 after 0.73 seconds
[0m12:43:24.849962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079dca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818af00>]}
[0m12:43:24.850159 [debug] [MainThread]: Flushing usage events
[0m12:43:39.437779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ca060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d17140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d35dc0>]}


============================== 12:43:39.440563 | acf4ab54-d5b6-4d4e-b6bd-1967635dcdfd ==============================
[0m12:43:39.440563 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:43:39.440877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:39.620580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acf4ab54-d5b6-4d4e-b6bd-1967635dcdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd1610>]}
[0m12:43:39.643971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acf4ab54-d5b6-4d4e-b6bd-1967635dcdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d54d70>]}
[0m12:43:39.645838 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:43:39.656233 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:43:39.729219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:39.729463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:39.751803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acf4ab54-d5b6-4d4e-b6bd-1967635dcdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eeeff0>]}
[0m12:43:39.816422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acf4ab54-d5b6-4d4e-b6bd-1967635dcdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109332960>]}
[0m12:43:39.816722 [info ] [MainThread]: Found 8 models, 7 data tests, 3 sources, 416 macros
[0m12:43:39.816894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf4ab54-d5b6-4d4e-b6bd-1967635dcdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb5b50>]}
[0m12:43:39.817925 [info ] [MainThread]: 
[0m12:43:39.818215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:39.820498 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m12:43:39.848031 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:43:39.848256 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:43:39.848391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:39.858372 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:43:39.858593 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:43:39.858739 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:43:39.879043 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:43:39.880252 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:43:39.881190 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:43:39.881339 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:43:39.883827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf4ab54-d5b6-4d4e-b6bd-1967635dcdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb5b50>]}
[0m12:43:39.884067 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:39.884198 [debug] [MainThread]: On master: BEGIN
[0m12:43:39.884318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:39.887466 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:43:39.887641 [debug] [MainThread]: On master: COMMIT
[0m12:43:39.887776 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:39.887895 [debug] [MainThread]: On master: COMMIT
[0m12:43:39.888047 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:39.888181 [debug] [MainThread]: On master: Close
[0m12:43:39.888726 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:43:39.888893 [info ] [MainThread]: 
[0m12:43:39.890404 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:43:39.890670 [info ] [Thread-1 (]: 1 of 7 START test not_null_src_listen_track_id ................................. [RUN]
[0m12:43:39.890917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m12:43:39.891124 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:43:39.898978 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:43:39.899789 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:43:39.906793 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:43:39.907217 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:43:39.907391 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m12:43:39.907538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:39.910978 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:39.911186 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:43:39.911359 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m12:43:39.917856 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:43:39.920485 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m12:43:39.921076 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m12:43:39.921248 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m12:43:39.922657 [info ] [Thread-1 (]: 1 of 7 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.03s]
[0m12:43:39.922966 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:43:39.923172 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:43:39.923382 [info ] [Thread-1 (]: 2 of 7 START test not_null_src_listen_user_id .................................. [RUN]
[0m12:43:39.923578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m12:43:39.923737 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:43:39.925832 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:43:39.926202 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:43:39.927182 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:43:39.927464 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:43:39.927615 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m12:43:39.927752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:39.931316 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:43:39.931518 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:43:39.931683 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m12:43:39.932260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:43:39.933020 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m12:43:39.933504 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m12:43:39.933658 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m12:43:39.934291 [info ] [Thread-1 (]: 2 of 7 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m12:43:39.934578 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:43:39.934782 [debug] [Thread-1 (]: Began running node test.dbt_project.test_col_type_is_int
[0m12:43:39.934997 [info ] [Thread-1 (]: 3 of 7 START test test_col_type_is_int ......................................... [RUN]
[0m12:43:39.935197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.test_col_type_is_int)
[0m12:43:39.935353 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test_col_type_is_int
[0m12:43:39.936279 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.test_col_type_is_int"
[0m12:43:39.936659 [debug] [Thread-1 (]: Began executing node test.dbt_project.test_col_type_is_int
[0m12:43:39.938283 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.test_col_type_is_int"
[0m12:43:39.938889 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test_col_type_is_int"
[0m12:43:39.939062 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: BEGIN
[0m12:43:39.939218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:39.942844 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:43:39.943085 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test_col_type_is_int"
[0m12:43:39.943258 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test_col_type_is_int"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with column_type_check as (
    select
        column_name,
        data_type
    from information_schema.columns
    where table_name = 'intermediate_data'  -- Remplace par ton nom de table
    and column_name = 'id'  -- Remplace par ta colonne
)

select
    count(*)
from column_type_check
where data_type = 'INTEGER'  -- Spécifie ici le type attendu
      
    ) dbt_internal_test
[0m12:43:39.954221 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:43:39.955304 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: ROLLBACK
[0m12:43:39.955834 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.test_col_type_is_int'
[0m12:43:39.955997 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: Close
[0m12:43:39.957104 [error] [Thread-1 (]: 3 of 7 FAIL 1 test_col_type_is_int ............................................. [[31mFAIL 1[0m in 0.02s]
[0m12:43:39.957450 [debug] [Thread-1 (]: Finished running node test.dbt_project.test_col_type_is_int
[0m12:43:39.957663 [debug] [Thread-1 (]: Began running node test.dbt_project.test_col_type_is_int_sql_src_listen_track_id.2161e4d500
[0m12:43:39.957831 [info ] [Thread-1 (]: 4 of 7 START test test_col_type_is_int_sql_src_listen_track_id ................. [RUN]
[0m12:43:39.958068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test_col_type_is_int, now test.dbt_project.test_col_type_is_int_sql_src_listen_track_id.2161e4d500)
[0m12:43:39.958247 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test_col_type_is_int_sql_src_listen_track_id.2161e4d500
[0m12:43:39.965220 [debug] [Thread-1 (]: Compilation Error in test test_col_type_is_int_sql_src_listen_track_id (dbt_project/models/01_source_layer/schema.yml)
  'test_col_type_is_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:43:39.965591 [error] [Thread-1 (]: 4 of 7 ERROR test_col_type_is_int_sql_src_listen_track_id ...................... [[31mERROR[0m in 0.01s]
[0m12:43:39.965885 [debug] [Thread-1 (]: Finished running node test.dbt_project.test_col_type_is_int_sql_src_listen_track_id.2161e4d500
[0m12:43:39.966097 [debug] [Thread-1 (]: Began running node test.dbt_project.test_col_type_is_int_sql_src_listen_user_id.60e9479879
[0m12:43:39.966677 [info ] [Thread-1 (]: 5 of 7 START test test_col_type_is_int_sql_src_listen_user_id .................. [RUN]
[0m12:43:39.966973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test_col_type_is_int_sql_src_listen_track_id.2161e4d500, now test.dbt_project.test_col_type_is_int_sql_src_listen_user_id.60e9479879)
[0m12:43:39.967165 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test_col_type_is_int_sql_src_listen_user_id.60e9479879
[0m12:43:39.970526 [debug] [Thread-1 (]: Compilation Error in test test_col_type_is_int_sql_src_listen_user_id (dbt_project/models/01_source_layer/schema.yml)
  'test_col_type_is_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:43:39.970849 [error] [Thread-1 (]: 5 of 7 ERROR test_col_type_is_int_sql_src_listen_user_id ....................... [[31mERROR[0m in 0.00s]
[0m12:43:39.971116 [debug] [Thread-1 (]: Finished running node test.dbt_project.test_col_type_is_int_sql_src_listen_user_id.60e9479879
[0m12:43:39.971312 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:43:39.971521 [info ] [Thread-1 (]: 6 of 7 START test unique_src_listen_track_id ................................... [RUN]
[0m12:43:39.971721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test_col_type_is_int_sql_src_listen_user_id.60e9479879, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m12:43:39.971883 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:43:39.975232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:43:39.975711 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:43:39.976843 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:43:39.977197 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:43:39.977358 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m12:43:39.977506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:39.980926 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:43:39.981148 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:43:39.981317 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:39.982785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:39.983589 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m12:43:39.984084 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m12:43:39.984232 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m12:43:39.984926 [info ] [Thread-1 (]: 6 of 7 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m12:43:39.985193 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:43:39.985376 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:43:39.985555 [info ] [Thread-1 (]: 7 of 7 START test unique_src_listen_user_id .................................... [RUN]
[0m12:43:39.985732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m12:43:39.985882 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:43:39.987798 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:43:39.988155 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:43:39.989166 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:43:39.989541 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:43:39.989713 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m12:43:39.989877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:39.993591 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:43:39.993825 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:43:39.993996 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:39.994730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:43:39.995520 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m12:43:39.995991 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m12:43:39.996149 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m12:43:39.996914 [info ] [Thread-1 (]: 7 of 7 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m12:43:39.997184 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:43:39.997730 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:39.997880 [debug] [MainThread]: On master: BEGIN
[0m12:43:39.997997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:40.001456 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:43:40.001634 [debug] [MainThread]: On master: COMMIT
[0m12:43:40.001763 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:40.001882 [debug] [MainThread]: On master: COMMIT
[0m12:43:40.002031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:43:40.002170 [debug] [MainThread]: On master: Close
[0m12:43:40.002685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:40.002816 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m12:43:40.002982 [info ] [MainThread]: 
[0m12:43:40.003124 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:43:40.003693 [debug] [MainThread]: Command end result
[0m12:43:40.019813 [info ] [MainThread]: 
[0m12:43:40.020168 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:43:40.020327 [info ] [MainThread]: 
[0m12:43:40.020513 [error] [MainThread]: [31mFailure in test test_col_type_is_int (dbt_project/tests/test_col_type_is_int.sql)[0m
[0m12:43:40.020673 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:43:40.020793 [info ] [MainThread]: 
[0m12:43:40.020945 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/dbt_project/tests/test_col_type_is_int.sql
[0m12:43:40.021068 [info ] [MainThread]: 
[0m12:43:40.021225 [error] [MainThread]:   Compilation Error in test test_col_type_is_int_sql_src_listen_track_id (dbt_project/models/01_source_layer/schema.yml)
  'test_col_type_is_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:43:40.021350 [info ] [MainThread]: 
[0m12:43:40.021505 [error] [MainThread]:   Compilation Error in test test_col_type_is_int_sql_src_listen_user_id (dbt_project/models/01_source_layer/schema.yml)
  'test_col_type_is_int' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:43:40.021630 [info ] [MainThread]: 
[0m12:43:40.021766 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m12:43:40.022979 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.61578375, "process_user_time": 0.98865, "process_kernel_time": 0.151778, "process_mem_max_rss": "141393920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:43:40.023252 [debug] [MainThread]: Command `dbt test` failed at 12:43:40.023210 after 0.62 seconds
[0m12:43:40.023451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ca060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d36090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d35f70>]}
[0m12:43:40.023609 [debug] [MainThread]: Flushing usage events
[0m12:53:41.462169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048464e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048461b0>]}


============================== 12:53:41.465543 | 13d2915d-cf05-4a26-a35e-2b72441e1eab ==============================
[0m12:53:41.465543 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:53:41.465856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:41.646487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d2915d-cf05-4a26-a35e-2b72441e1eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ad7c0>]}
[0m12:53:41.669866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d2915d-cf05-4a26-a35e-2b72441e1eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037650d0>]}
[0m12:53:41.671737 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:53:41.681727 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:53:41.758159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:41.758586 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m12:53:41.936652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d2915d-cf05-4a26-a35e-2b72441e1eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de1880>]}
[0m12:53:42.001494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d2915d-cf05-4a26-a35e-2b72441e1eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed9520>]}
[0m12:53:42.001790 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m12:53:42.001966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d2915d-cf05-4a26-a35e-2b72441e1eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b0770>]}
[0m12:53:42.002960 [info ] [MainThread]: 
[0m12:53:42.003246 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:42.005663 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m12:53:42.034750 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:53:42.034973 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:53:42.035107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:42.044944 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:53:42.045144 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:53:42.045292 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:53:42.065882 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:53:42.067060 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:53:42.067982 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:53:42.068132 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:53:42.070658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d2915d-cf05-4a26-a35e-2b72441e1eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb2e40>]}
[0m12:53:42.070894 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:42.071023 [debug] [MainThread]: On master: BEGIN
[0m12:53:42.071137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:42.074276 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:53:42.074449 [debug] [MainThread]: On master: COMMIT
[0m12:53:42.074582 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:42.074697 [debug] [MainThread]: On master: COMMIT
[0m12:53:42.074856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:42.074984 [debug] [MainThread]: On master: Close
[0m12:53:42.075548 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:53:42.075700 [info ] [MainThread]: 
[0m12:53:42.077028 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:53:42.077249 [info ] [Thread-1 (]: 1 of 6 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m12:53:42.077462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m12:53:42.077630 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:53:42.085634 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:53:42.085883 [error] [Thread-1 (]: 1 of 6 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m12:53:42.086131 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:53:42.086311 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:42.086760 [info ] [Thread-1 (]: 2 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m12:53:42.086943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m12:53:42.087094 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:42.091485 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:42.092108 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:42.098947 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:42.099320 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:42.099490 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m12:53:42.099638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:42.103274 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:53:42.103487 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:42.103657 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m12:53:42.107281 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:42.109323 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m12:53:42.109814 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m12:53:42.109983 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m12:53:42.110742 [info ] [Thread-1 (]: 2 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:53:42.111020 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:42.111241 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:42.111467 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m12:53:42.111703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m12:53:42.111874 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:42.113786 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:42.114135 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:42.115109 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:42.115398 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:42.115553 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m12:53:42.115694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:42.119085 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:42.119280 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:42.119443 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m12:53:42.120007 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:42.120743 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m12:53:42.121202 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m12:53:42.121354 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m12:53:42.121986 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m12:53:42.122251 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:42.122437 [debug] [Thread-1 (]: Began running node test.dbt_project.test_col_type_is_int
[0m12:53:42.122612 [info ] [Thread-1 (]: 4 of 6 START test test_col_type_is_int ......................................... [RUN]
[0m12:53:42.122791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.test_col_type_is_int)
[0m12:53:42.122940 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test_col_type_is_int
[0m12:53:42.123813 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.test_col_type_is_int"
[0m12:53:42.124114 [debug] [Thread-1 (]: Began executing node test.dbt_project.test_col_type_is_int
[0m12:53:42.125082 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.test_col_type_is_int"
[0m12:53:42.125373 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test_col_type_is_int"
[0m12:53:42.125516 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: BEGIN
[0m12:53:42.125649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:42.128741 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:42.128929 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test_col_type_is_int"
[0m12:53:42.129105 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test_col_type_is_int"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with column_type_check as (
    select
        column_name,
        data_type
    from information_schema.columns
    where table_name = 'intermediate_data'  -- Remplace par ton nom de table
    and column_name = 'id'  -- Remplace par ta colonne
)

select
    count(*)
from column_type_check
where data_type = 'INTEGER'  -- Spécifie ici le type attendu
      
    ) dbt_internal_test
[0m12:53:42.139701 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:53:42.140759 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: ROLLBACK
[0m12:53:42.141263 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.test_col_type_is_int'
[0m12:53:42.141418 [debug] [Thread-1 (]: On test.dbt_project.test_col_type_is_int: Close
[0m12:53:42.142340 [error] [Thread-1 (]: 4 of 6 FAIL 1 test_col_type_is_int ............................................. [[31mFAIL 1[0m in 0.02s]
[0m12:53:42.142634 [debug] [Thread-1 (]: Finished running node test.dbt_project.test_col_type_is_int
[0m12:53:42.142825 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:53:42.142981 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m12:53:42.143225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test_col_type_is_int, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m12:53:42.143430 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:53:42.146593 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:53:42.147003 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:53:42.147994 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:53:42.148285 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:53:42.148437 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m12:53:42.148576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:42.152332 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:53:42.152627 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:53:42.152802 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:53:42.154527 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:53:42.155311 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m12:53:42.155783 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m12:53:42.155934 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m12:53:42.156629 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m12:53:42.156877 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:53:42.157055 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:53:42.157267 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m12:53:42.157446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m12:53:42.157595 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:53:42.160668 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:53:42.161302 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:53:42.162340 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:53:42.162641 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:53:42.162805 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m12:53:42.162949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:42.166344 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:42.166541 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:53:42.166703 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:53:42.167389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:42.168158 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m12:53:42.168626 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m12:53:42.168772 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m12:53:42.169469 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m12:53:42.169741 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:53:42.170368 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:42.170563 [debug] [MainThread]: On master: BEGIN
[0m12:53:42.170711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:42.174194 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:53:42.174400 [debug] [MainThread]: On master: COMMIT
[0m12:53:42.174523 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:42.174635 [debug] [MainThread]: On master: COMMIT
[0m12:53:42.174808 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:42.174935 [debug] [MainThread]: On master: Close
[0m12:53:42.175505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:42.175629 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m12:53:42.175777 [info ] [MainThread]: 
[0m12:53:42.175924 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:53:42.176450 [debug] [MainThread]: Command end result
[0m12:53:42.194669 [info ] [MainThread]: 
[0m12:53:42.194932 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:53:42.195089 [info ] [MainThread]: 
[0m12:53:42.195277 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:53:42.195453 [info ] [MainThread]: 
[0m12:53:42.195630 [error] [MainThread]: [31mFailure in test test_col_type_is_int (dbt_project/tests/test_col_type_is_int.sql)[0m
[0m12:53:42.195782 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:53:42.195899 [info ] [MainThread]: 
[0m12:53:42.196042 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/dbt_project/tests/test_col_type_is_int.sql
[0m12:53:42.196169 [info ] [MainThread]: 
[0m12:53:42.196301 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m12:53:42.197933 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.78012586, "process_user_time": 1.131424, "process_kernel_time": 0.163102, "process_mem_max_rss": "145752064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:53:42.198185 [debug] [MainThread]: Command `dbt test` failed at 12:53:42.198144 after 0.78 seconds
[0m12:53:42.198369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b44a0>]}
[0m12:53:42.198526 [debug] [MainThread]: Flushing usage events
[0m12:53:59.494317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889dd60>]}


============================== 12:53:59.497349 | 45df7bde-8e9f-4f7d-9f61-cffcd49e0898 ==============================
[0m12:53:59.497349 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:53:59.497680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:59.667830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45df7bde-8e9f-4f7d-9f61-cffcd49e0898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108912e10>]}
[0m12:53:59.690919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45df7bde-8e9f-4f7d-9f61-cffcd49e0898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899f530>]}
[0m12:53:59.693213 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:53:59.703152 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:53:59.774274 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m12:53:59.774551 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/tests/test_col_type_is_int.sql
[0m12:53:59.811963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45df7bde-8e9f-4f7d-9f61-cffcd49e0898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab1340>]}
[0m12:53:59.869469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45df7bde-8e9f-4f7d-9f61-cffcd49e0898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eccbf0>]}
[0m12:53:59.869766 [info ] [MainThread]: Found 8 models, 5 data tests, 3 sources, 416 macros
[0m12:53:59.869945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45df7bde-8e9f-4f7d-9f61-cffcd49e0898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108911430>]}
[0m12:53:59.870917 [info ] [MainThread]: 
[0m12:53:59.871207 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:59.873479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m12:53:59.900170 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:53:59.900397 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:53:59.900534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:59.910865 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:53:59.911090 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:53:59.911239 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:53:59.931922 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:53:59.933362 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:53:59.934298 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:53:59.934463 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:53:59.937012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45df7bde-8e9f-4f7d-9f61-cffcd49e0898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1c4d0>]}
[0m12:53:59.937267 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:59.937399 [debug] [MainThread]: On master: BEGIN
[0m12:53:59.937516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:59.940686 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:53:59.940864 [debug] [MainThread]: On master: COMMIT
[0m12:53:59.941000 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:59.941119 [debug] [MainThread]: On master: COMMIT
[0m12:53:59.941273 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:59.941406 [debug] [MainThread]: On master: Close
[0m12:53:59.941929 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:53:59.942074 [info ] [MainThread]: 
[0m12:53:59.943430 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:53:59.943658 [info ] [Thread-1 (]: 1 of 5 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m12:53:59.943876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m12:53:59.944041 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:53:59.954090 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:53:59.954374 [error] [Thread-1 (]: 1 of 5 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m12:53:59.954622 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:53:59.954804 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:59.955393 [info ] [Thread-1 (]: 2 of 5 START test not_null_src_listen_track_id ................................. [RUN]
[0m12:53:59.955617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m12:53:59.955787 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:59.959611 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:59.959944 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:59.967839 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:59.968305 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:59.968478 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m12:53:59.968627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:59.972078 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:59.972302 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:53:59.972475 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m12:53:59.975973 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:59.977988 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m12:53:59.978473 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m12:53:59.978645 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m12:53:59.979443 [info ] [Thread-1 (]: 2 of 5 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:53:59.979718 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:53:59.979907 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:59.980092 [info ] [Thread-1 (]: 3 of 5 START test not_null_src_listen_user_id .................................. [RUN]
[0m12:53:59.980274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m12:53:59.980425 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:59.982346 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:59.982704 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:59.983703 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:59.984002 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:59.984160 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m12:53:59.984299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:59.987681 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:59.987927 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:53:59.988103 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m12:53:59.988733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:59.989611 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m12:53:59.990116 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m12:53:59.990271 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m12:53:59.990987 [info ] [Thread-1 (]: 3 of 5 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m12:53:59.991285 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:53:59.991477 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:53:59.991664 [info ] [Thread-1 (]: 4 of 5 START test unique_src_listen_track_id ................................... [RUN]
[0m12:53:59.991845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m12:53:59.991999 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:53:59.995182 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:53:59.995550 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:53:59.996535 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:53:59.996830 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:53:59.996984 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m12:53:59.997124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:00.000465 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:00.000659 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:54:00.000835 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:00.002556 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:54:00.003374 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m12:54:00.003856 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m12:54:00.004031 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m12:54:00.004698 [info ] [Thread-1 (]: 4 of 5 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m12:54:00.004958 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:54:00.005142 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:00.005347 [info ] [Thread-1 (]: 5 of 5 START test unique_src_listen_user_id .................................... [RUN]
[0m12:54:00.005561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m12:54:00.005722 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:00.007675 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:00.008005 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:00.008987 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:00.009431 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:00.009585 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m12:54:00.009727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:00.013397 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:54:00.013654 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:00.013833 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:00.014674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:54:00.015846 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m12:54:00.016362 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m12:54:00.016530 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m12:54:00.017457 [info ] [Thread-1 (]: 5 of 5 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m12:54:00.017780 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:00.018494 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:00.018666 [debug] [MainThread]: On master: BEGIN
[0m12:54:00.018796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:00.022324 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m12:54:00.022504 [debug] [MainThread]: On master: COMMIT
[0m12:54:00.022639 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:00.022758 [debug] [MainThread]: On master: COMMIT
[0m12:54:00.022909 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:00.023037 [debug] [MainThread]: On master: Close
[0m12:54:00.023644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:00.023818 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m12:54:00.024016 [info ] [MainThread]: 
[0m12:54:00.024178 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:54:00.024704 [debug] [MainThread]: Command end result
[0m12:54:00.042367 [info ] [MainThread]: 
[0m12:54:00.042621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:54:00.042773 [info ] [MainThread]: 
[0m12:54:00.042969 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:54:00.043127 [info ] [MainThread]: 
[0m12:54:00.043276 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:54:00.044755 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.5891887, "process_user_time": 0.973809, "process_kernel_time": 0.137546, "process_mem_max_rss": "138084352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:54:00.045035 [debug] [MainThread]: Command `dbt test` failed at 12:54:00.044994 after 0.59 seconds
[0m12:54:00.045231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f4ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108467ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcfec0>]}
[0m12:54:00.045396 [debug] [MainThread]: Flushing usage events
[0m12:54:27.909411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ce150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cde20>]}


============================== 12:54:27.913093 | d77334af-84da-4f0d-aeca-c5b49ec83336 ==============================
[0m12:54:27.913093 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:54:27.913414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select src_listen.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:28.093823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd77334af-84da-4f0d-aeca-c5b49ec83336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104946600>]}
[0m12:54:28.117065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd77334af-84da-4f0d-aeca-c5b49ec83336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cbb00>]}
[0m12:54:28.118874 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:54:28.129611 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:54:28.198369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:28.198601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:28.218382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd77334af-84da-4f0d-aeca-c5b49ec83336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a92fc0>]}
[0m12:54:28.280216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd77334af-84da-4f0d-aeca-c5b49ec83336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2f170>]}
[0m12:54:28.280497 [info ] [MainThread]: Found 8 models, 5 data tests, 3 sources, 416 macros
[0m12:54:28.280671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd77334af-84da-4f0d-aeca-c5b49ec83336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499dca0>]}
[0m12:54:28.281655 [info ] [MainThread]: 
[0m12:54:28.281941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:54:28.284382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m12:54:28.312273 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:54:28.312509 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:54:28.312654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:28.322462 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:54:28.322672 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:54:28.322820 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:54:28.343618 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:54:28.344870 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:54:28.345801 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:54:28.345959 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:54:28.348461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd77334af-84da-4f0d-aeca-c5b49ec83336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc380>]}
[0m12:54:28.348698 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:28.348823 [debug] [MainThread]: On master: BEGIN
[0m12:54:28.348939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:28.352078 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:54:28.352248 [debug] [MainThread]: On master: COMMIT
[0m12:54:28.352382 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:28.352500 [debug] [MainThread]: On master: COMMIT
[0m12:54:28.352656 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:28.352784 [debug] [MainThread]: On master: Close
[0m12:54:28.353348 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:54:28.353521 [info ] [MainThread]: 
[0m12:54:28.354870 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:54:28.355074 [info ] [Thread-1 (]: 1 of 5 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m12:54:28.355278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m12:54:28.355441 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:54:28.365693 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:54:28.365990 [error] [Thread-1 (]: 1 of 5 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m12:54:28.366241 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:54:28.366428 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:54:28.366906 [info ] [Thread-1 (]: 2 of 5 START test not_null_src_listen_track_id ................................. [RUN]
[0m12:54:28.367129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m12:54:28.367303 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:54:28.371138 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:54:28.371499 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:54:28.378275 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:54:28.378678 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:54:28.378861 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m12:54:28.379089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:28.382892 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:54:28.383133 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:54:28.383308 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m12:54:28.386928 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:28.389121 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m12:54:28.389637 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m12:54:28.389799 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m12:54:28.390555 [info ] [Thread-1 (]: 2 of 5 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:54:28.390851 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:54:28.391040 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:54:28.391230 [info ] [Thread-1 (]: 3 of 5 START test not_null_src_listen_user_id .................................. [RUN]
[0m12:54:28.391413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m12:54:28.391565 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:54:28.393514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:54:28.393911 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:54:28.394918 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:54:28.395215 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:54:28.395395 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m12:54:28.395534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:28.398917 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:28.399141 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:54:28.399314 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m12:54:28.399864 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:54:28.400625 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m12:54:28.401091 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m12:54:28.401247 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m12:54:28.401906 [info ] [Thread-1 (]: 3 of 5 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m12:54:28.402167 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:54:28.402350 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:54:28.402530 [info ] [Thread-1 (]: 4 of 5 START test unique_src_listen_track_id ................................... [RUN]
[0m12:54:28.402706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m12:54:28.402854 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:54:28.406163 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:54:28.406732 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:54:28.408654 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:54:28.409097 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:54:28.409273 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m12:54:28.409426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:28.412899 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:28.413099 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:54:28.413267 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:28.415040 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:54:28.415848 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m12:54:28.416334 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m12:54:28.416528 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m12:54:28.417220 [info ] [Thread-1 (]: 4 of 5 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m12:54:28.417480 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:54:28.417668 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:28.417849 [info ] [Thread-1 (]: 5 of 5 START test unique_src_listen_user_id .................................... [RUN]
[0m12:54:28.418024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m12:54:28.418174 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:28.420097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:28.420447 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:28.421418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:28.421730 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:28.421886 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m12:54:28.422028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:28.425317 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:28.425512 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:54:28.425684 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:28.426415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:54:28.427171 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m12:54:28.427637 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m12:54:28.427787 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m12:54:28.428478 [info ] [Thread-1 (]: 5 of 5 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m12:54:28.428756 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:54:28.429312 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:28.429452 [debug] [MainThread]: On master: BEGIN
[0m12:54:28.429578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:28.432983 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:54:28.433174 [debug] [MainThread]: On master: COMMIT
[0m12:54:28.433308 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:28.433426 [debug] [MainThread]: On master: COMMIT
[0m12:54:28.433580 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:28.433708 [debug] [MainThread]: On master: Close
[0m12:54:28.434259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:28.434413 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m12:54:28.434568 [info ] [MainThread]: 
[0m12:54:28.434719 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:54:28.435256 [debug] [MainThread]: Command end result
[0m12:54:28.451046 [info ] [MainThread]: 
[0m12:54:28.451264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:54:28.451402 [info ] [MainThread]: 
[0m12:54:28.451583 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:54:28.451721 [info ] [MainThread]: 
[0m12:54:28.451861 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:54:28.453508 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.57924074, "process_user_time": 0.948879, "process_kernel_time": 0.143035, "process_mem_max_rss": "142163968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:54:28.453776 [debug] [MainThread]: Command `dbt test` failed at 12:54:28.453737 after 0.58 seconds
[0m12:54:28.453969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043305f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba7fb0>]}
[0m12:54:28.454140 [debug] [MainThread]: Flushing usage events
[0m12:55:25.077522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065658e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a09f10>]}


============================== 12:55:25.081019 | 1e0a8981-93cc-4ebd-a830-9c8be024fcca ==============================
[0m12:55:25.081019 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:55:25.081353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:55:25.260973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e0a8981-93cc-4ebd-a830-9c8be024fcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a93fb0>]}
[0m12:55:25.284386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e0a8981-93cc-4ebd-a830-9c8be024fcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bb320>]}
[0m12:55:25.286231 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:55:25.296272 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:55:25.371067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:25.371309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:25.391062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e0a8981-93cc-4ebd-a830-9c8be024fcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a85c70>]}
[0m12:55:25.454706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e0a8981-93cc-4ebd-a830-9c8be024fcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aaa180>]}
[0m12:55:25.454999 [info ] [MainThread]: Found 8 models, 5 data tests, 3 sources, 416 macros
[0m12:55:25.455179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e0a8981-93cc-4ebd-a830-9c8be024fcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a900e0>]}
[0m12:55:25.456145 [info ] [MainThread]: 
[0m12:55:25.456435 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:55:25.458743 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m12:55:25.488342 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:55:25.488581 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:55:25.488720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:25.498512 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:55:25.498714 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:55:25.498869 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:55:25.519182 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:55:25.520444 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:55:25.521378 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:55:25.521529 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:55:25.524050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e0a8981-93cc-4ebd-a830-9c8be024fcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c0b00>]}
[0m12:55:25.524294 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:25.524431 [debug] [MainThread]: On master: BEGIN
[0m12:55:25.524553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:25.527737 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:55:25.527912 [debug] [MainThread]: On master: COMMIT
[0m12:55:25.528045 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:25.528164 [debug] [MainThread]: On master: COMMIT
[0m12:55:25.528320 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:55:25.528448 [debug] [MainThread]: On master: Close
[0m12:55:25.528979 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:55:25.529153 [info ] [MainThread]: 
[0m12:55:25.530495 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:55:25.530705 [info ] [Thread-1 (]: 1 of 5 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m12:55:25.530913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m12:55:25.531074 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:55:25.541329 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:55:25.541624 [error] [Thread-1 (]: 1 of 5 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m12:55:25.541885 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:55:25.542074 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:55:25.542550 [info ] [Thread-1 (]: 2 of 5 START test not_null_src_listen_track_id ................................. [RUN]
[0m12:55:25.542735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m12:55:25.542888 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:55:25.546749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:55:25.547229 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:55:25.554273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:55:25.554693 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:55:25.554866 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m12:55:25.555012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:25.558295 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:55:25.558494 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:55:25.558666 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m12:55:25.562188 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:55:25.564223 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m12:55:25.564730 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m12:55:25.564893 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m12:55:25.565606 [info ] [Thread-1 (]: 2 of 5 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:55:25.565870 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:55:25.566056 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:55:25.566242 [info ] [Thread-1 (]: 3 of 5 START test not_null_src_listen_user_id .................................. [RUN]
[0m12:55:25.566419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m12:55:25.566572 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:55:25.568772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:55:25.569204 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:55:25.570273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:55:25.570674 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:55:25.570850 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m12:55:25.571000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:25.574336 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:55:25.574538 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:55:25.574708 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m12:55:25.575262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:55:25.576045 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m12:55:25.576511 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m12:55:25.576659 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m12:55:25.577322 [info ] [Thread-1 (]: 3 of 5 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m12:55:25.577575 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:55:25.577756 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:55:25.577927 [info ] [Thread-1 (]: 4 of 5 START test unique_src_listen_track_id ................................... [RUN]
[0m12:55:25.578103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m12:55:25.578251 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:55:25.581478 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:55:25.581824 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:55:25.583585 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:55:25.583900 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:55:25.584058 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m12:55:25.584204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:25.587520 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:55:25.587760 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:55:25.587951 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:55:25.589727 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:55:25.590731 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m12:55:25.591235 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m12:55:25.591394 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m12:55:25.592146 [info ] [Thread-1 (]: 4 of 5 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m12:55:25.592407 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:55:25.592588 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:55:25.592773 [info ] [Thread-1 (]: 5 of 5 START test unique_src_listen_user_id .................................... [RUN]
[0m12:55:25.592956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m12:55:25.593102 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:55:25.595034 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:55:25.595545 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:55:25.596524 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:55:25.596808 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:55:25.596959 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m12:55:25.597100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:25.600779 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:55:25.600988 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:55:25.601160 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:55:25.601863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:55:25.602626 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m12:55:25.603099 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m12:55:25.603253 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m12:55:25.603953 [info ] [Thread-1 (]: 5 of 5 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m12:55:25.604267 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:55:25.604806 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:25.604948 [debug] [MainThread]: On master: BEGIN
[0m12:55:25.605069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:25.608272 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:55:25.608523 [debug] [MainThread]: On master: COMMIT
[0m12:55:25.608674 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:25.608810 [debug] [MainThread]: On master: COMMIT
[0m12:55:25.608986 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:55:25.609118 [debug] [MainThread]: On master: Close
[0m12:55:25.609707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:25.609864 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m12:55:25.610028 [info ] [MainThread]: 
[0m12:55:25.610227 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:55:25.610891 [debug] [MainThread]: Command end result
[0m12:55:25.626894 [info ] [MainThread]: 
[0m12:55:25.627124 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:55:25.627269 [info ] [MainThread]: 
[0m12:55:25.627458 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:55:25.627605 [info ] [MainThread]: 
[0m12:55:25.627746 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:55:25.629477 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.58415836, "process_user_time": 0.952388, "process_kernel_time": 0.154448, "process_mem_max_rss": "138084352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:55:25.629790 [debug] [MainThread]: Command `dbt test` failed at 12:55:25.629744 after 0.58 seconds
[0m12:55:25.630005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11001a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0a1e0>]}
[0m12:55:25.630213 [debug] [MainThread]: Flushing usage events
[0m12:59:25.942147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b871a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a146150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a145e20>]}


============================== 12:59:25.945159 | 6ea925d3-f763-4f8f-8503-d028c900cc3c ==============================
[0m12:59:25.945159 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:59:25.945479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:59:26.124730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ea925d3-f763-4f8f-8503-d028c900cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1aeb10>]}
[0m12:59:26.147732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ea925d3-f763-4f8f-8503-d028c900cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cc770>]}
[0m12:59:26.149537 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m12:59:26.159596 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m12:59:26.233580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:59:26.233914 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/tests/test/test.sql
[0m12:59:26.285589 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.test' (dbt_project/tests/test/test.sql) depends on a node named 'listen_history' in package '' which was not found
[0m12:59:26.321728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ea925d3-f763-4f8f-8503-d028c900cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5c37a0>]}
[0m12:59:26.386711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ea925d3-f763-4f8f-8503-d028c900cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aab1df0>]}
[0m12:59:26.387008 [info ] [MainThread]: Found 8 models, 5 data tests, 3 sources, 416 macros
[0m12:59:26.387176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ea925d3-f763-4f8f-8503-d028c900cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f8fe0>]}
[0m12:59:26.388124 [info ] [MainThread]: 
[0m12:59:26.388412 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:59:26.390701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m12:59:26.419393 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:59:26.419625 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m12:59:26.419762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:26.430065 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:59:26.430291 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m12:59:26.430445 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m12:59:26.450821 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:59:26.452038 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m12:59:26.452959 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m12:59:26.453109 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m12:59:26.455648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ea925d3-f763-4f8f-8503-d028c900cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ad8e0>]}
[0m12:59:26.455894 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:26.456028 [debug] [MainThread]: On master: BEGIN
[0m12:59:26.456146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:26.459449 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:59:26.459631 [debug] [MainThread]: On master: COMMIT
[0m12:59:26.459769 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:26.459891 [debug] [MainThread]: On master: COMMIT
[0m12:59:26.460050 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:26.460179 [debug] [MainThread]: On master: Close
[0m12:59:26.460744 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m12:59:26.460949 [info ] [MainThread]: 
[0m12:59:26.462382 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:59:26.462598 [info ] [Thread-1 (]: 1 of 5 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m12:59:26.462803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m12:59:26.462971 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:59:26.473168 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:26.473456 [error] [Thread-1 (]: 1 of 5 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m12:59:26.473722 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m12:59:26.473914 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:59:26.474539 [info ] [Thread-1 (]: 2 of 5 START test not_null_src_listen_track_id ................................. [RUN]
[0m12:59:26.474759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m12:59:26.474930 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:59:26.478800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:59:26.479428 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:59:26.486475 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:59:26.486930 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:59:26.487105 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m12:59:26.487253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:26.490576 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:59:26.490774 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m12:59:26.490949 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m12:59:26.494784 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:59:26.496780 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m12:59:26.497272 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m12:59:26.497440 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m12:59:26.498203 [info ] [Thread-1 (]: 2 of 5 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m12:59:26.498472 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m12:59:26.498659 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:59:26.498845 [info ] [Thread-1 (]: 3 of 5 START test not_null_src_listen_user_id .................................. [RUN]
[0m12:59:26.499022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m12:59:26.499172 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:59:26.501065 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:59:26.501445 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:59:26.503468 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:59:26.503867 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:59:26.504038 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m12:59:26.504188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:26.507664 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:59:26.507869 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m12:59:26.508039 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m12:59:26.508615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:26.509419 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m12:59:26.509901 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m12:59:26.510061 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m12:59:26.510736 [info ] [Thread-1 (]: 3 of 5 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m12:59:26.511052 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m12:59:26.511261 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:59:26.511449 [info ] [Thread-1 (]: 4 of 5 START test unique_src_listen_track_id ................................... [RUN]
[0m12:59:26.511647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m12:59:26.511878 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:59:26.515285 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:59:26.515675 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:59:26.516731 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:59:26.517047 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:59:26.517212 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m12:59:26.517366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:26.520822 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:59:26.521044 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m12:59:26.521222 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:59:26.522860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:26.523686 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m12:59:26.524202 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m12:59:26.524365 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m12:59:26.525036 [info ] [Thread-1 (]: 4 of 5 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m12:59:26.525293 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m12:59:26.525477 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:59:26.525691 [info ] [Thread-1 (]: 5 of 5 START test unique_src_listen_user_id .................................... [RUN]
[0m12:59:26.525898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m12:59:26.526067 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:59:26.528131 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:59:26.528701 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:59:26.529832 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:59:26.530209 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:59:26.530373 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m12:59:26.530522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:26.534082 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:59:26.534287 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m12:59:26.534460 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:59:26.535141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:26.535904 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m12:59:26.536380 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m12:59:26.536536 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m12:59:26.537206 [info ] [Thread-1 (]: 5 of 5 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m12:59:26.537474 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m12:59:26.537990 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:26.538131 [debug] [MainThread]: On master: BEGIN
[0m12:59:26.538252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:26.541368 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:59:26.541543 [debug] [MainThread]: On master: COMMIT
[0m12:59:26.541680 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:26.541805 [debug] [MainThread]: On master: COMMIT
[0m12:59:26.541968 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:26.542097 [debug] [MainThread]: On master: Close
[0m12:59:26.542617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:26.542768 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m12:59:26.542950 [info ] [MainThread]: 
[0m12:59:26.543098 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:59:26.543581 [debug] [MainThread]: Command end result
[0m12:59:26.559925 [info ] [MainThread]: 
[0m12:59:26.560177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:26.560325 [info ] [MainThread]: 
[0m12:59:26.560504 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:26.560648 [info ] [MainThread]: 
[0m12:59:26.560792 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:59:26.562490 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.65276843, "process_user_time": 1.021403, "process_kernel_time": 0.157163, "process_mem_max_rss": "142114816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:59:26.562774 [debug] [MainThread]: Command `dbt test` failed at 12:59:26.562734 after 0.65 seconds
[0m12:59:26.562974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b871a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a145e20>]}
[0m12:59:26.563147 [debug] [MainThread]: Flushing usage events
[0m13:00:40.731634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028554f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b5e80>]}


============================== 13:00:40.734706 | 89b04faa-fada-4a13-9f29-10525ae771a2 ==============================
[0m13:00:40.734706 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:00:40.735042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select src_listen.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:40.917826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b04faa-fada-4a13-9f29-10525ae771a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f83d10>]}
[0m13:00:40.941504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b04faa-fada-4a13-9f29-10525ae771a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b4980>]}
[0m13:00:40.943291 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m13:00:40.953148 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:00:41.027312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:41.027662 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/tests/test/test.sql
[0m13:00:41.116462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b04faa-fada-4a13-9f29-10525ae771a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717800>]}
[0m13:00:41.180629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b04faa-fada-4a13-9f29-10525ae771a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d69730>]}
[0m13:00:41.180922 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m13:00:41.181097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b04faa-fada-4a13-9f29-10525ae771a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3daf0>]}
[0m13:00:41.182105 [info ] [MainThread]: 
[0m13:00:41.182394 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:00:41.184682 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m13:00:41.216153 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m13:00:41.216386 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m13:00:41.216528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:41.228835 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:00:41.229058 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m13:00:41.229207 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m13:00:41.247661 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:00:41.248721 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m13:00:41.249771 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m13:00:41.249920 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m13:00:41.252462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b04faa-fada-4a13-9f29-10525ae771a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac8350>]}
[0m13:00:41.252713 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:41.252845 [debug] [MainThread]: On master: BEGIN
[0m13:00:41.252963 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:41.256389 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:00:41.256580 [debug] [MainThread]: On master: COMMIT
[0m13:00:41.256719 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:41.256843 [debug] [MainThread]: On master: COMMIT
[0m13:00:41.256998 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:00:41.257133 [debug] [MainThread]: On master: Close
[0m13:00:41.257684 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m13:00:41.257858 [info ] [MainThread]: 
[0m13:00:41.259298 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m13:00:41.259509 [info ] [Thread-1 (]: 1 of 6 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m13:00:41.259716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m13:00:41.259877 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m13:00:41.270090 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:00:41.270376 [error] [Thread-1 (]: 1 of 6 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m13:00:41.270627 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m13:00:41.270810 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m13:00:41.271419 [info ] [Thread-1 (]: 2 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m13:00:41.271642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m13:00:41.271813 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m13:00:41.275671 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m13:00:41.276166 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m13:00:41.283038 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m13:00:41.283681 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m13:00:41.283929 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m13:00:41.284126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:41.287856 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:00:41.288408 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m13:00:41.289199 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m13:00:41.293093 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:00:41.295199 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m13:00:41.295793 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m13:00:41.295966 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m13:00:41.296822 [info ] [Thread-1 (]: 2 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.03s]
[0m13:00:41.297136 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m13:00:41.297335 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m13:00:41.297554 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m13:00:41.297778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m13:00:41.297945 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m13:00:41.299951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m13:00:41.300315 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m13:00:41.302339 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m13:00:41.302691 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m13:00:41.302853 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m13:00:41.302996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:41.306641 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:00:41.306941 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m13:00:41.307135 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m13:00:41.307775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:00:41.308751 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m13:00:41.309272 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m13:00:41.309437 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m13:00:41.310182 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m13:00:41.310462 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m13:00:41.310650 [debug] [Thread-1 (]: Began running node test.dbt_project.test
[0m13:00:41.310825 [info ] [Thread-1 (]: 4 of 6 START test test ......................................................... [RUN]
[0m13:00:41.311001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.test)
[0m13:00:41.311146 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test
[0m13:00:41.312493 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.test"
[0m13:00:41.312952 [debug] [Thread-1 (]: Began executing node test.dbt_project.test
[0m13:00:41.313931 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.test"
[0m13:00:41.314427 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m13:00:41.314578 [debug] [Thread-1 (]: On test.dbt_project.test: BEGIN
[0m13:00:41.314715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:41.318288 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:00:41.318481 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m13:00:41.318649 [debug] [Thread-1 (]: On test.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m13:00:41.320746 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m13:00:41.320956 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:00:41.321146 [debug] [Thread-1 (]: On test.dbt_project.test: ROLLBACK
[0m13:00:41.325004 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.test'
[0m13:00:41.325185 [debug] [Thread-1 (]: On test.dbt_project.test: Close
[0m13:00:41.326849 [debug] [Thread-1 (]: Runtime Error in test test (dbt_project/tests/test/test.sql)
  Parser Error: syntax error at or near ";"
[0m13:00:41.327070 [error] [Thread-1 (]: 4 of 6 ERROR test .............................................................. [[31mERROR[0m in 0.02s]
[0m13:00:41.327319 [debug] [Thread-1 (]: Finished running node test.dbt_project.test
[0m13:00:41.327509 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m13:00:41.327701 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m13:00:41.327877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m13:00:41.328025 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m13:00:41.331129 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m13:00:41.331521 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m13:00:41.332587 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m13:00:41.332912 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m13:00:41.333074 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m13:00:41.333220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:41.336785 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:00:41.336993 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m13:00:41.337164 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:00:41.338697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:41.339465 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m13:00:41.339937 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m13:00:41.340093 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m13:00:41.340842 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m13:00:41.341152 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m13:00:41.341345 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m13:00:41.341530 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m13:00:41.341715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m13:00:41.341865 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m13:00:41.343829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m13:00:41.344166 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m13:00:41.345165 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m13:00:41.345474 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m13:00:41.345624 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m13:00:41.345764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:41.348986 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:00:41.349176 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m13:00:41.349347 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:00:41.350046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:41.350792 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m13:00:41.351267 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m13:00:41.351422 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m13:00:41.352066 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m13:00:41.352341 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m13:00:41.352881 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:41.353025 [debug] [MainThread]: On master: BEGIN
[0m13:00:41.353144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:41.356335 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:00:41.356540 [debug] [MainThread]: On master: COMMIT
[0m13:00:41.356677 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:41.356801 [debug] [MainThread]: On master: COMMIT
[0m13:00:41.356977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:00:41.357115 [debug] [MainThread]: On master: Close
[0m13:00:41.357685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:41.357817 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m13:00:41.357972 [info ] [MainThread]: 
[0m13:00:41.358138 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m13:00:41.358715 [debug] [MainThread]: Command end result
[0m13:00:41.376433 [info ] [MainThread]: 
[0m13:00:41.376698 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:00:41.376841 [info ] [MainThread]: 
[0m13:00:41.377029 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:00:41.377165 [info ] [MainThread]: 
[0m13:00:41.377313 [error] [MainThread]:   Runtime Error in test test (dbt_project/tests/test/test.sql)
  Parser Error: syntax error at or near ";"
[0m13:00:41.377438 [info ] [MainThread]: 
[0m13:00:41.377575 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m13:00:41.379172 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6807449, "process_user_time": 1.046775, "process_kernel_time": 0.162816, "process_mem_max_rss": "141312000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:00:41.379500 [debug] [MainThread]: Command `dbt test` failed at 13:00:41.379450 after 0.68 seconds
[0m13:00:41.379713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028554f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041184a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b6120>]}
[0m13:00:41.379888 [debug] [MainThread]: Flushing usage events
[0m07:29:01.434682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106149dc0>]}


============================== 07:29:01.438615 | 0a990b05-5812-472b-b829-5aa46b7b5507 ==============================
[0m07:29:01.438615 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:29:01.438945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select src_listen.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:01.631723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a990b05-5812-472b-b829-5aa46b7b5507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d0530>]}
[0m07:29:01.654886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a990b05-5812-472b-b829-5aa46b7b5507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f9520>]}
[0m07:29:01.656634 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:29:01.666813 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:29:01.743604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:01.743843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:01.766031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a990b05-5812-472b-b829-5aa46b7b5507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f9850>]}
[0m07:29:01.839444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a990b05-5812-472b-b829-5aa46b7b5507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674e4b0>]}
[0m07:29:01.839737 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:29:01.840157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a990b05-5812-472b-b829-5aa46b7b5507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067165a0>]}
[0m07:29:01.841231 [info ] [MainThread]: 
[0m07:29:01.841549 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:29:01.843951 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m07:29:01.874301 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:29:01.874529 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:29:01.874669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:01.884511 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m07:29:01.884724 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:29:01.884880 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:29:01.906224 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m07:29:01.907362 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:29:01.908288 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:29:01.908440 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:29:01.910872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a990b05-5812-472b-b829-5aa46b7b5507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657af90>]}
[0m07:29:01.911108 [debug] [MainThread]: Using duckdb connection "master"
[0m07:29:01.911241 [debug] [MainThread]: On master: BEGIN
[0m07:29:01.911363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:01.914572 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:29:01.914747 [debug] [MainThread]: On master: COMMIT
[0m07:29:01.914886 [debug] [MainThread]: Using duckdb connection "master"
[0m07:29:01.915012 [debug] [MainThread]: On master: COMMIT
[0m07:29:01.915187 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:29:01.915315 [debug] [MainThread]: On master: Close
[0m07:29:01.915868 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:29:01.916066 [info ] [MainThread]: 
[0m07:29:01.917469 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:29:01.917680 [info ] [Thread-1 (]: 1 of 6 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m07:29:01.917891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m07:29:01.918053 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:29:01.928351 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:29:01.928674 [error] [Thread-1 (]: 1 of 6 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m07:29:01.928950 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:29:01.929148 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:29:01.929825 [info ] [Thread-1 (]: 2 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m07:29:01.930062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m07:29:01.930293 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:29:01.934997 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:29:01.935765 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:29:01.942672 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:29:01.943031 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:29:01.943199 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m07:29:01.943354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:01.946850 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:29:01.947173 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:29:01.947352 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m07:29:01.951344 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:29:01.953519 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m07:29:01.954054 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m07:29:01.954226 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m07:29:01.955030 [info ] [Thread-1 (]: 2 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m07:29:01.955312 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:29:01.955509 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:29:01.955699 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m07:29:01.955905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m07:29:01.956067 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:29:01.958470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:29:01.959059 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:29:01.960097 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:29:01.960538 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:29:01.960695 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m07:29:01.960840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:01.964403 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:29:01.964616 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:29:01.964789 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m07:29:01.965417 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:29:01.966214 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m07:29:01.966685 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m07:29:01.966840 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m07:29:01.967494 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m07:29:01.967756 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:29:01.967941 [debug] [Thread-1 (]: Began running node test.dbt_project.test
[0m07:29:01.968117 [info ] [Thread-1 (]: 4 of 6 START test test ......................................................... [RUN]
[0m07:29:01.968297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.test)
[0m07:29:01.968443 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test
[0m07:29:01.970447 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.test"
[0m07:29:01.970800 [debug] [Thread-1 (]: Began executing node test.dbt_project.test
[0m07:29:01.971808 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.test"
[0m07:29:01.972086 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m07:29:01.972231 [debug] [Thread-1 (]: On test.dbt_project.test: BEGIN
[0m07:29:01.972368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:01.975694 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:29:01.975907 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m07:29:01.976090 [debug] [Thread-1 (]: On test.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:29:01.978632 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:29:01.978835 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:29:01.979036 [debug] [Thread-1 (]: On test.dbt_project.test: ROLLBACK
[0m07:29:01.983043 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.test'
[0m07:29:01.983328 [debug] [Thread-1 (]: On test.dbt_project.test: Close
[0m07:29:01.985133 [debug] [Thread-1 (]: Runtime Error in test test (dbt_project/tests/test/test.sql)
  Parser Error: syntax error at or near ";"
[0m07:29:01.985358 [error] [Thread-1 (]: 4 of 6 ERROR test .............................................................. [[31mERROR[0m in 0.02s]
[0m07:29:01.985610 [debug] [Thread-1 (]: Finished running node test.dbt_project.test
[0m07:29:01.985796 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:29:01.985994 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m07:29:01.986208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m07:29:01.986360 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:29:01.989485 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:29:01.989869 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:29:01.990872 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:29:01.991172 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:29:01.991329 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m07:29:01.991470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:01.994771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:29:01.994960 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:29:01.995133 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:29:01.996616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:29:01.997559 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m07:29:01.998063 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m07:29:01.998214 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m07:29:01.998917 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m07:29:01.999210 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:29:01.999402 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:29:01.999588 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m07:29:01.999769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m07:29:01.999921 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:29:02.002064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:29:02.002470 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:29:02.003568 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:29:02.004087 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:29:02.004298 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m07:29:02.004464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:02.008257 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:29:02.008484 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:29:02.008665 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:29:02.009396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:29:02.010224 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m07:29:02.010704 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m07:29:02.010860 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m07:29:02.011511 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m07:29:02.011781 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:29:02.012394 [debug] [MainThread]: Using duckdb connection "master"
[0m07:29:02.012543 [debug] [MainThread]: On master: BEGIN
[0m07:29:02.012679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:02.016147 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:29:02.016322 [debug] [MainThread]: On master: COMMIT
[0m07:29:02.016448 [debug] [MainThread]: Using duckdb connection "master"
[0m07:29:02.016568 [debug] [MainThread]: On master: COMMIT
[0m07:29:02.016728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:29:02.016852 [debug] [MainThread]: On master: Close
[0m07:29:02.017404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:02.017533 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m07:29:02.017679 [info ] [MainThread]: 
[0m07:29:02.017823 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m07:29:02.018371 [debug] [MainThread]: Command end result
[0m07:29:02.033677 [info ] [MainThread]: 
[0m07:29:02.033919 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:29:02.034066 [info ] [MainThread]: 
[0m07:29:02.034260 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:29:02.034399 [info ] [MainThread]: 
[0m07:29:02.034558 [error] [MainThread]:   Runtime Error in test test (dbt_project/tests/test/test.sql)
  Parser Error: syntax error at or near ";"
[0m07:29:02.034685 [info ] [MainThread]: 
[0m07:29:02.034834 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m07:29:02.036383 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6446271, "process_user_time": 0.97324, "process_kernel_time": 0.174084, "process_mem_max_rss": "142589952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:02.036694 [debug] [MainThread]: Command `dbt test` failed at 07:29:02.036645 after 0.64 seconds
[0m07:29:02.036918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b1460>]}
[0m07:29:02.037099 [debug] [MainThread]: Flushing usage events
[0m07:34:22.949402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e461b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45e80>]}


============================== 07:34:22.952411 | 654fc636-c2de-4365-9ab6-e6cbb43fb1ff ==============================
[0m07:34:22.952411 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:34:22.952770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select src_listen.sql', 'send_anonymous_usage_stats': 'True'}
[0m07:34:23.133427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '654fc636-c2de-4365-9ab6-e6cbb43fb1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110110b30>]}
[0m07:34:23.156863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '654fc636-c2de-4365-9ab6-e6cbb43fb1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106118bc0>]}
[0m07:34:23.158820 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:34:23.169230 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:34:23.246038 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m07:34:23.246361 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/tests/test.sql
[0m07:34:23.246507 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/tests/test/test.sql
[0m07:34:23.328890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '654fc636-c2de-4365-9ab6-e6cbb43fb1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018e060>]}
[0m07:34:23.391919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '654fc636-c2de-4365-9ab6-e6cbb43fb1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106b1b50>]}
[0m07:34:23.392209 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:34:23.392382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654fc636-c2de-4365-9ab6-e6cbb43fb1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110388c80>]}
[0m07:34:23.393377 [info ] [MainThread]: 
[0m07:34:23.393664 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:34:23.395950 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m07:34:23.424932 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:34:23.425164 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:34:23.425302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:23.435547 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m07:34:23.435768 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:34:23.435922 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:34:23.457209 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m07:34:23.458485 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:34:23.459438 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:34:23.459594 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:34:23.462097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654fc636-c2de-4365-9ab6-e6cbb43fb1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a23f0>]}
[0m07:34:23.462344 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:23.462469 [debug] [MainThread]: On master: BEGIN
[0m07:34:23.462584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:23.465764 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:34:23.465938 [debug] [MainThread]: On master: COMMIT
[0m07:34:23.466072 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:23.466190 [debug] [MainThread]: On master: COMMIT
[0m07:34:23.466341 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:34:23.466470 [debug] [MainThread]: On master: Close
[0m07:34:23.466996 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:34:23.467160 [info ] [MainThread]: 
[0m07:34:23.468525 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:34:23.468730 [info ] [Thread-1 (]: 1 of 6 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m07:34:23.468939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m07:34:23.469106 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:34:23.479437 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:34:23.479719 [error] [Thread-1 (]: 1 of 6 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m07:34:23.479984 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:34:23.480183 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:23.480815 [info ] [Thread-1 (]: 2 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m07:34:23.481060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m07:34:23.481241 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:23.485162 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:23.485904 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:23.492857 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:23.493244 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:23.493420 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m07:34:23.493583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:23.497068 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:23.497279 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:23.497449 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m07:34:23.501665 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:34:23.503831 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m07:34:23.504387 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m07:34:23.504561 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m07:34:23.505332 [info ] [Thread-1 (]: 2 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m07:34:23.505644 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:23.505851 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:23.506070 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m07:34:23.506297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m07:34:23.506464 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:23.508373 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:23.508963 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:23.510804 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:23.511119 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:23.511275 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m07:34:23.511417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:23.514880 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:23.515092 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:23.515260 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m07:34:23.515855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:34:23.516649 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m07:34:23.517115 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m07:34:23.517268 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m07:34:23.518103 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m07:34:23.518391 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:23.518620 [debug] [Thread-1 (]: Began running node test.dbt_project.test
[0m07:34:23.518808 [info ] [Thread-1 (]: 4 of 6 START test test ......................................................... [RUN]
[0m07:34:23.518992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.test)
[0m07:34:23.519144 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test
[0m07:34:23.520657 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.test"
[0m07:34:23.521026 [debug] [Thread-1 (]: Began executing node test.dbt_project.test
[0m07:34:23.522063 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.test"
[0m07:34:23.522367 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m07:34:23.522518 [debug] [Thread-1 (]: On test.dbt_project.test: BEGIN
[0m07:34:23.522657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:23.526554 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:34:23.526828 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m07:34:23.527003 [debug] [Thread-1 (]: On test.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:34:23.529862 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:34:23.530047 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:34:23.530249 [debug] [Thread-1 (]: On test.dbt_project.test: ROLLBACK
[0m07:34:23.534335 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.test'
[0m07:34:23.534505 [debug] [Thread-1 (]: On test.dbt_project.test: Close
[0m07:34:23.536613 [debug] [Thread-1 (]: Runtime Error in test test (dbt_project/tests/test.sql)
  Parser Error: syntax error at or near ";"
[0m07:34:23.536929 [error] [Thread-1 (]: 4 of 6 ERROR test .............................................................. [[31mERROR[0m in 0.02s]
[0m07:34:23.537235 [debug] [Thread-1 (]: Finished running node test.dbt_project.test
[0m07:34:23.537463 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:23.537721 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m07:34:23.537918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m07:34:23.538076 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:23.541113 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:23.541506 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:23.542495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:23.542794 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:23.542963 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m07:34:23.543102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:23.546513 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:23.546726 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:23.546898 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:23.548715 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:34:23.549599 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m07:34:23.550176 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m07:34:23.550351 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m07:34:23.551073 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m07:34:23.551359 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:23.551547 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:23.551741 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m07:34:23.551950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m07:34:23.552106 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:23.554197 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:23.554711 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:23.555701 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:23.555992 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:23.556145 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m07:34:23.556281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:23.559707 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:23.559902 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:23.560064 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:23.560770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:34:23.561567 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m07:34:23.562080 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m07:34:23.562241 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m07:34:23.562965 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m07:34:23.563236 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:23.563803 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:23.563953 [debug] [MainThread]: On master: BEGIN
[0m07:34:23.564073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:23.567154 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:34:23.567325 [debug] [MainThread]: On master: COMMIT
[0m07:34:23.567461 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:23.567576 [debug] [MainThread]: On master: COMMIT
[0m07:34:23.567728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:34:23.567855 [debug] [MainThread]: On master: Close
[0m07:34:23.568340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:23.568467 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m07:34:23.568613 [info ] [MainThread]: 
[0m07:34:23.568757 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m07:34:23.569271 [debug] [MainThread]: Command end result
[0m07:34:23.583550 [info ] [MainThread]: 
[0m07:34:23.583793 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:34:23.583935 [info ] [MainThread]: 
[0m07:34:23.584118 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:34:23.584254 [info ] [MainThread]: 
[0m07:34:23.584398 [error] [MainThread]:   Runtime Error in test test (dbt_project/tests/test.sql)
  Parser Error: syntax error at or near ";"
[0m07:34:23.584522 [info ] [MainThread]: 
[0m07:34:23.584662 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m07:34:23.586036 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6769012, "process_user_time": 1.02358, "process_kernel_time": 0.172406, "process_mem_max_rss": "142819328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:34:23.586301 [debug] [MainThread]: Command `dbt test` failed at 07:34:23.586261 after 0.68 seconds
[0m07:34:23.586494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107865df0>]}
[0m07:34:23.586666 [debug] [MainThread]: Flushing usage events
[0m07:34:44.310070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd1a30>]}


============================== 07:34:44.313063 | c467b1e2-590d-4a4d-8a67-59bd642c052d ==============================
[0m07:34:44.313063 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:34:44.313409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m07:34:44.377888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c467b1e2-590d-4a4d-8a67-59bd642c052d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa5250>]}
[0m07:34:44.398003 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11716913, "process_user_time": 0.631759, "process_kernel_time": 0.082989, "process_mem_max_rss": "95010816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:34:44.398349 [debug] [MainThread]: Command `dbt clean` succeeded at 07:34:44.398305 after 0.12 seconds
[0m07:34:44.398523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd1a30>]}
[0m07:34:44.398692 [debug] [MainThread]: Flushing usage events
[0m07:34:48.165067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103beeae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104692180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104691e80>]}


============================== 07:34:48.167235 | 6d314712-5b87-4b06-a11d-8fc47b96a878 ==============================
[0m07:34:48.167235 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:34:48.167547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m07:34:48.342565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d314712-5b87-4b06-a11d-8fc47b96a878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104793020>]}
[0m07:34:48.365302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d314712-5b87-4b06-a11d-8fc47b96a878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104675a30>]}
[0m07:34:48.367768 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:34:48.378594 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:34:48.379208 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:34:48.379432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d314712-5b87-4b06-a11d-8fc47b96a878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fae40>]}
[0m07:34:48.983622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d314712-5b87-4b06-a11d-8fc47b96a878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d38770>]}
[0m07:34:49.068883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d314712-5b87-4b06-a11d-8fc47b96a878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc30b0>]}
[0m07:34:49.069163 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:34:49.069339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d314712-5b87-4b06-a11d-8fc47b96a878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9cc80>]}
[0m07:34:49.070282 [info ] [MainThread]: 
[0m07:34:49.070548 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:34:49.072935 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m07:34:49.101844 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:34:49.102070 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:34:49.102208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:49.112254 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m07:34:49.112478 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:34:49.112643 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:34:49.134643 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m07:34:49.135887 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:34:49.136775 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:34:49.136931 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:34:49.139439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d314712-5b87-4b06-a11d-8fc47b96a878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdc110>]}
[0m07:34:49.139676 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:49.139806 [debug] [MainThread]: On master: BEGIN
[0m07:34:49.139921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:49.143127 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:34:49.143299 [debug] [MainThread]: On master: COMMIT
[0m07:34:49.143431 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:49.143546 [debug] [MainThread]: On master: COMMIT
[0m07:34:49.143700 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:34:49.143829 [debug] [MainThread]: On master: Close
[0m07:34:49.144370 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:34:49.144564 [info ] [MainThread]: 
[0m07:34:49.145931 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:34:49.146139 [info ] [Thread-1 (]: 1 of 6 START test accepted_type_src_listen_listen_timestamp__timestamp__date ... [RUN]
[0m07:34:49.146348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a)
[0m07:34:49.146510 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:34:49.154297 [debug] [Thread-1 (]: Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:34:49.154574 [error] [Thread-1 (]: 1 of 6 ERROR accepted_type_src_listen_listen_timestamp__timestamp__date ........ [[31mERROR[0m in 0.01s]
[0m07:34:49.154825 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a
[0m07:34:49.155010 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:49.155451 [info ] [Thread-1 (]: 2 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m07:34:49.155636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_type_src_listen_listen_timestamp__timestamp__date.bcf28c1f3a, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m07:34:49.155910 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:49.159827 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:49.160443 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:49.167317 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:49.167956 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:49.168130 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m07:34:49.168277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:49.171723 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:49.171928 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:34:49.172094 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m07:34:49.176411 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:34:49.178382 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m07:34:49.178866 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m07:34:49.179029 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m07:34:49.179689 [info ] [Thread-1 (]: 2 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m07:34:49.179982 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:34:49.180175 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:49.180388 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m07:34:49.180575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m07:34:49.180731 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:49.182661 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:49.183030 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:49.184013 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:49.184307 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:49.184473 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m07:34:49.184613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:49.188303 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:34:49.188575 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:34:49.188756 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m07:34:49.189447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:34:49.190237 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m07:34:49.190716 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m07:34:49.190867 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m07:34:49.191601 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m07:34:49.191898 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:34:49.192090 [debug] [Thread-1 (]: Began running node test.dbt_project.test
[0m07:34:49.192286 [info ] [Thread-1 (]: 4 of 6 START test test ......................................................... [RUN]
[0m07:34:49.192500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.test)
[0m07:34:49.192670 [debug] [Thread-1 (]: Began compiling node test.dbt_project.test
[0m07:34:49.194092 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.test"
[0m07:34:49.194508 [debug] [Thread-1 (]: Began executing node test.dbt_project.test
[0m07:34:49.195529 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.test"
[0m07:34:49.195891 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m07:34:49.196044 [debug] [Thread-1 (]: On test.dbt_project.test: BEGIN
[0m07:34:49.196187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:49.199687 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:49.199884 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.test"
[0m07:34:49.200045 [debug] [Thread-1 (]: On test.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:34:49.202100 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:34:49.202279 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:34:49.202460 [debug] [Thread-1 (]: On test.dbt_project.test: ROLLBACK
[0m07:34:49.206216 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.test'
[0m07:34:49.206377 [debug] [Thread-1 (]: On test.dbt_project.test: Close
[0m07:34:49.208135 [debug] [Thread-1 (]: Runtime Error in test test (dbt_project/tests/test.sql)
  Parser Error: syntax error at or near ";"
[0m07:34:49.208385 [error] [Thread-1 (]: 4 of 6 ERROR test .............................................................. [[31mERROR[0m in 0.02s]
[0m07:34:49.208661 [debug] [Thread-1 (]: Finished running node test.dbt_project.test
[0m07:34:49.208855 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:49.209071 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m07:34:49.209278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.test, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m07:34:49.209437 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:49.212684 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:49.213178 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:49.214289 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:49.214603 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:49.214758 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m07:34:49.214900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:49.218199 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:49.218385 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:34:49.218550 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:49.220243 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:34:49.221223 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m07:34:49.221703 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m07:34:49.221849 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m07:34:49.222576 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m07:34:49.222842 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:34:49.223031 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:49.223221 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m07:34:49.223400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m07:34:49.223547 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:49.226585 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:49.227012 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:49.228092 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:49.228417 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:49.228578 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m07:34:49.228727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:49.232219 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:34:49.232426 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:34:49.232595 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:34:49.233261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:34:49.234029 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m07:34:49.234491 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m07:34:49.234638 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m07:34:49.235298 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m07:34:49.235556 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:34:49.236193 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:49.236358 [debug] [MainThread]: On master: BEGIN
[0m07:34:49.236518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:49.240110 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m07:34:49.240303 [debug] [MainThread]: On master: COMMIT
[0m07:34:49.240435 [debug] [MainThread]: Using duckdb connection "master"
[0m07:34:49.240552 [debug] [MainThread]: On master: COMMIT
[0m07:34:49.240703 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:34:49.240823 [debug] [MainThread]: On master: Close
[0m07:34:49.241370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:49.241490 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m07:34:49.241632 [info ] [MainThread]: 
[0m07:34:49.241774 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m07:34:49.242302 [debug] [MainThread]: Command end result
[0m07:34:49.255928 [info ] [MainThread]: 
[0m07:34:49.256149 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:34:49.256287 [info ] [MainThread]: 
[0m07:34:49.256462 [error] [MainThread]:   Compilation Error in test accepted_type_src_listen_listen_timestamp__timestamp__date (dbt_project/models/01_source_layer/schema.yml)
  'test_accepted_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:34:49.256593 [info ] [MainThread]: 
[0m07:34:49.256735 [error] [MainThread]:   Runtime Error in test test (dbt_project/tests/test.sql)
  Parser Error: syntax error at or near ";"
[0m07:34:49.256854 [info ] [MainThread]: 
[0m07:34:49.256988 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m07:34:49.257748 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.1200634, "process_user_time": 1.493297, "process_kernel_time": 0.137987, "process_mem_max_rss": "142573568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:34:49.258007 [debug] [MainThread]: Command `dbt test` failed at 07:34:49.257968 after 1.12 seconds
[0m07:34:49.258176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040dbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104691e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104692120>]}
[0m07:34:49.258335 [debug] [MainThread]: Flushing usage events
[0m07:38:52.167107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad1d30>]}


============================== 07:38:52.170096 | e7e0d77b-5916-4942-a999-1a12474a396b ==============================
[0m07:38:52.170096 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:38:52.170445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m07:38:52.353818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7e0d77b-5916-4942-a999-1a12474a396b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a26f0>]}
[0m07:38:52.376930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7e0d77b-5916-4942-a999-1a12474a396b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af5070>]}
[0m07:38:52.378694 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:38:52.389102 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:38:52.464026 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m07:38:52.464345 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt_project/tests/custom_test_type_check.sql
[0m07:38:52.464595 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/schema.yml
[0m07:38:52.464733 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://dbt_project/tests/test.sql
[0m07:38:52.667318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7e0d77b-5916-4942-a999-1a12474a396b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906d4c0>]}
[0m07:38:52.729194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7e0d77b-5916-4942-a999-1a12474a396b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914ad20>]}
[0m07:38:52.729499 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:38:52.729674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e0d77b-5916-4942-a999-1a12474a396b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a2690>]}
[0m07:38:52.730667 [info ] [MainThread]: 
[0m07:38:52.730952 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:38:52.733431 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m07:38:52.761636 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:38:52.761872 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:38:52.762016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:52.775201 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m07:38:52.775440 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:38:52.775594 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:38:52.799258 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m07:38:52.800634 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:38:52.801576 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:38:52.801727 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:38:52.804322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e0d77b-5916-4942-a999-1a12474a396b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10909c6e0>]}
[0m07:38:52.804565 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:52.804697 [debug] [MainThread]: On master: BEGIN
[0m07:38:52.804813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:38:52.808056 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:38:52.808235 [debug] [MainThread]: On master: COMMIT
[0m07:38:52.808368 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:52.808493 [debug] [MainThread]: On master: COMMIT
[0m07:38:52.808646 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:38:52.808776 [debug] [MainThread]: On master: Close
[0m07:38:52.809311 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:38:52.809490 [info ] [MainThread]: 
[0m07:38:52.810955 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check
[0m07:38:52.811175 [info ] [Thread-1 (]: 1 of 6 START test custom_test_type_check ....................................... [RUN]
[0m07:38:52.811391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.custom_test_type_check)
[0m07:38:52.811554 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check
[0m07:38:52.815185 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.custom_test_type_check"
[0m07:38:52.815731 [debug] [Thread-1 (]: Began executing node test.dbt_project.custom_test_type_check
[0m07:38:52.823380 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.custom_test_type_check"
[0m07:38:52.823752 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:38:52.823919 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: BEGIN
[0m07:38:52.824063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:52.827550 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:38:52.827777 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:38:52.827957 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.custom_test_type_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:38:52.831303 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.custom_test_type_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check;
      
    ) dbt_internal_test
[0m07:38:52.831513 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:38:52.831723 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: ROLLBACK
[0m07:38:52.837030 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.custom_test_type_check'
[0m07:38:52.837204 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: Close
[0m07:38:52.839039 [debug] [Thread-1 (]: Runtime Error in test custom_test_type_check (dbt_project/tests/custom_test_type_check.sql)
  Parser Error: syntax error at or near ";"
[0m07:38:52.839314 [error] [Thread-1 (]: 1 of 6 ERROR custom_test_type_check ............................................ [[31mERROR[0m in 0.03s]
[0m07:38:52.839656 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check
[0m07:38:52.839903 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:38:52.840456 [info ] [Thread-1 (]: 2 of 6 START test custom_test_type_check_src_listen_listen_timestamp ........... [RUN]
[0m07:38:52.840658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check, now test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170)
[0m07:38:52.840815 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:38:52.845964 [debug] [Thread-1 (]: Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:38:52.846219 [error] [Thread-1 (]: 2 of 6 ERROR custom_test_type_check_src_listen_listen_timestamp ................ [[31mERROR[0m in 0.01s]
[0m07:38:52.846469 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:38:52.846650 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:38:52.846837 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m07:38:52.847013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m07:38:52.847162 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:38:52.850612 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:38:52.851364 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:38:52.852463 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:38:52.852771 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:38:52.852930 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m07:38:52.853085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:52.856615 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:38:52.856884 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:38:52.857059 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m07:38:52.859269 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:38:52.861301 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m07:38:52.861779 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m07:38:52.861935 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m07:38:52.862617 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m07:38:52.862882 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:38:52.863072 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:38:52.863260 [info ] [Thread-1 (]: 4 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m07:38:52.863445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m07:38:52.863599 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:38:52.865610 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:38:52.865983 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:38:52.866968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:38:52.867265 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:38:52.867417 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m07:38:52.867555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:52.870824 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:38:52.871013 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:38:52.871184 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m07:38:52.871759 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:38:52.872590 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m07:38:52.873212 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m07:38:52.873375 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m07:38:52.874223 [info ] [Thread-1 (]: 4 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m07:38:52.874558 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:38:52.874747 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:38:52.874930 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m07:38:52.875114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m07:38:52.875266 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:38:52.878314 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:38:52.878691 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:38:52.879685 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:38:52.879975 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:38:52.880136 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m07:38:52.880278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:52.883586 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:38:52.883785 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:38:52.883959 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:38:52.885468 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:38:52.886212 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m07:38:52.886675 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m07:38:52.886819 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m07:38:52.887440 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m07:38:52.887702 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:38:52.887879 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:38:52.888064 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m07:38:52.888240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m07:38:52.888387 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:38:52.890537 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:38:52.890935 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:38:52.891932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:38:52.892221 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:38:52.892370 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m07:38:52.892513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:52.896040 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:38:52.896264 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:38:52.896443 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:38:52.897152 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:38:52.897978 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m07:38:52.898481 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m07:38:52.898629 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m07:38:52.899356 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m07:38:52.899663 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:38:52.900217 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:52.900371 [debug] [MainThread]: On master: BEGIN
[0m07:38:52.900492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:38:52.903625 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:38:52.903793 [debug] [MainThread]: On master: COMMIT
[0m07:38:52.903928 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:52.904052 [debug] [MainThread]: On master: COMMIT
[0m07:38:52.904207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:38:52.904332 [debug] [MainThread]: On master: Close
[0m07:38:52.904827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:52.904964 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m07:38:52.905102 [info ] [MainThread]: 
[0m07:38:52.905240 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m07:38:52.905793 [debug] [MainThread]: Command end result
[0m07:38:52.920877 [info ] [MainThread]: 
[0m07:38:52.921118 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:38:52.921260 [info ] [MainThread]: 
[0m07:38:52.921437 [error] [MainThread]:   Runtime Error in test custom_test_type_check (dbt_project/tests/custom_test_type_check.sql)
  Parser Error: syntax error at or near ";"
[0m07:38:52.921563 [info ] [MainThread]: 
[0m07:38:52.921720 [error] [MainThread]:   Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:38:52.921854 [info ] [MainThread]: 
[0m07:38:52.921993 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m07:38:52.923683 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.793884, "process_user_time": 1.144926, "process_kernel_time": 0.157492, "process_mem_max_rss": "145948672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:38:52.923960 [debug] [MainThread]: Command `dbt test` failed at 07:38:52.923920 after 0.79 seconds
[0m07:38:52.924144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108534380>]}
[0m07:38:52.924330 [debug] [MainThread]: Flushing usage events
[0m07:39:36.979463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836dd30>]}


============================== 07:39:36.983008 | ed9277c4-a468-4a24-a9fd-a736ae67e67f ==============================
[0m07:39:36.983008 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:39:36.983320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:39:37.168159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed9277c4-a468-4a24-a9fd-a736ae67e67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608d4f0>]}
[0m07:39:37.192216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed9277c4-a468-4a24-a9fd-a736ae67e67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f4a70>]}
[0m07:39:37.194034 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:39:37.204494 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:39:37.281615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:39:37.281980 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/tests/custom_test_type_check.sql
[0m07:39:37.365494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed9277c4-a468-4a24-a9fd-a736ae67e67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087dac90>]}
[0m07:39:37.427704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed9277c4-a468-4a24-a9fd-a736ae67e67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e6ae0>]}
[0m07:39:37.427999 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:39:37.428173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9277c4-a468-4a24-a9fd-a736ae67e67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108532210>]}
[0m07:39:37.429201 [info ] [MainThread]: 
[0m07:39:37.429500 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:39:37.431831 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m07:39:37.460901 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:39:37.461136 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:39:37.461274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:37.471657 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m07:39:37.471873 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:39:37.472023 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:39:37.493113 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m07:39:37.494371 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:39:37.495308 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:39:37.495455 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:39:37.498023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9277c4-a468-4a24-a9fd-a736ae67e67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fdb80>]}
[0m07:39:37.498264 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:37.498386 [debug] [MainThread]: On master: BEGIN
[0m07:39:37.498502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:39:37.501792 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:39:37.501968 [debug] [MainThread]: On master: COMMIT
[0m07:39:37.502101 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:37.502219 [debug] [MainThread]: On master: COMMIT
[0m07:39:37.502390 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:39:37.502516 [debug] [MainThread]: On master: Close
[0m07:39:37.503067 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:39:37.503248 [info ] [MainThread]: 
[0m07:39:37.505035 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check
[0m07:39:37.505275 [info ] [Thread-1 (]: 1 of 6 START test custom_test_type_check ....................................... [RUN]
[0m07:39:37.505501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.custom_test_type_check)
[0m07:39:37.505658 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check
[0m07:39:37.509202 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.custom_test_type_check"
[0m07:39:37.509599 [debug] [Thread-1 (]: Began executing node test.dbt_project.custom_test_type_check
[0m07:39:37.517314 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.custom_test_type_check"
[0m07:39:37.517668 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:39:37.517839 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: BEGIN
[0m07:39:37.517990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:37.521458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:39:37.521660 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:39:37.521827 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.custom_test_type_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check
      
    ) dbt_internal_test
[0m07:39:37.526134 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:39:37.528287 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: ROLLBACK
[0m07:39:37.528801 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.custom_test_type_check'
[0m07:39:37.528969 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: Close
[0m07:39:37.529693 [error] [Thread-1 (]: 1 of 6 FAIL 1 custom_test_type_check ........................................... [[31mFAIL 1[0m in 0.02s]
[0m07:39:37.530017 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check
[0m07:39:37.530225 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:39:37.530397 [info ] [Thread-1 (]: 2 of 6 START test custom_test_type_check_src_listen_listen_timestamp ........... [RUN]
[0m07:39:37.530632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check, now test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170)
[0m07:39:37.530790 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:39:37.538451 [debug] [Thread-1 (]: Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:39:37.538699 [error] [Thread-1 (]: 2 of 6 ERROR custom_test_type_check_src_listen_listen_timestamp ................ [[31mERROR[0m in 0.01s]
[0m07:39:37.538936 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:39:37.539115 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:39:37.539598 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m07:39:37.539800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m07:39:37.539959 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:39:37.543331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:39:37.543715 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:39:37.545851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:39:37.546372 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:39:37.546539 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m07:39:37.546687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:37.550075 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:39:37.550272 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:39:37.550439 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m07:39:37.551045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:39:37.551881 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m07:39:37.552366 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m07:39:37.552543 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m07:39:37.553230 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.01s]
[0m07:39:37.553575 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:39:37.553775 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:39:37.553986 [info ] [Thread-1 (]: 4 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m07:39:37.554189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m07:39:37.554344 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:39:37.556360 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:39:37.556909 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:39:37.557983 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:39:37.558298 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:39:37.558452 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m07:39:37.558595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:37.562041 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:39:37.562246 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:39:37.562420 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m07:39:37.562989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:39:37.563810 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m07:39:37.564332 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m07:39:37.564496 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m07:39:37.565336 [info ] [Thread-1 (]: 4 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m07:39:37.565645 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:39:37.565868 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:39:37.566071 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m07:39:37.566273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m07:39:37.566436 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:39:37.569457 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:39:37.569824 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:39:37.570825 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:39:37.571127 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:39:37.571292 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m07:39:37.571440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:37.575103 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:39:37.575306 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:39:37.575475 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:39:37.577115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:37.577873 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m07:39:37.578334 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m07:39:37.578483 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m07:39:37.579190 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m07:39:37.579460 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:39:37.579649 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:39:37.579835 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m07:39:37.580018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m07:39:37.580173 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:39:37.582207 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:39:37.582561 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:39:37.583590 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:39:37.584052 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:39:37.584278 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m07:39:37.584462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:37.587999 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:39:37.588212 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:39:37.588388 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:39:37.589094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:39:37.590177 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m07:39:37.590735 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m07:39:37.590894 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m07:39:37.591610 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m07:39:37.591916 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:39:37.592460 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:37.592604 [debug] [MainThread]: On master: BEGIN
[0m07:39:37.592722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:39:37.596014 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:39:37.596184 [debug] [MainThread]: On master: COMMIT
[0m07:39:37.596316 [debug] [MainThread]: Using duckdb connection "master"
[0m07:39:37.596436 [debug] [MainThread]: On master: COMMIT
[0m07:39:37.596588 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:39:37.596717 [debug] [MainThread]: On master: Close
[0m07:39:37.597224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:37.597346 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m07:39:37.597492 [info ] [MainThread]: 
[0m07:39:37.597631 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m07:39:37.598188 [debug] [MainThread]: Command end result
[0m07:39:37.613248 [info ] [MainThread]: 
[0m07:39:37.613494 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:39:37.613638 [info ] [MainThread]: 
[0m07:39:37.613820 [error] [MainThread]: [31mFailure in test custom_test_type_check (dbt_project/tests/custom_test_type_check.sql)[0m
[0m07:39:37.613982 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m07:39:37.614103 [info ] [MainThread]: 
[0m07:39:37.614254 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/dbt_project/tests/custom_test_type_check.sql
[0m07:39:37.614380 [info ] [MainThread]: 
[0m07:39:37.614537 [error] [MainThread]:   Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:39:37.614668 [info ] [MainThread]: 
[0m07:39:37.614806 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m07:39:37.616651 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.67496806, "process_user_time": 1.041244, "process_kernel_time": 0.15808, "process_mem_max_rss": "142524416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:39:37.616927 [debug] [MainThread]: Command `dbt test` failed at 07:39:37.616885 after 0.68 seconds
[0m07:39:37.617116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836dfd0>]}
[0m07:39:37.617276 [debug] [MainThread]: Flushing usage events
[0m07:40:31.242041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642dee0>]}


============================== 07:40:31.244954 | 4b2dc630-6f88-4dcf-ac92-0866f21528e1 ==============================
[0m07:40:31.244954 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:40:31.245269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select src_listen', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:40:31.422535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b2dc630-6f88-4dcf-ac92-0866f21528e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0fad0>]}
[0m07:40:31.445424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b2dc630-6f88-4dcf-ac92-0866f21528e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fc7d0>]}
[0m07:40:31.447995 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:40:31.458476 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:40:31.536365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:40:31.536615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:40:31.558826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b2dc630-6f88-4dcf-ac92-0866f21528e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642e0c0>]}
[0m07:40:31.612295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b2dc630-6f88-4dcf-ac92-0866f21528e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067418b0>]}
[0m07:40:31.612581 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:40:31.612753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b2dc630-6f88-4dcf-ac92-0866f21528e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cf4a0>]}
[0m07:40:31.613547 [info ] [MainThread]: 
[0m07:40:31.613822 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:40:31.614246 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data'
[0m07:40:31.643258 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data"
[0m07:40:31.643504 [debug] [ThreadPool]: On list_moovai_data: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovai_data"'
    
  
  
[0m07:40:31.643648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:40:31.660211 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m07:40:31.661423 [debug] [ThreadPool]: On list_moovai_data: Close
[0m07:40:31.663004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovai_data, now create_moovai_data_main)
[0m07:40:31.663219 [debug] [ThreadPool]: Creating schema "database: "moovai_data"
schema: "main"
"
[0m07:40:31.667074 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m07:40:31.667248 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
        select type from duckdb_databases()
        where database_name='moovai_data'
        and type='sqlite'
    
  
[0m07:40:31.667380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:40:31.670995 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:40:31.671870 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m07:40:31.672021 [debug] [ThreadPool]: On create_moovai_data_main: BEGIN
[0m07:40:31.672232 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:40:31.672360 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m07:40:31.672483 [debug] [ThreadPool]: On create_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovai_data_main"} */

    
    
        create schema if not exists "moovai_data"."main"
    
[0m07:40:31.673198 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:40:31.673608 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m07:40:31.673742 [debug] [ThreadPool]: Using duckdb connection "create_moovai_data_main"
[0m07:40:31.673854 [debug] [ThreadPool]: On create_moovai_data_main: COMMIT
[0m07:40:31.674005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:40:31.674129 [debug] [ThreadPool]: On create_moovai_data_main: Close
[0m07:40:31.676919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovai_data_main, now list_moovai_data_main)
[0m07:40:31.679565 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:40:31.679722 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:40:31.679843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:40:31.682886 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m07:40:31.683051 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:40:31.683198 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:40:31.696362 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m07:40:31.697125 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:40:31.698113 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:40:31.698279 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:40:31.700030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b2dc630-6f88-4dcf-ac92-0866f21528e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068636b0>]}
[0m07:40:31.700253 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:31.700382 [debug] [MainThread]: On master: BEGIN
[0m07:40:31.700497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:40:31.703577 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:40:31.703744 [debug] [MainThread]: On master: COMMIT
[0m07:40:31.703875 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:31.703991 [debug] [MainThread]: On master: COMMIT
[0m07:40:31.704142 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:40:31.704271 [debug] [MainThread]: On master: Close
[0m07:40:31.704791 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:40:31.704942 [info ] [MainThread]: 
[0m07:40:31.706107 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m07:40:31.706357 [info ] [Thread-1 (]: 1 of 1 START sql view model main.src_listen .................................... [RUN]
[0m07:40:31.706555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now model.dbt_project.src_listen)
[0m07:40:31.706716 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m07:40:31.710165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m07:40:31.710554 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m07:40:31.725501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m07:40:31.726018 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m07:40:31.726184 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m07:40:31.726331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:40:31.729738 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:40:31.729936 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m07:40:31.730096 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovai_data"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m07:40:31.732401 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:40:31.735578 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m07:40:31.735765 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m07:40:31.736469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:40:31.737847 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m07:40:31.738012 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovai_data"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m07:40:31.738246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:40:31.746072 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m07:40:31.746256 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m07:40:31.746412 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m07:40:31.747274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:40:31.749630 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m07:40:31.749817 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovai_data"."main"."src_listen__dbt_backup" cascade
[0m07:40:31.750119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:40:31.751194 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m07:40:31.755794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b2dc630-6f88-4dcf-ac92-0866f21528e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0eba0>]}
[0m07:40:31.756103 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m07:40:31.756378 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m07:40:31.756926 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:31.757069 [debug] [MainThread]: On master: BEGIN
[0m07:40:31.757188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:40:31.760643 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:40:31.760827 [debug] [MainThread]: On master: COMMIT
[0m07:40:31.760955 [debug] [MainThread]: Using duckdb connection "master"
[0m07:40:31.761068 [debug] [MainThread]: On master: COMMIT
[0m07:40:31.761220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:40:31.761345 [debug] [MainThread]: On master: Close
[0m07:40:31.761837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:40:31.761960 [debug] [MainThread]: Connection 'model.dbt_project.src_listen' was properly closed.
[0m07:40:31.762124 [info ] [MainThread]: 
[0m07:40:31.762267 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m07:40:31.762555 [debug] [MainThread]: Command end result
[0m07:40:31.776723 [info ] [MainThread]: 
[0m07:40:31.776989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:40:31.777142 [info ] [MainThread]: 
[0m07:40:31.777298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:40:31.778923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.57318515, "process_user_time": 0.953556, "process_kernel_time": 0.147548, "process_mem_max_rss": "135348224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:40:31.779213 [debug] [MainThread]: Command `dbt run` succeeded at 07:40:31.779165 after 0.57 seconds
[0m07:40:31.779399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106832bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105738ce0>]}
[0m07:40:31.779564 [debug] [MainThread]: Flushing usage events
[0m07:41:28.976302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106139160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106399ca0>]}


============================== 07:41:28.979390 | 40776005-9557-4e98-ad19-3efed1e62d16 ==============================
[0m07:41:28.979390 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:41:28.979701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:41:29.171691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40776005-9557-4e98-ad19-3efed1e62d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646b5c0>]}
[0m07:41:29.194657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40776005-9557-4e98-ad19-3efed1e62d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641c290>]}
[0m07:41:29.196736 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:41:29.206405 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:41:29.281699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:41:29.282059 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/tests/custom_test_type_check.sql
[0m07:41:29.365377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40776005-9557-4e98-ad19-3efed1e62d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104188650>]}
[0m07:41:29.426760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40776005-9557-4e98-ad19-3efed1e62d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a56660>]}
[0m07:41:29.427064 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:41:29.427236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40776005-9557-4e98-ad19-3efed1e62d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106728470>]}
[0m07:41:29.428227 [info ] [MainThread]: 
[0m07:41:29.428517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:41:29.430784 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m07:41:29.460307 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:41:29.460545 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:41:29.460692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:29.470810 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m07:41:29.471024 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:41:29.471174 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:41:29.492253 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m07:41:29.493529 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:41:29.494489 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:41:29.494636 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:41:29.497199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40776005-9557-4e98-ad19-3efed1e62d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ad040>]}
[0m07:41:29.497449 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:29.497577 [debug] [MainThread]: On master: BEGIN
[0m07:41:29.497695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:41:29.500887 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:41:29.501062 [debug] [MainThread]: On master: COMMIT
[0m07:41:29.501198 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:29.501315 [debug] [MainThread]: On master: COMMIT
[0m07:41:29.501470 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:41:29.501604 [debug] [MainThread]: On master: Close
[0m07:41:29.502140 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:41:29.502310 [info ] [MainThread]: 
[0m07:41:29.503737 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check
[0m07:41:29.503934 [info ] [Thread-1 (]: 1 of 6 START test custom_test_type_check ....................................... [RUN]
[0m07:41:29.504132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.custom_test_type_check)
[0m07:41:29.504289 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check
[0m07:41:29.507776 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.custom_test_type_check"
[0m07:41:29.508443 [debug] [Thread-1 (]: Began executing node test.dbt_project.custom_test_type_check
[0m07:41:29.516042 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.custom_test_type_check"
[0m07:41:29.516389 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:41:29.516555 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: BEGIN
[0m07:41:29.516699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:29.519875 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:29.520065 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:41:29.520240 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.custom_test_type_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE
        -- Vérifie que la colonne n'est pas convertible ni en DATE ni en TIMESTAMP
        (CAST(listen_timestamp AS DATE) IS NULL)
        AND (CAST(listen_timestamp AS TIMESTAMP) IS NULL)
)

SELECT COUNT(*) = 0
FROM type_check;
      
    ) dbt_internal_test
[0m07:41:29.523657 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.custom_test_type_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE
        -- Vérifie que la colonne n'est pas convertible ni en DATE ni en TIMESTAMP
        (CAST(listen_timestamp AS DATE) IS NULL)
        AND (CAST(listen_timestamp AS TIMESTAMP) IS NULL)
)

SELECT COUNT(*) = 0
FROM type_check;
      
    ) dbt_internal_test
[0m07:41:29.523872 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m07:41:29.524141 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: ROLLBACK
[0m07:41:29.529527 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.custom_test_type_check'
[0m07:41:29.529688 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: Close
[0m07:41:29.531495 [debug] [Thread-1 (]: Runtime Error in test custom_test_type_check (dbt_project/tests/custom_test_type_check.sql)
  Parser Error: syntax error at or near ";"
[0m07:41:29.531749 [error] [Thread-1 (]: 1 of 6 ERROR custom_test_type_check ............................................ [[31mERROR[0m in 0.03s]
[0m07:41:29.532030 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check
[0m07:41:29.532240 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:41:29.532759 [info ] [Thread-1 (]: 2 of 6 START test custom_test_type_check_src_listen_listen_timestamp ........... [RUN]
[0m07:41:29.532972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check, now test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170)
[0m07:41:29.533135 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:41:29.539093 [debug] [Thread-1 (]: Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:41:29.539337 [error] [Thread-1 (]: 2 of 6 ERROR custom_test_type_check_src_listen_listen_timestamp ................ [[31mERROR[0m in 0.01s]
[0m07:41:29.539573 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:41:29.539753 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:29.539937 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m07:41:29.540114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m07:41:29.540296 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:29.543340 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:29.543811 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:29.545635 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:29.546178 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:29.546406 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m07:41:29.546579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:29.550194 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:41:29.550419 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:29.550590 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m07:41:29.552944 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:41:29.554955 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m07:41:29.555429 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m07:41:29.555589 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m07:41:29.556302 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.02s]
[0m07:41:29.556558 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:29.556738 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:29.556920 [info ] [Thread-1 (]: 4 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m07:41:29.557101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m07:41:29.557265 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:29.559503 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:29.560191 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:29.561155 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:29.561450 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:29.561603 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m07:41:29.561744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:29.565113 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:29.565290 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:29.565452 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m07:41:29.566060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:41:29.566867 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m07:41:29.567333 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m07:41:29.567481 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m07:41:29.568157 [info ] [Thread-1 (]: 4 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m07:41:29.568465 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:29.568664 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:29.568862 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m07:41:29.569063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m07:41:29.569219 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:29.572361 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:29.572859 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:29.573963 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:29.574375 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:29.574542 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m07:41:29.574689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:29.577995 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:29.578190 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:29.578359 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:41:29.579983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:41:29.580754 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m07:41:29.581223 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m07:41:29.581377 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m07:41:29.582006 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m07:41:29.582289 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:29.582481 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:29.582698 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m07:41:29.582912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m07:41:29.583110 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:29.585037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:29.585382 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:29.586357 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:29.586772 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:29.586926 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m07:41:29.587066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:29.590251 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:29.590443 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:29.590615 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:41:29.591268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:41:29.592002 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m07:41:29.592464 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m07:41:29.592615 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m07:41:29.593283 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m07:41:29.593554 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:29.594104 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:29.594285 [debug] [MainThread]: On master: BEGIN
[0m07:41:29.594417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:41:29.597814 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:41:29.598049 [debug] [MainThread]: On master: COMMIT
[0m07:41:29.598185 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:29.598313 [debug] [MainThread]: On master: COMMIT
[0m07:41:29.598469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:41:29.598599 [debug] [MainThread]: On master: Close
[0m07:41:29.599160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:41:29.599294 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m07:41:29.599443 [info ] [MainThread]: 
[0m07:41:29.599594 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m07:41:29.600125 [debug] [MainThread]: Command end result
[0m07:41:29.614221 [info ] [MainThread]: 
[0m07:41:29.614444 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:41:29.614587 [info ] [MainThread]: 
[0m07:41:29.614756 [error] [MainThread]:   Runtime Error in test custom_test_type_check (dbt_project/tests/custom_test_type_check.sql)
  Parser Error: syntax error at or near ";"
[0m07:41:29.614883 [info ] [MainThread]: 
[0m07:41:29.615044 [error] [MainThread]:   Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:41:29.615186 [info ] [MainThread]: 
[0m07:41:29.615327 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m07:41:29.616700 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.67767924, "process_user_time": 1.035748, "process_kernel_time": 0.147432, "process_mem_max_rss": "139886592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:41:29.616980 [debug] [MainThread]: Command `dbt test` failed at 07:41:29.616936 after 0.68 seconds
[0m07:41:29.617183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106399df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de3c80>]}
[0m07:41:29.617352 [debug] [MainThread]: Flushing usage events
[0m07:41:38.470841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105149ee0>]}


============================== 07:41:38.474230 | ad1e251c-0ae4-4468-a37b-a746092b3dc2 ==============================
[0m07:41:38.474230 [info ] [MainThread]: Running with dbt=1.8.6
[0m07:41:38.474585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline_test/src/02_modeling/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:41:38.588817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad1e251c-0ae4-4468-a37b-a746092b3dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bde80>]}
[0m07:41:38.612149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad1e251c-0ae4-4468-a37b-a746092b3dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a7470>]}
[0m07:41:38.614776 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m07:41:38.623145 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m07:41:38.694714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:41:38.695084 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/tests/custom_test_type_check.sql
[0m07:41:38.776805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1e251c-0ae4-4468-a37b-a746092b3dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a69c0>]}
[0m07:41:38.835833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1e251c-0ae4-4468-a37b-a746092b3dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab18e0>]}
[0m07:41:38.836127 [info ] [MainThread]: Found 8 models, 6 data tests, 3 sources, 416 macros
[0m07:41:38.836304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1e251c-0ae4-4468-a37b-a746092b3dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105788830>]}
[0m07:41:38.837314 [info ] [MainThread]: 
[0m07:41:38.837601 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:41:38.839978 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovai_data_main'
[0m07:41:38.864538 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:41:38.864763 [debug] [ThreadPool]: On list_moovai_data_main: BEGIN
[0m07:41:38.864904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:38.869145 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:41:38.869367 [debug] [ThreadPool]: Using duckdb connection "list_moovai_data_main"
[0m07:41:38.869530 [debug] [ThreadPool]: On list_moovai_data_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovai_data_main"} */
select
      'moovai_data' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovai_data'
  
[0m07:41:38.880206 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m07:41:38.881057 [debug] [ThreadPool]: On list_moovai_data_main: ROLLBACK
[0m07:41:38.882099 [debug] [ThreadPool]: Failed to rollback 'list_moovai_data_main'
[0m07:41:38.882280 [debug] [ThreadPool]: On list_moovai_data_main: Close
[0m07:41:38.884171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1e251c-0ae4-4468-a37b-a746092b3dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580c2c0>]}
[0m07:41:38.884383 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:38.884507 [debug] [MainThread]: On master: BEGIN
[0m07:41:38.884621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:41:38.887896 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:41:38.888071 [debug] [MainThread]: On master: COMMIT
[0m07:41:38.888205 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:38.888325 [debug] [MainThread]: On master: COMMIT
[0m07:41:38.888483 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:41:38.888617 [debug] [MainThread]: On master: Close
[0m07:41:38.889132 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m07:41:38.889277 [info ] [MainThread]: 
[0m07:41:38.890939 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check
[0m07:41:38.891158 [info ] [Thread-1 (]: 1 of 6 START test custom_test_type_check ....................................... [RUN]
[0m07:41:38.891446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovai_data_main, now test.dbt_project.custom_test_type_check)
[0m07:41:38.891641 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check
[0m07:41:38.895206 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.custom_test_type_check"
[0m07:41:38.895554 [debug] [Thread-1 (]: Began executing node test.dbt_project.custom_test_type_check
[0m07:41:38.903332 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.custom_test_type_check"
[0m07:41:38.903732 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:41:38.903897 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: BEGIN
[0m07:41:38.904043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:38.907865 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:41:38.908177 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.custom_test_type_check"
[0m07:41:38.908351 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.custom_test_type_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      WITH type_check AS (
    SELECT
        listen_timestamp
    FROM "moovai_data"."main"."src_listen"
    WHERE CAST(listen_timestamp AS DATE) IS NULL
)

SELECT COUNT(*)
FROM type_check
      
    ) dbt_internal_test
[0m07:41:38.909125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:41:38.911202 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: ROLLBACK
[0m07:41:38.911688 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.custom_test_type_check'
[0m07:41:38.911847 [debug] [Thread-1 (]: On test.dbt_project.custom_test_type_check: Close
[0m07:41:38.912584 [error] [Thread-1 (]: 1 of 6 FAIL 1 custom_test_type_check ........................................... [[31mFAIL 1[0m in 0.02s]
[0m07:41:38.912870 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check
[0m07:41:38.913071 [debug] [Thread-1 (]: Began running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:41:38.913281 [info ] [Thread-1 (]: 2 of 6 START test custom_test_type_check_src_listen_listen_timestamp ........... [RUN]
[0m07:41:38.913463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check, now test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170)
[0m07:41:38.913614 [debug] [Thread-1 (]: Began compiling node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:41:38.920832 [debug] [Thread-1 (]: Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:41:38.921092 [error] [Thread-1 (]: 2 of 6 ERROR custom_test_type_check_src_listen_listen_timestamp ................ [[31mERROR[0m in 0.01s]
[0m07:41:38.921330 [debug] [Thread-1 (]: Finished running node test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170
[0m07:41:38.921510 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:38.921993 [info ] [Thread-1 (]: 3 of 6 START test not_null_src_listen_track_id ................................. [RUN]
[0m07:41:38.922207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.custom_test_type_check_src_listen_listen_timestamp.c3ab016170, now test.dbt_project.not_null_src_listen_track_id.c736c9f6a2)
[0m07:41:38.922372 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:38.925763 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:38.926189 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:38.928138 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:38.928479 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:38.928640 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: BEGIN
[0m07:41:38.928782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:38.932170 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:38.932363 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"
[0m07:41:38.932529 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_track_id.c736c9f6a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select track_id
from "moovai_data"."main"."src_listen"
where track_id is null



      
    ) dbt_internal_test
[0m07:41:38.933219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:41:38.934051 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: ROLLBACK
[0m07:41:38.934529 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_track_id.c736c9f6a2'
[0m07:41:38.934685 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_track_id.c736c9f6a2: Close
[0m07:41:38.935356 [info ] [Thread-1 (]: 3 of 6 PASS not_null_src_listen_track_id ....................................... [[32mPASS[0m in 0.01s]
[0m07:41:38.935618 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_track_id.c736c9f6a2
[0m07:41:38.935802 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:38.936007 [info ] [Thread-1 (]: 4 of 6 START test not_null_src_listen_user_id .................................. [RUN]
[0m07:41:38.936215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_track_id.c736c9f6a2, now test.dbt_project.not_null_src_listen_user_id.a469a54135)
[0m07:41:38.936375 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:38.938283 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:38.938663 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:38.939656 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:38.939947 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:38.940098 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: BEGIN
[0m07:41:38.940238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:38.943668 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:38.943865 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.not_null_src_listen_user_id.a469a54135"
[0m07:41:38.944034 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.not_null_src_listen_user_id.a469a54135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "moovai_data"."main"."src_listen"
where user_id is null



      
    ) dbt_internal_test
[0m07:41:38.944609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:41:38.945441 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: ROLLBACK
[0m07:41:38.945967 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.not_null_src_listen_user_id.a469a54135'
[0m07:41:38.946143 [debug] [Thread-1 (]: On test.dbt_project.not_null_src_listen_user_id.a469a54135: Close
[0m07:41:38.947003 [info ] [Thread-1 (]: 4 of 6 PASS not_null_src_listen_user_id ........................................ [[32mPASS[0m in 0.01s]
[0m07:41:38.947293 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_src_listen_user_id.a469a54135
[0m07:41:38.947482 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:38.947665 [info ] [Thread-1 (]: 5 of 6 START test unique_src_listen_track_id ................................... [RUN]
[0m07:41:38.947851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_src_listen_user_id.a469a54135, now test.dbt_project.unique_src_listen_track_id.55e844a78b)
[0m07:41:38.948035 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:38.951151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:38.951497 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:38.952494 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:38.952786 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:38.952940 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: BEGIN
[0m07:41:38.953079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:38.956441 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:38.956632 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_track_id.55e844a78b"
[0m07:41:38.956806 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_track_id.55e844a78b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    track_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where track_id is not null
group by track_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:41:38.957594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:41:38.958498 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: ROLLBACK
[0m07:41:38.958974 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_track_id.55e844a78b'
[0m07:41:38.959117 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_track_id.55e844a78b: Close
[0m07:41:38.959816 [info ] [Thread-1 (]: 5 of 6 PASS unique_src_listen_track_id ......................................... [[32mPASS[0m in 0.01s]
[0m07:41:38.960104 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_track_id.55e844a78b
[0m07:41:38.960295 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:38.960478 [info ] [Thread-1 (]: 6 of 6 START test unique_src_listen_user_id .................................... [RUN]
[0m07:41:38.960661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_src_listen_track_id.55e844a78b, now test.dbt_project.unique_src_listen_user_id.1fb0b373ad)
[0m07:41:38.960813 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:38.962738 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:38.963094 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:38.964064 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:38.964337 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:38.964492 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: BEGIN
[0m07:41:38.964641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:38.968170 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m07:41:38.968407 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"
[0m07:41:38.968574 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "test.dbt_project.unique_src_listen_user_id.1fb0b373ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "moovai_data"."main"."src_listen"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:41:38.969293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:41:38.970053 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: ROLLBACK
[0m07:41:38.970529 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad'
[0m07:41:38.970677 [debug] [Thread-1 (]: On test.dbt_project.unique_src_listen_user_id.1fb0b373ad: Close
[0m07:41:38.971354 [info ] [Thread-1 (]: 6 of 6 PASS unique_src_listen_user_id .......................................... [[32mPASS[0m in 0.01s]
[0m07:41:38.971635 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_src_listen_user_id.1fb0b373ad
[0m07:41:38.972189 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:38.972338 [debug] [MainThread]: On master: BEGIN
[0m07:41:38.972456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:41:38.975824 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m07:41:38.976018 [debug] [MainThread]: On master: COMMIT
[0m07:41:38.976150 [debug] [MainThread]: Using duckdb connection "master"
[0m07:41:38.976264 [debug] [MainThread]: On master: COMMIT
[0m07:41:38.976415 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:41:38.976540 [debug] [MainThread]: On master: Close
[0m07:41:38.977074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:41:38.977221 [debug] [MainThread]: Connection 'test.dbt_project.unique_src_listen_user_id.1fb0b373ad' was properly closed.
[0m07:41:38.977378 [info ] [MainThread]: 
[0m07:41:38.977526 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m07:41:38.978064 [debug] [MainThread]: Command end result
[0m07:41:38.993462 [info ] [MainThread]: 
[0m07:41:38.993720 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:41:38.993868 [info ] [MainThread]: 
[0m07:41:38.994051 [error] [MainThread]: [31mFailure in test custom_test_type_check (dbt_project/tests/custom_test_type_check.sql)[0m
[0m07:41:38.994207 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m07:41:38.994321 [info ] [MainThread]: 
[0m07:41:38.994463 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/dbt_project/tests/custom_test_type_check.sql
[0m07:41:38.994581 [info ] [MainThread]: 
[0m07:41:38.994732 [error] [MainThread]:   Compilation Error in test custom_test_type_check_src_listen_listen_timestamp (dbt_project/models/01_source_layer/schema.yml)
  'test_custom_test_type_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:41:38.994860 [info ] [MainThread]: 
[0m07:41:38.994993 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m07:41:38.995941 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.55795723, "process_user_time": 1.032348, "process_kernel_time": 0.125471, "process_mem_max_rss": "141459456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:41:38.996184 [debug] [MainThread]: Command `dbt test` failed at 07:41:38.996145 after 0.56 seconds
[0m07:41:38.996363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d84a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab2630>]}
[0m07:41:38.996516 [debug] [MainThread]: Flushing usage events
[0m08:15:01.589592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122851820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124106d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124106a20>]}


============================== 08:15:01.592407 | 7ecf6633-aa42-4792-a353-db4222580e07 ==============================
[0m08:15:01.592407 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:15:01.592712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline-master/Docker_Airflow/modeling/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:15:02.505060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ecf6633-aa42-4792-a353-db4222580e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b501d0>]}
[0m08:15:02.528305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ecf6633-aa42-4792-a353-db4222580e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067280b0>]}
[0m08:15:02.530260 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:15:02.572041 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:15:02.622759 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:15:02.623080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ecf6633-aa42-4792-a353-db4222580e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124287dd0>]}
[0m08:15:03.166668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ecf6633-aa42-4792-a353-db4222580e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246919a0>]}
[0m08:15:03.215301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ecf6633-aa42-4792-a353-db4222580e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249456d0>]}
[0m08:15:03.215576 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 416 macros
[0m08:15:03.215741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ecf6633-aa42-4792-a353-db4222580e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12453d8e0>]}
[0m08:15:03.216748 [info ] [MainThread]: 
[0m08:15:03.217049 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:15:03.219365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovitamix'
[0m08:15:03.276968 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix"
[0m08:15:03.277197 [debug] [ThreadPool]: On list_moovitamix: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovitamix"'
    
  
  
[0m08:15:03.277338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:03.280755 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovitamix"'
    
  
  
[0m08:15:03.280948 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m08:15:03.281293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:03.281428 [debug] [MainThread]: Connection 'list_moovitamix' was properly closed.
[0m08:15:03.281564 [info ] [MainThread]: 
[0m08:15:03.281717 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m08:15:03.281927 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/brossierlucas/programmation/moovai_pipeline_test/dags/moovitamix.db": No such file or directory
[0m08:15:03.314242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7626758, "process_user_time": 1.519585, "process_kernel_time": 0.191838, "process_mem_max_rss": "127795200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:15:03.314593 [debug] [MainThread]: Command `dbt run` failed at 08:15:03.314540 after 1.76 seconds
[0m08:15:03.314808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122851820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a21460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246de840>]}
[0m08:15:03.315008 [debug] [MainThread]: Flushing usage events
[0m08:15:57.218840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039d7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c69f0>]}


============================== 08:15:57.221565 | b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7 ==============================
[0m08:15:57.221565 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:15:57.221878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline-master/Docker_Airflow/modeling/logs', 'version_check': 'True', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:15:57.404337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033e1910>]}
[0m08:15:57.428752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee3c20>]}
[0m08:15:57.431831 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:15:57.443266 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:15:57.491509 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:15:57.491831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a60ef0>]}
[0m08:15:58.041385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c83e0>]}
[0m08:15:58.089300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d4740>]}
[0m08:15:58.089588 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 416 macros
[0m08:15:58.089761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105255490>]}
[0m08:15:58.090718 [info ] [MainThread]: 
[0m08:15:58.091025 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:15:58.093561 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovitamix'
[0m08:15:58.150292 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix"
[0m08:15:58.150520 [debug] [ThreadPool]: On list_moovitamix: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovitamix"'
    
  
  
[0m08:15:58.150662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:58.165414 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:15:58.166406 [debug] [ThreadPool]: On list_moovitamix: Close
[0m08:15:58.167838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovitamix, now create_moovitamix_main)
[0m08:15:58.168067 [debug] [ThreadPool]: Creating schema "database: "moovitamix"
schema: "main"
"
[0m08:15:58.171350 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:15:58.171521 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
        select type from duckdb_databases()
        where database_name='moovitamix'
        and type='sqlite'
    
  
[0m08:15:58.171651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:15:58.174513 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:15:58.175188 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:15:58.175341 [debug] [ThreadPool]: On create_moovitamix_main: BEGIN
[0m08:15:58.175505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:15:58.175627 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:15:58.175751 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
    
        create schema if not exists "moovitamix"."main"
    
[0m08:15:58.176323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:15:58.176717 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:15:58.176847 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:15:58.176961 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:15:58.177108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:15:58.177238 [debug] [ThreadPool]: On create_moovitamix_main: Close
[0m08:15:58.178239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovitamix_main, now list_moovitamix_main)
[0m08:15:58.180849 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:15:58.181009 [debug] [ThreadPool]: On list_moovitamix_main: BEGIN
[0m08:15:58.181128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:15:58.183687 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:15:58.183848 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:15:58.183996 [debug] [ThreadPool]: On list_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix_main"} */
select
      'moovitamix' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovitamix'
  
[0m08:15:58.196280 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m08:15:58.197002 [debug] [ThreadPool]: On list_moovitamix_main: ROLLBACK
[0m08:15:58.197900 [debug] [ThreadPool]: Failed to rollback 'list_moovitamix_main'
[0m08:15:58.198044 [debug] [ThreadPool]: On list_moovitamix_main: Close
[0m08:15:58.199171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e30080>]}
[0m08:15:58.199432 [debug] [MainThread]: Using duckdb connection "master"
[0m08:15:58.199591 [debug] [MainThread]: On master: BEGIN
[0m08:15:58.199716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:15:58.202450 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:15:58.202627 [debug] [MainThread]: On master: COMMIT
[0m08:15:58.202766 [debug] [MainThread]: Using duckdb connection "master"
[0m08:15:58.202885 [debug] [MainThread]: On master: COMMIT
[0m08:15:58.203050 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:15:58.203180 [debug] [MainThread]: On master: Close
[0m08:15:58.203687 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m08:15:58.203854 [info ] [MainThread]: 
[0m08:15:58.205396 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m08:15:58.205650 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m08:15:58.205850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovitamix_main, now model.dbt_project.src_listen)
[0m08:15:58.206007 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m08:15:58.209412 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m08:15:58.210178 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m08:15:58.225187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m08:15:58.225734 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:15:58.225902 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m08:15:58.226051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:58.229154 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:15:58.229404 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:15:58.229569 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovitamix"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m08:15:58.242273 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovitamix"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m08:15:58.242509 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:15:58.242740 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m08:15:58.247435 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m08:15:58.247614 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m08:15:58.249469 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name listen_history does not exist!
  Did you mean "moovitamix.listen_history"?
  LINE 10:     select * from moovai_data.listen_history
                             ^
[0m08:15:58.250181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d4800>]}
[0m08:15:58.250480 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m08:15:58.250763 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m08:15:58.250957 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m08:15:58.251573 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m08:15:58.251813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m08:15:58.251982 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m08:15:58.254176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m08:15:58.254571 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m08:15:58.256004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m08:15:58.256307 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:15:58.256466 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m08:15:58.256608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:58.259447 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:15:58.259645 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:15:58.259818 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:15:58.268774 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:15:58.268983 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:15:58.269196 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m08:15:58.270707 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m08:15:58.270874 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m08:15:58.272774 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovitamix.tracks"?
  LINE 10:     select * from moovai_data.tracks
                             ^
[0m08:15:58.272991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104596030>]}
[0m08:15:58.273275 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.02s]
[0m08:15:58.273530 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m08:15:58.273711 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m08:15:58.273893 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m08:15:58.274084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m08:15:58.274231 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m08:15:58.275541 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m08:15:58.275936 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m08:15:58.277354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m08:15:58.277659 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:15:58.277804 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m08:15:58.277940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:58.280742 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:15:58.280932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:15:58.281096 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:15:58.290193 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:15:58.290439 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:15:58.290667 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m08:15:58.292165 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m08:15:58.292334 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m08:15:58.294153 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "moovitamix.users"?
  LINE 9:     select * from moovai_data.users
                            ^
[0m08:15:58.294358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7eacdbe-db12-4cee-bff6-e45bc6ccfaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fa930>]}
[0m08:15:58.294638 [error] [Thread-1 (]: 3 of 8 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.02s]
[0m08:15:58.294901 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m08:15:58.295148 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m08:15:58.295361 [info ] [Thread-1 (]: 4 of 8 SKIP relation main.int_fact_listen ...................................... [[33mSKIP[0m]
[0m08:15:58.295717 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m08:15:58.295935 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m08:15:58.296123 [info ] [Thread-1 (]: 5 of 8 SKIP relation main.int_dim_tracks ....................................... [[33mSKIP[0m]
[0m08:15:58.296317 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m08:15:58.296477 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m08:15:58.296630 [info ] [Thread-1 (]: 6 of 8 SKIP relation main.int_dim_users ........................................ [[33mSKIP[0m]
[0m08:15:58.296864 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m08:15:58.297111 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m08:15:58.297276 [info ] [Thread-1 (]: 7 of 8 SKIP relation main.mart_listen_and_tracks ............................... [[33mSKIP[0m]
[0m08:15:58.297453 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m08:15:58.297618 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m08:15:58.297772 [info ] [Thread-1 (]: 8 of 8 SKIP relation main.mart_listen_and_users ................................ [[33mSKIP[0m]
[0m08:15:58.297965 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m08:15:58.298518 [debug] [MainThread]: Using duckdb connection "master"
[0m08:15:58.298655 [debug] [MainThread]: On master: BEGIN
[0m08:15:58.298771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:15:58.301550 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:15:58.301712 [debug] [MainThread]: On master: COMMIT
[0m08:15:58.301838 [debug] [MainThread]: Using duckdb connection "master"
[0m08:15:58.301952 [debug] [MainThread]: On master: COMMIT
[0m08:15:58.302106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:15:58.302228 [debug] [MainThread]: On master: Close
[0m08:15:58.302727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:58.302854 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m08:15:58.303023 [info ] [MainThread]: 
[0m08:15:58.303164 [info ] [MainThread]: Finished running 3 view models, 3 incremental models, 2 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m08:15:58.303641 [debug] [MainThread]: Command end result
[0m08:15:58.317000 [info ] [MainThread]: 
[0m08:15:58.317234 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m08:15:58.317376 [info ] [MainThread]: 
[0m08:15:58.317547 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name listen_history does not exist!
  Did you mean "moovitamix.listen_history"?
  LINE 10:     select * from moovai_data.listen_history
                             ^
[0m08:15:58.317681 [info ] [MainThread]: 
[0m08:15:58.317833 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovitamix.tracks"?
  LINE 10:     select * from moovai_data.tracks
                             ^
[0m08:15:58.317960 [info ] [MainThread]: 
[0m08:15:58.318115 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "moovitamix.users"?
  LINE 9:     select * from moovai_data.users
                            ^
[0m08:15:58.318247 [info ] [MainThread]: 
[0m08:15:58.318383 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m08:15:58.319930 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1341279, "process_user_time": 1.505312, "process_kernel_time": 0.167508, "process_mem_max_rss": "137723904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:15:58.320173 [debug] [MainThread]: Command `dbt run` failed at 08:15:58.320129 after 1.13 seconds
[0m08:15:58.320359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476ca70>]}
[0m08:15:58.320529 [debug] [MainThread]: Flushing usage events
[0m08:18:03.935289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ef8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa2a80>]}


============================== 08:18:03.938027 | 93ebda95-13fb-4398-aa6f-29ac39b7034e ==============================
[0m08:18:03.938027 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:18:03.938347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline-master/Docker_Airflow/modeling/logs', 'debug': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:18:04.123961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040729f0>]}
[0m08:18:04.147445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa0080>]}
[0m08:18:04.149181 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:18:04.159545 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:18:04.224649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:18:04.225039 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/sources.yml
[0m08:18:04.304363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ae120>]}
[0m08:18:04.353402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439ac60>]}
[0m08:18:04.353689 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 416 macros
[0m08:18:04.353865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a05f0>]}
[0m08:18:04.354839 [info ] [MainThread]: 
[0m08:18:04.355151 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:18:04.357476 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovitamix'
[0m08:18:04.386380 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix"
[0m08:18:04.386614 [debug] [ThreadPool]: On list_moovitamix: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovitamix"'
    
  
  
[0m08:18:04.386759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:04.401947 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:18:04.403243 [debug] [ThreadPool]: On list_moovitamix: Close
[0m08:18:04.404708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovitamix, now create_moovitamix_main)
[0m08:18:04.404919 [debug] [ThreadPool]: Creating schema "database: "moovitamix"
schema: "main"
"
[0m08:18:04.408178 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:04.408343 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
        select type from duckdb_databases()
        where database_name='moovitamix'
        and type='sqlite'
    
  
[0m08:18:04.408484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:04.412161 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:18:04.413192 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:04.413347 [debug] [ThreadPool]: On create_moovitamix_main: BEGIN
[0m08:18:04.413521 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:18:04.413653 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:04.413782 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
    
        create schema if not exists "moovitamix"."main"
    
[0m08:18:04.414814 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:18:04.415285 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:18:04.415432 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:04.415560 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:18:04.415725 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:18:04.415868 [debug] [ThreadPool]: On create_moovitamix_main: Close
[0m08:18:04.418864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovitamix_main, now list_moovitamix_main)
[0m08:18:04.421515 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:18:04.421664 [debug] [ThreadPool]: On list_moovitamix_main: BEGIN
[0m08:18:04.421783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:04.424678 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:18:04.424854 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:18:04.425003 [debug] [ThreadPool]: On list_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix_main"} */
select
      'moovitamix' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovitamix'
  
[0m08:18:04.440229 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:18:04.441000 [debug] [ThreadPool]: On list_moovitamix_main: ROLLBACK
[0m08:18:04.441936 [debug] [ThreadPool]: Failed to rollback 'list_moovitamix_main'
[0m08:18:04.442077 [debug] [ThreadPool]: On list_moovitamix_main: Close
[0m08:18:04.443150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bb020>]}
[0m08:18:04.443379 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:04.443510 [debug] [MainThread]: On master: BEGIN
[0m08:18:04.443637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:18:04.446263 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:18:04.446434 [debug] [MainThread]: On master: COMMIT
[0m08:18:04.446568 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:04.446682 [debug] [MainThread]: On master: COMMIT
[0m08:18:04.446835 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:18:04.446967 [debug] [MainThread]: On master: Close
[0m08:18:04.447490 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m08:18:04.447693 [info ] [MainThread]: 
[0m08:18:04.449132 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m08:18:04.449400 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m08:18:04.449622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovitamix_main, now model.dbt_project.src_listen)
[0m08:18:04.449788 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m08:18:04.453334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m08:18:04.453721 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m08:18:04.468642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m08:18:04.469100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:04.469286 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m08:18:04.469439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:04.472506 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:04.472715 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:04.472890 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovitamix"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m08:18:04.485946 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovitamix"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovai_data.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m08:18:04.486148 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:18:04.486384 [debug] [Thread-1 (]: On model.dbt_project.src_listen: ROLLBACK
[0m08:18:04.491315 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_listen'
[0m08:18:04.491494 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m08:18:04.493358 [debug] [Thread-1 (]: Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name listen_history does not exist!
  Did you mean "moovitamix.listen_history"?
  LINE 10:     select * from moovai_data.listen_history
                             ^
[0m08:18:04.494194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10353e1e0>]}
[0m08:18:04.494618 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.src_listen ........................... [[31mERROR[0m in 0.04s]
[0m08:18:04.494933 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m08:18:04.495136 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m08:18:04.495755 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m08:18:04.495988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m08:18:04.496155 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m08:18:04.497542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m08:18:04.497869 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m08:18:04.499335 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m08:18:04.499633 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:04.499790 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m08:18:04.499929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:04.502799 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:04.502984 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:04.503143 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:18:04.511920 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:18:04.512107 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:18:04.512307 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m08:18:04.513797 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m08:18:04.513955 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m08:18:04.515714 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovitamix.tracks"?
  LINE 10:     select * from moovai_data.tracks
                             ^
[0m08:18:04.515936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494ba70>]}
[0m08:18:04.516208 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.02s]
[0m08:18:04.516463 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m08:18:04.516645 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m08:18:04.516835 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m08:18:04.517085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m08:18:04.517254 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m08:18:04.518456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m08:18:04.518923 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m08:18:04.521471 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m08:18:04.522052 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:04.522215 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m08:18:04.522352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:04.525174 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:04.525364 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:04.525528 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:18:04.534362 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:18:04.534550 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:18:04.534763 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m08:18:04.536256 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m08:18:04.536421 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m08:18:04.538295 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "moovitamix.users"?
  LINE 9:     select * from moovai_data.users
                            ^
[0m08:18:04.538492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ebda95-13fb-4398-aa6f-29ac39b7034e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104948b00>]}
[0m08:18:04.538769 [error] [Thread-1 (]: 3 of 8 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.02s]
[0m08:18:04.539027 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m08:18:04.539206 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m08:18:04.539369 [info ] [Thread-1 (]: 4 of 8 SKIP relation main.int_fact_listen ...................................... [[33mSKIP[0m]
[0m08:18:04.539628 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m08:18:04.539799 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m08:18:04.539955 [info ] [Thread-1 (]: 5 of 8 SKIP relation main.int_dim_tracks ....................................... [[33mSKIP[0m]
[0m08:18:04.540158 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m08:18:04.540398 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m08:18:04.540564 [info ] [Thread-1 (]: 6 of 8 SKIP relation main.int_dim_users ........................................ [[33mSKIP[0m]
[0m08:18:04.540749 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m08:18:04.540915 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m08:18:04.541068 [info ] [Thread-1 (]: 7 of 8 SKIP relation main.mart_listen_and_tracks ............................... [[33mSKIP[0m]
[0m08:18:04.541296 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m08:18:04.541486 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m08:18:04.541644 [info ] [Thread-1 (]: 8 of 8 SKIP relation main.mart_listen_and_users ................................ [[33mSKIP[0m]
[0m08:18:04.541815 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m08:18:04.542346 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:04.542480 [debug] [MainThread]: On master: BEGIN
[0m08:18:04.542597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:18:04.545502 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:18:04.545762 [debug] [MainThread]: On master: COMMIT
[0m08:18:04.545900 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:04.546046 [debug] [MainThread]: On master: COMMIT
[0m08:18:04.546217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:18:04.546340 [debug] [MainThread]: On master: Close
[0m08:18:04.546934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:18:04.547100 [debug] [MainThread]: Connection 'model.dbt_project.src_users' was properly closed.
[0m08:18:04.547295 [info ] [MainThread]: 
[0m08:18:04.547451 [info ] [MainThread]: Finished running 3 view models, 3 incremental models, 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m08:18:04.547940 [debug] [MainThread]: Command end result
[0m08:18:04.560582 [info ] [MainThread]: 
[0m08:18:04.560902 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m08:18:04.561058 [info ] [MainThread]: 
[0m08:18:04.561266 [error] [MainThread]:   Runtime Error in model src_listen (dbt_project/models/01_source_layer/src_listen.sql)
  Catalog Error: Table with name listen_history does not exist!
  Did you mean "moovitamix.listen_history"?
  LINE 10:     select * from moovai_data.listen_history
                             ^
[0m08:18:04.561405 [info ] [MainThread]: 
[0m08:18:04.561560 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovitamix.tracks"?
  LINE 10:     select * from moovai_data.tracks
                             ^
[0m08:18:04.561690 [info ] [MainThread]: 
[0m08:18:04.561843 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "moovitamix.users"?
  LINE 9:     select * from moovai_data.users
                            ^
[0m08:18:04.561972 [info ] [MainThread]: 
[0m08:18:04.562112 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m08:18:04.563629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6608886, "process_user_time": 1.041556, "process_kernel_time": 0.167846, "process_mem_max_rss": "134168576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:18:04.563887 [debug] [MainThread]: Command `dbt run` failed at 08:18:04.563846 after 0.66 seconds
[0m08:18:04.564070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa2d50>]}
[0m08:18:04.564228 [debug] [MainThread]: Flushing usage events
[0m08:18:32.091481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060962a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afeff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afecf0>]}


============================== 08:18:32.094407 | 70ad3e60-2071-4d8b-bb40-32faaae9ee73 ==============================
[0m08:18:32.094407 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:18:32.094727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline-master/Docker_Airflow/modeling/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:18:32.264898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f950>]}
[0m08:18:32.287821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106095a90>]}
[0m08:18:32.289788 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:18:32.300090 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:18:32.361447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:18:32.361817 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/sources.yml
[0m08:18:32.362033 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_listen.sql
[0m08:18:32.563144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a2810>]}
[0m08:18:32.608766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e09250>]}
[0m08:18:32.609051 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 416 macros
[0m08:18:32.609220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebd4c0>]}
[0m08:18:32.610190 [info ] [MainThread]: 
[0m08:18:32.610475 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:18:32.612857 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovitamix'
[0m08:18:32.640624 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix"
[0m08:18:32.640858 [debug] [ThreadPool]: On list_moovitamix: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovitamix"'
    
  
  
[0m08:18:32.641002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:32.655367 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m08:18:32.656784 [debug] [ThreadPool]: On list_moovitamix: Close
[0m08:18:32.658480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovitamix, now create_moovitamix_main)
[0m08:18:32.658762 [debug] [ThreadPool]: Creating schema "database: "moovitamix"
schema: "main"
"
[0m08:18:32.665273 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:32.665635 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
        select type from duckdb_databases()
        where database_name='moovitamix'
        and type='sqlite'
    
  
[0m08:18:32.665804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:32.671683 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:18:32.673461 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:32.673945 [debug] [ThreadPool]: On create_moovitamix_main: BEGIN
[0m08:18:32.674365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:18:32.674526 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:32.674878 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
    
        create schema if not exists "moovitamix"."main"
    
[0m08:18:32.676809 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:18:32.677355 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:18:32.677575 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:32.677726 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:18:32.677957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:18:32.678111 [debug] [ThreadPool]: On create_moovitamix_main: Close
[0m08:18:32.680315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovitamix_main, now list_moovitamix_main)
[0m08:18:32.683504 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:18:32.683711 [debug] [ThreadPool]: On list_moovitamix_main: BEGIN
[0m08:18:32.683848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:32.687010 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:18:32.687216 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:18:32.687371 [debug] [ThreadPool]: On list_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix_main"} */
select
      'moovitamix' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovitamix'
  
[0m08:18:32.700981 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:18:32.701724 [debug] [ThreadPool]: On list_moovitamix_main: ROLLBACK
[0m08:18:32.702657 [debug] [ThreadPool]: Failed to rollback 'list_moovitamix_main'
[0m08:18:32.702800 [debug] [ThreadPool]: On list_moovitamix_main: Close
[0m08:18:32.703896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072113a0>]}
[0m08:18:32.704128 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:32.704261 [debug] [MainThread]: On master: BEGIN
[0m08:18:32.704379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:18:32.707095 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:18:32.707264 [debug] [MainThread]: On master: COMMIT
[0m08:18:32.707396 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:32.707509 [debug] [MainThread]: On master: COMMIT
[0m08:18:32.707658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:18:32.707781 [debug] [MainThread]: On master: Close
[0m08:18:32.708285 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m08:18:32.708438 [info ] [MainThread]: 
[0m08:18:32.709655 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m08:18:32.710048 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m08:18:32.710262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovitamix_main, now model.dbt_project.src_listen)
[0m08:18:32.710415 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m08:18:32.713842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m08:18:32.714233 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m08:18:32.729368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m08:18:32.729869 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:32.730046 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m08:18:32.730193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:32.733080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:32.733276 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:32.733432 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovitamix"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovitamix.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m08:18:32.735416 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:18:32.738611 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:32.738800 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovitamix"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m08:18:32.739562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:32.746468 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m08:18:32.746649 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:32.746796 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m08:18:32.747623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:32.749877 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:32.750052 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovitamix"."main"."src_listen__dbt_backup" cascade
[0m08:18:32.750273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:32.751358 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m08:18:32.756202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c7320>]}
[0m08:18:32.756539 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m08:18:32.756819 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m08:18:32.757016 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m08:18:32.757315 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m08:18:32.757542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m08:18:32.757706 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m08:18:32.758905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m08:18:32.759523 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m08:18:32.761077 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m08:18:32.761436 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:32.761599 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m08:18:32.761748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:32.764881 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:32.765076 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:32.765238 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:18:32.776896 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovai_data.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:18:32.777131 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:18:32.777412 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: ROLLBACK
[0m08:18:32.782299 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_tracks'
[0m08:18:32.782477 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m08:18:32.784360 [debug] [Thread-1 (]: Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovitamix.tracks"?
  LINE 10:     select * from moovai_data.tracks
                             ^
[0m08:18:32.784591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b0d10>]}
[0m08:18:32.784883 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model main.src_tracks ........................... [[31mERROR[0m in 0.03s]
[0m08:18:32.785171 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m08:18:32.785368 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m08:18:32.785975 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m08:18:32.786178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m08:18:32.786331 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m08:18:32.787624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m08:18:32.787975 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m08:18:32.790182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m08:18:32.790468 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:32.790623 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m08:18:32.790764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:32.793589 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:32.793769 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:32.793920 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:18:32.802580 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovai_data.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:18:32.802764 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m08:18:32.802963 [debug] [Thread-1 (]: On model.dbt_project.src_users: ROLLBACK
[0m08:18:32.804437 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_project.src_users'
[0m08:18:32.804593 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m08:18:32.806342 [debug] [Thread-1 (]: Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "moovitamix.users"?
  LINE 9:     select * from moovai_data.users
                            ^
[0m08:18:32.806539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a9880>]}
[0m08:18:32.806807 [error] [Thread-1 (]: 3 of 8 ERROR creating sql view model main.src_users ............................ [[31mERROR[0m in 0.02s]
[0m08:18:32.807058 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m08:18:32.807237 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m08:18:32.807422 [info ] [Thread-1 (]: 4 of 8 START sql incremental model main.int_fact_listen ........................ [RUN]
[0m08:18:32.807688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m08:18:32.807865 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m08:18:32.809294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m08:18:32.809753 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m08:18:32.828845 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m08:18:32.829418 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:32.829580 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m08:18:32.829720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:32.832549 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:32.832735 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:32.832896 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
    
    

    create  table
      "moovitamix"."main"."int_fact_listen"
  
    as (
      

with cte_int_listen as (

    select * from "moovitamix"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
  
[0m08:18:32.834380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:32.836914 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m08:18:32.837109 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:32.837258 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m08:18:32.837650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:32.837994 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m08:18:32.840539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ad3e60-2071-4d8b-bb40-32faaae9ee73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107681d60>]}
[0m08:18:32.840846 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model main.int_fact_listen ................... [[32mOK[0m in 0.03s]
[0m08:18:32.841113 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m08:18:32.841300 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m08:18:32.841499 [info ] [Thread-1 (]: 5 of 8 SKIP relation main.int_dim_tracks ....................................... [[33mSKIP[0m]
[0m08:18:32.841679 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m08:18:32.841847 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m08:18:32.842053 [info ] [Thread-1 (]: 6 of 8 SKIP relation main.int_dim_users ........................................ [[33mSKIP[0m]
[0m08:18:32.842268 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m08:18:32.842453 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m08:18:32.842661 [info ] [Thread-1 (]: 7 of 8 SKIP relation main.mart_listen_and_tracks ............................... [[33mSKIP[0m]
[0m08:18:32.842835 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m08:18:32.843006 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m08:18:32.843172 [info ] [Thread-1 (]: 8 of 8 SKIP relation main.mart_listen_and_users ................................ [[33mSKIP[0m]
[0m08:18:32.843344 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m08:18:32.843851 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:32.843992 [debug] [MainThread]: On master: BEGIN
[0m08:18:32.844108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:18:32.846855 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:18:32.847024 [debug] [MainThread]: On master: COMMIT
[0m08:18:32.847152 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:32.847268 [debug] [MainThread]: On master: COMMIT
[0m08:18:32.847424 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:18:32.847547 [debug] [MainThread]: On master: Close
[0m08:18:32.848055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:18:32.848176 [debug] [MainThread]: Connection 'model.dbt_project.int_fact_listen' was properly closed.
[0m08:18:32.848350 [info ] [MainThread]: 
[0m08:18:32.848498 [info ] [MainThread]: Finished running 3 view models, 3 incremental models, 2 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m08:18:32.849002 [debug] [MainThread]: Command end result
[0m08:18:32.861938 [info ] [MainThread]: 
[0m08:18:32.862245 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:18:32.862416 [info ] [MainThread]: 
[0m08:18:32.862670 [error] [MainThread]:   Runtime Error in model src_tracks (dbt_project/models/01_source_layer/src_tracks.sql)
  Catalog Error: Table with name tracks does not exist!
  Did you mean "moovitamix.tracks"?
  LINE 10:     select * from moovai_data.tracks
                             ^
[0m08:18:32.862820 [info ] [MainThread]: 
[0m08:18:32.862984 [error] [MainThread]:   Runtime Error in model src_users (dbt_project/models/01_source_layer/src_users.sql)
  Catalog Error: Table with name users does not exist!
  Did you mean "moovitamix.users"?
  LINE 9:     select * from moovai_data.users
                            ^
[0m08:18:32.863120 [info ] [MainThread]: 
[0m08:18:32.863270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=4 TOTAL=8
[0m08:18:32.865308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.807477, "process_user_time": 1.190466, "process_kernel_time": 0.173078, "process_mem_max_rss": "139919360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:18:32.865622 [debug] [MainThread]: Command `dbt run` failed at 08:18:32.865576 after 0.81 seconds
[0m08:18:32.865812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106095b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106568440>]}
[0m08:18:32.865981 [debug] [MainThread]: Flushing usage events
[0m08:18:48.765183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bd5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104696bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104696900>]}


============================== 08:18:48.767950 | 1416d774-ff75-4edf-b715-9b4be00a1cb0 ==============================
[0m08:18:48.767950 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:18:48.768268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline-master/Docker_Airflow/modeling/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:18:48.948651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104823230>]}
[0m08:18:48.971971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104158560>]}
[0m08:18:48.973832 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:18:48.984999 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:18:49.047671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:18:49.048017 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_users.sql
[0m08:18:49.048204 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt_project/models/01_source_layer/src_tracks.sql
[0m08:18:49.156483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a741a0>]}
[0m08:18:49.205701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa79b0>]}
[0m08:18:49.205977 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 416 macros
[0m08:18:49.206148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e7c80>]}
[0m08:18:49.207130 [info ] [MainThread]: 
[0m08:18:49.207407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:18:49.209669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovitamix'
[0m08:18:49.236648 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix"
[0m08:18:49.236881 [debug] [ThreadPool]: On list_moovitamix: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovitamix"'
    
  
  
[0m08:18:49.237027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:49.253190 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m08:18:49.254534 [debug] [ThreadPool]: On list_moovitamix: Close
[0m08:18:49.256021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovitamix, now create_moovitamix_main)
[0m08:18:49.256243 [debug] [ThreadPool]: Creating schema "database: "moovitamix"
schema: "main"
"
[0m08:18:49.259488 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:49.259653 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
        select type from duckdb_databases()
        where database_name='moovitamix'
        and type='sqlite'
    
  
[0m08:18:49.259796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:49.263150 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:18:49.263983 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:49.264123 [debug] [ThreadPool]: On create_moovitamix_main: BEGIN
[0m08:18:49.264287 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:18:49.264410 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:49.264532 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
    
        create schema if not exists "moovitamix"."main"
    
[0m08:18:49.264922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:18:49.265315 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:18:49.265444 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:18:49.265555 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:18:49.265701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:18:49.265827 [debug] [ThreadPool]: On create_moovitamix_main: Close
[0m08:18:49.266830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovitamix_main, now list_moovitamix_main)
[0m08:18:49.269429 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:18:49.269576 [debug] [ThreadPool]: On list_moovitamix_main: BEGIN
[0m08:18:49.269691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:49.272307 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:18:49.272472 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:18:49.272622 [debug] [ThreadPool]: On list_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix_main"} */
select
      'moovitamix' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovitamix'
  
[0m08:18:49.285736 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:18:49.286502 [debug] [ThreadPool]: On list_moovitamix_main: ROLLBACK
[0m08:18:49.287426 [debug] [ThreadPool]: Failed to rollback 'list_moovitamix_main'
[0m08:18:49.287584 [debug] [ThreadPool]: On list_moovitamix_main: Close
[0m08:18:49.288775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa7a40>]}
[0m08:18:49.288994 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:49.289125 [debug] [MainThread]: On master: BEGIN
[0m08:18:49.289242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:18:49.291997 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:18:49.292173 [debug] [MainThread]: On master: COMMIT
[0m08:18:49.292309 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:49.292429 [debug] [MainThread]: On master: COMMIT
[0m08:18:49.292586 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:18:49.292719 [debug] [MainThread]: On master: Close
[0m08:18:49.293238 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m08:18:49.293417 [info ] [MainThread]: 
[0m08:18:49.294762 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m08:18:49.295014 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m08:18:49.295223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovitamix_main, now model.dbt_project.src_listen)
[0m08:18:49.295390 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m08:18:49.299075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m08:18:49.299534 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m08:18:49.317078 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m08:18:49.317615 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:49.317777 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m08:18:49.317932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.320937 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:49.321155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:49.321324 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovitamix"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovitamix.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m08:18:49.323273 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:18:49.326493 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:49.326698 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovitamix"."main"."src_listen" rename to "src_listen__dbt_backup"
[0m08:18:49.327439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:49.328772 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:49.328929 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovitamix"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m08:18:49.329142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.337688 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m08:18:49.337876 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:49.338027 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m08:18:49.338848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:49.341143 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:18:49.341317 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovitamix"."main"."src_listen__dbt_backup" cascade
[0m08:18:49.341622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.342818 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m08:18:49.347026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104add670>]}
[0m08:18:49.347369 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m08:18:49.347640 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m08:18:49.347833 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m08:18:49.348106 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m08:18:49.348299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m08:18:49.348449 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m08:18:49.349682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m08:18:49.349998 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m08:18:49.351447 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m08:18:49.351731 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:49.351883 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m08:18:49.352024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.354831 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:49.355031 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:49.355189 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovitamix.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:18:49.355522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.356938 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:49.357103 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovitamix"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m08:18:49.357326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.357945 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m08:18:49.358096 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:49.358227 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m08:18:49.358596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.359643 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:18:49.359810 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovitamix"."main"."src_tracks__dbt_backup" cascade
[0m08:18:49.360034 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.360634 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m08:18:49.363122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105064f80>]}
[0m08:18:49.363416 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.01s]
[0m08:18:49.363672 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m08:18:49.363855 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m08:18:49.364110 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m08:18:49.364292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m08:18:49.364446 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m08:18:49.365697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m08:18:49.365988 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m08:18:49.367418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m08:18:49.367750 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:49.367905 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m08:18:49.368049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.371009 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:49.371206 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:49.371363 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovitamix.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:18:49.371682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.373109 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:49.373270 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovitamix"."main"."src_users__dbt_tmp" rename to "src_users"
[0m08:18:49.373493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.374112 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m08:18:49.374263 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:49.374393 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m08:18:49.374782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.375826 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:18:49.375986 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovitamix"."main"."src_users__dbt_backup" cascade
[0m08:18:49.376198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.376818 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m08:18:49.379438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509e960>]}
[0m08:18:49.379738 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m08:18:49.379995 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m08:18:49.380185 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m08:18:49.380441 [info ] [Thread-1 (]: 4 of 8 START sql incremental model main.int_fact_listen ........................ [RUN]
[0m08:18:49.380626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m08:18:49.380774 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m08:18:49.382154 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m08:18:49.382443 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m08:18:49.402836 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:49.403136 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

    
  
    
    

    create temporary table
      "int_fact_listen__dbt_tmp20240924081849396770"
  
    as (
      

with cte_int_listen as (

    select * from "moovitamix"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
  
[0m08:18:49.403312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.408198 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:18:49.411782 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:49.411971 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m08:18:49.412176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.412329 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:49.412487 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_fact_listen__dbt_tmp20240924081849396770'
      
      
      order by ordinal_position

  
[0m08:18:49.423647 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:18:49.426083 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:49.426274 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_fact_listen'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'moovitamix'
      
      order by ordinal_position

  
[0m08:18:49.427870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:49.431458 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:49.431657 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'int_fact_listen'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'moovitamix'
      
      order by ordinal_position

  
[0m08:18:49.433206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:49.441193 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m08:18:49.441632 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:49.441805 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */


    insert into "moovitamix"."main"."int_fact_listen" ("user_id", "track_id", "listen_timestamp")
    (
        select "user_id", "track_id", "listen_timestamp"
        from "int_fact_listen__dbt_tmp20240924081849396770"
    )
  
[0m08:18:49.442844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:49.443553 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m08:18:49.443717 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:18:49.443860 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m08:18:49.444150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.444477 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m08:18:49.445349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a74110>]}
[0m08:18:49.445644 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model main.int_fact_listen ................... [[32mOK[0m in 0.06s]
[0m08:18:49.445905 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m08:18:49.446095 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m08:18:49.446336 [info ] [Thread-1 (]: 5 of 8 START sql incremental model main.int_dim_tracks ......................... [RUN]
[0m08:18:49.446542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m08:18:49.446702 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m08:18:49.448057 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m08:18:49.448428 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m08:18:49.450073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m08:18:49.450374 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m08:18:49.450527 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m08:18:49.450678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.453493 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:49.453680 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m08:18:49.453849 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
    
    

    create  table
      "moovitamix"."main"."int_dim_tracks"
  
    as (
      

with cte_src_tracks as (

    select * from "moovitamix"."main"."src_tracks"

)

--INSERT INTO int_tracks
select *
from cte_src_tracks
    );
  
  
  
[0m08:18:49.454500 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.456929 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m08:18:49.457110 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m08:18:49.457259 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m08:18:49.457640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.457991 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m08:18:49.460496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc4170>]}
[0m08:18:49.460788 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model main.int_dim_tracks .................... [[32mOK[0m in 0.01s]
[0m08:18:49.461036 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m08:18:49.461230 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m08:18:49.461525 [info ] [Thread-1 (]: 6 of 8 START sql incremental model main.int_dim_users .......................... [RUN]
[0m08:18:49.461748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m08:18:49.461912 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m08:18:49.463310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m08:18:49.463680 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m08:18:49.465227 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m08:18:49.465531 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m08:18:49.465681 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m08:18:49.465820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.468802 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:49.469041 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m08:18:49.469216 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
    
    

    create  table
      "moovitamix"."main"."int_dim_users"
  
    as (
      

with cte_src_users as (

    select * from "moovitamix"."main"."src_users"

)

--INSERT INTO int_users
select *
from cte_src_users
    );
  
  
  
[0m08:18:49.470884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:18:49.471746 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m08:18:49.471903 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m08:18:49.472046 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m08:18:49.472468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.472829 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m08:18:49.475401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b11160>]}
[0m08:18:49.475684 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model main.int_dim_users ..................... [[32mOK[0m in 0.01s]
[0m08:18:49.475933 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m08:18:49.476113 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m08:18:49.476403 [info ] [Thread-1 (]: 7 of 8 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m08:18:49.476627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen_and_tracks)
[0m08:18:49.476789 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m08:18:49.478529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m08:18:49.478900 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m08:18:49.485231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m08:18:49.485623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:18:49.485785 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m08:18:49.485930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.488877 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:49.489059 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:18:49.489229 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovitamix"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovitamix"."main"."int_fact_listen" AS l
LEFT JOIN "moovitamix"."main"."int_dim_tracks" as r
ON l.track_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m08:18:49.491171 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:18:49.492682 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:18:49.492881 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovitamix"."main"."mart_listen_and_tracks__dbt_tmp" rename to "mart_listen_and_tracks"
[0m08:18:49.493262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.494115 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m08:18:49.494278 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:18:49.494426 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m08:18:49.494936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.496099 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:18:49.496267 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
drop table if exists "moovitamix"."main"."mart_listen_and_tracks__dbt_backup" cascade
[0m08:18:49.496493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.497120 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m08:18:49.499871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f72c0>]}
[0m08:18:49.500181 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.mart_listen_and_tracks .................. [[32mOK[0m in 0.02s]
[0m08:18:49.500455 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m08:18:49.500640 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m08:18:49.500862 [info ] [Thread-1 (]: 8 of 8 START sql table model main.mart_listen_and_users ........................ [RUN]
[0m08:18:49.501052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.mart_listen_and_users)
[0m08:18:49.501207 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_users
[0m08:18:49.502758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_users"
[0m08:18:49.503132 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_users
[0m08:18:49.504585 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_users"
[0m08:18:49.504867 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:18:49.505012 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: BEGIN
[0m08:18:49.505151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:49.508208 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:18:49.508396 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:18:49.508566 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */

  
    
    

    create  table
      "moovitamix"."main"."mart_listen_and_users__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovitamix"."main"."int_fact_listen" AS l
LEFT JOIN "moovitamix"."main"."int_dim_users" as r
ON l.user_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m08:18:49.509107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.510697 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:18:49.510894 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovitamix"."main"."mart_listen_and_users__dbt_tmp" rename to "mart_listen_and_users"
[0m08:18:49.511208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.511914 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m08:18:49.512062 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:18:49.512200 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m08:18:49.512573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.513644 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:18:49.513807 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
drop table if exists "moovitamix"."main"."mart_listen_and_users__dbt_backup" cascade
[0m08:18:49.514026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:18:49.514629 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: Close
[0m08:18:49.517427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1416d774-ff75-4edf-b715-9b4be00a1cb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f972f0>]}
[0m08:18:49.517770 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main.mart_listen_and_users ................... [[32mOK[0m in 0.02s]
[0m08:18:49.518081 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m08:18:49.518721 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:49.518898 [debug] [MainThread]: On master: BEGIN
[0m08:18:49.519031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:18:49.522449 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:18:49.522672 [debug] [MainThread]: On master: COMMIT
[0m08:18:49.522813 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:49.522938 [debug] [MainThread]: On master: COMMIT
[0m08:18:49.523106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:18:49.523237 [debug] [MainThread]: On master: Close
[0m08:18:49.523784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:18:49.523922 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_users' was properly closed.
[0m08:18:49.524102 [info ] [MainThread]: 
[0m08:18:49.524248 [info ] [MainThread]: Finished running 3 view models, 3 incremental models, 2 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m08:18:49.524928 [debug] [MainThread]: Command end result
[0m08:18:49.539127 [info ] [MainThread]: 
[0m08:18:49.539351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:18:49.539502 [info ] [MainThread]: 
[0m08:18:49.539651 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m08:18:49.541059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.80794024, "process_user_time": 1.186377, "process_kernel_time": 0.168507, "process_mem_max_rss": "141983744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:18:49.541346 [debug] [MainThread]: Command `dbt run` succeeded at 08:18:49.541299 after 0.81 seconds
[0m08:18:49.541532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c9b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb1eb0>]}
[0m08:18:49.541697 [debug] [MainThread]: Flushing usage events
[0m08:48:47.587383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf6990>]}


============================== 08:48:47.590302 | 1d1fee12-eef3-415f-90cc-3dbe79a0f1a1 ==============================
[0m08:48:47.590302 [info ] [MainThread]: Running with dbt=1.8.6
[0m08:48:47.590619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/brossierlucas/programmation/moovai_pipeline-master/Docker_Airflow/modeling/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/brossierlucas/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:48:47.772634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf6c00>]}
[0m08:48:47.796147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d20d10>]}
[0m08:48:47.798042 [info ] [MainThread]: Registered adapter: duckdb=1.8.3
[0m08:48:47.807951 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m08:48:47.870415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:47.870659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:47.891262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fe810>]}
[0m08:48:47.945682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107009580>]}
[0m08:48:47.945976 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 416 macros
[0m08:48:47.946152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712d400>]}
[0m08:48:47.947162 [info ] [MainThread]: 
[0m08:48:47.947445 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:48:47.949824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_moovitamix'
[0m08:48:47.978828 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix"
[0m08:48:47.979065 [debug] [ThreadPool]: On list_moovitamix: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"moovitamix"'
    
  
  
[0m08:48:47.979213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:47.993836 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m08:48:47.995197 [debug] [ThreadPool]: On list_moovitamix: Close
[0m08:48:47.996862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_moovitamix, now create_moovitamix_main)
[0m08:48:47.997111 [debug] [ThreadPool]: Creating schema "database: "moovitamix"
schema: "main"
"
[0m08:48:48.000566 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:48:48.000781 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
        select type from duckdb_databases()
        where database_name='moovitamix'
        and type='sqlite'
    
  
[0m08:48:48.000929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:48.004577 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:48:48.005558 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:48:48.005731 [debug] [ThreadPool]: On create_moovitamix_main: BEGIN
[0m08:48:48.005925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:48.006059 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:48:48.006186 [debug] [ThreadPool]: On create_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "create_moovitamix_main"} */

    
    
        create schema if not exists "moovitamix"."main"
    
[0m08:48:48.006945 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:48:48.007376 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:48:48.007511 [debug] [ThreadPool]: Using duckdb connection "create_moovitamix_main"
[0m08:48:48.007630 [debug] [ThreadPool]: On create_moovitamix_main: COMMIT
[0m08:48:48.007795 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:48:48.007923 [debug] [ThreadPool]: On create_moovitamix_main: Close
[0m08:48:48.009111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_moovitamix_main, now list_moovitamix_main)
[0m08:48:48.012705 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:48:48.012903 [debug] [ThreadPool]: On list_moovitamix_main: BEGIN
[0m08:48:48.013033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:48.016007 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:48:48.016208 [debug] [ThreadPool]: Using duckdb connection "list_moovitamix_main"
[0m08:48:48.016353 [debug] [ThreadPool]: On list_moovitamix_main: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "connection_name": "list_moovitamix_main"} */
select
      'moovitamix' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'moovitamix'
  
[0m08:48:48.030022 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m08:48:48.030890 [debug] [ThreadPool]: On list_moovitamix_main: ROLLBACK
[0m08:48:48.031937 [debug] [ThreadPool]: Failed to rollback 'list_moovitamix_main'
[0m08:48:48.032110 [debug] [ThreadPool]: On list_moovitamix_main: Close
[0m08:48:48.033248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b81d30>]}
[0m08:48:48.033474 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:48.033604 [debug] [MainThread]: On master: BEGIN
[0m08:48:48.033717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:48:48.036550 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:48:48.036718 [debug] [MainThread]: On master: COMMIT
[0m08:48:48.036851 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:48.036968 [debug] [MainThread]: On master: COMMIT
[0m08:48:48.037120 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:48.037246 [debug] [MainThread]: On master: Close
[0m08:48:48.037749 [info ] [MainThread]: Concurrency: 1 threads (target='local')
[0m08:48:48.037915 [info ] [MainThread]: 
[0m08:48:48.039254 [debug] [Thread-1 (]: Began running node model.dbt_project.src_listen
[0m08:48:48.039514 [info ] [Thread-1 (]: 1 of 8 START sql view model main.src_listen .................................... [RUN]
[0m08:48:48.039720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_moovitamix_main, now model.dbt_project.src_listen)
[0m08:48:48.039877 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_listen
[0m08:48:48.043366 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_listen"
[0m08:48:48.043746 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_listen
[0m08:48:48.059151 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_listen"
[0m08:48:48.059688 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:48:48.059876 [debug] [Thread-1 (]: On model.dbt_project.src_listen: BEGIN
[0m08:48:48.060040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.063158 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.063365 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:48:48.063521 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */

  
  create view "moovitamix"."main"."src_listen__dbt_tmp" as (
    

with cte_src_listen as (


    select * from moovitamix.listen_history
    WHERE listen_timestamp = CURRENT_DATE
)

select *
from cte_src_listen
  );

[0m08:48:48.065624 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:48:48.068888 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:48:48.069090 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
alter view "moovitamix"."main"."src_listen__dbt_tmp" rename to "src_listen"
[0m08:48:48.069896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:48.076913 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m08:48:48.077119 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:48:48.077276 [debug] [Thread-1 (]: On model.dbt_project.src_listen: COMMIT
[0m08:48:48.078317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:48.080617 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_listen"
[0m08:48:48.080797 [debug] [Thread-1 (]: On model.dbt_project.src_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_listen"} */
drop view if exists "moovitamix"."main"."src_listen__dbt_backup" cascade
[0m08:48:48.081025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.082094 [debug] [Thread-1 (]: On model.dbt_project.src_listen: Close
[0m08:48:48.087003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036ae0>]}
[0m08:48:48.087318 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.src_listen ............................... [[32mOK[0m in 0.05s]
[0m08:48:48.087599 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_listen
[0m08:48:48.087808 [debug] [Thread-1 (]: Began running node model.dbt_project.src_tracks
[0m08:48:48.088094 [info ] [Thread-1 (]: 2 of 8 START sql view model main.src_tracks .................................... [RUN]
[0m08:48:48.088290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_listen, now model.dbt_project.src_tracks)
[0m08:48:48.088442 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_tracks
[0m08:48:48.089735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_tracks"
[0m08:48:48.090730 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_tracks
[0m08:48:48.092333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_tracks"
[0m08:48:48.092625 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:48:48.092776 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: BEGIN
[0m08:48:48.092921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.096065 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.096247 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:48:48.096400 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */

  
  create view "moovitamix"."main"."src_tracks__dbt_tmp" as (
    

with cte_src_tracks as (


    select * from moovitamix.tracks
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_tracks
  );

[0m08:48:48.096748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.098209 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:48:48.098369 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
alter view "moovitamix"."main"."src_tracks__dbt_tmp" rename to "src_tracks"
[0m08:48:48.098590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.099329 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m08:48:48.099478 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:48:48.099617 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: COMMIT
[0m08:48:48.100061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.101185 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_tracks"
[0m08:48:48.101382 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_tracks"} */
drop view if exists "moovitamix"."main"."src_tracks__dbt_backup" cascade
[0m08:48:48.101672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.102420 [debug] [Thread-1 (]: On model.dbt_project.src_tracks: Close
[0m08:48:48.105526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036ae0>]}
[0m08:48:48.105875 [info ] [Thread-1 (]: 2 of 8 OK created sql view model main.src_tracks ............................... [[32mOK[0m in 0.02s]
[0m08:48:48.106163 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_tracks
[0m08:48:48.106355 [debug] [Thread-1 (]: Began running node model.dbt_project.src_users
[0m08:48:48.106626 [info ] [Thread-1 (]: 3 of 8 START sql view model main.src_users ..................................... [RUN]
[0m08:48:48.106818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_tracks, now model.dbt_project.src_users)
[0m08:48:48.106974 [debug] [Thread-1 (]: Began compiling node model.dbt_project.src_users
[0m08:48:48.109100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.src_users"
[0m08:48:48.109453 [debug] [Thread-1 (]: Began executing node model.dbt_project.src_users
[0m08:48:48.110914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.src_users"
[0m08:48:48.111220 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:48:48.111371 [debug] [Thread-1 (]: On model.dbt_project.src_users: BEGIN
[0m08:48:48.111507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.114384 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.114570 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:48:48.114734 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */

  
  create view "moovitamix"."main"."src_users__dbt_tmp" as (
    

with cte_src_users as (

    select * from moovitamix.users
    WHERE created_at = CURRENT_DATE

)

select *
from cte_src_users
  );

[0m08:48:48.115086 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.116692 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:48:48.116873 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
alter view "moovitamix"."main"."src_users__dbt_tmp" rename to "src_users"
[0m08:48:48.117133 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.117861 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m08:48:48.118013 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:48:48.118153 [debug] [Thread-1 (]: On model.dbt_project.src_users: COMMIT
[0m08:48:48.118542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.119629 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.src_users"
[0m08:48:48.119786 [debug] [Thread-1 (]: On model.dbt_project.src_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.src_users"} */
drop view if exists "moovitamix"."main"."src_users__dbt_backup" cascade
[0m08:48:48.120010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.120596 [debug] [Thread-1 (]: On model.dbt_project.src_users: Close
[0m08:48:48.123285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075718b0>]}
[0m08:48:48.123586 [info ] [Thread-1 (]: 3 of 8 OK created sql view model main.src_users ................................ [[32mOK[0m in 0.02s]
[0m08:48:48.123844 [debug] [Thread-1 (]: Finished running node model.dbt_project.src_users
[0m08:48:48.124030 [debug] [Thread-1 (]: Began running node model.dbt_project.int_fact_listen
[0m08:48:48.124304 [info ] [Thread-1 (]: 4 of 8 START sql incremental model main.int_fact_listen ........................ [RUN]
[0m08:48:48.124510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.src_users, now model.dbt_project.int_fact_listen)
[0m08:48:48.124669 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_fact_listen
[0m08:48:48.126141 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_fact_listen"
[0m08:48:48.126557 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_fact_listen
[0m08:48:48.146194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_fact_listen"
[0m08:48:48.146705 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:48:48.146874 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: BEGIN
[0m08:48:48.147017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.149927 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.150132 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:48:48.150293 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_fact_listen"} */

  
    
    

    create  table
      "moovitamix"."main"."int_fact_listen"
  
    as (
      

with cte_int_listen as (

    select * from "moovitamix"."main"."src_listen"

)

--INSERT INTO int_listen
select *
from cte_int_listen
    );
  
  
  
[0m08:48:48.151793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:48.154192 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m08:48:48.154369 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_fact_listen"
[0m08:48:48.154520 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: COMMIT
[0m08:48:48.154888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.155225 [debug] [Thread-1 (]: On model.dbt_project.int_fact_listen: Close
[0m08:48:48.157927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107572900>]}
[0m08:48:48.158272 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model main.int_fact_listen ................... [[32mOK[0m in 0.03s]
[0m08:48:48.158546 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_fact_listen
[0m08:48:48.158736 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_tracks
[0m08:48:48.158961 [info ] [Thread-1 (]: 5 of 8 START sql incremental model main.int_dim_tracks ......................... [RUN]
[0m08:48:48.159154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_fact_listen, now model.dbt_project.int_dim_tracks)
[0m08:48:48.159308 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_tracks
[0m08:48:48.160796 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_tracks"
[0m08:48:48.161328 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_tracks
[0m08:48:48.162938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_tracks"
[0m08:48:48.163241 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m08:48:48.163389 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: BEGIN
[0m08:48:48.163527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.166440 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.166623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m08:48:48.166785 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_tracks"} */

  
    
    

    create  table
      "moovitamix"."main"."int_dim_tracks"
  
    as (
      

with cte_src_tracks as (

    select * from "moovitamix"."main"."src_tracks"

)

--INSERT INTO int_tracks
select *
from cte_src_tracks
    );
  
  
  
[0m08:48:48.167429 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.168167 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m08:48:48.168316 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_tracks"
[0m08:48:48.168460 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: COMMIT
[0m08:48:48.168885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.169232 [debug] [Thread-1 (]: On model.dbt_project.int_dim_tracks: Close
[0m08:48:48.172146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748aff0>]}
[0m08:48:48.172502 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model main.int_dim_tracks .................... [[32mOK[0m in 0.01s]
[0m08:48:48.172768 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_tracks
[0m08:48:48.172964 [debug] [Thread-1 (]: Began running node model.dbt_project.int_dim_users
[0m08:48:48.173271 [info ] [Thread-1 (]: 6 of 8 START sql incremental model main.int_dim_users .......................... [RUN]
[0m08:48:48.173502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_tracks, now model.dbt_project.int_dim_users)
[0m08:48:48.173674 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_dim_users
[0m08:48:48.175143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_dim_users"
[0m08:48:48.175485 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_dim_users
[0m08:48:48.177861 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.int_dim_users"
[0m08:48:48.178179 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m08:48:48.178339 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: BEGIN
[0m08:48:48.178477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.181545 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.181778 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m08:48:48.181947 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.int_dim_users"} */

  
    
    

    create  table
      "moovitamix"."main"."int_dim_users"
  
    as (
      

with cte_src_users as (

    select * from "moovitamix"."main"."src_users"

)

--INSERT INTO int_users
select *
from cte_src_users
    );
  
  
  
[0m08:48:48.183559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:48:48.184385 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m08:48:48.184557 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.int_dim_users"
[0m08:48:48.184702 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: COMMIT
[0m08:48:48.185095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.185430 [debug] [Thread-1 (]: On model.dbt_project.int_dim_users: Close
[0m08:48:48.188121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d1160>]}
[0m08:48:48.188413 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model main.int_dim_users ..................... [[32mOK[0m in 0.01s]
[0m08:48:48.188660 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_dim_users
[0m08:48:48.188845 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_tracks
[0m08:48:48.189107 [info ] [Thread-1 (]: 7 of 8 START sql table model main.mart_listen_and_tracks ....................... [RUN]
[0m08:48:48.189296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_dim_users, now model.dbt_project.mart_listen_and_tracks)
[0m08:48:48.189451 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_tracks
[0m08:48:48.191180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_tracks"
[0m08:48:48.191584 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_tracks
[0m08:48:48.197762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_tracks"
[0m08:48:48.198297 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:48:48.198467 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: BEGIN
[0m08:48:48.198632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.201650 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.201840 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:48:48.202006 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */

  
    
    

    create  table
      "moovitamix"."main"."mart_listen_and_tracks__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovitamix"."main"."int_fact_listen" AS l
LEFT JOIN "moovitamix"."main"."int_dim_tracks" as r
ON l.track_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m08:48:48.204457 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:48:48.205982 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:48:48.206153 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
alter table "moovitamix"."main"."mart_listen_and_tracks__dbt_tmp" rename to "mart_listen_and_tracks"
[0m08:48:48.206392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.207084 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m08:48:48.207240 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:48:48.207378 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: COMMIT
[0m08:48:48.207777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.208820 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_tracks"
[0m08:48:48.208975 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_tracks"} */
drop table if exists "moovitamix"."main"."mart_listen_and_tracks__dbt_backup" cascade
[0m08:48:48.209181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.209788 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_tracks: Close
[0m08:48:48.213022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107152a50>]}
[0m08:48:48.213415 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.mart_listen_and_tracks .................. [[32mOK[0m in 0.02s]
[0m08:48:48.213696 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_tracks
[0m08:48:48.213894 [debug] [Thread-1 (]: Began running node model.dbt_project.mart_listen_and_users
[0m08:48:48.214147 [info ] [Thread-1 (]: 8 of 8 START sql table model main.mart_listen_and_users ........................ [RUN]
[0m08:48:48.214365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.mart_listen_and_tracks, now model.dbt_project.mart_listen_and_users)
[0m08:48:48.214532 [debug] [Thread-1 (]: Began compiling node model.dbt_project.mart_listen_and_users
[0m08:48:48.216402 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.mart_listen_and_users"
[0m08:48:48.216763 [debug] [Thread-1 (]: Began executing node model.dbt_project.mart_listen_and_users
[0m08:48:48.218222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.mart_listen_and_users"
[0m08:48:48.218518 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:48:48.218669 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: BEGIN
[0m08:48:48.218809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:48.221873 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m08:48:48.222066 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:48:48.222236 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */

  
    
    

    create  table
      "moovitamix"."main"."mart_listen_and_users__dbt_tmp"
  
    as (
      

with mart_listen_and_tracks as (

SELECT *
FROM  "moovitamix"."main"."int_fact_listen" AS l
LEFT JOIN "moovitamix"."main"."int_dim_users" as r
ON l.user_id = r.id

)

select * from mart_listen_and_tracks
    );
  
  
[0m08:48:48.222812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.224518 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:48:48.224703 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
alter table "moovitamix"."main"."mart_listen_and_users__dbt_tmp" rename to "mart_listen_and_users"
[0m08:48:48.224992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.225677 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m08:48:48.225842 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:48:48.225986 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: COMMIT
[0m08:48:48.226352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.227371 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_project.mart_listen_and_users"
[0m08:48:48.227533 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "dbt_project", "target_name": "local", "node_id": "model.dbt_project.mart_listen_and_users"} */
drop table if exists "moovitamix"."main"."mart_listen_and_users__dbt_backup" cascade
[0m08:48:48.227773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:48:48.228363 [debug] [Thread-1 (]: On model.dbt_project.mart_listen_and_users: Close
[0m08:48:48.231225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d1fee12-eef3-415f-90cc-3dbe79a0f1a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075817f0>]}
[0m08:48:48.231524 [info ] [Thread-1 (]: 8 of 8 OK created sql table model main.mart_listen_and_users ................... [[32mOK[0m in 0.02s]
[0m08:48:48.231784 [debug] [Thread-1 (]: Finished running node model.dbt_project.mart_listen_and_users
[0m08:48:48.232372 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:48.232516 [debug] [MainThread]: On master: BEGIN
[0m08:48:48.232636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:48:48.235896 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m08:48:48.236095 [debug] [MainThread]: On master: COMMIT
[0m08:48:48.236231 [debug] [MainThread]: Using duckdb connection "master"
[0m08:48:48.236362 [debug] [MainThread]: On master: COMMIT
[0m08:48:48.236528 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:48:48.236667 [debug] [MainThread]: On master: Close
[0m08:48:48.237254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:48.237426 [debug] [MainThread]: Connection 'model.dbt_project.mart_listen_and_users' was properly closed.
[0m08:48:48.237626 [info ] [MainThread]: 
[0m08:48:48.237783 [info ] [MainThread]: Finished running 3 view models, 3 incremental models, 2 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:48:48.238431 [debug] [MainThread]: Command end result
[0m08:48:48.252180 [info ] [MainThread]: 
[0m08:48:48.252414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:48:48.252570 [info ] [MainThread]: 
[0m08:48:48.252721 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m08:48:48.254032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.70108885, "process_user_time": 1.08995, "process_kernel_time": 0.174199, "process_mem_max_rss": "137150464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:48:48.254278 [debug] [MainThread]: Command `dbt run` succeeded at 08:48:48.254237 after 0.70 seconds
[0m08:48:48.254453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cae1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105558fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b8410>]}
[0m08:48:48.254607 [debug] [MainThread]: Flushing usage events
